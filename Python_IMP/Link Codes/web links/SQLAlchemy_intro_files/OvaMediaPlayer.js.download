!function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){t.exports=i(33)},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t){if(!t)return!1;var e=parseInt(t.get("ga_factor"));if(null!==z||!e)return z;if(1===e)return z=!0;e>100&&(e=100);var i=c(0,e);return z=i===e}function r(t,e,i){n(i)&&l(t,e,i)}function o(t,e,i,s){n(s)&&u(t,e,i,s)}function a(t,e,i){n(i)&&h(t,e,i)}function d(t){return t?1:0}function l(t,e,i){var s=i.get("player_version"),n=i.get("ab_test")||"";e.tag.requiredViewabilityDrawn&&(n+="!ronrv");var r=new XMLHttpRequest;r.open("POST",i.get("kbnul")+"/putes",!0);var o={event:t,timestamp:(new Date).toISOString(),version:s,abTest:n};o=Object.assign(o,e),r.send(x(o))}function u(t,e,i,s){var n=s.get("player_version"),r=s.get("ab_test")||"",o=new XMLHttpRequest;o.open("POST",s.get("kbnul")+"/putes/"+t,!0);var a={event:e,timestamp:(new Date).toISOString(),version:n,abTest:r};a=Object.assign(a,i),o.send(x(a))}function h(t,e,i){var s=i.get("player_version"),n=new XMLHttpRequest;n.open("POST",i.get("kbnul")+"/putes/vast",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t=Object.assign(t,{version:s,timestamp:(new Date).toISOString()},e),n.send(x(t))}function c(t,e){var i=Math.floor(Math.random()*(e-t+1))+t;return i}function p(t,e){var i=q,s=[],n=0;for(e=e||i.length,t=t||22,n=0;n<t;n++)s[n]=i[0|Math.random()*e];return s.join("")}function v(t){return"string"!=typeof t?t:(t=t.replace(/^(http[s]?:|ftp:)/g,""),0!==t.indexOf("//")&&(t="//"+t),t)}function f(t){if(!t||"string"!=typeof t)return 0;var e;t=y(t);var i="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";"undefined"==typeof e&&(e=0);var s=0,n=0;e^=-1;for(var r=0,o=t.length;r<o;r++)n=255&(e^t.charCodeAt(r)),s="0x"+i.substr(9*n,8),e=e>>>8^s;return e^-1}function m(t){t=t||{};for(var e,i=function(){},s=["debug","error","info","log","warn"],n=s.length;n--;)e=s[n],t[e]&&(t[e]=i)}function g(t){var e=/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:\/\n]+)/im.exec(t);return e&&e.length?e[1]:null}function y(t){t=t.replace(/\r\n/g,"\n");for(var e="",i=0;i<t.length;i++){var s=t.charCodeAt(i);s<128?e+=String.fromCharCode(s):s>127&&s<2048?(e+=String.fromCharCode(s>>6|192),e+=String.fromCharCode(63&s|128)):(e+=String.fromCharCode(s>>12|224),e+=String.fromCharCode(s>>6&63|128),e+=String.fromCharCode(63&s|128))}return e}function _(t){var e=0,i={"pre-roll":0,preroll:0,"mid-roll":-1,midroll:-1,"post-roll":-2,postroll:-2};return i.hasOwnProperty(t)&&(e=i[t]),e}function b(t){return t.replace(/\s/g,"")}function w(t,e){t.className.indexOf(e)===-1&&(t.className+=" "+e),t.className=t.className.split("  ").join(" ")}function A(t,e){t.className=t.className.split(e).join("").split("  ").join(" ")}function k(t){var e={};for(var i in t)if(t.hasOwnProperty(i))if("object"==N(t[i])){var s=k(t[i]);for(var n in s)s.hasOwnProperty(n)&&"function"!=typeof s[n]&&(e[i+"_"+n]=s[n])}else e[i]=t[i];return e}function T(t){try{return JSON.parse(x(t))}catch(t){return{}}}function C(t,e,i,s,n){var r=this;try{!n&&t.contentWindow.console.error&&(t.contentWindow.console.error=function(){});var o="iframe"==t.tagName.toLowerCase()?t.contentDocument:t;if(!o)return;var a=o.querySelectorAll(e);a.forEach(function(t){r.DOMIterator(t,e,i,s,n)}),i(o.querySelectorAll(s))}catch(t){return}}function E(t){if(!t)return null;for(var e=t.querySelector("iframe");e;)try{e=e.contentDocument.querySelector("iframe")}catch(t){break}return e}function I(t,e){return{current:t,hasNext:function(){try{return!e&&t.contentWindow.console.error&&(this.current.contentWindow.console.error=function(){}),this.current=this.current.contentDocument.querySelector("iframe"),!0}catch(t){return!1}}}}function V(t){try{return/\{\s*\[native code\]\s*\}/.test(t.toString())}catch(t){return!0}}function x(t,e){try{var i,s=[],n=null;V(Array.prototype.toJSON)||(n=Array.prototype.toJSON,delete Array.prototype.toJSON),i=JSON.stringify(t,function(t,e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":N(e))){if(s.indexOf(e)>-1)return;s.push(e)}return e},e)}catch(t){i=""}return null!==n&&(Array.prototype.toJSON=n),i}function S(t,e,i){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];t&&t.push(e,i,s)}function P(t){return t>1?t/100:t}function L(t){return parseInt(t)}function F(t){return t<1e3?1e3*t:t}function B(t,e){var i=window.cmTag&&window.cmTag.config?window.cmTag.config:{baseReportD:"taboola.com",dataCenter:"am"},s=e.get("baseReportD")||i.baseReportD,n=e.get("dataCenter")||i.dataCenter,r={baseReportD:s,dataCenter:n,cijs:"convusmp",ttype:t,cisd:"convusmp",cipid:e.get("cipid")||"",crid:e.get("creativeId")||"",dast:e.get("auc_dast")||"",cmcv:"",uv:e.get("unit_version")||"",unm:e.get("unit_type")||"",cb:Date.now(),abt:e.get("ab_test")||""};return r}function D(t){var e="//conv"+t.dataCenter+"mp."+t.baseReportD+"/st?";for(var i in t)e+=i+"="+t[i]+"&";var s=document.createElement("img");s.src=e}function O(t,e){return t.filter(function(t){var i=e&&t.hasOwnProperty(e)?t[e]:t;return void 0!==i})}function M(t){var e={};return t.forEach(function(t){e[t.key]=t.value}),e}function R(t,e){for(var i in t)if(t[i]===e)return i;return""}function U(t){var e=t.split("."),i=e[0],s=i.split(":"),n=0,r=1;for(2===e.length&&(n+=parseInt(e[1])/1e3);s.length>0;)n+=r*parseInt(s.pop(),10),r*=60;return n}function j(t,e){var i=e.get("creatives"),s=encodeURIComponent(i.VIDEO_URL&&i.VIDEO_URL.url?i.VIDEO_URL.url:i.VIDEO_URL),n=(new Date).getTime();return t=t.replace(/%%referrer%%/gi,i.REFERRER),t=t.replace(/%%domain%%/gi,i.DOMAIN),t=t.replace(/%%video-url%%/gi,s),t=t.replace(/%%page-url%%/gi,i.PAGE_URL),t=t.replace(/%%player-width%%/gi,i.PLAYER_WIDTH),t=t.replace(/%%player-height%%/gi,i.PLAYER_HEIGHT),t=t.replace(/%%timestamp%%/gi,Math.floor(n/1e3)),t=t.replace(/%%vidlength%%/gi,i.VIDLENGTH),t=t.replace(/%%keywords%%/gi,i.KEY_WORDS),t=t.replace(/%%description%%/gi,i.DESCRIPTION),t=t.replace(/%%vertical%%/gi,i.VERTICAL),t=t.replace(/%%tag%%/gi,i.TAG?i.TAG:""),t=t.replace(/%%title%%/gi,i.TITLE),t=t.replace(/%%cirf%%/gi,encodeURIComponent(decodeURIComponent(i.CIRF))),t=t.replace(/%%cb%%/gi,"R0."+n),t=t.replace(/%%country%%/gi,e.get("country")),t=t.replace(/%%ip%%/gi,e.get("ip")),t=t.replace(/%%ua%%/gi,encodeURIComponent(navigator.userAgent)),t=t.replace(/%%dast%%/gi,e.get("auc_dast")||""),t=t.replace(/%%[^%]*%%/gi,"")}function W(){return Q.UAParser(window.navigator.userAgent)}Object.defineProperty(e,"__esModule",{value:!0});var N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.shouldReport=n,e.reportDb=r,e.reportDebug=o,e.reportVastToDb=a,e.boolToInt=d,e.getRandomInt=c,e.generateGuid=p,e.setUrlPrefix=v,e.crc32=f,e._suppressConsoleMethods=m,e.stripDomain=g,e.getStreamType=_,e.trim=b,e.addClass=w,e.removeClass=A,e.flattenObject=k,e.deepClone=T,e.DOMIterator=C,e.getDeepestIframe=E,e.domIframeIterator=I,e.isNativeCode=V,e.stringify=x,e.logToBI=S,e.normalizeVolume=P,e.roundNumericValue=L,e.normalizeMilliseconds=F,e.createPixelParams=B,e.sendPixel=D,e.filterUndefinededValues=O,e.flattenKeys=M,e.getObjectKeyByValue=R,e.hmsmToSecondsOnly=U,e.replaceMacros=j,e.parseUserAgent=W;var H=i(108),Q=s(H),z=null,q="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split("")},function(t,e,i){(function(e,s){"use strict";function n(){try{var t=I;return I=null,t.apply(this,arguments)}catch(t){return S.e=t,S}}function r(t){return I=t,n}function o(t){return null==t||t===!0||t===!1||"string"==typeof t||"number"==typeof t}function a(t){return"function"==typeof t||"object"==typeof t&&null!==t}function d(t){return o(t)?new Error(g(t)):t}function l(t,e){var i,s=t.length,n=new Array(s+1);for(i=0;i<s;++i)n[i]=t[i];return n[i]=e,n}function u(t,e,i){if(!V.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var s=Object.getOwnPropertyDescriptor(t,e);return null!=s?null==s.get&&null==s.set?s.value:i:void 0}function h(t,e,i){if(o(t))return t;var s={value:i,configurable:!0,enumerable:!1,writable:!0};return V.defineProperty(t,e,s),t}function c(t){throw t}function p(t){try{if("function"==typeof t){var e=V.names(t.prototype),i=V.isES5&&e.length>1,s=e.length>0&&!(1===e.length&&"constructor"===e[0]),n=B.test(t+"")&&V.names(t).length>0;if(i||s||n)return!0}return!1}catch(t){return!1}}function v(t){function e(){}function i(){return typeof s.foo}e.prototype=t;var s=new e;return i(),i(),t}function f(t){return D.test(t)}function m(t,e,i){for(var s=new Array(t),n=0;n<t;++n)s[n]=e+n+i;return s}function g(t){try{return t+""}catch(t){return"[no string representation]"}}function y(t){return t instanceof Error||null!==t&&"object"==typeof t&&"string"==typeof t.message&&"string"==typeof t.name}function _(t){try{h(t,"isOperational",!0)}catch(t){}}function b(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||t.isOperational===!0)}function w(t){return y(t)&&V.propertyIsWritable(t,"stack")}function A(t){return{}.toString.call(t)}function k(t,e,i){for(var s=V.names(t),n=0;n<s.length;++n){var r=s[n];if(i(r))try{V.defineProperty(e,r,V.getDescriptor(t,r))}catch(t){}}}function T(t){return j?s.env[t]:void 0}function C(){if("function"==typeof Promise)try{var t=new Promise(function(){});if("[object Promise]"==={}.toString.call(t))return Promise}catch(t){}}function E(t,e){return t.bind(e)}var I,V=i(7),x="undefined"==typeof navigator,S={e:{}},P="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof e?e:void 0!==this?this:null,L=function(t,e){function i(){this.constructor=t,this.constructor$=e;for(var i in e.prototype)s.call(e.prototype,i)&&"$"!==i.charAt(i.length-1)&&(this[i+"$"]=e.prototype[i])}var s={}.hasOwnProperty;return i.prototype=e.prototype,t.prototype=new i,t.prototype},F=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var i=0;i<t.length;++i)if(t[i]===e)return!0;return!1};if(V.isES5){var i=Object.getOwnPropertyNames;return function(t){for(var s=[],n=Object.create(null);null!=t&&!e(t);){var r;try{r=i(t)}catch(t){return s}for(var o=0;o<r.length;++o){var a=r[o];if(!n[a]){n[a]=!0;var d=Object.getOwnPropertyDescriptor(t,a);null!=d&&null==d.get&&null==d.set&&s.push(a)}}t=V.getPrototypeOf(t)}return s}}var s={}.hasOwnProperty;return function(i){if(e(i))return[];var n=[];t:for(var r in i)if(s.call(i,r))n.push(r);else{for(var o=0;o<t.length;++o)if(s.call(t[o],r))continue t;n.push(r)}return n}}(),B=/this\s*\.\s*\S+\s*=/,D=/^[a-z$_][a-z$_0-9]*$/i,O=function(){return"stack"in new Error?function(t){return w(t)?t:new Error(g(t))}:function(t){if(w(t))return t;try{throw new Error(g(t))}catch(t){return t}}}(),M=function(t){return V.isArray(t)?t:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var R="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,i=[],s=t[Symbol.iterator]();!(e=s.next()).done;)i.push(e.value);return i};M=function(t){return V.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?R(t):null}}var U="undefined"!=typeof s&&"[object process]"===A(s).toLowerCase(),j="undefined"!=typeof s&&"undefined"!=typeof s.env,W={isClass:p,isIdentifier:f,inheritedDataKeys:F,getDataPropertyOrDefault:u,thrower:c,isArray:V.isArray,asArray:M,notEnumerableProp:h,isPrimitive:o,isObject:a,isError:y,canEvaluate:x,errorObj:S,tryCatch:r,inherits:L,withAppended:l,maybeWrapAsError:d,toFastProperties:v,filledRange:m,toString:g,canAttachTrace:w,ensureErrorObject:O,originatesFromRejection:b,markAsOriginatingFromRejection:_,classString:A,copyDescriptors:k,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:U,hasEnvVariables:j,env:T,global:P,getNativePromise:C,domainBind:E};W.isRecentNode=W.isNode&&function(){var t=s.versions.node.split(".").map(Number);return 0===t[0]&&t[1]>10||t[0]>0}(),W.isNode&&W.toFastProperties(s);try{throw new Error}catch(t){W.lastLineError=t}t.exports=W}).call(e,function(){return this}(),i(10))},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),n=function(){function t(e){i(this,t),this.label="["+e+"]",this.isDevelopModeOn=this.debugLevels.indexOf("develop")>-1,this.isTrackerOn=this.debugLevels.indexOf("*")>-1||this.debugLevels.indexOf("qa")>-1||this.isDevelopModeOn}return s(t,[{key:"table",value:function(t){this.isDevelopModeOn&&console.table(t)}},{key:"_templateLogging",value:function(t,e,i,s){if(this.isTrackerOn){var n="";for(var r in i)n+=r+": "+i[r]+"; ";"string"==typeof e?console[s]("%c"+this.label+" ["+t+"] "+e,n):console[s]("%c"+this.label+" ["+t+"]",n,e)}}},{key:"debug",value:function(t,e,i){}},{key:"error",value:function(t,e,i){this._templateLogging(t,e,i,"error")}},{key:"warn",value:function(t,e,i){this._templateLogging(t,e,i,"warn")}},{key:"info",value:function(t,e,i){this._templateLogging(t,e,i,"info")}},{key:"log",value:function(t,e,i){this._templateLogging(t,e,i,"log")}}]),t}();n.prototype.debugLevels="",e.default=n},function(t,e){"use strict";t.exports={AdLoaded:"AdLoaded",AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdSkippableStateChange:"AdSkippableStateChange",AdSizeChange:"AdSizeChange",AdLinearChange:"AdLinearChange",AdDurationChange:"AdDurationChange",AdExpandedChange:"AdExpandedChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdLog:"AdLog",AdError:"AdError",SoundViolation:"SoundViolation",HijackAttempt:"HijackAttempt",Progress:"Progress"}},function(t,e,i){"use strict";function s(t,e){function i(s){return this instanceof i?(h(this,"message","string"==typeof s?s:e),h(this,"name",t),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new i(s)}return u(i,Error),i}function n(t){return this instanceof n?(h(this,"name","OperationalError"),h(this,"message",t),this.cause=t,this.isOperational=!0,void(t instanceof Error?(h(this,"message",t.message),h(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new n(t)}var r,o,a=i(7),d=a.freeze,l=i(2),u=l.inherits,h=l.notEnumerableProp,c=s("Warning","warning"),p=s("CancellationError","cancellation error"),v=s("TimeoutError","timeout error"),f=s("AggregateError","aggregate error");try{r=TypeError,o=RangeError}catch(t){r=s("TypeError","type error"),o=s("RangeError","range error")}for(var m="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),g=0;g<m.length;++g)"function"==typeof Array.prototype[m[g]]&&(f.prototype[m[g]]=Array.prototype[m[g]]);a.defineProperty(f.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),f.prototype.isOperational=!0;var y=0;f.prototype.toString=function(){var t=Array(4*y+1).join(" "),e="\n"+t+"AggregateError of:\n";y++,t=Array(4*y+1).join(" ");for(var i=0;i<this.length;++i){for(var s=this[i]===this?"[Circular AggregateError]":this[i]+"",n=s.split("\n"),r=0;r<n.length;++r)n[r]=t+n[r];s=n.join("\n"),e+=s+"\n"}return y--,e},u(n,Error);var _=Error.__BluebirdErrorTypes__;_||(_=d({CancellationError:p,TimeoutError:v,OperationalError:n,RejectionError:n,AggregateError:f}),a.defineProperty(Error,"__BluebirdErrorTypes__",{value:_,writable:!1,enumerable:!1,configurable:!1})),t.exports={Error:Error,TypeError:r,RangeError:o,CancellationError:_.CancellationError,OperationalError:_.OperationalError,TimeoutError:_.TimeoutError,AggregateError:_.AggregateError,Warning:c}},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function t(e){i(this,t),this.parent=e,this.events={},this.dispatchEvent=function t(e,i,s){var n=t.beacon;if(void 0==i&&(i={}),e&&n.events[e]){for(var r=0;r<n.events[e].useCapture.length;r++)n.events[e].useCapture[r].assignedFunction.apply(n.parent,[{dispatcher:s?s:n.parent,type:e,eventData:i,staticData:n.events[e].useCapture[r].static_data}]);for(var r=0;r<n.events[e].noCapture.length;r++)n.events[e].noCapture[r].assignedFunction.apply(n.parent,[{dispatcher:s?s:n.parent,type:e,eventData:i,staticData:n.events[e].noCapture[r].static_data}])}},this.dispatchEvent.beacon=this,this.removeEventListener=function t(e,i){var s=t.beacon;if(e){if(void 0==i&&s.events[e])return void(s.events[e]={useCapture:[],noCapture:[]});if(i&&s.events[e]&&"function"==typeof i){for(var n=[],r=0;r<s.events[e].useCapture.length;r++)s.events[e].useCapture[r].assignedFunction!=i&&n.push(s.events[e].useCapture[r]);s.events[e].useCapture=n,n=[];for(var r=0;r<s.events[e].noCapture.length;r++)s.events[e].noCapture[r].assignedFunction==i&&n.push(s.events[e].noCapture[r]);s.events[e].noCapture=n}}},this.removeEventListener.beacon=this,this.addEventListener=function t(e,i,s){var n=t.beacon;if(e&&"function"==typeof i){for(var r=[],o=3;o<arguments.length;o++)r.push(arguments[o]);n.events[e]||(n.events[e]={useCapture:[],noCapture:[]}),s?n.events[e].useCapture.push({assignedFunction:i,static_data:r}):n.events[e].noCapture.push({assignedFunction:i,static_data:r})}},this.addEventListener.beacon=this,this.listEvents=function t(){return Object.keys(t.beacon.events)},this.listEvents.beacon=this,this.listEventHandlers=function(t){var e=dispatchEvent.beacon;if(!t||!e.events[t])return[];var i,s=[];i=e.events[t].useCapture;for(var n=0;n<i;n++)s.push(e.events[t].useCapture[n]);i=e.events[t].noCapture;for(var n=0;n<i;n++)s.push(e.events[t].noCapture[n]);return s},this.listEventHandlers.beacon=this,this.destroy=function(){for(var t in self.events)self.events[t]=null;self.events={}}};e.default=s},function(t,e){var i=function(){"use strict";return void 0===this}();if(i)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:i,propertyIsWritable:function(t,e){var i=Object.getOwnPropertyDescriptor(t,e);return!(i&&!i.writable&&!i.set)}};else{var s={}.hasOwnProperty,n={}.toString,r={}.constructor.prototype,o=function(t){var e=[];for(var i in t)s.call(t,i)&&e.push(i);return e},a=function(t,e){return{value:t[e]}},d=function(t,e,i){return t[e]=i.value,t},l=function(t){return t},u=function(t){try{return Object(t).constructor.prototype}catch(t){return r}},h=function(t){try{return"[object Array]"===n.call(t)}catch(t){return!1}};t.exports={isArray:h,keys:o,names:o,defineProperty:d,getDescriptor:a,freeze:l,getPrototypeOf:u,isES5:i,propertyIsWritable:function(){return!0}}}},function(t,e){"use strict";function i(t,e,i,s,n,r){function o(t,e,i,s,n,r,o){if(!t)return!1;e=e||"";var d=new XMLHttpRequest,u=e?"POST":"GET";return d.open(u,t,!0),d.withCredentials=!0,r===!1&&(d.withCredentials=!1),d.setRequestHeader("Content-type",l),d.async=void 0==n||n,d.callback="function"==typeof i?i:function(){},d.fallback="function"==typeof s?s:function(){},d.timeout=o,d.gotResponse=!1,d.addEventListener("error",function(t){this.gotResponse||(this.gotResponse=!0,d.fallback())}),d.addEventListener("load",function(t){this.gotResponse||(this.gotResponse=!0,d.fallback())}),d.addEventListener("abort",function(t){this.gotResponse||(this.gotResponse=!0,d.fallback())}),d.addEventListener("timeout",function(t){this.gotResponse||(this.gotResponse=!0,d.fallback())}),d.addEventListener("readystatechange",function(r){if(4==this.readyState){if(this.gotResponse)return;switch(this.gotResponse=!0,this.status+""){case"200":case"460":this.callback(this.responseText,c);break;default:if(!h)return c.push(this.status),void a(t,e,i,s,n,!1,o);c.push(this.status),this.fallback(c,t)}}}),d.send(e),!0}function a(t,e,i,s,n,r,a){h=!0,o(t,e,i,s,n,!1,a)}var d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5e3,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"application/x-www-form-urlencoded",u=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],h=!u,c=[];o(t,e,i,s,n,r,d)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e){"use strict";t.exports={tagStarted:0,tagImpression:1,vastFecthError:2,emptyVast:3,mediaFileNotSupported:4,adError:5,filterVastByRegex:6,playerClosed:7,vastError:8,totalTimeout:9,adErrorBeforeLoad:10,networkError:11,adUnitLoadFailed:12,queueExpired:13,queueTrimmed:14,globalTimeout:15,adtoTimeout:16,adSkiped:17,adloadedTimeout:18,hijackAttempt:19,idleMode:20,firstImpression:99,videoFirstQuartile:21,videoMidpoint:22,videoThirdQuartile:23,videoComplete:24,newCompletion:25,replayAd:27,soundViolation:34,firstWfMeasurment:35,playerClosedMeasurment:36,maxNetworkCalls:39,adLoaded:41,startAd:42,videoThrottle:48,globalAdTimeout:53,fallBackCanvas:70}},function(t,e){function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function n(t){if(u===setTimeout)return setTimeout(t,0);if((u===i||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function r(t){if(h===clearTimeout)return clearTimeout(t);if((h===s||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function o(){f&&p&&(f=!1,p.length?v=p.concat(v):m=-1,v.length&&a())}function a(){if(!f){var t=n(o);f=!0;for(var e=v.length;e;){for(p=v,v=[];++m<e;)p&&p[m].run();m=-1,e=v.length}p=null,f=!1,r(t)}}function d(t,e){this.fun=t,this.array=e}function l(){}var u,h,c=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:i}catch(t){u=i}try{h="function"==typeof clearTimeout?clearTimeout:s}catch(t){h=s}}();var p,v=[],f=!1,m=-1;c.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];v.push(new d(t,e)),1!==v.length||f||n(a)},d.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=l,c.addListener=l,c.once=l,c.off=l,c.removeListener=l,c.removeAllListeners=l,c.emit=l,c.prependListener=l,c.prependOnceListener=l,c.listeners=function(t){return[]},c.binding=function(t){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(t){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},function(t,e){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function s(t){return"function"==typeof t}function n(t){return"number"==typeof t}function r(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if(!n(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,i,n,a,d,l;if(this._events||(this._events={}),"error"===t&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var u=new Error('Uncaught, unspecified "error" event. ('+e+")");throw u.context=e,u}if(i=this._events[t],o(i))return!1;if(s(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),i.apply(this,a)}else if(r(i))for(a=Array.prototype.slice.call(arguments,1),l=i.slice(),n=l.length,d=0;d<n;d++)l[d].apply(this,a);return!0},i.prototype.addListener=function(t,e){var n;if(!s(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,s(e.listener)?e.listener:e),this._events[t]?r(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,r(this._events[t])&&!this._events[t].warned&&(n=o(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){function i(){this.removeListener(t,i),n||(n=!0,e.apply(this,arguments))}if(!s(e))throw TypeError("listener must be a function");var n=!1;return i.listener=e,this.on(t,i),this},i.prototype.removeListener=function(t,e){var i,n,o,a;if(!s(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(i=this._events[t],o=i.length,n=-1,i===e||s(i.listener)&&i.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(r(i)){for(a=o;a-- >0;)if(i[a]===e||i[a].listener&&i[a].listener===e){n=a;break}if(n<0)return this;1===i.length?(i.length=0,delete this._events[t]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[t],s(i))this.removeListener(t,i);else if(i)for(;i.length;)this.removeListener(t,i[i.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?s(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(s(e))return 1;if(e)return e.length}return 0},i.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var d=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),l=i(3),u=(n(l),i(11)),h=i(1),c=s(h),p=i(4),v=n(p),f=i(69),m=2e3,g=function(t){function e(t,i,s,n,a,d,l){r(this,e);var u=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return u.video=t,u.target=l,u.store=a,u.createCanvas(),u.modifyVideo(t),u.owner=i,u.shouldAutoPlay=s||!1,u.canvasCss=n||{},u.bypass=!1,u.clntRedirRslvWhiteList=u.store.get("mpgclrslv")||[],u.ready=!1,u.loop=d,u.vidAttr={},t.muted=!0,u.status="LOADING",u.quartiles=[{event:v.default.AdVideoFirstQuartile,percentage:.25},{event:v.default.AdVideoMidpoint,percentage:.5},{event:v.default.AdVideoThirdQuartile,percentage:.75}],u.owner&&c.logToBI(u.owner.vpaidLog,"canvas",{ctor:!0}),u}return a(e,t),d(e,[{key:"emitStartAd",value:function(){var t=this;this.stratAdCalled=!0,this._playTimeout=setTimeout(function(){t._play()},m)}},{key:"backToVideoTag",value:function(t){var e=this;if(!this.bypass&&this.src){this.bypass=!0;var i=this.jsmpeg.currentTime,s=this.video.style,n=this.video.parentElement||this.target,r=parseInt(this.canvas.style.zIndex),o=this.jsmpeg.loop;this.newVid=n.appendChild(document.createElement("video")),this.newVid.className="mc-loud-video",this.newVid.setAttribute("playsinline",""),this.newVid.setAttribute("autoplay",""),o&&this.newVid.setAttribute("loop",""),this.newVid.style.height=s.height,this.newVid.style.width=s.width,this.newVid.style.top=s.top?s.top:"0",this.newVid.style.left=s.left?s.left:"0",this.newVid.style.background="#000000",this.newVid.style.zIndex=r,this.newVid.style.display="none",this.newVid.src=this.src,this.newVid.volume="muteChanged"===t.type?this.store.get("dfltvlm"):0,this.newVid.muted=0===this.newVid.volume,this.newVid.addEventListener("ended",function(t){e.dispatchDOM("ended")},!1),this.newVid.addEventListener("click",function(t){
e.dispatchDOM("click",t)});var a=function(){e.tuTicker=clearInterval(e.tuTicker),e.jsmpeg.stop(),e.jsmpeg=void 0,e.newVid.style.display="block",e.canvas.style.display="none",e.video.style.display="none",("playChanged"===t.type||e.video.paused)&&e._pause(),e.emit("newVidCreated",e.newVid)},d=function t(){if(0!==e.newVid.duration){e.newVid.removeEventListener("durationchange",t);var s=e.jsmpeg&&e.jsmpeg.currentTime>0?e.jsmpeg.currentTime:i;if(0===e.newVid.currentTime||e.newVid.currentTime<s){e.newVid.currentTime=s;var n=function t(){e.newVid.currentTime>s&&(e.newVid.removeEventListener("timeupdate",t),a())};e.newVid.addEventListener("timeupdate",n)}}};this.newVid.addEventListener("durationchange",d),this.newVid.currentTime=i,this.newVid.play().then(function(){e.newVid.currentTime=i}),this.isCanvasFinished=!1}}},{key:"mpegFinish",value:function(){this.isCanvasFinished||(this.emit("canvasEnded"),this.dispatchDOM("ended"),this.isCanvasFinished=!0)}},{key:"onLoad",value:function(){var t=this;if(!this.loaded){this.loaded=!0;var e=parseInt(this.store.get("width")),i=parseInt(this.store.get("height"));this.onResize(e,i),setTimeout(function(){t.ready=!0,t.emit("ready"),t.dispatchDOM("loadedmetadata")},0)}}},{key:"createCanvas",value:function(){var t=this,e=document.createElement("canvas");e.className="mc-video mc-canvas",this.store.get("isMultiVpaidUnit")&&c.addClass(e,"multi-vpaids");var i=this.video.parentElement||this.target;this.canvas=i.appendChild(e),i.className+=" mpegcnv";var s=this;this.video&&this.video.addEventListener("resize",function(t){s.onResize(t.target.clientWidth,t.target.clientHeight)}),this.canvas.addEventListener("click",function(e){t.dispatchDOM("click",e)})}},{key:"onResize",value:function(t,e){this.jsmpeg&&this.canvas&&(this.canvas.style.position="absolute",this.canvas.style.top="0px",this.canvas.style.width=t+"px",this.canvas.style.height=e+"px"),this.height=e,this.width=t}},{key:"hookProp",value:function(t,e,i,s){var n="alt_"+e;t.hasOwnProperty(n)||(t[n]="",Object.defineProperty(t,e,{get:function(){var t=i?i():this[n];return t},set:function(i){this[n]=i,s&&s(i)&&t.setAttribute(e,i)}}))}},{key:"hookMethod",value:function(t,e,i){this.hooks||(this.hooks=[]),this.hooks[e]=t[e];var s=this;t[e]=function(){var t={};if(i(arguments,t)){if(!s.hooks.hasOwnProperty(e)||"function"!=typeof s.hooks[e])return!1;var n=s.hooks[e].apply(this,arguments);return t.res?t.res:n}}}},{key:"dispatchDOM",value:function(t,e){if(this.video){var i=new Event(t);this.video.dispatchEvent(i)}}},{key:"errHndlr",value:function(t){this.owner&&(c.logToBI(this.owner.vpaidLog,"jsmpegError",t),this.owner._onPlayerError&&this.owner._onPlayerError())}},{key:"isUrlInRslvWhiteList",value:function(t){if(!this.clntRedirRslvWhiteList.length)return!0;for(var e=0;e<this.clntRedirRslvWhiteList.length;++e)if(t.indexOf(this.clntRedirRslvWhiteList[e])>-1)return!0;return!1}},{key:"setSrc",value:function(t){if(t=t.trim(),t&&!this.hasVidUrl){c.logToBI(this.owner.vpaidLog,"canvasUrl",{url:t}),this.hasVidUrl=!0,"javascript"==this.owner.tech&&this.video&&this.video._vidSetAttr("src",t),this.src=t;var e=this.store.get("cnvsldrt"),i=parseInt(this.store.get("width")),s=parseInt(this.store.get("height")),n={loadeReadyRate:e,canvas:this.canvas,audio:!1,centerVertically:!0,autoplay:this.shouldAutoPlay,loop:this.loop||!1,pcy:s,pcx:i,onload:this.onLoad.bind(this),errHndlr:this.errHndlr.bind(this),onfinished:this.mpegFinish.bind(this),progressive:!1,canvasCss:this.canvasCss,disableGl:this.store.get("dsbgl")},r=this.store.get("gtvid2"),o=r+"="+encodeURIComponent(t);return(/\.mpg$/.test(t)||/\.mpeg$/.test(t))&&(o=t),this.jsmpeg=new f(o,n,this),this._setVideoDuration(this.src),!1}}},{key:"_play",value:function(){var t=this;if(!this.blockActions){if(clearTimeout(this._playTimeout),this._timeUpdateTicker(),!this.ready)return void this.on("ready",function(){t.emit("play"),t._play()});this.newVid?this.newVid.play():this.jsmpeg.play(),this.dispatchDOM("playing"),this.status="PLAYING",this._render()}}},{key:"_timeUpdateTicker",value:function(){var t=this;clearInterval(this.tuTicker),this.tuTicker=setInterval(function(){t.dispatchDOM("timeupdate"),t.quartiles.length>0&&t.video.currentTime/t.video.duration>=t.quartiles[0].percentage&&c.logToBI(t.owner.vpaidLog,"canvas_quartiles",{event:t.quartiles.shift().event})},1e3)}},{key:"_pause",value:function(){this.stopped||(this.status="PAUSED",this._render(),this.newVid?this.newVid.pause():this.jsmpeg?this.jsmpeg.pause():"")}},{key:"muteButtonClick",value:function(t){if(!this.stopped){var e=!!this.newVid&&!this.newVid.muted;if(c.logToBI(this.owner.vpaidLog,"canvasMuteToggle",{muted:e}),!this.newVid)return void this.backToVideoTag({type:"muteChanged"});this.newVid.volume=this.newVid.muted?this.store.get("dfltvlm"):0,this.newVid.muted=0===this.newVid.volume}}},{key:"playButtonClick",value:function(t){if(!this.stopped){var e="PLAYING"===this.status?"PAUSED":"PLAYING";if(c.logToBI(this.owner.vpaidLog,"canvasPlayToggle",{status:e,view:this.newVid?"newVid":"canvas"}),this.status=e,!this.newVid)return void this.backToVideoTag({type:"playChanged"});var i=this.newVid||this.jsmpeg;"PLAYING"===this.status?i.play():i.pause(),this._render()}}},{key:"modifyVideo",value:function(t){var e=this;if(!this.stopped){var i=this;t._vidSetAttr=t.setAttribute,t.getAttribute=function(t,i){return e.vidAttr[t]},t.setAttribute=function(s,n){if(!i.stopped)return e.vidAttr[s]=n,"volume"===s&&(e._volume=n),c.logToBI(i.owner.vpaidLog,"hookSetAttribute",{key:s,val:n}),"src"===s?void e.setSrc(n):t._vidSetAttr(s,n)},this.hookMethod(t,"play",function(){if(!i.stopped)return c.logToBI(i.owner.vpaidLog,"hookMethodPlay",{hookMethod:!0}),i._play(),i.dispatchDOM("playing"),!1}),this.hookMethod(t,"pause",function(){if(!i.stopped)return c.logToBI(i.owner.vpaidLog,"hookMethodPause",{hookMethod:!0}),i._pause(),!0}),this.hookMethod(t,"stop",function(){if(c.logToBI(i.owner.vpaidLog,"hookMethodStop",{hookMethod:!0}),!i.stopped)return i.jsmpeg.stop(),!0}),this.hookProp(t,"paused",function(){return"PAUSED"===this.status}.bind(this),null),this.hookProp(t,"src",null,this.setSrc.bind(this)),this.hookProp(this.video,"volume",function(){return e.newVid?e.newVid.volume:e._volume},function(t){return e._volume=t,!0}),this.hookProp(t,"currentTime",function(){var t=i.newVid||i.jsmpeg;return t?t.currentTime:0},null),this.hookProp(t,"duration",function(){if(i.duration)return i.duration},function(t){i.duration=t})}}},{key:"_setVideoDuration",value:function(t){var e=this,i=document.createElement("video");i.src=t,i.addEventListener("loadedmetadata",function(){e.video&&(e.video.duration=i.duration),i.src="",i=void 0}),i.load()}},{key:"_render",value:function(){this.newVid||this.canvas}},{key:"hide",value:function(){this.stopped||(this.canvas.style.display="none",this._render())}},{key:"show",value:function(){this.stopped||(this.canvas.style.display="block",this._render())}},{key:"removeDomMember",value:function(t){var e=t.parentNode;e.removeChild(t)}},{key:"restartAd",value:function(){var t=this;this.stopped||(this.newVid?(this.newVid.currentTime=0,this.newVid.play()):this.jsmpeg&&(this.blockActions=!0,this.jsmpeg.stop(),setTimeout(function(){t.jsmpeg.play()},20),setTimeout(function(){t.blockActions=!1},2e3)))}},{key:"destroy",value:function(){clearTimeout(this._playTimeout),clearInterval(this.tuTicker),this.jsmpeg=void 0;var t=this._events;for(var e in t)this.removeAllListeners(e);this.removeDomMember(this.canvas),this.canvas=void 0}}]),e}(u.EventEmitter);e.default=g},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=i(1),a=s(o),d={event_AdImpression:"conversion",event_SoundViolation:"soundViolation",adStartTimeout:"adStartTimeout",AutoKill:"auto_kill",AdStopADTO:"before_startAd_timeout",queueTrimmed:"queueTrimmed",adPlayTimeout:"adPlayTimeout",queueExpired:"removed_from_queue",tagError:"tagError",vastFilterdByRegex:"vast_blacklisted",event_AdLoaded:"adLoaded",fetchVastXhr:"fetchVastXhr",fetchVastFallToXhr:"fetchVastFallToXhr",vpaidTimeout_AdLoaded:"adload_timeout",creatingVpaidHandler:"initVpaid",createdVpaidHandler:"before_adload",creatingVpaidHandlerError:"creatingVpaidHandlerError",networkError:"networkError",adUnitLoadFailed:"vpaid_unit_failed",adloadedTimeout:"adload_timeout",adImpressionTimeout:"adImpressionTimeout",playerClosed:"playerClosed",idleMode:"idleMode",hijackAttempt:"vpaid_blacklisted_url"},l=["conversion","soundViolation","timeout","bfRon","adPlayTimeout","vast_blacklisted","tagError","queueTrimmed","before_startAd_timeout","auto_kill","vpaidTimeout","creatingVpaidHandlerError","networkError","vpaid_unit_failed","adload_timeout","adImpressionTimeout","idleMode","vpaid_blacklisted_url","removed_from_queue"],u={NoMediaFiles:"empty_vast",event_AdError:"ad_error",vastxhrerror_noflash:"vast_fetch_fail",WrapperError:"wrapper_error",ParsingError:"xml_parsing_error",NoMediaFileAfterSort:"unsupported_mediafile"},h={BfRon:!0},c={difa:"idfa",aid:"appId",aname:"appName"},p=1e4,v=function(){function t(e,i){var s=this;n(this,t),this.tag=e,this.store=i,this.created=Date.now(),this.dataChanged=!1,this.friendlyVideoUrl=!1,this.iframesDetector=this.store.get("iframesDetector");var r=this.store.get("dast"),o="";r&&(o=r.cicmp);var d=this.store.get("subUnitType");this.sessionStarted=this.store.get("session_started")||this.created,this.data={_id:a.generateGuid(10),player_id:this.store.get("player_id"),tag:e,isMobile:e.isMobile,created:(new Date).toISOString(),timeSinceSessionStarted:this.created-this.sessionStarted,dp:e.dp,status:"new",statuses:["new"],unitType:e.unitType,unitVersion:e.unitVersion,firstlookAD:e.flad||0,itemScore:-1,waterfallIndex:e.waterfallIndex,fullPageUrl:this.store.get("fullPageUrl"),requiredViewability:e.requiredViewability,documentVisible:!document.hidden,oneAuction:this.store.get("mltads"),su:void 0!=d?d:-99999,redId:this.store.get("red_id")||"na",displayLineItem:o,updatesCount:0,serverSideDataSaver:this.store.get("serverSideDataSaver")||"na",clientSideDataSaver:this.store.get("clientSideDataSaver")||"na",dataSaver:this.store.get("dataSaver"),taboolaVpaid:this.store.get("istblvpd"),costModel:e.costModel,hasHjk:!!this.store.get("hjkFuncString"),hasDsm:!!this.store.get("dsm"),hasVpaidAnalytics:!!this.store.get("analyticsFuncString")},Object.assign(this.data,this._getDastData()),this.isReportDb=!1,this.dtor=!1,this._dataModified=!0,this.updatingInterval=setInterval(function(){s._dataModified&&s._sendData()},p)}return r(t,[{key:"_getDastData",value:function(){var t=this.store.get("dast")||{},e={},i=!1;for(var s in c){var n=t[s];if(n){var r=c[s];e[r]=n,i=!0}}return e.inApp=i,this.store.set("isInApp",i),e}},{key:"push",value:function(t,e,i){if(this.data){if(t.indexOf("AdError")>-1||"event_SoundViolation"===t)this._addStatus(this._prettyErrorStatus(t,e));else if(d.hasOwnProperty(t)&&"conversion"!==this.data.status)this._addStatus(d[t]);else if(h.hasOwnProperty(t)){var s="is"+t;this.data[s]=!0}var n=Date.now(),r=n-this.created;if(e.time=r,this._dataChanged(),!i&&this.data.hasOwnProperty(t))return Array.isArray(this.data[t])||(this.data[t]=[this.data[t]]),this.data[t].push(e),void(this.data[t].length>3&&this.data[t].splice(0,1));this.data[t]=e,l.indexOf(this.data.status)!==-1&&this._setDpStats()}}},{key:"_dataChanged",value:function(){this._dataModified=!0}},{key:"_sendData",value:function(){this._collectDataFromVpaidAnalytics(),this.data&&this.data.updatesCount++,a.reportDb("VpaidLog",this.data,this.store),this._dataModified=!1}},{key:"_collectDataFromVpaidAnalytics",value:function(){try{if(this.getVpaidAnalyticsReport){var t=this.getVpaidAnalyticsReport();t.realTotalRequestsCounter=t.totalRequestsCounter,this._wrappersCount&&(t.totalRequestsCounter+=this._wrappersCount,t.wrappersCount=this._wrappersCount);var e=this.iframesDetector.detect(t.iframes,this.friendlyVideoUrl);t.totalRequestsCounter+=this.iframesDetector.calculateWeightsByIframeType(e),t.totalRequestsCounter-=t.iframes.length,this.push("vpaidAnalytics",t,!0),this.push("vpaidIframesDetection",e,!0)}}catch(t){this.push("vpaidAnalyticsCollectFail",{ex:t})}}},{key:"_prettyErrorStatus",value:function(t,e){var i=e.errType?e.errType:t;return u.hasOwnProperty(i)?u[i]:"error_"+i}},{key:"_setDpStats",value:function(){if(!this.isDPStatusSet&&!this.store.get("static_schedule")){var t=Date.now();if(this.data.dtor=!0,this.data.timeFromLastPlayFromQueue=t-this.store.get("playFromQueue"),this.data.timeFromLastPlayFromQueueFound=t-this.store.get("playFromQueueFound"),this.isDPStatusSet=!0,this._incrStats(".tries"),"conversion"===this.data.status){this._incrStats(".conversions"),this.store.set(this.tag.dp+".failsRow",0);var e=this.store.get(this.tag.lineItem+".failsRow");this.store.set(this.tag.lineItem+".failsInARowTillConversion",e<0?0:e),this.store.set(this.tag.lineItem+".failsRow",0)}else this._incrStats(".fails"),this.store.get(this.tag.lineItem+".failsRow")<0?this.store.set(this.tag.lineItem+".failsRow",1):this._incrStats(".failsRow");var i=this.store.get(this.tag.dp)||{fails:0,failsRow:0,conversions:0},s=this.store.get(this.tag.lineItem)||{};s.fails||(s.fails=0),s.failsRow||(s.failsRow=0),s.conversions||(s.conversions=0),i.lineItems=i.lineItems||[],i.lineItems.indexOf(this.tag.lineItem)===-1&&i.lineItems.push(this.tag.lineItem),this.data.lineItemLog=s,this.data.dpLog=i,this.data.conversionsCount=this.store.get("conversionsCount"),this.data.unit={width:this.store.get("width"),height:this.store.get("height")};var n=this.store.get("lineItems")||[];n.indexOf(this.tag.lineItem)===-1&&(n.push(this.tag.lineItem),this.store.set("lineItems",n)),this.store.set(this.tag.lineItem,s)}}},{key:"_incrStats",value:function(t){this.store.incr(this.tag.dp+t),this.store.incr(this.tag.lineItem+t)}},{key:"saveToDb",value:function(){if(this.data){this._setDpStats();var t;try{t=cmTag.utils.getLoopTime()}catch(t){}t&&(this.data.loopTime=t),this._reportDb()}}},{key:"_reportDb",value:function(){this.isReportDb||(this.data.updatesCount++,a.reportDb("VpaidLog",this.data,this.store),this.tag=null,this.data=null,this.store=null,this.isReportDb=!0,this._dataModified=!1,clearInterval(this.updatingInterval))}},{key:"_addStatus",value:function(t){var e=this;l.indexOf(this.data.status)===-1&&(this.data.status=t,this.data.statuses.push(t),"conversion"===t&&setTimeout(function(){e._sendData()},2e3))}},{key:"toString",value:function(){return a.stringify(this.data,4)}},{key:"setVastWrapperCount",value:function(t){this._wrappersCount=t}}]),t}();e.default=v},function(t,e,i){"use strict";function s(t,e,i,s,n){i=i||{},this._id=p(),this._destroyed=!1,this.store=n,this._frameContainer=c.createElementInEl(t,"div"),this._videoEl=e,this._vpaidOptions=s||{timeout:1e4},this._templateConfig={template:i.template||f,extraOptions:i.extraOptions||{}}}function n(t){var e=this[t];e&&(e.remove&&e.remove(),delete this[t])}function r(){a.call(this),delete this._adUnit}function o(){a.call(this),l.call(this)}function a(){n.call(this,"_frame"),d.call(this)}function d(){this._onLoad&&(window.removeEventListener("message",this._onLoad),c.clearCallbackTimeout(this._onLoad),delete this._onLoad)}function l(){this._adUnit&&(this._adUnit.stopAd(),delete this._adUnit)}function u(){if(this._destroyed)throw new Error("VPAIDHTML5Client already destroyed!")}function h(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}var c=i(15),p=c.unique("vpaidIframe"),v=i(26),f='<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"></head><body style="margin:0;padding:0"><div class="ad-element"></div><script type="text/javascript" src="{{iframeURL_JS}}"></script><script type="text/javascript">window.parent.postMessage(\'{"event": "ready", "id": "{{iframeID}}"}\', \'{{origin}}\');</script></body></html>',m="AdStopped";s.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,o.call(this))},s.prototype.isDestroyed=function(){return this._destroyed},s.prototype.loadAdUnit=function(t,e){function i(t){if(t.origin===h()){var i;try{i=JSON.parse(t.data)}catch(t){i={}}if(i.id===n.getID()){var s,o,a;if(n._frame.contentWindow?(a=n._frame.contentWindow.getVPAIDAd,o=c.validate("function"==typeof a,"the ad didn't return a function to create an ad")):o="the iframe is not anymore in the DOM tree",!o){var l=n._frame.contentWindow.document.querySelector(".ad-element");s=new v(a(),l,n._videoEl,n._frame),s.subscribe(m,r.bind(n)),o=c.validate(s.isValidVPAIDAd(),"the add is not fully complaint with VPAID specification")}return n._adUnit=s,d.call(n),e(o,o?null:s),!0}}}function s(){e("timeout",null)}u.call(this),o.call(this);var n=this,a=c.createIframeWithContent(this._frameContainer,this._templateConfig.template,c.extend({iframeURL_JS:t,iframeID:this.getID(),origin:h()},this._templateConfig.extraOptions));this.store.get("msnifrmsrchk")&&(a._src=a.src,Object.defineProperty(a,"src",{get:function(){return a._src},set:function(t){}})),this._frame=a,this._onLoad=c.callbackTimeout(this._vpaidOptions.timeout,i.bind(this),s.bind(this)),window.addEventListener("message",this._onLoad)},s.prototype.unloadAdUnit=function(){o.call(this)},s.prototype.getID=function(){return this._id},t.exports=s},function(t,e){"use strict";function i(){}function s(t,e){return t?null:new Error(e)}function n(t){var e=f[t];e&&(clearTimeout(e),delete f[t])}function r(t,e,s){var r,o;return o=setTimeout(function(){e=i,delete o[r],s()},t),r=function(){e.apply(this,arguments)&&n(r)},f[r]=o,r}function o(t,e,i){var s=document.createElement(e);return i&&(s.id=i),t.appendChild(s),s}function a(t,e,i){var s=d(t,null,i.zIndex);if(h(s,u(e,i)))return s}function d(t,e,i){var s=document.createElement("iframe");return s.src=e||"about:blank",s.marginWidth="0",s.marginHeight="0",s.frameBorder="0",s.width="100%",s.height="100%",l(s),i&&(s.style.zIndex=i),s.setAttribute("SCROLLING","NO"),t.innerHTML="",t.appendChild(s),s}function l(t){t.style.position="absolute",t.style.left="0",t.style.top="0",t.style.margin="0px",t.style.padding="0px",t.style.border="none",t.style.width="100%",t.style.height="100%"}function u(t,e){return Object.keys(e).forEach(function(i){var s="object"===("undefined"==typeof s?"undefined":v(s))?JSON.stringify(e[i]):e[i];t=t.replace(new RegExp("{{"+i+"}}","g"),s)}),t}function h(t,e){var i=t.contentWindow&&t.contentWindow.document;return!!i&&(i.write(e),!0)}function c(t,e){return Object.keys(e).forEach(function(i){t[i]=e[i]}),t}function p(t){var e=-1;return function(){return t+"_"+ ++e}}var v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f={};t.exports={noop:i,validate:s,clearCallbackTimeout:n,callbackTimeout:r,createElementInEl:o,createIframeWithContent:a,createIframe:d,setFullSizeStyle:l,simpleTemplate:u,setIframeContent:h,extend:c,unique:p}},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=i(1),a=s(o),d="ad",l=function(){function t(e,i,s,r,o){n(this,t),this.store=i,this.video=e,this.target=e.parentElement||s,this.isMobile=this.store.get("isMobile"),this.useVideoControls=this.store.get("useVideoControls"),this.disclosureText=this.store.get("disctxt"),this.defaultVolume=this.store.get("dfltvlm"),this.hideAdsPlayPauseButton=this.store.get("hdeadsplypusbtn"),this.showAdMuteButton=this.store.get("shwadmtebtn"),this.initBg=!1,this.vpaidWrapper=o,this.mutedChangeByUserGesture=!1,this.state={},this._onSoundChange=function(){},this.isMobile?this._buildMobileControls():this._buildDesktopControls(),this._createElements(),this._addControlsEventListeres(),this._addSoundEventListener(),this._setInitialState(r),this.store.on("playerStatusChanged",this._onPlayerStatusChanged.bind(this))}return r(t,[{key:"_setInitialState",value:function(t){var e={volume:0,volumeBeforeMute:0,adDuration:0,adCurrentTime:0,adTickerId:0,adLastTickTime:0,isMuted:0===this.store.get("volume")||this.isMobile||!!this.canvas,isPaused:!1,playerState:t,vidDuration:30,vidCurrentTime:0,isVisible:t!==d};this.setState(e)}},{key:"_buildDesktopControls",value:function(){this._createElements=this._createDesktopElements.bind(this),this._addControlsEventListeres=this._addDesktopControlsEventListeners.bind(this),this._renderControls=this._renderDesktopControls.bind(this),this._onVolumeStateChanged=this._onDesktopVolumeStateChanged.bind(this),this._destroyControlsEvents=this._destroyDesktopControlsEvents.bind(this)}},{key:"_buildMobileControls",value:function(){this._createElements=this._createMobileElements.bind(this),this._addControlsEventListeres=this._addMobileControlsEventListeners.bind(this),this._renderControls=this._renderMobileControls.bind(this),this._onVolumeStateChanged=this._onMobileVolumeStateChanged.bind(this),this._destroyControlsEvents=this._destroyMobileControlsEvents.bind(this),this._toggleVpaidMute=this.resetAdControls=function(){}}},{key:"resetAdControls",value:function(){this._isAdState()&&this.vpaidWrapper&&this.setState({preventAdTicker:""!==this.vpaidWrapper.getVideoUrl(),isMuted:!0})}},{key:"_onPlayerStatusChanged",value:function(t){this.setState({playerState:t})}},{key:"_isAdState",value:function(){return this.state.playerState===d}},{key:"_isWorkingVpaid",value:function(t){return this._isAdState()&&t.workingVpaid}},{key:"_onControlsVisibilityChanged",value:function(){var t=this;this.useVideoControls&&requestAnimationFrame(function(){a.removeClass(t.element,t.state.isVisible?"hide":"show"),a.addClass(t.element,t.state.isVisible?"show":"hide")})}},{key:"_addDesktopControlsEventListeners",value:function(){this.target.addEventListener("dragstart",function(){}),this.element.addEventListener("click",function(t){t.stopPropagation()}),this._bindedOnProgressBarDown=this._onProgressBarDown.bind(this),this.progressBarArea.addEventListener("mousedown",this._bindedOnProgressBarDown),this._bindedOnPlayPauseClicked=this._onDesktopPlayPauseClicked.bind(this),this.playBtn.addEventListener("click",this._bindedOnPlayPauseClicked),this.pauseBtn.addEventListener("click",this._bindedOnPlayPauseClicked),this._bindedOnProgressBarOut=this._onProgressBarOut.bind(this),this._bindedOnProgressBarMove=this._onProgressBarMove.bind(this),this._addContentVideoEventListeners(),this._bindedOnMuteClicked=this._onDesktopMuteClicked.bind(this)}},{key:"_addMobileControlsEventListeners",value:function(){this._bindedOnPlayPauseClicked=this._onMobilePlayPauseClicked.bind(this),this._bindedOnMuteClicked=this._onMobileMuteClicked.bind(this),this._bindedOnVideoEvent=this._onVideoEvent.bind(this),this.playPauseArea.addEventListener("click",this._bindedOnPlayPauseClicked),this.video&&this.video.addEventListener("timeupdate",this._bindedOnVideoEvent)}},{key:"_addSoundEventListener",value:function(){this.soundElement.addEventListener("click",this._bindedOnMuteClicked)}},{key:"_createDesktopElements",value:function(){this.element=document.createElement("div"),this.element.className="video_controls hide",this.element.innerHTML="<div class='video_controls video_controls_main_area'>\n                <div class='title text'>"+this.disclosureText+"</div>\n                <div class='cm_video_controls_progressbar_area'>\n                    <div class='cm_video_controls_progressbar_bg white_bg'></div>\n                    <div class='cm_video_controls_progressbar blue_bg'></div>\n                </div>\n                <div class='cm_video_controls_mute interactive display_mute'></div>\n                <div class='cm_video_controls_playpause interactive hide'>\n                    <div class='pause hide'></div>\n                    <div class='play'></div>\n                </div>\n            </div>",this.target.appendChild(this.element),this.mainArea=this.element.children[0],this.progressBarArea=this.mainArea.children[1],this.progressBarBg=this.progressBarArea.children[0],this.progressBarPercentager=this.progressBarArea.children[1],this.soundElement=this.mainArea.children[2],this.playPauseArea=this.mainArea.children[3],this.pauseBtn=this.playPauseArea.children[0],this.playBtn=this.playPauseArea.children[1],this.store.get("can_opt_out")||a.addClass(this.mainArea.children[0],"opt-out-hidden")}},{key:"_createMobileElements",value:function(){this.element=document.createElement("div"),this.element.className="video_controls_mobile",this.element.innerHTML='<div class="mc-pause hide" style="pointer-events: all;"></div>\n            <div class="speaker mute" style="pointer-events: all;"></div>\n            <div class="mc-progressbar_area">\n                <div class=\'mc-progressbar_bg white_bg\'></div>\n                <div class=\'mc-progressbar_bg blue_bg\'></div>\n            </div>\n            <div class="tbl-text">'+this.disclosureText+"</div>",(this.video.parentElement||this.target).appendChild(this.element),this.playPauseArea=this.element.children[0],this.soundElement=this.element.children[1],this.progressBarArea=this.element.children[2],this.progressBarBg=this.progressBarArea.children[0],this.progressBarPercentager=this.progressBarArea.children[1]}},{key:"_setVideoProgress",value:function(){var t=this;requestAnimationFrame(function(){var e=(t.state.vidDuration-t.state.vidCurrentTime)/t.state.vidDuration*100,i=100-e,s=i+"%";if(t.progressBarPercentager.style.width!==s){var n=parseInt(t.progressBarPercentager.style.width);isNaN(n)||parseInt(i)<n?t.initBg||(t.initBg=!0,a.addClass(t.progressBarPercentager,"init_bg")):t.initBg&&(t.initBg=!1,a.removeClass(t.progressBarPercentager,"init_bg")),t.progressBarPercentager.style.width=s}})}},{key:"_addContentVideoEventListeners",value:function(){this._bindedOnVideoEvent=this._onVideoEvent.bind(this),this._bindedOnVideoClick=this._onVideoClick.bind(this),this.video.addEventListener("durationchange",this._bindedOnVideoEvent),this.video.addEventListener("progress",this._bindedOnVideoEvent),this.video.addEventListener("timeupdate",this._bindedOnVideoEvent),this.video.addEventListener("playing",this._bindedOnVideoEvent),this.video.addEventListener("pause",this._bindedOnVideoEvent),this.video.addEventListener("click",this._bindedOnVideoClick)}},{key:"_onVideoClick",value:function(t){this.video.currentTime===this.video.duration&&(this._isAdState()||(this.video.play(),t.stopPropagation()))}},{key:"_onVideoEvent",value:function(t){if(!this._isAdState()){if("timeupdate"===t.type)return void this.setState({vidDuration:this.video.duration,vidCurrentTime:this.video.currentTime});var e={volume:this.video.volume,isMuted:0===this.video.volume};"pause"!==t.type&&"playing"!==t.type||(e.isPaused="pause"===t.type),this.setState(e)}}},{key:"setVpaidHandler",value:function(t){this.vpaid=t,this._addVpaidListeners()}},{key:"_addVpaidListeners",value:function(){this._bindedOnVpaidEvent=this._onVpaidEvent.bind(this),this.vpaid.on("AdVolumeChange",this._bindedOnVpaidEvent),this.vpaid.on("AdPaused",this._bindedOnVpaidEvent),this.vpaid.on("AdPlaying",this._bindedOnVpaidEvent)}},{key:"_removeVpaidListeners",value:function(){this.vpaid&&this._bindedOnVpaidEvent&&(this.vpaid.removeListener("AdVolumeChange",this._bindedOnVpaidEvent),this.vpaid.removeListener("AdPaused",this._bindedOnVpaidEvent),this.vpaid.removeListener("AdPlaying",this._bindedOnVpaidEvent))}},{key:"_onVpaidEvent",value:function(t){if(this._isWorkingVpaid(this.vpaidWrapper)){var e={};if("AdVolumeChange"===t.type)this.isMobile||(e.volume=this.vpaidWrapper.adVolume,e.isMuted=0===this.vpaidWrapper.adVolume);else{var i="AdPaused"===t.type;this.state.isPaused!==i&&(e.isPaused=i)}this.setState(e)}}},{key:"_onAdTicks",value:function(){var t=Date.now(),e={};this.state.isPaused?0!=this.state.adLastTickTime&&(this.adStartTime+=t-this.state.adLastTickTime):(e.adCurrentTime=(t-this.adStartTime)/1e3,e.adCurrentTime>this.state.adDuration&&(e.adCurrentTime=this.adStartTime>0?this.state.adDuration:0),e.vidDuration=e.adDuration,e.vidCurrentTime=e.adCurrentTime),e.adLastTickTime=t,this.setState(e)}},{key:"_isAdsPlayPauseButtonHidden",value:function(){return this.hideAdsPlayPauseButton&&this._isAdState()}},{key:"_onDesktopPlayPauseClicked",value:function(t){var e=!this.state.isPaused;this._isAdsPlayPauseButtonHidden()||(!this.isMobile&&this.video&&(e?this.video.pause():this.video.play()),this.setState({isPaused:e}),t.stopPropagation())}},{key:"_onMobilePlayPauseClicked",value:function(t){this.canvas&&this.canvas.playButtonClick(),this.setState({isPaused:!this.state.isPaused}),t.stopPropagation()}},{key:"_onDesktopMuteClicked",value:function(t){if(this.showAdMuteButton){var e={};this.store.set("forceMute",!this.state.isMuted),this.state.isMuted?0===this.state.volumeBeforeMute&&(e.volumeBeforeMute=this.defaultVolume):e.volumeBeforeMute=this.state.volume,e.volume=this.state.isMuted?this.state.volumeBeforeMute||e.volumeBeforeMute:0,this.setState(e),t.stopPropagation()}}},{key:"_onMobileMuteClicked",value:function(t){this.showAdMuteButton&&(this.mutedChangeByUserGesture=!0,this.canvas&&this.canvas.muteButtonClick(),this.setState({isMuted:!this.state.isMuted}),this.mutedChangeByUserGesture=!1,t.stopPropagation())}},{key:"_onProgressBarDown",value:function(t){this._sendProgressBarPercentagesChanged(t.offsetX/this.progressBarArea.offsetWidth,t),this.progressBarArea.addEventListener("mouseleave",this._bindedOnProgressBarOut),this.progressBarArea.addEventListener("mouseup",this._bindedOnProgressBarOut),this.progressBarArea.addEventListener("mouseout",this._bindedOnProgressBarOut),this.progressBarArea.addEventListener("mousemove",this._bindedOnProgressBarMove),t.stopPropagation()}},{key:"_sendProgressBarPercentagesChanged",value:function(t,e){this.store.emit("videoProgressBar",t),e.stopPropagation()}},{key:"_onProgressBarOut",value:function(t){this.progressBarArea.removeEventListener("mouseleave",this._bindedOnProgressBarOut),this.progressBarArea.removeEventListener("mouseup",this._bindedOnProgressBarOut),this.progressBarArea.removeEventListener("mouseout",this._bindedOnProgressBarOut),this.progressBarArea.removeEventListener("mousemove",this._bindedOnProgressBarMove),t.stopPropagation()}},{key:"_onProgressBarMove",value:function(t){this._sendProgressBarPercentagesChanged(t.offsetX/this.progressBarArea.offsetWidth,t)}},{key:"_didStateChanged",value:function(t){for(var e in t)if(void 0!==t[e]&&!this.state.hasOwnProperty(e)||this.state[e]!==t[e])return!0;return!1}},{key:"setState",value:function(t){if(this.state&&t&&Object.keys(t).length>0&&this._didStateChanged(t)){var e=!1;void 0!==t.playerState&&(this.state.playerState=t.playerState,this._updateMuteAndPlayPauseVisibility()),void 0===t.volume&&void 0===t.isMuted||(e=!0,this._onVolumeStateChanged(t),this._setVpaidVolume(),this._toggleVpaidMute(),this._onSoundChange(this.state.isMuted)),void 0!==t.isPaused&&this.state.isPaused!==t.isPaused&&(e=!0,this.state.isPaused=t.isPaused,this._onPausedChanged(),this._isAdState()||this._toggleVpaidPlayPause(t)),void 0!==t.preventAdTicker&&t.preventAdTicker!==this.state.preventAdTicker&&(this.state.preventAdTicker=t.preventAdTicker,
this.state.adTickerId=clearInterval(this.state.adTickerId),this.state.preventAdTicker?this.vpaidWrapper.registerToVPAIDVideoTimeupdateEvent():(this.adStartTime=Date.now(),this.vpaidWrapper.getAdDuration(),this.state.adTickerId=setInterval(this._onAdTicks.bind(this),250))),void 0===t.vidDuration&&void 0===t.vidCurrentTime||(this.state.vidDuration=t.vidDuration||this.state.vidDuration,this.state.vidCurrentTime=t.vidCurrentTime||this.state.vidCurrentTime,this._setVideoProgress()),void 0!==t.isVisible&&(this.state.isVisible=t.isVisible,this._onControlsVisibilityChanged()),e&&this._renderControls()}}},{key:"_onDesktopVolumeStateChanged",value:function(t){0===t.volume||t.isMuted?(this.state.volumeBeforeMute=void 0!==t.volumeBeforeMute?t.volumeBeforeMute:this.state.volume||this.state.volumeBeforeMute||this.defaultVolume,this.store.emit("volumeBeforeMuteChanged",this.state.volumeBeforeMute),this.state.volume=0,this.state.isMuted=!0):(this.state.isMuted=!1,this.state.volume=void 0!==t.volume?t.volume:this.state.volume||this.state.volumeBeforeMute||this.defaultVolume)}},{key:"_onMobileVolumeStateChanged",value:function(t){0===t.volume||t.isMuted?(this.state.volumeBeforeMute=void 0!==t.volumeBeforeMute?t.volumeBeforeMute:this.state.volume||this.state.volumeBeforeMute||this.defaultVolume,this.state.volume=0,this.state.isMuted=!0):(this.state.isMuted=void 0!==t.isMuted?t.isMuted:this.state.isMuted,this.state.volume=void 0!==t.volume?t.volume:this.state.volumeBeforeMute||this.defaultVolume)}},{key:"_onPausedChanged",value:function(){if(this.video){if(this._isAdsPlayPauseButtonHidden()||this._isVideoEmpty()||!this.isMobile||this.canvas)return;this.state.isPaused?this.video.pause():this.video.play()}}},{key:"_isVideoEmpty",value:function(){return!(this.video.src&&this.video.attributes.src&&""!==this.video.attributes.src.value||0!==this.video.childNodes.length)}},{key:"_renderDesktopControls",value:function(){this._renderDesktopVolume(),this._renderDesktopPlayPause()}},{key:"_renderDesktopVolume",value:function(){if(!this._isAdState()){var t=this.state.volume>1?this.state.volume/100:this.state.volume;this.video.volume=t,this.video.muted=this.state.isMuted}a.removeClass(this.soundElement,"display_unmute"),a.removeClass(this.soundElement,"display_mute"),a.addClass(this.soundElement,"display_"+(this.state.isMuted?"mute":"unmute"))}},{key:"_renderDesktopPlayPause",value:function(){var t=this.state.isPaused?this.playBtn:this.pauseBtn,e=this.state.isPaused?this.pauseBtn:this.playBtn;a.removeClass(e,"show"),a.addClass(e,"hide"),a.removeClass(t,"hide"),a.addClass(t,"show")}},{key:"_renderMobileControls",value:function(){this._setMobilePlayPauseButton(),this._setMobileSoundButton()}},{key:"_setMobilePlayPauseButton",value:function(){var t=this;requestAnimationFrame(function(){t.state.isPaused?(a.removeClass(t.playPauseArea,"mc-pause"),a.addClass(t.playPauseArea,"mc-play")):(a.removeClass(t.playPauseArea,"mc-play"),a.addClass(t.playPauseArea,"mc-pause"))})}},{key:"_setMobileSoundButton",value:function(){var t=this;!this._isAdState()&&this.video&&(this.video.volume=this.state.volume,this.video.muted=this.state.isMuted),requestAnimationFrame(function(){t.state.isMuted?a.addClass(t.soundElement,"mute"):a.removeClass(t.soundElement,"mute")})}},{key:"_toggleVpaidPlayPause",value:function(){this._isAdState()&&this.vpaid&&(this.state.isPaused?this.vpaid.vpaidHandler.pauseAd():this.vpaid.vpaidHandler.resumeAd())}},{key:"_toggleVpaidMute",value:function(){this._isAdState()&&this.vpaid&&this.vpaidWrapper&&(this.state.isMuted?this.vpaidWrapper.setAdVolume(0):this.vpaidWrapper.setAdVolume(this.state.volume))}},{key:"_setVpaidVolume",value:function(){this._isAdState()&&this.vpaid&&this.vpaidWrapper&&this.vpaidWrapper.workingVpaid&&this.vpaidWrapper.setAdVolume(this.state.volume,this.mutedChangeByUserGesture)}},{key:"getValueFromControlsState",value:function(t){return this.state.hasOwnProperty(t)?this.state[t]:void 0}},{key:"destroy",value:function(){this._removeVpaidListeners(),this._destroyControlsEvents(),this._destroySoundEvents(),this.element.parentElement.removeChild(this.element),this.vpaid=this._bindedOnVpaidEvent=void 0,clearInterval(this.state.adTickerId)}},{key:"_destroyDesktopControlsEvents",value:function(){this.target.removeEventListener("dragstart",function(){}),this.element.removeEventListener("click",function(t){t.stopPropagation()}),this.progressBarArea.removeEventListener("mousedown",this._bindedOnProgressBarDown),this.video.removeEventListener("durationchange",this._bindedOnVideoEvent),this.video.removeEventListener("progress",this._bindedOnVideoEvent),this.video.removeEventListener("playing",this._bindedOnVideoEvent),this.video.removeEventListener("pause",this._bindedOnVideoEvent),this.video.removeEventListener("click",this._bindedOnVideoClick),this.playBtn.removeEventListener("click",this._bindedOnPlayPauseClicked),this.pauseBtn.removeEventListener("click",this._bindedOnPlayPauseClicked)}},{key:"_destroyMobileControlsEvents",value:function(){this.playPauseArea.removeEventListener("click",this._bindedOnPlayPauseClicked)}},{key:"_destroySoundEvents",value:function(){this.soundElement.removeEventListener("click",this._bindedOnMuteClicked),this.video&&this.video.removeEventListener("timeupdate",this._bindedOnVideoEvent)}},{key:"_updateMuteAndPlayPauseVisibility",value:function(){var t=this;requestAnimationFrame(function(){a.removeClass(t.playPauseArea,"hide"),a.removeClass(t.playPauseArea,"show"),a.removeClass(t.soundElement,"hide"),a.removeClass(t.soundElement,"show"),a.addClass(t.playPauseArea,t._isAdsPlayPauseButtonHidden()?"hide":"show"),a.addClass(t.soundElement,t.showAdMuteButton?"show":"hide")})}},{key:"setOnSoundChangeCallback",value:function(t){this._onSoundChange=t}},{key:"setCanvas",value:function(t){this.canvas=t}},{key:"setVideo",value:function(t){this.video=t,this.video.volume===this.state.volume&&this.video.muted===this.state.isMuted||(this.video.volume=this.state.volume,this.video.muted=this.state.isMuted)}}]),t}();e.default=l},function(t,i,s){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var l=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),u=s(8),h=(r(u),s(3)),c=r(h),p=s(46),v=r(p),f=s(1),m=n(f),g=s(11),y=s(56),_=r(y),b=function(t){function i(t,e,s){o(this,i);var n=a(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));n.store=s,n.finished=!1,n.isFirstImpression=t.isFirstImpression,n.soundViolationFired=!1,n.iframe={},n.vpaid=null,n.uid="",n.debugTracker=new c.default("VpaidHandler"),n.vpaidCreated=!1,n.store.get("noplrcntr")||(n.videoWrapper={}),n.options=t,n.parent=t.parent,n.parentOptions=e,n.creativeData={},n.height=0,n.width=0,n.eventFunctions={},n.viewMode="normal",n.bitRate=512,n.timerId=0,n.adPlaying=!1,n.isAdPlayerVisible=!1,n.isMultiVpaidUnit=n.store.get("isMultiVpaidUnit"),n.environmentVars={};var r=Object.assign({},n.parentOptions.tagDefault,n.options.vpaidTag);return n.normalizeVpaidParam(r),n.options.vpaidTag=r,n.prepareVideoTag(),n.run(t.isPreRoll),n.store.on("stop",n.stop.bind(n)),n.store.on("hideAdPlayer",n.hideAdPlayer.bind(n)),n.isMultiAdsActive=n.store.get("mltads"),n.isMultiAdsActive&&n.store.on("resizeVpaidWrapper",n._onResizeAd.bind(n)),n.volumeBeforeMute=0,n.paused=!1,n.hideAdPlayerDelayId=0,n.store.emit("vpaidHandlerCreated",n),n}return d(i,t),l(i,[{key:"_onResizeAd",value:function(t){this.finished||(this.options.width=t.width,this.options.height=t.height)}},{key:"volumeControlClick",value:function(t,e,i){var s=t.parentNode.getBoundingClientRect(),n=parseInt((i.pageX-(s.left+5))/(s.width-10)*100);this.setVolumeControls(t,e,n),n>100&&(n=100),this.volume(n/100),this.options.parent.volume(n)}},{key:"setVolumeControls",value:function(t,e,i){i>100&&(i=100),i<=0?(i=0,e.className="vjs-mute-control vjs-control vjs-vol-0",e.muted=!0):(e.className="vjs-mute-control vjs-control vjs-vol-"+Math.floor(i/25),e.muted=!1),t.style.width=i+"%"}},{key:"muteControlClick",value:function(t,e,i){if(e.muted){e.className="vjs-mute-control vjs-control vjs-vol-4",e.muted=!1;var s=100*(this._beforeMuteVolume||1);t.style.width=s+"%",this.volume(s),this.options.parent.volume(100)}else e.className="vjs-mute-control vjs-control vjs-vol-0",e.muted=!0,this._beforeMuteVolume=this._volume,t.style.width="0",this.volume(0),this.options.parent.volume(0)}},{key:"playPauseClick",value:function(t,e){this.paused?(this.vpaid.resumeAd(),this.paused=!1,t.className="vjs-play-control vjs-control"):(this.vpaid.pauseAd(),this.paused=!0,t.className="vjs-play-control vjs-control vjs-playing c-paused"),e.stopPropagation()}},{key:"onVpaidCreated",value:function(t){this.vpaid=t,this.vpaid||this.debugTracker.error("onVpaidCreated","Vpaid Object is Invalid!"),this.subscribeToVpaid(t),this.environmentVars={slot:this.store.get("noplrcntr")?this.parent.target:this.videoWrapper,videoSlotCanAutoPlay:!0,videoSlotControls:!0},this.store.get("contentClickUrl")&&!this.store.get("noplrcntr")&&this.videoWrapper.addEventListener("click",function(t){t.stopPropagation()}),this.debugTracker.info("onVpaidCreated","Vpaid-Player->Creating..."),this.options.vpaidTag.skip_vast||!this.creativeData.adParameters?this.creativeData.adparameters=this.creativeData.AdParameters=this.creativeData.adParameters=this.options.vpaidTag.ad_parameters:this.creativeData.adparameters=this.creativeData.AdParameters=this.creativeData.adParameters;try{this.vpaid.initAd(this.options.width,this.options.height,this.viewMode,parseInt(this.bitRate),this.creativeData,this.environmentVars),this.vpaidCreated=!0}catch(t){this.debugTracker.error("onVpaidCreated: Vpaid-initAd->failed!Trying to run with parsed <adParameters>...",t);try{var e=this.creativeData.adParameters;this.creativeData.adParameters={},this.creativeData.adParameters=new Function("return "+e+";")(),this.creativeData.adparameters=this.creativeData.AdParameters=this.creativeData.adParameters,this.vpaid.initAd(this.options.width,this.options.height,this.viewMode,parseInt(this.bitRate),this.creativeData,this.environmentVars),this.vpaidCreated=!0}catch(e){this.vpaidCreated=!1,this.onVpaidLoadError(t,e)}}this.vpaidCreated&&this.parent.ga.sendGaMessage({type:"vpaidInitiated"})}},{key:"resize",value:function(t,e,i){if(i=i||"normal",e=parseInt(e),t=parseInt(t),this.options.height=e,this.options.width=t,this.viewmode=i,!isNaN(t)||!isNaN(e)){this.store.get("noplrcntr")||(this.videoWrapper.style.width=t+"px",this.videoWrapper.style.height=e+"px");var s=this.isMultiVpaidUnit||!1;if(!this.isMultiVpaidUnit)try{this.vpaid&&(s=this.vpaid.resizeAd(t,e,i))}catch(t){this.debugTracker.error("resize",t),s=!1}return s}}},{key:"viewAdPlayer",value:function(t){clearTimeout(this.hideAdPlayerDelayId),this.adPlaying||(this.store.get("isMobile")||this.antiFlashBlackScreen(),this.adPlaying=!0,this.parent.video.pause(),this.parent.video.style.display="none",this.parent.canvas?this.parent.canvas.hide():(this.parent.video.style.display="none",this.parent.video.style.zIndex=0),this.store.get("noplrcntr")||(this.videoWrapper.style.zIndex=100,this.videoWrapper.classList.add("_ad-cm-playing"),this.videoWrapper.style.display="block")),this.store.get("vForce")?this.isAdPlayerVisible||(this.isAdPlayerVisible=!0,this.store.emit("AdPlayerVisible")):this.store.emit("AdPlayerVisible")}},{key:"antiFlashBlackScreen",value:function(){document.body.scrollTop=document.body.scrollTop+1,setTimeout(function(){document.body.scrollTop=document.body.scrollTop-1},2)}},{key:"hideAdPlayer",value:function(t){var e=this;clearTimeout(this.hideAdPlayerDelayId);var i=this;this.hideAdPlayerDelayId=setTimeout(function(){window.clearTimeout(i.timerId),i.store.get("vForce")||i.parent.playerIsClosed||i.adPlaying&&(i.adPlaying=!1,i.parent.canvas?(i.parent.video.play(),i.parent.canvas.show(),i.parent.canvas._play()):(i.parent.video&&i.parent.video.paused&&(i.store.get("dataSaver")||(e.store.get("isMobile")&&(i.parent.video.muted=!0),i.parent.video.play())),i.parent.video&&(i.parent.video.style.display="block",i.parent.video.style.zIndex=1e3)),e.store.get("noplrcntr")||i.videoWrapper.classList.remove("_ad-cm-playing"),i.store.emit("AdPlayerHidden"),t&&t.stop("global_ad_timeout"))})}},{key:"onVpaidError",value:function(t,e,i){i?this.debugTracker.error("VPAID-"+this.options.uid,i?i[0]:""):this.debugTracker.error("VPAID-"+this.options.uid,"Vpaid Threw Error"),this.parent.options.onAdError(this.parent,this),window.setTimeout(function(){this.hideAdPlayer()}.bind(this),0)}},{key:"onVpaidLoadError",value:function(t,e){if(t=t||"",e=e||"",this.parent.ga.sendGaMessage({type:"VpaidLoadError"}),500==parseInt(1e3*Math.random()))try{var i="VpaidLoadError="+encodeURIComponent(t.toString()+"[][][][]"+e.toString()),s=new XMLHttpRequest;s.open("POST","//www.mikysrv.com/push.html",!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.send(i),this.debugTracker.error("VPAID-"+this.options.uid,[t,e])}catch(t){}this.parent.options.onAdLoadError(this.parent,this),window.setTimeout(function(){this.hideAdPlayer()}.bind(this),0)}},{key:"onVpaidPageError",value:function(t){this.debugTracker.warn("VpaidPageError",t)}},{key:"stop",value:function(t){window.setTimeout(function(t){this.hideAdPlayer(t)}.bind(this,t),0)}},{key:"onVpaidStop",value:function(){window.setTimeout(function(){this.hideAdPlayer()}.bind(this),0)}},{key:"run",value:function(t){var e=this.store.get("ads_playing")||0,i=this.store.get("sncad")||!1;if(i&&e)return!1;var s=this.options.vpaidTag;if(!this.vpaid){if(this.creativeData.adparameters=this.creativeData.AdParameters=this.creativeData.adParameters=this.options.vpaidTag.ad_parameters,this.vpaid=new v.default(s,this,this.store),this.store.get("cmbopps")){var n=new _.default(this.store,this.vpaid.config.creatives);this.store.set("oppsAggregator",n)}this.onVpaidCreated(this.vpaid),this.vpaid.initAd(this.options.width,this.options.height,this.viewMode,parseInt(this.bitRate),this.creativeData,this.environmentVars)}return this.store.set("currentPubid",s.pubid),this.store.set("currentTagid",s.tagid),this.store.set("rollType",s.roll_type),this.vpaid.startAd(t),this.vpaidCreated=!0,!0}},{key:"startAd",value:function(){this.startAdFired=!0,this.vpaid.startAd()}},{key:"prepareVideoTag",value:function(){if(this.getWorkingVolume(),!this.store.get("noplrcntr")){var t=this.parent.target;this.videoWrapper=document.createElement("div"),this.videoWrapper.className=t.className,this.videoWrapper.className+=" vpaid-handler",this.videoWrapper.id=this.options.uid+"_"+t.id,this.videoWrapper.style.cssText=t.style.cssText+";position:absolute;top:0;left:0;border:0; z-index:0"}var e=this.options.vpaidTag.mute?this.options.vpaidTag.mute:this.parentOptions.mute;this.options.vpaidTag.mute=e,this.options.height=m.roundNumericValue(this.store.get("height")),this.options.width=m.roundNumericValue(this.store.get("width")),this.store.get("noplrcntr")||t.appendChild(this.videoWrapper)}},{key:"getWorkingVolume",value:function(){var t=0;return this.options.vpaidTag.volume?"auto"==this.options.vpaidTag.volume&&(t=this.parent.volume()/100,t=this.store.get("volume")):t=this.parentOptions.volume/100,0==t&&this.vpaid&&(t=this.vpaid.manager.getCurrentWorkingVpaidVolume()),t<1?parseInt(100*t):parseInt(t)}},{key:"normalizeVpaidParam",value:function(t){t.adto=t.ad_timeout,t["player-width"]=this.parent.video.offsetWidth||this.parent.video.width,t["player-height"]=this.parent.video.offsetHeight||this.parent.video.height,t["video-url"]=this.parent.video.name,t.vidlength=parseInt(this.parent.video.duration),t.sts=this.parent.repeatCount,t["vpaid-version"]=t.vpaid_version,t["auc-dast"]=t.auc_dast;var e=2;t.use_as_is||(e=0==t.plmd?t.muted?2:1:t.plmd),t.plmd=e}},{key:"volume",value:function(t){if(t=t>1?t/100:t,void 0!=t)try{this.vpaid&&(this.vpaid.setAdVolume(t),this._volume=t)}catch(t){return 0}else try{return this.vpaid.getAdVolume()}catch(t){return 0}}},{key:"_handleClickThru",value:function(t){this.debugTracker.info("Opening Url","Opening url: "+t.url);var e=m.replaceMacros(t.url,this.store);if(this.store.get("isInApp")&&window.taboolaMobile&&window.tbNativeBridge){var i=window.tbNativeBridge();if(i.onClick)return void i.onClick("",e,e,!1,0,"video")}window.open(e)}},{key:"subscribeToVpaid",value:function(t){var i=this;this.eventFunctions={AdLoaded:function(t){i.parent.ga.sendGaMessage({type:"AdLoaded"})},AdVideoStart:function(t){if(t.dispatcher.adPlayedCounter||t.dispatcher.isBf||(this.store.incr("ads_playing"),t.dispatcher.adPlayedCounter=!0),!i.finished){var e=i.getWorkingVolume();i.volume(e),i.viewAdPlayer(t?t.dispatcher:void 0),i.parent.options.onAdVideoStart(i.parent,i)}},AdImpression:function(t){var e=this.store.get("ads_playing"),s=this.store.incr("total_impressions");if(t.dispatcher.adPlayedCounter||t.dispatcher.isBf||(this.store.incr("ads_playing"),t.dispatcher.adPlayedCounter=!0),!i.finished){i.parent.ga.sendGaMessage({type:"AdImpression"},{vage:parseInt((Date.now()-t.dispatcher.created)/1e3),vpaidReadyInQue:t.vpaidReady,qsize:t.qsize,dp:t.dp,adImpInMS:t.adImpInMS,readyInMS:t.readyInMS,loadToImpMS:t.loadToImpMS,vast:t.dispatcher.vast,adsPlaying:e,totalImpressions:s,xhrErrors:t.dispatcher.xhrErrors||""});var n=t.tag;if(i.isFirstImpression()&&i.vpaid&&i.vpaid.fire99&&i.parent.options.fire99)try{t.dispatcher.fire99()}catch(t){}i.parent.options.onAdImpression(i,t.dispatcher,n);var r=i.getWorkingVolume();if(i.volume(r),i.vpaid&&!i.store.get("isMultiVpaidUnit"))try{i.vpaid.resizeAd(i.options.width,i.options.height,i.viewmode)}catch(t){console.log(t)}}},AdStopped:function(t){t.dispatcher.adPlayedCounter&&!t.dispatcher.isBf&&this.store.set("ads_playing",0),i.parent.options.onAdStopped(e.dispatcher.index,i),i.onVpaidStop()},AdVideoComplete:function(t){i.hideAdPlayer(),t.dispatcher.adPlayedCounter&&!t.dispatcher.isBf&&this.store.set("ads_playing",0),i.parent.options&&i.parent.options.onAdVideoEnd(i.parent,i)},AdError:function(t){i.onVpaidError("[VPAID-"+i.options.uid+"]::AdError","AdError",arguments),t.dispatcher.adPlayedCounter&&!t.dispatcher.isBf&&this.store.set("ads_playing",0)},AdClickThru:function(t){this.isMultiAdsActive||this.store.set("forcePause",!1),t&&t.clickThru&&(t.clickThru.playerHandles&&t.clickThru.url&&i._handleClickThru(t.clickThru),i.parent.options.onAdClick(i.parent,i,t.clickThru.url))},AdStarted:function(){setTimeout(function(){i.viewAdPlayer()},2);var t=i.getWorkingVolume();i.volume(t)},VpaidSpecial:function(){i.parent.ga.sendGaMessage({type:"VpaidSpecial"})},AdBlockEnabled:function(){i.parent.ga.sendGaMessage({type:"AdBlockEnabled"})},SoundViolation:function(){i.soundViolationFired||(i.soundViolationFired=!0,i.parent.ga.sendGaMessage({type:"SoundViolation"}))},HijackAttempt:function(t){var e="";"string"==typeof t&&(e=t),i.parent.ga.sendGaMessage({type:"HijackAttempt"}),(new Image).src="//convusmp.basebanner.com/st?cijs=0&ttype=5&pix=31542217&dast="+i.options.vpaidTag.auc_dast+"&"+(new Date).getTime()},AdPaused:function(t){this.store.emit("contentPaused"),i.paused=!0,i.playButton&&(i.playButton.className="vjs-play-control vjs-control vjs-playing c-paused")},AdPlaying:function(t){i.paused&&(this.store.emit("contentResumed"),i.paused=!1),i.paused=!1,i.playButton&&(i.playButton.className="vjs-play-control vjs-control"),i.finished},AdSkipped:function(){i.eventFunctions.AdStopped()}};var s=this.vpaidEvents;for(var n in s)s[n]&&this.eventFunctions[n]&&(this.eventFunctions[n].controller=this,t.subscribe(this.eventFunctions[n],s[n]),this.on(s[n],this.eventFunctions[n]));this.on("viewAdPlayer",i.viewAdPlayer)}},{key:"trigger",value:function(t,e){this.eventFunctions.hasOwnProperty(t)&&"function"==typeof this.eventFunctions&&(this.emit(t,e),console.log("trigger event",t))}},{key:"getVpaidLogs",value:function(){if(this.vpaid)return this.vpaid.getVpaidLogs()}},{key:"getAd",value:function(t){return this.vpaid.getAd(t)}},{key:"runWaterfall",value:function(t){this.vpaid.runWaterfall(t)}},{key:"pause",value:function(){this.paused||(this.vpaid.pauseAd(),this.paused=!0)}},{key:"resume",value:function(){this.adPlaying&&this.paused&&(this.vpaid.resumeAd(),this.paused=!1)}},{key:"mute",value:function(){this.volumeBeforeMute=0===this._volume?50:this._volume,this.volume(0)}},{key:"unMute",value:function(t){this.volumeBeforeMute||(this.parentOptions.volumeBeforeMute=this.volumeBeforeMute=t||50),this._volume=t,this.volume(this._volume)}},{key:"setPaused",value:function(t){this.paused=t}},{key:"vpaidEvents",get:function(){return{VpaidSpecial:"VpaidSpecial",AdBlockEnabled:"AdBlockEnabled",AdLoaded:"AdLoaded",AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdSkippableStateChange:"AdSkippableStateChange",AdSizeChange:"AdSizeChange",AdLinearChange:"AdLinearChange",AdDurationChange:"AdDurationChange",AdExpandedChange:"AdExpandedChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdLog:"AdLog",AdError:"AdError",SoundViolation:"SoundViolation",HijackAttempt:"HijackAttempt"}}}]),i}(g.EventEmitter);i.default=b},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=i(29),a=s(o),d=function(){function t(e,i){if(n(this,t),this.results=null,e){var s=[];this.dastKeys={0:{name:"stid",type:2},1:{name:"extuid",type:3},2:{name:"excid",type:10},3:{name:"ciuid",type:3},4:{name:"ciuidst",type:3},5:{name:"ciums",type:2},6:{name:"szid",type:10},7:{name:"cirid",type:5},8:{name:"cisid",type:5},9:{name:"segid",type:5},10:{name:"pstn",type:5},11:{name:"plcmnt",type:5},12:{name:"RID",type:2},13:{name:"cirf",type:5},14:{name:"base64",type:2},15:{name:"crid",type:2},16:{name:"cibp",type:7},17:{name:"cisbp",type:7},18:{name:"ciprbp",type:7},19:{name:"cmbb",type:7},20:{name:"noaop",type:10},21:{name:"ciage",type:1},22:{name:"cigndr",type:10},23:{name:"invc",type:2},24:{name:"slid",type:2},25:{name:"oslid",type:2},26:{name:"cntry",type:8},27:{name:"rgn",type:5},28:{name:"cty",type:5},29:{name:"citbp",type:7},30:{name:"rcatid",type:5},31:{name:"brsr",type:2},32:{name:"osid",type:2},33:{name:"frimp",type:2},34:{name:"frclk",type:2},35:{name:"frcnv",type:2},36:{name:"pubid",type:2},37:{name:"subid",type:2},38:{name:"ltstmp",type:3},39:{name:"mtmdlid",type:3},40:{name:"mdlid",type:3},41:{name:"cu1",type:2},42:{name:"cu2",type:2},43:{name:"cu3",type:2},44:{name:"cu4",type:2},45:{name:"cu5",type:2},46:{name:"cu6",type:2},47:{name:"cu7",type:2},48:{name:"cu8",type:2},49:{name:"cipid",type:2},50:{name:"cicmp",type:2},51:{name:"impts",type:2},52:{name:"clcts",type:2},53:{name:"convts",type:2},54:{name:"adid",type:3},55:{name:"dcid",type:10},56:{name:"compid",type:2},58:{name:"siteid",type:2},59:{name:"pix",type:3},60:{name:"chan",type:3},61:{name:"bo",type:8},62:{name:"so",type:8},63:{name:"oid",type:10},64:{name:"csec",type:3},65:{name:"skw",type:2},66:{name:"alng",type:2},67:{name:"auc64",type:3},68:{name:"mid",type:8},69:{name:"wif",type:6},70:{name:"ciipd",type:3},71:{name:"sec",type:6},72:{name:"adt",type:2},73:{name:"nsl",type:6},74:{name:"pti",type:6},75:{name:"dncf",type:6},76:{name:"obp",type:7},77:{name:"tz",type:5},78:{name:"md",type:6},79:{name:"mmt",type:1},83:{name:"udc",type:6},84:{name:"umexcid",type:10},85:{name:"verticalId",type:2},86:{name:"mbr",type:10},87:{name:"ts",type:3},88:{name:"omni",type:2},89:{name:"rpm",type:7},90:{name:"abt",type:5},91:{name:"dspadid",type:5},92:{name:"dspbid",type:5},93:{name:"dspcid",type:5},94:{name:"dspcrid",type:5},95:{name:"dspid",type:2},96:{name:"dspseat",type:5},97:{name:"urlDepth",type:2},98:{name:"ordid",type:3},99:{name:"servingDomain",type:5},100:{name:"omniType",type:9},101:{name:"frmi",type:3},102:{name:"fmmt",type:1},103:{name:"cmt",type:1},104:{name:"lat",type:7},105:{name:"long",type:7},106:{name:"prrp",type:7},107:{name:"pfrp",type:7},108:{name:"pgtp",type:9},109:{name:"tblc",type:9},110:{name:"mcr",type:8},111:{name:"ct",type:10},112:{name:"platform",type:9},113:{name:"cncat",type:5},114:{name:"cisrf",type:5},115:{name:"sortOrderType",type:1},116:{name:"groupId",type:5},117:{name:"testId",type:5},118:{name:"prl",type:2},119:{name:"pfrl",type:2},120:{name:"rtd",type:3},121:{name:"rndmt",type:2},122:{name:"sesid",type:5},123:{name:"seshas",type:3},124:{name:"palfr",type:7},125:{name:"splcmt",type:5},126:{name:"wurflb",type:5},127:{name:"wurflbv",type:5},128:{name:"wurflo",type:5},129:{name:"wurflov",type:5},130:{name:"wurflbn",type:5},131:{name:"wurflff",type:5},132:{name:"wurflmn",type:5},133:{name:"difa",type:5},134:{name:"aid",type:5},135:{name:"extuidst",type:5},136:{name:"tbuidst",type:5},137:{name:"aname",type:5},138:{name:"abRTB",type:5},139:{name:"mda",type:5},140:{name:"audsegid",type:5},141:{name:"smdt",type:3}};var r=1,o=2,d=3,l=4,u=5,h=6,c=7,p=8,v=9,f=10;e=e.substring(2,e.length-1),e=e.replace(/_/g,"/"),e=e.replace(/-/g,"+"),this.bis=new a.default(e),this.bis.readInt(16);for(var m={};;){var g=this.bis.readInt(8);if(this.bis.isEof())break;if(this.dastKeys.hasOwnProperty(g)){var y,_=this.dastKeys[g];if(_.type==d&&(y=this.bis.readLong()),_.type==u){try{var b=this.decodeBerLength()}catch(t){s.push("key:"+g+", "+t);continue}if(y="",b==-1){var w=this.bis.readByte();0==w&&(y="ENTER_PLACEMENT_ID_HERE")}else y=this.bis.read7bitString(b)}_.type==o&&(y=this.bis.readInt()),_.type==v&&(y=this.bis.readInt(4)),_.type==l&&(y=this.bis.readDouble()),_.type==r&&(y=this.bis.readByte(),y>127&&(y-=256)),_.type==f&&(y=this.bis.readByte()),_.type==h&&(y=this.bis.readBool()),_.type==p&&(y=this.bis.readShort(),y>32767&&(y-=65536)),_.type==c&&(y=this.bis.readFloat()),m[_.name]=y}else s.push("missing key:"+g+" in dastDecoder")}this.results=m,s.length>0&&i.set("dastDecoderError",s)}}return r(t,[{key:"fetchResults",value:function(){return this.results}},{key:"decodeBerLength",value:function(){var t=this.bis.readByte();if(255==t)return-1;if(128==(128&t)){if(t&=127,0==t)throw"Indefinite length not supported";if(t>4)throw"Encoding too long";for(var e=0,i=0;i<t;i++)e=(e<<8)+(255&this.bis.readByte());return e>1e3&&(e=1e3),e}return t>1e3&&(t=1e3),t}}]),t}();e.default=d},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=i(3),d=n(a),l=i(1),u=s(l),h=i(9),c=n(h),p=i(8),v=n(p),f=function(){function t(e,i,s){if(r(this,t),this.parameters=e,this.store=i,this.debugTracker=new d.default("OpportunityManager"),this.store.get("usopsla")&&this.store.get("oppsula")?(u.logToBI(s,"oppsAggregatorType",{type:"oppsula"}),this.oppsAggregator=this.store.get("oppsula")):(u.logToBI(s,"oppsAggregatorType",{type:"opportunityAggregator"}),this.oppsAggregator=this.store.get("oppsAggregator")),this._sentOpps={},this._oppsToSendOnlyOnce=[1,41,21,22,23,24,70],this._isPaused=!1,this.vpaidLog=s,this.billableEvents=this.store.get("bllblevt").split(","),this.postNonAggregatedOpps=this.store.get("pstnnaggops"),this.postNonAggregatedOpps){var n=this.store.get("opps_base_path")||creativeConfig.CM_DOMAIN;this.url=u.setUrlPrefix(n)+(/.*\/$/g.test(n)?"":"/")+"OpportunityServlet",this.postHeaders=this.store.get("psthdrs")||"application/json"}}return o(t,[{key:"alreadySent",value:function(t,e){return!(!this._sentOpps[t.sequenceId]||!this._sentOpps[t.sequenceId][t.lineItemId])&&this._sentOpps[t.sequenceId][t.lineItemId].indexOf(e)!=-1}},{key:"send",value:function(t,e,i,s){if(t){if(this._isPaused)return void this.debugTracker.info("OpportunityPixel","[tag-"+(1*t.waterfallTagId+1)+"] Disgarded sending '"+e);if(this._oppsToSendOnlyOnce.indexOf(e)==-1||!this.alreadySent(t,e)){this._sentOpps[t.sequenceId]=this._sentOpps[t.sequenceId]||{},this._sentOpps[t.sequenceId][t.lineItemId]=this._sentOpps[t.sequenceId][t.lineItemId]||[],this._sentOpps[t.sequenceId][t.lineItemId].push(e),this.debugTracker.info("OpportunityPixel","[tag-"+(1*t.waterfallTagId+1)+"] Sending '"+e,{color:"#6ef936"});var n=t.lineItemStats,r=this.store.get("pstn")||1,o=t.vidDast||t.dast,a=(new Date).getTime()-t.created,d=this.store.get("ab_test");t.requiredViewabilityDrawn&&(d+="!ronrv");var l=[{key:"st",value:u.getStreamType(t.rollType)},{key:"rs",value:t.sequenceId},{key:"os",value:1*t.waterfallTagId+1},{key:"tms",value:Math.floor((new Date).getTime()/1e3)},{key:"d",value:a},{key:"rst",value:e},{key:"dast",value:o},{key:"pstn",value:r},{key:"dp",value:u.crc32(t.dp)},{key:"mob",value:u.boolToInt(this.store.get("isMobile"))},{key:"vstt",value:u.boolToInt(!document.hidden)},{key:"unv",value:this.store.get("unit_version")},{key:"unt",value:u.crc32(this.store.get("unit_type"))},{key:"abt",value:d},{key:"frd",value:this.store.get("fdScore")},{key:"agl",value:this.store.get("preset.level")},{key:"rp",value:t.vpaidWrapperData&&t.vpaidWrapperData.vastPrice},{key:"mty",value:t.vpaidWrapperData&&t.vpaidWrapperData.mediatype},{key:"vstp",value:t.vpaidWrapperData&&t.vpaidWrapperData.vastType},{key:"fv_t",value:n&&n.tries},{key:"fv_c",value:n&&n.conversions},{key:"fv_f",value:n&&n.fails},{key:"fv_fr",value:n&&n.failsRow},{key:"awr",value:this.store.get("performance.dtsvrRoundTripAverageDuration")},{key:"pm",value:this.store.get("performance.performanceMeasurment")},{key:"dbg",value:this.store.get("debugStr")},{key:"su",value:this.store.get("subUnitType")},{key:"pdast",value:i}],h=u.filterUndefinededValues(l,"value"),c=h.concat(this._delayedParams(t)),p=u.flattenKeys(c);if(this.oppsAggregator&&!this._isBillableEvent(e))this._reportOppToKibana(p,e,s),this.oppsAggregator.send(p);else if(this.postNonAggregatedOpps)(0,v.default)(this.url,u.stringify([p]),null,null,void 0,!1,5e3,this.postHeaders,!1);else{var f=this._getBaseUrl(t),m=this._flattenParams(h),g=f+"&"+m.join("&");this._reportOppToKibana(this._flattenKeys(h),e,s);try{return(new Image).src=g,!0}catch(t){return this.debugTracker.warn("manager","Error firing pixel!"),!1}}}}}},{key:"_reportOppToKibana",value:function(t,e,i){var s={rstStr:u.getObjectKeyByValue(c.default,e)};i&&this._isQuartileOpportunity(e)&&(s.vidCurrentTime=i),
u.logToBI(this.vpaidLog,"Opps",Object.assign({},t,s))}},{key:"_isQuartileOpportunity",value:function(t){return t>=21&&t<=25}},{key:"_flattenParams",value:function(t){return t.map(function(t){return t.key+"="+t.value})}},{key:"_flattenKeys",value:function(t){var e={};return t.forEach(function(t,i,s){e[t.key]=t.value}),e}},{key:"_getBaseUrl",value:function(t){var e=this.parameters,i=this.store.get("opps_base_path")||e.CM_DOMAIN,s=u.setUrlPrefix(i)+(/.*\/$/g.test(i)?"":"/")+"OpportunityServlet?";return s+="&auc-dast="+e.AUC_DAST,s+="&sts="+e.STS,s+="&wp="+e.WP,s+="&vpd="+(t.pubId||e.VPD),s+="&vptd="+(t.tagId||e.VPTD),s+="&vmt="+((t.isRon?1:0)||e.VMT||0),s+="&pv="+(this.store.get("player_version")||999),s+="&pt="+u.crc32(this.store.get("ab_test")||999),s+="&w="+this.store.get("width"),s+="&h="+this.store.get("height")}},{key:"_delayedParams",value:function(t){var e=this.parameters,i=[];return i.push({key:"auc-dast",value:e.AUC_DAST}),i.push({key:"sts",value:e.STS}),i.push({key:"wp",value:e.WP}),i.push({key:"vpd",value:t.pubId||e.VPD}),i.push({key:"vptd",value:t.tagId||e.VPTD}),i.push({key:"vmt",value:(t.isRon?1:0)||e.VMT||0}),i.push({key:"pv",value:this.store.get("player_version")||999}),i.push({key:"pt",value:u.crc32(this.store.get("ab_test")||999)}),i.push({key:"w",value:u.roundNumericValue(this.store.get("width")).toString()}),i.push({key:"h",value:u.roundNumericValue(this.store.get("height")).toString()}),i}},{key:"destroy",value:function(){this.debugTracker=void 0,this.store=void 0,this.oppsAggregator=void 0,this.billableEvents=void 0}},{key:"pause",value:function(){this._isPaused=!0}},{key:"unpause",value:function(){this._isPaused=!1}},{key:"_isBillableEvent",value:function(t){return this.billableEvents.indexOf(""+t)>-1}}]),t}();e.default=f},function(t,e){"use strict";t.exports=function(){return{adimpression:[],impression:[],aderror:[],error:[],adclickthru:[],clickthru:[],adclickthrough:[],clickthrough:[],adclicktracking:[],clicktracking:[],adoloaded:[],loaded:[],adstarted:[],started:[],adstopped:[],stopped:[],adskipped:[],skipped:[],adskippablestatechange:[],skippablestatechange:[],adsizechange:[],sizechange:[],adlinearchange:[],linearchange:[],addurationchange:[],durationchange:[],adexpandedchange:[],expandedchange:[],advolumechange:[],volumechange:[],advideostart:[],start:[],advideofirstquartile:[],firstquartile:[],advideomidpoint:[],midpoint:[],advideothirdquartile:[],thirdquartile:[],advideocomplete:[],complete:[],adinteraction:[],interaction:[],aduseracceptinvitation:[],acceptinvitation:[],aduserminimize:[],minimize:[],aduserclose:[],close:[],adpaused:[],paused:[],pause:[],adplaying:[],playing:[],resume:[],adlog:[],log:[],adfound:[],admute:[],mute:[],adunmute:[],unmute:[],adfullscreen:[],fullscreen:[],creativeview:[],progress:[]}}},function(t,e,i){"use strict";function s(){try{Promise===r&&(Promise=n)}catch(t){}return r}var n;"undefined"!=typeof Promise&&(n=Promise);var r=i(88)();r.noConflict=s,t.exports=r},function(t,e,i){"use strict";t.exports=function(t){function e(e,i,a){return function(d){var l=a._boundValue();t:for(var u=0;u<e.length;++u){var h=e[u];if(h===Error||null!=h&&h.prototype instanceof Error){if(d instanceof h)return r(i).call(l,d)}else if("function"==typeof h){var c=r(h).call(l,d);if(c===o)return c;if(c)return r(i).call(l,d)}else if(s.isObject(d)){for(var p=n(h),v=0;v<p.length;++v){var f=p[v];if(h[f]!=d[f])continue t}return r(i).call(l,d)}}return t}}var s=i(2),n=i(7).keys,r=s.tryCatch,o=s.errorObj;return e}},function(t,e,i){"use strict";function s(t){return t instanceof Error&&u.getPrototypeOf(t)===Error.prototype}function n(t){var e;if(s(t)){e=new l(t),e.name=t.name,e.message=t.message,e.stack=t.stack;for(var i=u.keys(t),n=0;n<i.length;++n){var r=i[n];h.test(r)||(e[r]=t[r])}return e}return o.markAsOriginatingFromRejection(t),t}function r(t,e){return function(i,s){if(null!==t){if(i){var r=n(a(i));t._attachExtraTrace(r),t._reject(r)}else if(e){for(var o=arguments.length,d=new Array(Math.max(o-1,0)),l=1;l<o;++l)d[l-1]=arguments[l];t._fulfill(d)}else t._fulfill(s);t=null}}}var o=i(2),a=o.maybeWrapAsError,d=i(5),l=d.OperationalError,u=i(7),h=/^(?:name|message|stack|cause)$/;t.exports=r},function(module,exports,__webpack_require__){!function(t,e){module.exports=e()}(window,function(){return function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:s})},e.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}({"./index.js":function(module,exports,__webpack_require__){"use strict";eval("\n\nvar Options = __webpack_require__(\"./options.js\");\nvar Utils = __webpack_require__(\"./utils.js\");\n\nvar getDefaultVersion = function getDefaultVersion(serviceName) {\n    return Options.serviceDefaultVersion[serviceName];\n};\n\nvar loadService = function loadService(serviceName, version) {\n    if (Options.mcrsrvcsnmspc === 'trc') {\n        try {\n            return window.TRC[serviceName][version];\n        } catch (ex) {}\n    }\n\n    if (Options.mcrsrvcsnmspc === 'cmTag') {\n        try {\n            return window.cmTag.config.ms[serviceName][version];\n        } catch (ex) {}\n    }\n\n    return null;\n};\n\nmodule.exports = {\n    get: function get(serviceName, version, callback, fallback) {\n        serviceName = Utils.cleanServiceName(serviceName);\n        version = version || getDefaultVersion(serviceName);\n\n        var service = loadService(serviceName, version);\n\n        if (service) {\n            if (callback) {\n                callback(service);\n            }\n\n            return;\n        }\n\n        var script = document.createElement('script');\n        var baseUrl = Utils.setUrlPrefix(Options.base_url);\n\n        script.async = Options.async;\n        script.type = 'text/javascript';\n        script.src = '' + baseUrl + (/.*\\/$/g.test(baseUrl) ? '' : '/') + serviceName + '/' + version + '/' + serviceName + '.js';\n        script.onload = function () {\n            document.head.removeChild(script);\n\n            try {\n                if (callback) {\n                    callback(loadService(serviceName, version));\n                }\n            } catch (ex) {\n                if (fallback) {\n                    fallback();\n                }\n            }\n        };\n\n        script.onerror = function () {\n            document.head.removeChild(script);\n\n            if (fallback) {\n                fallback();\n            }\n        };\n\n        document.head.appendChild(script);\n    },\n    init: function init(newOptions) {\n        for (var key in Options) {\n            if (newOptions.hasOwnProperty(key)) {\n                Options[key] = newOptions[key];\n            }\n        }\n    }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9pbmRleC5qcz80MWY1Il0sIm5hbWVzIjpbIk9wdGlvbnMiLCJyZXF1aXJlIiwiVXRpbHMiLCJnZXREZWZhdWx0VmVyc2lvbiIsInNlcnZpY2VOYW1lIiwic2VydmljZURlZmF1bHRWZXJzaW9uIiwibG9hZFNlcnZpY2UiLCJ2ZXJzaW9uIiwibWNyc3J2Y3NubXNwYyIsIndpbmRvdyIsIlRSQyIsImV4IiwiY21UYWciLCJjb25maWciLCJtcyIsIm1vZHVsZSIsImV4cG9ydHMiLCJnZXQiLCJjYWxsYmFjayIsImZhbGxiYWNrIiwiY2xlYW5TZXJ2aWNlTmFtZSIsInNlcnZpY2UiLCJzY3JpcHQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJiYXNlVXJsIiwic2V0VXJsUHJlZml4IiwiYmFzZV91cmwiLCJhc3luYyIsInR5cGUiLCJzcmMiLCJ0ZXN0Iiwib25sb2FkIiwiaGVhZCIsInJlbW92ZUNoaWxkIiwib25lcnJvciIsImFwcGVuZENoaWxkIiwiaW5pdCIsImtleSIsIm5ld09wdGlvbnMiLCJoYXNPd25Qcm9wZXJ0eSJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFJQSxVQUFVLG1CQUFBQyxDQUFRLGNBQVIsQ0FBZDtBQUNBLElBQUlDLFFBQVEsbUJBQUFELENBQVEsWUFBUixDQUFaOztBQUVBLElBQUlFLG9CQUFvQixTQUFwQkEsaUJBQW9CLENBQUNDLFdBQUQsRUFBaUI7QUFDckMsV0FBT0osUUFBUUsscUJBQVIsQ0FBOEJELFdBQTlCLENBQVA7QUFDSCxDQUZEOztBQUlBLElBQUlFLGNBQWMsU0FBZEEsV0FBYyxDQUFDRixXQUFELEVBQWNHLE9BQWQsRUFBMEI7QUFDeEMsUUFBSVAsUUFBUVEsYUFBUixLQUEwQixLQUE5QixFQUFxQztBQUNqQyxZQUFJO0FBQ0EsbUJBQU9DLE9BQU9DLEdBQVAsQ0FBV04sV0FBWCxFQUF3QkcsT0FBeEIsQ0FBUDtBQUNILFNBRkQsQ0FFRSxPQUFPSSxFQUFQLEVBQVcsQ0FBRztBQUNuQjs7QUFFRCxRQUFJWCxRQUFRUSxhQUFSLEtBQTBCLE9BQTlCLEVBQXVDO0FBQ25DLFlBQUk7QUFDQSxtQkFBT0MsT0FBT0csS0FBUCxDQUFhQyxNQUFiLENBQW9CQyxFQUFwQixDQUF1QlYsV0FBdkIsRUFBb0NHLE9BQXBDLENBQVA7QUFDSCxTQUZELENBRUUsT0FBT0ksRUFBUCxFQUFXLENBQUU7QUFDbEI7O0FBRUQsV0FBTyxJQUFQO0FBQ0gsQ0FkRDs7QUFnQkFJLE9BQU9DLE9BQVAsR0FBaUI7QUFDYkMsU0FBSyxhQUFDYixXQUFELEVBQWNHLE9BQWQsRUFBdUJXLFFBQXZCLEVBQWlDQyxRQUFqQyxFQUE4QztBQUMvQ2Ysc0JBQWNGLE1BQU1rQixnQkFBTixDQUF1QmhCLFdBQXZCLENBQWQ7QUFDQUcsa0JBQVVBLFdBQVdKLGtCQUFrQkMsV0FBbEIsQ0FBckI7O0FBRUEsWUFBSWlCLFVBQVVmLFlBQVlGLFdBQVosRUFBeUJHLE9BQXpCLENBQWQ7O0FBRUEsWUFBSWMsT0FBSixFQUFhO0FBQ1QsZ0JBQUlILFFBQUosRUFBYztBQUNWQSx5QkFBU0csT0FBVDtBQUNIOztBQUVEO0FBQ0g7O0FBRUQsWUFBSUMsU0FBU0MsU0FBU0MsYUFBVCxDQUF1QixRQUF2QixDQUFiO0FBQ0EsWUFBSUMsVUFBVXZCLE1BQU13QixZQUFOLENBQW1CMUIsUUFBUTJCLFFBQTNCLENBQWQ7O0FBRUFMLGVBQU9NLEtBQVAsR0FBZTVCLFFBQVE0QixLQUF2QjtBQUNBTixlQUFPTyxJQUFQLEdBQWMsaUJBQWQ7QUFDQVAsZUFBT1EsR0FBUCxRQUFpQkwsT0FBakIsSUFBNkIsU0FBU00sSUFBVCxDQUFjTixPQUFkLElBQXlCLEVBQXpCLEdBQThCLEdBQTNELElBQW1FckIsV0FBbkUsU0FBb0ZHLE9BQXBGLFNBQWlHSCxXQUFqRztBQUNBa0IsZUFBT1UsTUFBUCxHQUFnQixZQUFNO0FBQ2xCVCxxQkFBU1UsSUFBVCxDQUFjQyxXQUFkLENBQTBCWixNQUExQjs7QUFFQSxnQkFBSTtBQUNBLG9CQUFJSixRQUFKLEVBQWM7QUFDVkEsNkJBQVNaLFlBQVlGLFdBQVosRUFBeUJHLE9BQXpCLENBQVQ7QUFDSDtBQUNKLGFBSkQsQ0FJRSxPQUFPSSxFQUFQLEVBQVc7QUFDVCxvQkFBSVEsUUFBSixFQUFjO0FBQ1ZBO0FBQ0g7QUFDSjtBQUNKLFNBWkQ7O0FBY0FHLGVBQU9hLE9BQVAsR0FBaUIsWUFBTTtBQUNuQloscUJBQVNVLElBQVQsQ0FBY0MsV0FBZCxDQUEwQlosTUFBMUI7O0FBRUEsZ0JBQUlILFFBQUosRUFBYztBQUNWQTtBQUNIO0FBQ0osU0FORDs7QUFRQUksaUJBQVNVLElBQVQsQ0FBY0csV0FBZCxDQUEwQmQsTUFBMUI7QUFDSCxLQTVDWTtBQTZDYmUsVUFBTSwwQkFBYztBQUNoQixhQUFLLElBQUlDLEdBQVQsSUFBZ0J0QyxPQUFoQixFQUF5QjtBQUNyQixnQkFBSXVDLFdBQVdDLGNBQVgsQ0FBMEJGLEdBQTFCLENBQUosRUFBb0M7QUFDaEN0Qyx3QkFBUXNDLEdBQVIsSUFBZUMsV0FBV0QsR0FBWCxDQUFmO0FBQ0g7QUFDSjtBQUNKO0FBbkRZLENBQWpCIiwiZmlsZSI6Ii4vaW5kZXguanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgT3B0aW9ucyA9IHJlcXVpcmUoJy4vb3B0aW9ucycpO1xudmFyIFV0aWxzID0gcmVxdWlyZSgnLi91dGlscycpO1xuXG52YXIgZ2V0RGVmYXVsdFZlcnNpb24gPSAoc2VydmljZU5hbWUpID0+IHtcbiAgICByZXR1cm4gT3B0aW9ucy5zZXJ2aWNlRGVmYXVsdFZlcnNpb25bc2VydmljZU5hbWVdO1xufTtcblxudmFyIGxvYWRTZXJ2aWNlID0gKHNlcnZpY2VOYW1lLCB2ZXJzaW9uKSA9PiB7XG4gICAgaWYgKE9wdGlvbnMubWNyc3J2Y3NubXNwYyA9PT0gJ3RyYycpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuVFJDW3NlcnZpY2VOYW1lXVt2ZXJzaW9uXTtcbiAgICAgICAgfSBjYXRjaCAoZXgpIHsgfVxuICAgIH1cblxuICAgIGlmIChPcHRpb25zLm1jcnNydmNzbm1zcGMgPT09ICdjbVRhZycpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuY21UYWcuY29uZmlnLm1zW3NlcnZpY2VOYW1lXVt2ZXJzaW9uXTtcbiAgICAgICAgfSBjYXRjaCAoZXgpIHt9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIGdldDogKHNlcnZpY2VOYW1lLCB2ZXJzaW9uLCBjYWxsYmFjaywgZmFsbGJhY2spID0+IHtcbiAgICAgICAgc2VydmljZU5hbWUgPSBVdGlscy5jbGVhblNlcnZpY2VOYW1lKHNlcnZpY2VOYW1lKTtcbiAgICAgICAgdmVyc2lvbiA9IHZlcnNpb24gfHwgZ2V0RGVmYXVsdFZlcnNpb24oc2VydmljZU5hbWUpO1xuXG4gICAgICAgIHZhciBzZXJ2aWNlID0gbG9hZFNlcnZpY2Uoc2VydmljZU5hbWUsIHZlcnNpb24pO1xuICAgICAgICBcbiAgICAgICAgaWYgKHNlcnZpY2UpIHtcbiAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKHNlcnZpY2UpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG4gICAgICAgIHZhciBiYXNlVXJsID0gVXRpbHMuc2V0VXJsUHJlZml4KE9wdGlvbnMuYmFzZV91cmwpO1xuXG4gICAgICAgIHNjcmlwdC5hc3luYyA9IE9wdGlvbnMuYXN5bmM7XG4gICAgICAgIHNjcmlwdC50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7XG4gICAgICAgIHNjcmlwdC5zcmMgPSBgJHsgYmFzZVVybCB9JHsgLy4qXFwvJC9nLnRlc3QoYmFzZVVybCkgPyAnJyA6ICcvJyB9JHsgc2VydmljZU5hbWUgfS8keyB2ZXJzaW9uIH0vJHsgc2VydmljZU5hbWUgfS5qc2A7XG4gICAgICAgIHNjcmlwdC5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgICAgICBkb2N1bWVudC5oZWFkLnJlbW92ZUNoaWxkKHNjcmlwdCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGxvYWRTZXJ2aWNlKHNlcnZpY2VOYW1lLCB2ZXJzaW9uKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgICAgICBpZiAoZmFsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgZmFsbGJhY2soKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgc2NyaXB0Lm9uZXJyb3IgPSAoKSA9PiB7XG4gICAgICAgICAgICBkb2N1bWVudC5oZWFkLnJlbW92ZUNoaWxkKHNjcmlwdCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChmYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGZhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHQpO1xuICAgIH0sXG4gICAgaW5pdDogbmV3T3B0aW9ucyA9PiB7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiBPcHRpb25zKSB7XG4gICAgICAgICAgICBpZiAobmV3T3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgT3B0aW9uc1trZXldID0gbmV3T3B0aW9uc1trZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./index.js\n")},"./options.js":function(module,exports,__webpack_require__){"use strict";eval("\n\nmodule.exports = {\n    base_url: '//vidstat.taboola.com/',\n    async: true,\n    mcrsrvcsnmspc: 'trc',\n    serviceDefaultVersion: {\n        oppsula: '1.0.1'\n    }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9vcHRpb25zLmpzP2M5ZmEiXSwibmFtZXMiOlsibW9kdWxlIiwiZXhwb3J0cyIsImJhc2VfdXJsIiwiYXN5bmMiLCJtY3JzcnZjc25tc3BjIiwic2VydmljZURlZmF1bHRWZXJzaW9uIiwib3Bwc3VsYSJdLCJtYXBwaW5ncyI6Ijs7QUFBQUEsT0FBT0MsT0FBUCxHQUFpQjtBQUNiQyxjQUFVLHdCQURHO0FBRWJDLFdBQU8sSUFGTTtBQUdiQyxtQkFBZSxLQUhGO0FBSWJDLDJCQUF1QjtBQUNuQkMsaUJBQVM7QUFEVTtBQUpWLENBQWpCIiwiZmlsZSI6Ii4vb3B0aW9ucy5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0ge1xuICAgIGJhc2VfdXJsOiAnLy92aWRzdGF0LnRhYm9vbGEuY29tLycsXG4gICAgYXN5bmM6IHRydWUsXG4gICAgbWNyc3J2Y3NubXNwYzogJ3RyYycsXG4gICAgc2VydmljZURlZmF1bHRWZXJzaW9uOiB7XG4gICAgICAgIG9wcHN1bGE6ICcxLjAuMSdcbiAgICB9XG59OyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./options.js\n")},"./utils.js":function(module,exports,__webpack_require__){"use strict";eval('\n\nmodule.exports = {\n    setUrlPrefix: function setUrlPrefix(url) {\n        if (typeof url !== "string") {\n            return url;\n        }\n\n        url = url.replace(/^(http[s]?:|ftp:)/g, "");\n\n        if (url.indexOf("//") !== 0) {\n            url = "//" + url;\n        }\n\n        return url;\n    },\n    cleanServiceName: function cleanServiceName(serviceName) {\n        return serviceName.replace(/.js$/, \'\');\n    }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi91dGlscy5qcz8xYjIzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJzZXRVcmxQcmVmaXgiLCJ1cmwiLCJyZXBsYWNlIiwiaW5kZXhPZiIsImNsZWFuU2VydmljZU5hbWUiLCJzZXJ2aWNlTmFtZSJdLCJtYXBwaW5ncyI6Ijs7QUFBQUEsT0FBT0MsT0FBUCxHQUFpQjtBQUNiQyxrQkFBYyxzQkFBVUMsR0FBVixFQUFlO0FBQ3pCLFlBQUksT0FBT0EsR0FBUCxLQUFlLFFBQW5CLEVBQTZCO0FBQ3pCLG1CQUFPQSxHQUFQO0FBQ0g7O0FBRURBLGNBQU1BLElBQUlDLE9BQUosQ0FBWSxvQkFBWixFQUFpQyxFQUFqQyxDQUFOOztBQUVBLFlBQUlELElBQUlFLE9BQUosQ0FBWSxJQUFaLE1BQXNCLENBQTFCLEVBQTZCO0FBQ3pCRixrQkFBTyxPQUFPQSxHQUFkO0FBQ0g7O0FBRUQsZUFBT0EsR0FBUDtBQUNILEtBYlk7QUFjYkcsc0JBQWtCLDBCQUFVQyxXQUFWLEVBQXVCO0FBQ3JDLGVBQU9BLFlBQVlILE9BQVosQ0FBb0IsTUFBcEIsRUFBNEIsRUFBNUIsQ0FBUDtBQUNIO0FBaEJZLENBQWpCIiwiZmlsZSI6Ii4vdXRpbHMuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBzZXRVcmxQcmVmaXg6IGZ1bmN0aW9uICh1cmwpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB1cmwgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB1cmw7XG4gICAgICAgIH1cblxuICAgICAgICB1cmwgPSB1cmwucmVwbGFjZSgvXihodHRwW3NdPzp8ZnRwOikvZyxcIlwiKTtcbiAgICAgICAgXG4gICAgICAgIGlmICh1cmwuaW5kZXhPZihcIi8vXCIpICE9PSAwKSB7XG4gICAgICAgICAgICB1cmwgPSAgXCIvL1wiICsgdXJsO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHVybDtcbiAgICB9LFxuICAgIGNsZWFuU2VydmljZU5hbWU6IGZ1bmN0aW9uIChzZXJ2aWNlTmFtZSkge1xuICAgICAgICByZXR1cm4gc2VydmljZU5hbWUucmVwbGFjZSgvLmpzJC8sICcnKTtcbiAgICB9XG59OyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./utils.js\n')},0:function(t,e,i){t.exports=i("./index.js")}})})},function(t,e){"use strict";function i(t,e,i){}function s(t,e,i){Object.defineProperty(t,e,{writable:!1,configurable:!1,value:i})}var n=["handshakeVersion","initAd","startAd","stopAd","skipAd","resizeAd","pauseAd","resumeAd","expandAd","collapseAd","subscribe","unsubscribe"],r=["AdLoaded","AdStarted","AdStopped","AdSkipped","AdSkippableStateChange","AdSizeChange","AdLinearChange","AdDurationChange","AdExpandedChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdClickThru","AdInteraction","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog","AdError"],o=["getAdLinear","getAdWidth","getAdHeight","getAdExpanded","getAdSkippableState","getAdRemainingTime","getAdDuration","getAdVolume","getAdCompanions","getAdIcons"],a=["setAdVolume"];i.prototype.handshakeVersion=function(t,e){},i.prototype.initAd=function(t,e,i,s,n,r,o){},i.prototype.startAd=function(t){},i.prototype.stopAd=function(t){},i.prototype.skipAd=function(t){},i.prototype.resizeAd=function(t,e,i,s){},i.prototype.pauseAd=function(t){},i.prototype.resumeAd=function(t){},i.prototype.expandAd=function(t){},i.prototype.collapseAd=function(t){},i.prototype.subscribe=function(t,e,i){},i.prototype.unsubscribe=function(t,e){},i.prototype.getAdLinear=function(t){},i.prototype.getAdWidth=function(t){},i.prototype.getAdHeight=function(t){},i.prototype.getAdExpanded=function(t){},i.prototype.getAdSkippableState=function(t){},i.prototype.getAdRemainingTime=function(t){},i.prototype.getAdDuration=function(t){},i.prototype.getAdVolume=function(t){},i.prototype.getAdCompanions=function(t){},i.prototype.getAdIcons=function(t){},i.prototype.setAdVolume=function(t,e){},s(i,"METHODS",n),s(i,"GETTERS",o),s(i,"SETTERS",a),s(i,"EVENTS",r);var d=n.filter(function(t){return["skipAd"].indexOf(t)===-1});s(i,"checkVPAIDInterface",function(t){var e=d.every(function(e){return"function"==typeof t[e]});return e}),t.exports=i},function(t,e,i){"use strict";function s(t,e,i,s){this._isValid=h(t),this._isValid&&(this._creative=t,this._el=e,this._videoEl=i,this._iframe=s,this._subscribers=new u,c.setFullSizeStyle(e),r.call(this))}function n(t,e){var i,s=l.prototype[t].length,n=s===e.length?e.pop():void 0,r=null;try{i=this._creative[t].apply(this._creative,e)}catch(t){r=t}d(n,this._subscribers,r,i)}function r(){if(f.forEach(function(t){this._creative.subscribe(a.bind(this,t),t)}.bind(this)),this._creative.subscribe(o.bind(this),v),this._videoEl){var t=this._iframe.contentDocument.documentElement,e=this._videoEl;t.addEventListener("click",function(i){i.target===t&&e.click()})}}function o(t,e,i){this._subscribers.triggerSync(v,{url:t,id:e,playerHandles:i})}function a(t){this._subscribers.trigger(t,Array.prototype.slice.call(arguments).slice(1))}function d(t,e,i,s){t?t(i,s):i&&e.trigger(p,i)}var l=i(25),u=i(27),h=l.checkVPAIDInterface,c=i(15),p=(l.METHODS,"AdError"),v="AdClickThru",f=l.EVENTS.filter(function(t){return t!=v});s.prototype=Object.create(l.prototype),s.prototype.isValidVPAIDAd=function(){return this._isValid},l.METHODS.forEach(function(t){var e=["subscribe","unsubscribe","initAd"];e.indexOf(t)===-1&&(s.prototype[t]=function(){var e=Array.prototype.slice.call(arguments);this.syncmthds&&this.syncmthds.indexOf(t)>-1?n.call(this,t,e):setTimeout(function(){n.call(this,t,e)}.bind(this),0)})}),s.prototype.initAd=function(t,e,i,s,n,r,o){n=n||{},r=c.extend({slot:this._el,videoSlot:this._videoEl},r||{}),setTimeout(function(){var a;try{this._creative.initAd(t,e,i,s,n,r)}catch(t){a=t}d(o,this._subscribers,a)}.bind(this),0)},s.prototype.subscribe=function(t,e,i){this._subscribers.subscribe(e,t,i)},s.prototype.unsubscribe=function(t,e){this._subscribers.unsubscribe(e,t)},s.prototype.on=s.prototype.subscribe,s.prototype.off=s.prototype.unsubscribe,l.GETTERS.forEach(function(t){s.prototype[t]=function(e){setTimeout(function(){var i,s=null;try{i=this._creative[t]()}catch(t){s=t}d(e,this._subscribers,s,i)}.bind(this),0)}}),s.prototype.setAdVolume=function(t,e){setTimeout(function(){var i,s=null;try{this._creative.setAdVolume(t),i=this._creative.getAdVolume()}catch(t){}d(e,this._subscribers,s,i)}.bind(this),0)},s.prototype._destroy=function(){this.stopAd(),this._subscribers.unsubscribeAll()},t.exports=s},function(t,e){"use strict";function i(){this._subscribers={}}function s(t,e){setTimeout(function(){t.handler.call(t.context,e)},0)}i.prototype.subscribe=function(t,e,i){this.isHandlerAttached(t,e)||this.get(e).push({handler:t,context:i,eventName:e})},i.prototype.unsubscribe=function(t,e){this._subscribers[e]=this.get(e).filter(function(e){return t!==e.handler})},i.prototype.unsubscribeAll=function(){this._subscribers={}},i.prototype.trigger=function(t,e){for(var i=this.get(t),n=0;n<i.length;n++)s(i[n],e)},i.prototype.triggerSync=function(t,e){var i=this.get(t);i.forEach(function(t){t.handler.call(t.context,e)})},i.prototype.get=function(t){return this._subscribers[t]||(this._subscribers[t]=[]),this._subscribers[t]||[]},i.prototype.isHandlerAttached=function(t,e){return this.get(e).some(function(e){return t===e.handler})},t.exports=i},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),n=function(){function t(e){i(this,t),this.os=e.os.name,this.osVersion=parseInt(e.os.version),this.browserName=e.browser.name,this.browserMajorVersion=parseInt(e.browser.major)}return s(t,[{key:"isAutoplaySupported",value:function(){switch(this.os){case"Android":return this.isAutoplaySupportedAndroid();case"iOS":return this.isAutoplaySupportedIOS();default:return!1}}},{key:"isAutoplaySupportedIOS",value:function(){if(this.osVersion<10)return!1;switch(this.browserName){case"Firefox":return this.browserMajorVersion>=7;default:return!0}}},{key:"isAutoplaySupportedAndroid",value:function(){switch(this.browserName){case"Chrome":case"Chrome WebView":return parseInt(this.browserMajorVersion)>=53;case"Firefox":return parseInt(this.browserMajorVersion)>=49;case"Android Browser":return parseInt(this.browserMajorVersion)>=7;default:return!1}}}]),t}();e.default=n},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),n=function(){function t(e){i(this,t),this.decodedData=atob(e),this.nextBits=0,this.numBitsRemaining=0,this.isEndOfStream=!1,this.pointerInDecodedData=0}return s(t,[{key:"getNextByte",value:function(){return this.pointerInDecodedData===this.decodedData.length?-1:this.decodedData.charCodeAt(this.pointerInDecodedData++)}},{key:"read",value:function(){if(this.isEndOfStream)return-1;if(0===this.numBitsRemaining){if(this.nextBits=this.getNextByte(),this.nextBits===-1)return this.isEndOfStream=!0,-1;this.numBitsRemaining=8}return this.numBitsRemaining--,this.nextBits>>7-this.numBitsRemaining&1}},{key:"isEof",value:function(){return this.isEndOfStream||0==this.numBitsRemaining&&this.pointerInDecodedData==this.decodedData.length-1}},{key:"readChar",value:function(){for(var t=0,e=0;e<7;e++){var i=this.read();t|=i<<e}return String.fromCharCode(t)}},{key:"readByte",value:function(){for(var t=0,e=0;e<8;e++){var i=this.read();t|=i<<e}return t}},{key:"read7bitString",value:function(t){for(var e="",i=0;i<t;i++)e+=this.readChar();return e}},{key:"read8bitString",value:function(t){for(var e="",i=0;i<t;i++)e+=String.fromCharCode(this.readByte());return e}},{key:"readBytes",value:function(t){for(var e=new ArrayBuffer(t),i=0;i<t;i++)e[i]=this.readByte();return e}},{key:"readInt",value:function(t){if(void 0!==t){for(var e=0,i=0;i<t;i++){var s=this.read();e|=s<<i}return e}for(var n=0,i=3;i>=0;i--)n+=this.readByte(),i>0&&(n<<=8);return n}},{key:"readLong",value:function(){for(var t=0,e=7;e>=0;e--)t+=this.readByte(),e>0&&(t<<=8);return t}},{key:"readShort",value:function(){for(var t=0,e=1;e>=0;e--)t+=this.readByte(),e>0&&(t<<=8);return t}},{key:"readFloat",value:function(){for(var t=new ArrayBuffer(4),e=new DataView(t),i=0;i<4;i++)e.setUint8(i,this.readByte());var s=e.getFloat32(0);return s}},{key:"readDouble",value:function(){for(var t=new ArrayBuffer(8),e=new DataView(t),i=0;i<8;i++)e.setUint8(i,this.readByte());var s=e.getFloat64(0);return s}},{key:"readBool",value:function(){return this.read()>0}}]),t}();e.default=n},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),n=function(){function t(e){i(this,t),this.store=e,this.effectiveTypes={"slow-2g":1,"2g":2,"3g":3,"4g":4},this.types={bluetooth:1,cellular:2,ethernet:3,none:4,wifi:5,wimax:6,other:7,unknown:8},this.navigatorConnection={},this._detectConnectionType()}return s(t,[{key:"_detectConnectionType",value:function(){var t=this,e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(e){var i=function(){var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection,i=e.effectiveType||"",s=e.type||"";t.navigatorConnection={browserSupport:!0,downlink:e.downlink||0,effectiveType:i,type:s,effectiveTypeId:t.effectiveTypes.hasOwnProperty(i)?t.effectiveTypes[i]:0,typeId:t.types.hasOwnProperty(s)?t.types[s]:0,rtt:e.rtt||0,saveData:e.saveData||!1},t.store.set("navigatorConnection",t.navigatorConnection),t.store.emit("navigatorConnectionChange",t.navigatorConnection)};e.onchange=i,i()}else this.navigatorConnection={browserSupport:!1},this.store.set("navigatorConnection",this.navigatorConnection)}}]),t}();e.default=n},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=i(34),d=n(a),l=i(9),u=n(l),h=i(1),c=s(h),p=70,v=function(){function t(e,i){r(this,t),this._store=e,this._intervalDuration=this._store.get("kpitrvldrt"),this._numOfSamplesPerMeasurment=this._store.get("prfsmpmsnt"),this._durationOfSamplePerMeasurment=this._store.get("prfsmitrvpmsnt"),this._playerOpportunityManager=i,this.dataSaverUrl=this._store.get("dtsvrurl"),this._addListeners(),this._startLoopTimeInterval(),this._measure(),this._runFirstMeasurmentCycle()}return o(t,[{key:"_addListeners",value:function(){this._store.once("stop",this._onStop.bind(this)),this._store.once("beforeunload",this._onBeforeunload.bind(this))}},{key:"_startLoopTimeInterval",value:function(){var t=this._store.get("msrkpifctr")||100;if(t=Math.min(100,t),1===t||c.getRandomInt(0,t)===t){var e=c.normalizeMilliseconds(this._store.get("msrkpiintvl")||15);this._loopInterval=setInterval(this._sendLoopKpiPixel.bind(this),e)}}},{key:"_sendLoopKpiPixel",value:function(){var t=c.createPixelParams(p,this._store);t.kpipm=this._store.get("performance.performanceMeasurment"),t.kpinw=this._store.get("performance.wfRoundTripAverageDuration"),c.sendPixel(t,this._store)}},{key:"_measure",value:function(){var t=this;this._running=!0,this._runSampling("first_kpi"),this.intervalMeasureId=setInterval(function(){t._runSampling("last_kpi")},this._intervalDuration)}},{key:"_runSampling",value:function(t){var e=this,i=new d.default;i.runEventLoopSampling(this._numOfSamplesPerMeasurment,this._durationOfSamplePerMeasurment).then(function(s){e._store.set(t,s),e._saveData(s),i.cleanResources()}),this._measureDataSaverRoundtripDuration()}},{key:"_measureDataSaverRoundtripDuration",value:function(){var t=this;if(this.dataSaverUrl){var e=(new Date).getTime(),i=new XMLHttpRequest;i.onreadystatechange=function(){i.readyState==XMLHttpRequest.DONE&&t._store.set("performance.dtsvrRoundTripAverageDuration",(new Date).getTime()-e)},i.open("GET",this.dataSaverUrl,!0),i.send(null)}}},{key:"_sendOpp",value:function(t){this._playerOpportunityManager.send(t)}},{key:"_runFirstMeasurmentCycle",value:function(){var t=this,e=new d.default;e.runOneEventLoopSampling().then(function(e){t._saveData(e),t._sendOpp(u.default.firstWfMeasurment)})}},{key:"_saveData",value:function(t){this._store.set("performance.wfRoundTripAverageDuration",this._store.get("waterfall_data.average_duration")),this._store.set("performance.performanceMeasurment",Math.round(t))}},{key:"_onBeforeunload",value:function(){this._destroy()}},{key:"_onStop",value:function(){this._destroy()}},{key:"_destroy",value:function(){this._running&&(clearInterval(this.intervalMeasureId),clearInterval(this._loopInterval),this._running=!1,this._saveData(this._store.get("last_kpi")),this._sendOpp(u.default.playerClosedMeasurment))}}]),t}();e.default=v},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),n=function(){function t(e,s){i(this,t),this.parent=e,this.getAdSkippableRemainingTime=this.build_vpaid_get_controller(e,"getAdSkippableRemainingTime",-1),this.getAdLinear=this.build_vpaid_get_controller(e,"getAdLinear",!0),this.getAdWidth=this.build_vpaid_get_controller(e,"getAdWidth",0,"width"),this.getAdHeight=this.build_vpaid_get_controller(e,"getAdHeight",0,"height"),this.getAdExpanded=this.build_vpaid_get_controller(e,"getAdExpanded",!0),this.getAdSkippableState=this.build_vpaid_get_controller(e,"getAdSkippableState",!0),this.getAdRemainingTime=this.build_vpaid_get_controller(e,"getAdRemainingTime",-1),this.getAdDuration=this.build_vpaid_get_controller(e,"getAdDuration",-1),this.getAdCompanions=this.build_vpaid_get_controller(e,"getAdCompanions",[]),this.getAdIcons=this.build_vpaid_get_controller(e,"getAdIcons",[]),this.pauseAd=this.build_vpaid_set_controller(e,"pauseAd"),this.resumeAd=this.build_vpaid_set_controller(e,"resumeAd"),this.expandAd=this.build_vpaid_set_controller(e,"expandAd"),this.collapseAd=this.build_vpaid_set_controller(e,"collapseAd"),this.skipAd=this.build_vpaid_set_controller(e,"skipAd"),this.stopAd=this.build_vpaid_set_controller(e,"stopAd"),this.store=s,this.isMultiAdsActive=this.store.get("mltads")}return s(t,[{key:"startAd",value:function(){this.parent.vpaidHandler.startAd()}},{key:"getAdVolume",value:function(){if(!this.isMultiAdsActive){var t=this.parent.volume();return t}}},{key:"setAdVolume",value:function(t,e){this.isMultiAdsActive||this.store.get("forceMute")&&t>0||(this.parent.volume(t),
this.parent.runningVpaid&&this.parent.runningVpaid.vpaid&&this.parent.runningVpaid.vpaid.setAdVolume(t))}},{key:"resizeAd",value:function(t,e,i){if(!this.isMultiAdsActive)return!!this.parent.runningVpaid&&this.parent.runningVpaid.resize(t,e,i)}},{key:"muteAd",value:function(){}},{key:"unmuteAd",value:function(){}},{key:"setParam",value:function(t,e){return this.store(t,e)}},{key:"getParam",value:function(t){return this.store(t)}},{key:"build_vpaid_set_controller",value:function(t,e){var i=function e(){return!!t.scheduleMaster.gotVpaid&&!!t.scheduleMaster.runningVpaid.vpaid[e.type]&&t.scheduleMaster.vpaid[e.type]()};return i.proxy=t,i.type=e,i}},{key:"build_vpaid_get_controller",value:function(t,e,i,s){var n=function e(){return t.scheduleMaster.gotVpaid?t.scheduleMaster.vpaid[e.type]():e.default_value_key&&void 0!=t.options[e.default_value_key]?t.options[e.default_value_key]:e.default_value};return n.proxy=t,n.default_value=i,s?n.default_value_key=s:n.default_value_key=void 0,n.type=e,n}},{key:"gotVpaid",get:function(){return!!(this.parent&&this.parent.scheduleMaster&&this.parent.scheduleMaster.gotVpaid)}},{key:"gotAd",get:function(){return!(!this.gotVpaid||!this.parent.scheduleMaster.runningVpaid.adPlaying)}}]),t}();e.default=n,n.prototype.getAdSkippableRemainingTime=n.prototype.build_vpaid_get_controller(parent,"getAdSkippableRemainingTime",-1)},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t){return t&&t.__esModule?t:{default:t}}function r(t){function e(){if(this.isMobile){var t=this.store.get("forcecnvsmpg"),e=this.store.get("useapforcntnt");if(t&&!e)return this.store.set("hasAutoPlay",!1),void(this.hasAutoPlay=!1);var i=this.store.get("ua"),s=new E.default(i);s.isAutoplaySupported()?(this.store.set("hasAutoPlay",!0),this.hasAutoPlay=!0):(this.store.set("hasAutoPlay",!1),this.hasAutoPlay=!1)}}var i=this;this.overrideWindowMethods=function(){Object.assign=function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t}};var s=A.parseUserAgent(),n=void 0==Object.assign||!A.isNativeCode(Object.assign);n&&this.overrideWindowMethods(),this.status="loading",this.videoLength=0,this.ga_set=!1,this.video=void 0,this.repeatCount=0,this.schedule={},this.playerIsClosed=!1,this.options=(0,c.getDefaults)(t);var r=Object.assign((0,c.getUnitParams)(),t.dplayerSettings);this.options=Object.assign({},this.options,r);var o=new v.default(this.options);this.store=o,this.store.set("player_id",Date.now()+"_"+A.generateGuid(30)),this.store.set("fullPageUrl",window.location.href),this.store.set("forcePause",!1),this.store.set("forceMute",!1),this.store.set("dataSaverDetected",!1),this.store.set("conversionsCount",0),this.store.set("failsCount",0),this.store.set("getAdData.count",0),this.store.set("playerAspectRatio",this.options.aspect_ratio),this.store.set("noplrcntr",this.store.get("noplrcntr")&&this.store.get("isMultiVpaidUnit")),h.default.prototype.debugLevels=this.store.get("debugLevels")||"",this.logConnectionType=function(t){var e="unknown",i={1:"dialup",2:"wired",3:"wifi",4:"mobile",5:"satellite"};t&&(e=i.hasOwnProperty(t)?i[t]:t.toString()),this.store.set("connectionType",{type:e})},this._preventAutoplay=!this.store.get("isMobile")&&this.store.get("prvaupl")&&s&&s.browser&&s.browser.name&&"firefox"==s.browser.name.toLowerCase();var d={};try{var u=new S.default(t.auc_dast,this.store);d=u.fetchResults(),d&&(d.sesid&&this.store.set("sessionId",d.sesid),this.logConnectionType(d.ct))}catch(t){this.store.set("dastDecoderError",A.stringify(t))}this.store.set("dast",d),d.hasOwnProperty("abt")&&(this.store.set("dast_AbTest",d.abt),this.store.set("abTest",this.store.get("abTest")?this.store.get("abTest")+"|"+d.abt:d.abt));var p=this.store.get("isMobile"),f=this.store.get("measureKPI");(p||f)&&(this.playerOpportunityManager=new O.default(this.store)),this.dependenciesLoader=new W.default(this.store),this.dependenciesLoader.getDynamicSettings();var g=this.store.getLatestVersion("prtct");if(g&&g.value){var _=g.value.match(/(?:\/vpaid\/hjk.)(.*).js/);if(_&&2===_.length){var w=_[1];this.dependenciesLoader.get("hjk",w,"hjkFuncString",g.value,this.store.get("hjkclb"))}}var k=this.store.getLatestVersion("anltcsurl");if(k&&k.value){var C=k.value.match(/(?:\/vpaid\/vpaidAnalytics.)(.*).js/);if(C&&2===C.length){var I=C[1];this.dependenciesLoader.get("vpaidAnalytics",I,"analyticsFuncString",k.value,this.store.get("anltcsclb"))}}this.store.get("base_url")&&0!==this.store.get("base_url").length||(this.store.set("original_base_url","empty"),this.store.set("href",window.location.href),this.store.set("base_url","//www.cmbestsrv.com")),this.resourceLoader=new L.default(this.store),this.store.set("resourceLoader",this.resourceLoader),this.store.get("loadrsrc")&&this.resourceLoader.loadCSSResources(document),this.connectionTypeDetector=new H.default(this.store),this.store.set("queueLength",0),this.store.set("vpaidReadyCount",0),this.store.set("document.visible",!document.hidden),A.reportDebug("player_waterfall","ctor1",{type:"debug",message:"ctor1",options:this.store.data},this.store),o.set("ads_playing",0),o.set("ads_started",0),o.set("total_impressions",0),f&&(this.KPIsRecorder=new T.default(this.store,this.playerOpportunityManager)),this.options.schedule&&this.options.schedule.length&&this.options.schedule[0].ad_parameters&&this.options.schedule[0].ad_parameters.length>2&&o.set("static_schedule",this.options.schedule),this.overrideNonNativeFunctions=function(){var t=this.store.get("ovrdnonntvfnclst");if(Object.keys(t).length>0){var e=document.createElement("iframe");e.style.width=0,e.style.height=0,e.style.visibility="hidden",e.style.display="none",document.body.appendChild(e);for(var i in t)A.isNativeCode(window[i])||(window[i]=t[i](e))}},this.overrideNonNativeFunctions(),this.isMobile=this.store.get("isMobile"),e.call(this),this.isMultiVpaidUnit=this.store.get("isMultiVpaidUnit");var x=this,P=36e5*(this.store.get("kill_after_hour")||0);P&&setTimeout(function(){x.closeCleanPlayer("kill_after_hour")},P),window.addEventListener("beforeunload",function(t){i.store.emit("beforeunload")}),this.store.on("AdImpression",function(){x.killAfterXWithNoConversion()}),this.playerStatus="content",this.store.on("AdPlayerVisible",function(){if(!this.playerIsClosed){this.playerStatus="ad";var t={playerState:this.playerStatus,isVisible:!1};this.VideoControls&&(this.isMobile?this.VideoControls.setState(t):(this.wasContentPausedBeforeAd=this.VideoControls.getValueFromControlsState("isPaused"),t.isPaused=!1,this.VideoControls.setState(t),this.runningVpaid&&(this.runningVpaid.vpaid.vpaidHandler.setPaused(!1),this.runningVpaid.vpaid.vpaidHandler.volume(this.VideoControls.getValueFromControlsState("volume")))),this.store.emit("playerStatusChanged",this.playerStatus))}}.bind(this)),this.store.on("AdPlayerHidden",function(){if(!this.playerIsClosed){this.playerStatus="content";var t={playerState:this.playerStatus,isVisible:!0};this.VideoControls&&(this.isMobile?(this.volume(0),this.VideoControls.setState(t)):(t.isPaused=this.wasContentPausedBeforeAd,this.VideoControls.setState(t),this.volume(this.VideoControls.getValueFromControlsState("volume"))),this.store.emit("playerStatusChanged",this.playerStatus))}}.bind(this)),this.debugTracker=new h.default("OvaMediaPlayer"),this.debugTracker.info("unit-version: "+this.store.get("unit_loader_version")+", player-version: "+this.store.get("player_version"),this.store,{color:"#D15EFF"}),this.seek=function(t){if(!this._isAdState())try{if(void 0==t)return this.video.currentTime;if(isNaN(parseFloat(t)))return;this.video.currentTime=parseFloat(t)}catch(t){return 0}},this.killAfterXWithNoConversion=function(){var t=this.store.get("kaxwnc");t&&(this.kaxwnc&&clearTimeout(this.kaxwnc),this.kaxwnc=setTimeout(function(){x.closeCleanPlayer("killAfterXWithNoConversion")},t))},this.killAfterXWithNoConversion(),this.play=function(){if(!this.store.get("forcePause"))return this._isAdState()?void this.vpaidHandler.vpaid.manager.play():void this.video.play()},this.pause=function(){return this._isAdState()?void this.vpaidHandler.vpaid.manager.pause():(this.store.emit("contentPaused"),void this.video.pause())},this.resume=function(){return this._isAdState()?void this.vpaidHandler.vpaid.manager.play():(this.store.emit("contentResumed"),void("paused"==this.status&&this.video.play()))},this.stop=function(){try{if("stopped"==this.status||this._isAdState())return;this.status="stopping",this.video.pause(),this.seek(0),this.status="stopped",this.options.onPlayerStop(this)}catch(t){}},this.resize=function(t,e,i){this.vpaidManager&&this.vpaidManager.resize(t,e);var s=0,n=0,r=0;try{(void 0==t||isNaN(parseInt(t)))&&(t=!1),(void 0==e||isNaN(parseInt(e)))&&(e=!1),t||e||(this.debugTracker.error("resize","No `height` or `width` specified!"),t=this.store.get("width"),e=this.store.get("height")),e&&t?(this.options.height=e+"",this.options.width=t+"",this.setVideoSize(this.options.width.search(/px$/g)>-1?this.options.width:this.options.width+"px",this.options.height.search(/px$/g)>-1?this.options.height:this.options.height+"px")):(i&&i.split(":").length>1&&(this.options.aspect_ratio=i),t?(this.options.height=!1,this.options.width=t+"",r=this.options.aspect_ratio.split(":")[1]/this.options.aspect_ratio.split(":")[0],s=this.options.width.search(/px$/g)>-1?this.options.width:parseFloat(this.options.width)+"px",n=Math.floor(parseFloat(s)*r)+"px",this.setVideoSize(s,n)):(this.options.width=!1,this.options.height=e+"",r=this.options.aspect_ratio.split(":")[0]/this.options.aspect_ratio.split(":")[1],n=this.options.height.search(/px$/g)>-1?this.options.height:parseFloat(this.options.height)+"px",s=Math.floor(parseFloat(n)*r)+"px",this.setVideoSize(s,n)))}catch(t){this.debugTracker.error("resize","Resizing component failed!")}},this.setVideoSize=function(t,e){this.isMultiVpaidUnit||(this.store.get("noplrcntr")||(this.target.style.width=t,this.target.style.height=e,this.target.setAttribute("width",parseInt(t)),this.target.setAttribute("height",parseInt(e))),this.video.style.width=t,this.video.style.height=e,this.video.setAttribute("width",parseInt(t)),this.video.setAttribute("height",parseInt(e))),this.scheduleMaster.runningVpaid&&!this.scheduleMaster.runningVpaid.finished&&this.scheduleMaster.runningVpaid.resize(parseInt(t),parseInt(e))},this.handleTarget=function(t){var e;return e=this.store.get("noplrcntr")?document.querySelector(t):"string"==typeof t?document.getElementById(t):t},this.stringToSeconds=function(t){for(var e=t.split(":"),i=[],s=0;s<e.length;s++)i.push(isNaN(parseInt(e[s]))?0:parseInt(e[s]));var n=0;switch(i.length){case 1:n=parseInt(t);break;case 2:n=60*parseInt(i[0])+parseInt(i[1]);break;case 3:n=3600*parseInt(i[1])+60*parseInt(i[1])+parseInt(i[2])}return n},this.secondsToString=function(t){t=Math.floor(t);var e=(t-t%3600)/3600;e=e<10?"0"+e:e,t-=3600*e;var i=(t-t%60)/60;return i=i<10?"0"+i:i,t-=60*i,t=t<10?"0"+t:t,(e>0?e+":":"")+i+":"+t},this.generateId=function(){for(var t="vpaid-"+Math.floor(65536*(1+Math.random()));document.getElementById(t);)t="vpaid-"+Math.floor(1e5*Math.random());return t},this.ova=new a.default(this,this.store),this.initVpaidManager=function(){this.vpaidManager=new b.default(this.store,this)},this.store.on("closePlayer",function(){i.closePlayer()}),this.initScheduleMaster=function(){this.scheduleMaster=new l.default(this,this.store),this.store.get("vForce")&&this.scheduleMaster.disable()},this.initScheduleMaster(),this.handlePlayerPause=function(){if(!this.playerIsClosed)switch(this.status){case"loading-play":case"playing":this.status="paused",this.options.onPlayerPause(this);break;default:return}},this.handlePlayerPlay=function(){if(!this.playerIsClosed)switch(this.status){case"loading":this.status="loading-play";break;case"ended":this.status="playing",window.setTimeout(function(){!this.playerIsClosed&&this.options._onPlayerRepeat&&this.options._onPlayerRepeat()}.bind(this),0),window.setTimeout(function(){!this.playerIsClosed&&this.options._onPlayerRepeat&&this.options._onPlayerRepeat()}.bind(this),0),window.setTimeout(function(){!this.playerIsClosed&&this.options.onPlayerPlay&&this.options.onPlayerPlay()}.bind(this),0);break;case"loading-play":case"stopped":case"paused":this.status="playing",window.setTimeout(function(){!this.playerIsClosed&&this.options.onPlayerResume&&this.options.onPlayerResume()}.bind(this),0);break;default:return}},this._onPlayerRepeat=function(){this.repeatCount++},this.handleOnCanPlay=function(){if(!this.playerIsClosed)switch(this.status){case"loading-play":this.status="playing",this.createSchedule(),window.setTimeout(function(){this.onPlayerReadyRun(),this.options.onPlayerReady()}.bind(this),0),window.setTimeout(function(){this.options.onPlayerPlay()}.bind(this),0);break;case"loading":this.createSchedule(),window.setTimeout(function(){this.onPlayerReadyRun(),this.options.onPlayerReady()}.bind(this),0);break;default:return}},this.handlePlayerEnd=function(){if(!this.playerIsClosed)switch(this.store.emit("contentChanged"),this.status){case"playing":window.setTimeout(function(){this.options.onPlayerPause()}.bind(this),0);case"paused":this.status="ended",this.options.repeat?window.setTimeout(function(t){t.play()}.bind(this,this.video),0):(this.options.onPlayerComplete(this),this.options.onPlayerStop(this));break;default:return}},this.handlePlayerSeeked=function(t){this.playerIsClosed||window.setTimeout(function(){this.options.onPlayerSeek()}.bind(this),0)},this.handlePlayerError=function(t){this.status="stopping",this.video.pause(),this.status="loading",this.options.onPlayerError(this,t)},this.handlePlayerVolume=function(){this.debugTracker.info("Event","Player Volume Was Changed!")},this.muteToggle=function(){this.options.mute?this.unMute():this.mute()},this.mute=function(){return this._isAdState()?void this.vpaidHandler.vpaid.manager.mute():(this.video.muted=this.options.mute=!0,this.vpaidManager&&this.vpaidManager.mute(),void this.volume(0))},this.unMute=function(){return this._isAdState()?void this.vpaidHandler.vpaid.manager.unmute():(this.video.muted=this.options.mute=!1,this.vpaidManager&&this.vpaidManager.unmute(this.options.volume>1?this.options.volume/100:this.options.volume),void this.volume(this.options.volumeBeforeMute))},this.volume=function(t){if("stopped"!=this.status&&!(this.store.get("forceMute")&&t>0)){if(this.vpaidManager&&this.vpaidManager.volume(t),void 0==t)return this._getCurrentVolume();if(!(this.options.videoControlsForceMute&&t>0))return 0===t&&0!=this.options.volume&&(this.options.volumeBeforeMute=this.options.volume),this.options.volume=t,t=t>1?t/100:t,0==t?(this.video.muted=this.options.mute=!0,this.video.volume=0):(this.video.muted=this.options.mute=!1,this.video.volume=t),x.store.set("volume",t),this.VideoControls&&this.VideoControls.setState({volume:t}),t}},this._getCurrentVolume=function(){return this._isAdState()?this.vpaidHandler.vpaid.manager.getCurrentWorkingVpaidVolume():this.options.volume},this.onPlayerReadyRun=function(){var t=this.onPlayerReadyActions.length;if(0!=t){for(var e=0;e<t;e++)this.onPlayerReadyActions[e].apply(this,[]);this.onPlayerReadyActions=new Array}},this.onPlayerReadyActions=new Array,this.attachEventsToVideo=function(t){var e=this,i=this,s=function t(e){t.player.handlePlayerSeeked(e)};s.player=this,t.addEventListener("seeked",s,!0);var n=function t(){t.player.handleOnCanPlay()};n.player=this,t.addEventListener("canplay",n,!0);var r=function t(){t.player.handlePlayerPlay()};r.player=this,t.addEventListener("play",r,!0);var o=function t(){t.player.handlePlayerPause()};o.player=this,t.addEventListener("pause",o,!0);var a=function t(){t.player.handlePlayerEnd()};a.player=this,t.addEventListener("ended",a,!0);var d=function(t){i.isMobile||i.handlePlayerError(t)};d.player=this;var i=this;t.addEventListener("error",d,!0),t.addEventListener("click",function(){0===t.currentTime&&this.store.get("dataSaverDetected")&&(t.play(),i.VideoControls&&i.VideoControls.setState({isPaused:!1}))}),this.contentInterval=setInterval(function(){var t=i.video.currentTime,s=i.video.duration;e.store.set("contentTime",t),e.store.set("contentDuration",s)},5e3)},this._switchToCanvas=function(t){var e=this;if(this.isCanvas=!0,this.playerOpportunityManager.send(B.default.fallBackCanvas),this._shouldPlayContent()){var i=this,s=function(){i.canvas.destroy(),i.store.set("sncad",!0),i.canvas=!1},n="";t.src?n=t.src:this.options.files.map(function(t){if(!n){if(/\.mpg$/.test(t.url)||/\.mpeg$/.test(t.url))return;n=t.url}}),this.canvas=new y.default(t,{_onPlayerError:s},!0,{position:"absolute",zIndex:102},this.store,this.store.get("repeat"),this.target),this.canvas.on("newVidCreated",this._onNewVidCreated.bind(this)),this.isCanvaMode=!0,setTimeout(function(){t._vidSetAttr("src",""),setTimeout(function(){e.canvas&&(e.canvas.setSrc(n),t.style.display="none",e.handleOnCanPlay())},2e3)},2)}},this.createMediaPlayer=function(){this.store.get("noplrcntr")||(this.target.className+=" vpaid-player-container",this.isMultiVpaidUnit&&A.addClass(this.target,"multi-vpaids"));var e=document.createElement("video");if(this.playerTag=e,e.id=this.generateId(),e.className=this.options.video_class_name,this.isMultiVpaidUnit&&A.addClass(e,"multi-vpaids"),e.style.cssText="position: relative; z-index:99; cursor:pointer; display:block",e.setAttribute("playsinline",""),e.setAttribute("muted",""),this._preventAutoplay||e.setAttribute("autoplay",""),this.isMobile&&this.hasAutoPlay){var i=this.store.get("ua");if("Android"===i.os.name){var s=function(){this.store.get("dataSaver")&&(this.store.set("forcecnvsmpg",!0),this._switchToCanvas(e),this.VideoControls&&this.VideoControls.setCanvas(this.canvas))};this.store.get("dtsvr")?(o.on("dataSaverDetectionFinished",s.bind(this)),V.default.detect(this.store)):this.store.get("dataSaver")?(this.store.set("serverSideDataSaver","on"),s.call(this)):this.store.set("serverSideDataSaver","off")}else"iOS"===i.os.name&&(e.removeAttribute("autoplay",""),e.setAttribute("muted",""),e.muted=!0)}if(this.attachEventsToVideo(e),this.isMultiVpaidUnit)if(this.options.height||this.options.width)if(this.options.height&&this.options.width)e.style.height=this.options.height.search(/px$/g)>-1?this.options.height:this.options.height+"px",e.style.width=this.options.width.search(/px$/g)>-1?this.options.width:this.options.width+"px";else if(this.options.width){var n=this.options.aspect_ratio.split(":")[1]/this.options.aspect_ratio.split(":")[0];e.style.width=this.options.width.search(/px$/g)>-1?this.options.width:parseFloat(this.options.width)+"px",e.style.height=Math.floor(parseFloat(e.style.width)*n)+"px"}else{var r=this.options.aspect_ratio.split(":")[0]/this.options.aspect_ratio.split(":")[1];e.style.height=this.options.height.search(/px$/g)>-1?this.options.height:parseFloat(this.options.height)+"px",e.style.width=Math.floor(parseFloat(e.style.height)*r)+"px"}else this.debugTracker.error("createMediaPlayer","No `height` or `width` specified!");e.muted=!0,e.setAttribute("width",parseFloat(e.style.width)+""),e.setAttribute("height",parseFloat(e.style.height)+""),e.setAttribute("playsinline","");var a=this;setTimeout(function(){try{a.handleOnCanPlay()}catch(t){}},200),this.options.repeat&&(e.playerRepeat=!0),this.options.image&&e.setAttribute("poster",this.options.image);try{if(this._shouldPlayContent())for(var d=0;d<this.options.files.length;d++){var l=this.options.files[d];if(!/\.mpg$/.test(l.url)&&!/\.mpeg$/.test(l.url))if(this.isMobile&&!this.hasAutoPlay)this.playerTag.src=l.url;else{var u=document.createElement("source");u.setAttribute("type",l.type),u.src=l.url,e.name||(e.name=l.name?l.name:l.url),e.appendChild(u)}}}catch(t){this.debugTracker.error("createMediaPlayer","Files array supplied is corrupted or malformed!")}this._shouldPlayContent()&&this.target.appendChild(e),this.video=e,this.store.get("noplrcntr")||(this.target.id="_cm-css-reset"),this.isMobile&&!this.hasAutoPlay?this._switchToCanvas(e):e.volume=this.options.volume/100;var h=!this.isMobile&&(this.options.controls||this.store.get("ad_controls"))||this.isMobile&&this.options.controls;this.store.set("useVideoControls",!0),h&&this._shouldPlayContent()&&this.addVideoControls(),this.volume(this.options.mute?0:this.options.volume),this.setVideoSize(t.width+"px",t.height+"px"),this.VideoControls&&this.VideoControls.setState({playerState:this.playerStatus})},this._shouldPlayContent=function(){return!this.store.get("vForce")||this.store.get("cntonvfrc")},this._onNewVidCreated=function(t){this.video.parentElement.removeChild(this.video),this.video=t,this.canvas=!1,this.VideoControls&&(this.VideoControls.setCanvas(this.canvas),this.VideoControls.setVideo(this.video))},this.addVideoControls=function(){this.VideoControls=new m.default(this.video,this.store,this.target,"content"),this.canvas&&this.VideoControls.setCanvas(this.canvas),this.store.on("videoControlsVolume",this._onVideoControlVolumeChanged.bind(this)),this.store.on("volumeBeforeMuteChanged",this._onVideoControlsVolumeBeforeMuteChanged.bind(this)),this.isMobile||(this.store.on("videoControlsMute",this._onVideoControlMuteChanged.bind(this)),this.store.on("videoControlsPause",this._onVideoControlPauseChanged.bind(this)),this.store.on("videoProgressBar",this._onVideoProgressBarChanged.bind(this)))},this._onVideoControlsVolumeBeforeMuteChanged=function(t){this.options.volumeBeforeMute=t},this._isAdState=function(){return"ad"===this.playerStatus},this._onVideoControlMuteChanged=function(t){this.options.videoControlsForceMute=t,this.store.set("forceMute",t),t?this.mute():this.unMute()},this._onVideoControlVolumeChanged=function(t){this.options.videoControlsForceMute=!1,this.store.set("forceMute",0===t),this.volume(t)},this._onVideoControlPauseChanged=function(t){this.store.set("forcePause",t),t?this.pause():this.video.currentTime===this.video.duration?this.play():this.resume()},this._onVideoProgressBarChanged=function(t){if(!this._isAdState()){var e=Math.floor(t*this.video.duration);this.store.emit("videoProgressBarTransition",this.video.duration,e),this.video.currentTime=e}},this.onVpaidCreated=function(t){this.runningVpaid=t,this.vpaidHandler=t}.bind(this),this.store.on("vpaidHandlerCreated",this.onVpaidCreated),this.ga={sendGaMessage:function(){}};var x=this;if(this.createGA=function(){},this.removeGA=function(){this.ga_set},this.convertPreMidPostToTime=function(t,e){var e=Math.round(e),i={},s=this.options.schedule_auto,n=void 0;if(n=t["pre-roll"].length>0?t["pre-roll"][0]:t["mid-roll"].length>0?t["mid-roll"][0]:t["post-roll"].length>0?t["post-roll"][0]:void 0,void 0==n)return this.debugTracker.error("PreMidPostToTime","Error creating automatic schedule!Pleace check the schedule preset!"),{};i["00:00"]=n;var r=[];t["mid-roll"].length>0?r=t["mid-roll"]:t["post-roll"].length>0?r=t["post-roll"]:r.push(n);var o=void 0;for(o=t["post-roll"].length>0?t["post-roll"][0]:r[0];s<e;){var a=this.secondsToString(s),d=r.shift();r.push(d),s+=this.options.schedule_auto,s>e&&(d=o),i[a]=d}return i},this.createSchedule=function(){if(!this.scheduleCreated&&!this.store.get("vForce")){this.scheduleCreated=!0,this.videoLength=this.video.duration,this.videoLength=this.videoLength||120;var t=this.options.schedule,e={},i=this.options.schedule_auto;0===this.options.schedule_auto&&(this.options.schedule_auto=1);for(var s=0;s<t.length;s++){var n=t[s];if(this.options.schedule_auto)e[n.roll_type]||(e[n.roll_type]=[]),e[n.roll_type].push(n);else for(var r=0;r<n.positions.length;r++)!e[n.positions[r]]&&this.videoLength-this.options.min_vpaid_run_time>this.stringToSeconds(n.positions[r])&&(e[n.positions[r]]=n)}this.options.schedule_auto&&(e["pre-roll"]||(e["pre-roll"]=[]),e["mid-roll"]||(e["mid-roll"]=[]),e["post-roll"]||(e["post-roll"]=[]),e=this.convertPreMidPostToTime(e,this.videoLength)),this.options.schedule_auto=i,this.scheduleMaster.schedule=e,this.store.set("contentSchedule",e),this.scheduleMaster.start()}},this.setVideoFile=function(t,e,i){for(;this.video.childNodes.length;)this.video.removeChild(this.video.childNodes[0]);e?this.video.setAttribute("poster",e):this.video.removeAttribute("poster"),i?(this.status="loading",this._preventAutoplay||this.video.setAttribute("autoplay","true")):this.video.removeAttribute("autoplay");try{this.video.removeAttribute("src");for(var s=0;s<t.length;s++){var n=t[s],r=document.createElement("source");r.setAttribute("type",n.type),r.src=n.url,this.video.name||(this.video.name=n.name?n.name:n.url),this.video.appendChild(r)}this.video.load()}catch(t){this.debugTracker.error("setVideoFile","Error creating video sources!")}},this._onVpaidClosed=function(){},this._pausePlayer=function(){this.scheduleMaster.stop(!0),this.seek(0),this.stop(),this.store.emit("pausePlayer")},this.closePlayer=function(){this._onVpaidClosed=this.closeCleanPlayer.bind(this,"_onVpaidClosed"),this.options.onPlayerClose(this),this.scheduleMaster.stop()},this.closeCleanPlayer=function(t){var e=this;this.store.set("playerClosed",!0),setTimeout(function(){if(t=t||"none",e.store.emit("stop","close:"+t),!e.playerIsClosed){if(clearInterval(e.contentInterval),e.vpaidManager&&e.vpaidManager.stop(),e.VideoControls&&e.VideoControls.destroy(),e.playerIsClosed=!0,e._onVpaidClosed=function(){},e.stop(),e.removeGA(),!e.store.get("noplrcntr"))for(;e.target.childNodes.length;)e.target.removeChild(e.target.childNodes[0]);e.onPlayerReadyActions=e.debugTracker=e.video=e.schedule=e.ova=e.ga=e.scheduleMaster=e.KPIsRecorder=e.VideoControls=void 0,e.options=e.target=void 0}},0)},this.target=this.handleTarget(t.target_id),!this.target||!this.target.appendChild)return void this.debugTracker.error("Constructor","No player target!Can't build player in ["+this.target+"]... aborting!");this.store.set("can_opt_out",this.store.get("can_opt_out")||null!==this.target.parentElement.querySelector("#_cm-opt-out-view")),this.options.htmlVideoSupport?this.createMediaPlayer():(this.debugTracker.error("Constructor","Browser does not support <video> Tag!Nothing to do, aborting..."),this.options.onPlayerLoadError(this)),this.store.get("base_url"),this.set=function(t,e){this.store.set(t,e)},this.get=function(t){return this.store.get(t)},this.on=function(t,e){this.store.on(t,e)},this.off=function(t,e){this.store.removeListener(t,e)},this.getVpaidLogs=function(){return this.vpaidManager?this.vpaidManager.getVpaidLogs():this.scheduleMaster?this.scheduleMaster.getVpaidLogs():void 0},this.startWaterfall=function(){try{this.scheduleMaster.vpaid.waterfallManager.start()}catch(t){return!1}return!0},this.stopWaterfall=function(){try{this.scheduleMaster.vpaid.waterfallManager.stop()}catch(t){return!1}return!0},this.emit=function(t,e){t&&this.store.emit(t,e)};var F=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;F&&setTimeout(function(){x.handleOnCanPlay()},500),this.store.get("vForce")&&this.initVpaidManager(),this.getAd=function(t){if(this.vpaidManager)return this.vpaidManager.getAd(t)},this.startIdleMode=function(){this.store.set("isIdleMode",!0)},this.stopIdleMode=function(){this.store.set("isIdleMode",!1)},this.startWf=function(){this.store.emit("startWf")}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r;var o=i(32),a=n(o),d=i(36),l=n(d),u=i(3),h=n(u),c=i(45),p=i(38),v=n(p),f=i(16),m=n(f),g=i(12),y=n(g),_=i(39),b=n(_),w=i(1),A=s(w),k=i(31),T=n(k),C=i(28),E=n(C),I=i(43),V=n(I),x=i(18),S=n(x),P=i(35),L=n(P),F=i(9),B=n(F),D=i(59),O=n(D),M=i(40),R=(s(M),i(41)),U=(s(R),i(42)),j=(s(U),i(44)),W=n(j),N=i(30),H=n(N);window.OvaMediaPlayer=r},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=i(37),a=s(o),d=i(21),l=s(d),u=function(){function t(){n(this,t),this._stopwatchs=[]}return r(t,[{key:"startSampling",value:function(){var t=new a.default;return this._stopwatchs.push(t),t.start(),this._stopwatchs.length-1}},{key:"stopSampling",value:function(t){this._stopwatchs[t].stop()}},{key:"getDuration",value:function(t){return this._stopwatchs[t].duration()}},{key:"runOneEventLoopSampling",value:function(){var t=this;return new l.default(function(e){var i=t.startSampling();setTimeout(function(){t.stopSampling(i),e(t.getDuration(i))},0)})}},{key:"runEventLoopSampling",value:function(t,e){var i=this;return new l.default(function(s){var n=[],r=0,o=setInterval(function(){r<t?(n.push(i.runOneEventLoopSampling()),r++):(clearInterval(o),l.default.all(n).then(function(t){var e=t.reduce(function(t,e){return Math.max(t,e)},0);s(e)}))},e)})}},{key:"cleanResources",value:function(){this._stopwatchs.length=0}}]),t}();e.default=u},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),n=function(){function t(e){i(this,t),this.store=e,this.baseUrl=this.store.get("base_url"),this.playerVersion=this.store.get("full_player_version"),this.useIframeOnVpaidWrapper=this.store.get("isMobile")&&this.store.get("usifrmonvpdwrpr"),this.deployFolder="/vpaid/vPlayer/player/v",this.filename=this.store.get("plyrcss"),this.css="player"==this.filename?'#_cm-css-reset { height: inherit; width: inherit; direction: ltr; text-align: left; } #_cm-css-reset.vpaid-player-container .vjs-tech { background-color: #000000; } #_cm-css-reset.vpaid-player-container { position: relative; z-index: 99; } #_cm-css-reset.vpaid-player-container video ~ iframe { z-index: 10; position: absolute; left: 0; top: 0; } #_cm-css-reset .vpaid-ad-controls { -webkit-transition: opacity 500ms ease-out; -moz-transition: opacity 500ms ease-out; -o-transition: opacity 500ms ease-out; transition: opacity 500ms ease-out; opacity: 0; } #_cm-css-reset.vpaid-player-container:hover .vpaid-ad-controls { opacity: 1; } #_cm-css-reset.vpaid-player-container .vpaid-ad-controls, #_cm-css-reset.vpaid-player-container .vpaid-ad-pause { height: 30px; right: 0; position: absolute; left: 0px; bottom: 0; z-index: 1001; background-color: rgba(0, 0, 0, 1); border-top: 1px rgba(255, 255, 255, 0.7) solid; } #_cm-css-reset .vpaid-ad-controls.vjs-default-skin .vjs-control { width: 2em; } /* #_cm-css-reset .vpaid-ad-controls.vjs-default-skin .vjs-control:before { line-height: 2; font-size: 16px; }*/ #_cm-css-reset .vpaid-ad-controls.vjs-default-skin .vjs-control.c-paused:before { content: "e001"; } #_cm-css-reset.vpaid-player-container .vpaid-ad-volume-container { height: 30px; width: 60px; position: relative; float: right; margin-right: 10px; top: 0; cursor: pointer; } #_cm-css-reset.vpaid-player-container .vpaid-ad-mute-container { height: 30px; width: 30px; position: relative; float: right; top: 0; cursor: pointer; } #_cm-css-reset.vpaid-player-container .vpaid-ad-volume-track { height: 8px; border: 1px #000000 solid; box-shadow: 0 0 5px 1px rgb(255, 255, 255); position: absolute; z-index: 0; right: 0; top: 11px; left: 0; background: rgba(51, 51, 51, 0.9) } #_cm-css-reset.vpaid-player-container .vpaid-ad-volume-slider { height: 8px; border: 1px #000000 solid; position: absolute; width: 40%; top: 11px; left: 0; background: rgba(183, 234, 187, 0.9); z-index: 1; } /*#_cm-css-reset .mpegcnv::before { content: ""; position: absolute; top: 0; bottom: 0; left: 0; right: 0; z-index: 100; }*/ #_cm-css-reset .tbl-text { font-family: Arial,Helvetica,sans-serif; white-space: nowrap; font-size: 11px; color: #fff; left: 10px; top: 4px; position: absolute; font-weight: bold; z-index: 1001; } #_cm-css-reset .mc-video { z-index: 101; } #_cm-css-reset .vpaid-handler { z-index: 1000; height: 100%; width: 100%; } #_cm-css-reset .speaker { position: absolute; width: 46px; height: 46px; bottom: -3px; right: -5px; z-index: 1001; background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><path class="cls-1" d="M22,27.26a.76.76,0,0,1-.44.69.75.75,0,0,1-.33.07.76.76,0,0,1-.49-.18l-4.19-3.47H14.33a.77.77,0,0,1-.77-.77V20.56a.77.77,0,0,1,.77-.77h2.23l4.19-3.47a.77.77,0,0,1,1.26.59Zm2.94-1.2h-.06a.76.76,0,0,1-.54-.22l-.1-.1a.77.77,0,0,1-.07-1,4.45,4.45,0,0,0-.12-5.46.77.77,0,0,1,.05-1l.1-.1a.75.75,0,0,1,.58-.22.77.77,0,0,1,.56.28,6.13,6.13,0,0,1,.16,7.55.76.76,0,0,1-.56.31Zm3.17,2.37a.77.77,0,0,1-.55.27h0a.77.77,0,0,1-.54-.22l-.1-.1a.77.77,0,0,1,0-1,8.16,8.16,0,0,0-.13-10.67.77.77,0,0,1,0-1l.1-.1a.75.75,0,0,1,.56-.23.77.77,0,0,1,.55.26,9.84,9.84,0,0,1,.16,12.87Zm0,0"/></svg>\'); } #_cm-css-reset .speaker.mute { background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><path class="cls-1" d="M20.22,26.66a.72.72,0,0,1-.41.65.71.71,0,0,1-.31.07.72.72,0,0,1-.46-.17L15.12,24H13a.72.72,0,0,1-.72-.72V20.38a.72.72,0,0,1,.72-.72h2.09L19,16.41a.72.72,0,0,1,1.18.55ZM26,27.76"/><rect class="cls-1" x="26.15" y="16.31" width="2.43" height="11.22" rx="1.22" ry="1.22" transform="translate(62.22 18.06) rotate(135)"/><rect class="cls-1" x="26.15" y="16.31" width="2.43" height="11.22" rx="1.22" ry="1.22" transform="translate(31.23 56.77) rotate(-135)"/></svg>\'); } #_cm-css-reset .hide { display: none } #_cm-css-reset .mc-loud-video{ position:absolute; pointer-events: none; } #_cm-css-reset .mc-loud-video::-webkit-media-controls-panel { display: none!important; -webkit-appearance: none; } /* Old shadow dom for play button */ #_cm-css-reset .mc-loud-video::--webkit-media-controls-play-button { display: none!important; -webkit-appearance: none; } /* New shadow dom for play button */ /* This one works */ #_cm-css-reset .mc-loud-video::-webkit-media-controls-start-playback-button { display: none!important; -webkit-appearance: none; } #_cm-css-reset .mc-loud-video::-webkit-media-controls { display:none !important; } #_cm-css-reset .mc-loud-video::-webkit-media-controls-enclosure { display:none !important; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls.show{ display: block; margin: 0; padding: 0; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls.show *{ position: absolute !important; display: block; margin: 0; padding: 0; background-color: transparent; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls { width: 100%; height: 100%; z-index: 1000; left: 0; bottom: -32px; -webkit-transition: bottom 0.35s ease-in-out; -moz-transition: bottom 0.35s ease-in-out; -o-transition: bottom 0.35s ease-in-out; transition: bottom 0.35s ease-in-out; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .control { z-index: 100; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .interactive { pointer-events: all; cursor: pointer; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls.hide, #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .hide { display: none; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls.show, #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .show { display: block; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .cm_video_controls_progressbar_area { width: 100%; height: 5px; bottom: 0%; cursor: default; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .cm_video_controls_progressbar_area .cm_video_controls_progressbar { height: 100%; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .cm_video_controls_progressbar_area .cm_video_controls_progressbar_bg { width: 100%; height: 100%; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .white_bg { background: rgba(255,255,255,0.3); } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .blue_bg { background: rgba(21,75,145,1); -webkit-transition : width 0.5s ease; -moz-transition : width 0.5s ease; -o-transition : width 0.5s ease; transition : width 0.5s ease; width: 0%; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .blue_bg.init_bg { -webkit-transition : none; -moz-transition : none; -o-transition : none; transition : none; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls { width: 100%; height: 27px; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .cm_video_controls_main_area .play_pause { top: 3px; left: 5px; width: 20px; height: 20px; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .cm_video_controls_main_area .play_pause .pause { width: 40px; height: 27px; top: -7px; left: -8px; background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><rect class="cls-1" x="17.23" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/><rect class="cls-1" x="23.63" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/></svg>\'); background-size: 36px; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .cm_video_controls_main_area .play_pause .play { border-top: 5px solid transparent; border-left: 10px solid #fff; border-bottom: 5px solid transparent; left: 6px; top: 5px; z-index: 102; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .cm_video_controls_main_area .title { top: 7px; left: 30px; width: 140px; text-align: left; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .cm_video_controls_main_area .timer { top: 6px; right: 110px; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .text { color: white; font-size: 13px; font-weight: bold; font-family: Arial,Helvetica,sans-serif; top: 10px; left: 28px; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .text.opt-out-hidden { left: 13px; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls { width: 100%; height: 100%; right: 0px; bottom: 0; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area .cm_video_controls_mute { width: 35px; height: 27px; right: 8px; bottom: 5px; background-size: 44px; box-sizing: content-box; background-position-y: center; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area .cm_video_controls_mute.display_mute { background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><path class="cls-1" d="M20.22,26.66a.72.72,0,0,1-.41.65.71.71,0,0,1-.31.07.72.72,0,0,1-.46-.17L15.12,24H13a.72.72,0,0,1-.72-.72V20.38a.72.72,0,0,1,.72-.72h2.09L19,16.41a.72.72,0,0,1,1.18.55ZM26,27.76"/><rect class="cls-1" x="26.15" y="16.31" width="2.43" height="11.22" rx="1.22" ry="1.22" transform="translate(62.22 18.06) rotate(135)"/><rect class="cls-1" x="26.15" y="16.31" width="2.43" height="11.22" rx="1.22" ry="1.22" transform="translate(31.23 56.77) rotate(-135)"/></svg>\'); } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area .cm_video_controls_mute.display_unmute { background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><path class="cls-1" d="M22,27.26a.76.76,0,0,1-.44.69.75.75,0,0,1-.33.07.76.76,0,0,1-.49-.18l-4.19-3.47H14.33a.77.77,0,0,1-.77-.77V20.56a.77.77,0,0,1,.77-.77h2.23l4.19-3.47a.77.77,0,0,1,1.26.59Zm2.94-1.2h-.06a.76.76,0,0,1-.54-.22l-.1-.1a.77.77,0,0,1-.07-1,4.45,4.45,0,0,0-.12-5.46.77.77,0,0,1,.05-1l.1-.1a.75.75,0,0,1,.58-.22.77.77,0,0,1,.56.28,6.13,6.13,0,0,1,.16,7.55.76.76,0,0,1-.56.31Zm3.17,2.37a.77.77,0,0,1-.55.27h0a.77.77,0,0,1-.54-.22l-.1-.1a.77.77,0,0,1,0-1,8.16,8.16,0,0,0-.13-10.67.77.77,0,0,1,0-1l.1-.1a.75.75,0,0,1,.56-.23.77.77,0,0,1,.55.26,9.84,9.84,0,0,1,.16,12.87Zm0,0"/></svg>\'); } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area .video-controls-scroller-area { width: 80px; height: 100%; right: 5px; top: 0%; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .playerSaveButton { position: absolute; border: 1px solid #fff; border-radius: 9px; width: 50px; height: 24px; top: 20%; left: 0; font-size: 14px; color: #fff; text-align: center; line-height: 24px; cursor: pointer; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls_mobile { width: 100%; height: 100%; top: 0; left: 0; pointer-events: none; z-index: 1001; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area { pointer-events: none; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area .cm_video_controls_playpause.hide { display: none; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area .cm_video_controls_playpause.show { display: block; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area .cm_video_controls_playpause { bottom: 28px; left: 5px; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area .cm_video_controls_playpause .pause { width: 40px; height: 27px; top: -10px; left: -8px; background-image: url(data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><rect class="cls-1" x="17.23" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/><rect class="cls-1" x="23.63" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/></svg>); background-size: 40px; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area .cm_video_controls_playpause .play { border-top: 6px solid transparent; border-left: 10px solid #fff; border-bottom: 6px solid transparent; left: 7px; top: 3px; z-index: 102; } #_cm-css-reset .mc-play { width: 0; height: 0; border-top: 7px solid transparent; border-left: 9px solid #fff; border-bottom: 7px solid transparent; left: 14px; position: absolute; bottom: 10px; z-index: 1001; } #_cm-css-reset .mc-pause { display: block; width: 42px; height: 42px; left: -4px; position: absolute; bottom: -2px; z-index: 1001; background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><rect class="cls-1" x="17.23" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/><rect class="cls-1" x="23.63" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/></svg>\'); } #_cm-css-reset .mc-pause.hide, #_cm-css-reset .mc-play.hide { display: none; } #_cm-css-reset .mc-pause.show, #_cm-css-reset .mc-play.show { display: block; } #_cm-css-reset .mc-canvas { pointer-events: none; } #_cm-css-reset .mc-progressbar_area { width: 100%; height: 5px; bottom: 0%; position: absolute; z-index: 9999; } #_cm-css-reset .mc-progressbar_area .mc-progressbar_bg.white_bg { background: rgba(255,255,255,0.3); width: 100%; height: 100%; } #_cm-css-reset .mc-progressbar_area .mc-progressbar_bg.blue_bg { background: rgba(21,75,145,1); -webkit-transition : width 0.5s ease; -moz-transition : width 0.5s ease; -o-transition : width 0.5s ease; transition : width 0.5s ease; position: absolute; bottom: 0%; height: 100%; } #_cm-css-reset .mc-progressbar_area .mc-progressbar_bg.blue_bg.init_bg { -webkit-transition : none; -moz-transition : none; -o-transition : none; transition : none; } #_cm-css-reset > .multi-vpaids { height: 0px; } #_cm-css-reset *::-webkit-media-controls-panel { display: none!important; -webkit-appearance: none; } /* Old shadow dom for play button */ #_cm-css-reset *::-webkit-media-controls-play-button { display: none!important; -webkit-appearance: none; } /* New shadow dom for play button */ /* This one works! */ #_cm-css-reset *::-webkit-media-controls-start-playback-button { display: none!important; -webkit-appearance: none; } #_cm-css-reset .cm-ad-player { cursor: pointer; position: absolute; left: 0px; top: 0px; z-index: 0; } #_cm-css-reset ._cm-ad-feed-manager ._cm-ad { display: block !important; visibility: hidden !important; } #_cm-css-reset ._cm-ad-choices-player { position: absolute; top: 16px; left: 13px; } #_cm-css-reset ._cm-ad-choices-player-anchor { display: inline-block; opacity: 0.5; vertical-align: middle; }':'#_cm-css-reset .vjs-tech { background-color: #000000; } #_cm-css-reset video ~ iframe { z-index: 10; position: absolute; left: 0; top: 0; } #_cm-css-reset .vpaid-ad-controls { -webkit-transition: opacity 500ms ease-out; -moz-transition: opacity 500ms ease-out; -o-transition: opacity 500ms ease-out; transition: opacity 500ms ease-out; opacity: 0; } #_cm-css-reset:hover .vpaid-ad-controls { opacity: 1; } #_cm-css-reset .vpaid-ad-controls, #_cm-css-reset .vpaid-ad-pause { height: 30px; right: 0; position: absolute; left: 0px; bottom: 0; z-index: 1001; background-color: rgba(0, 0, 0, 1); border-top: 1px rgba(255, 255, 255, 0.7) solid; } #_cm-css-reset .vpaid-ad-controls.vjs-default-skin .vjs-control { width: 2em; } /* #_cm-css-reset .vpaid-ad-controls.vjs-default-skin .vjs-control:before { line-height: 2; font-size: 16px; }*/ #_cm-css-reset .vpaid-ad-controls.vjs-default-skin .vjs-control.c-paused:before { content: "e001"; } #_cm-css-reset .vpaid-ad-volume-container { height: 30px; width: 60px; position: relative; float: right; margin-right: 10px; top: 0; cursor: pointer; } #_cm-css-reset .vpaid-ad-mute-container { height: 30px; width: 30px; position: relative; float: right; top: 0; cursor: pointer; } #_cm-css-reset .vpaid-ad-volume-track { height: 8px; border: 1px #000000 solid; box-shadow: 0 0 5px 1px rgb(255, 255, 255); position: absolute; z-index: 0; right: 0; top: 11px; left: 0; background: rgba(51, 51, 51, 0.9) } #_cm-css-reset .vpaid-ad-volume-slider { height: 8px; border: 1px #000000 solid; position: absolute; width: 40%; top: 11px; left: 0; background: rgba(183, 234, 187, 0.9); z-index: 1; } /*#_cm-css-reset .mpegcnv::before { content: ""; position: absolute; top: 0; bottom: 0; left: 0; right: 0; z-index: 100; }*/ #_cm-css-reset .tbl-text { font-family: Arial,Helvetica,sans-serif; white-space: nowrap; font-size: 11px; color: #fff; left: 10px; top: 4px; position: absolute; font-weight: bold; z-index: 1001; } #_cm-css-reset .mc-video { z-index: 101; } #_cm-css-reset .speaker { position: absolute; width: 46px; height: 46px; bottom: -3px; right: -5px; z-index: 1001; background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><path class="cls-1" d="M22,27.26a.76.76,0,0,1-.44.69.75.75,0,0,1-.33.07.76.76,0,0,1-.49-.18l-4.19-3.47H14.33a.77.77,0,0,1-.77-.77V20.56a.77.77,0,0,1,.77-.77h2.23l4.19-3.47a.77.77,0,0,1,1.26.59Zm2.94-1.2h-.06a.76.76,0,0,1-.54-.22l-.1-.1a.77.77,0,0,1-.07-1,4.45,4.45,0,0,0-.12-5.46.77.77,0,0,1,.05-1l.1-.1a.75.75,0,0,1,.58-.22.77.77,0,0,1,.56.28,6.13,6.13,0,0,1,.16,7.55.76.76,0,0,1-.56.31Zm3.17,2.37a.77.77,0,0,1-.55.27h0a.77.77,0,0,1-.54-.22l-.1-.1a.77.77,0,0,1,0-1,8.16,8.16,0,0,0-.13-10.67.77.77,0,0,1,0-1l.1-.1a.75.75,0,0,1,.56-.23.77.77,0,0,1,.55.26,9.84,9.84,0,0,1,.16,12.87Zm0,0"/></svg>\'); } #_cm-css-reset .speaker.mute { background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><path class="cls-1" d="M20.22,26.66a.72.72,0,0,1-.41.65.71.71,0,0,1-.31.07.72.72,0,0,1-.46-.17L15.12,24H13a.72.72,0,0,1-.72-.72V20.38a.72.72,0,0,1,.72-.72h2.09L19,16.41a.72.72,0,0,1,1.18.55ZM26,27.76"/><rect class="cls-1" x="26.15" y="16.31" width="2.43" height="11.22" rx="1.22" ry="1.22" transform="translate(62.22 18.06) rotate(135)"/><rect class="cls-1" x="26.15" y="16.31" width="2.43" height="11.22" rx="1.22" ry="1.22" transform="translate(31.23 56.77) rotate(-135)"/></svg>\'); } #_cm-css-reset .hide { display: none } #_cm-css-reset .mc-loud-video{ position:absolute; pointer-events: none; } #_cm-css-reset .mc-loud-video::-webkit-media-controls-panel { display: none!important; -webkit-appearance: none; } /* Old shadow dom for play button */ #_cm-css-reset .mc-loud-video::--webkit-media-controls-play-button { display: none!important; -webkit-appearance: none; } /* New shadow dom for play button */ /* This one works */ #_cm-css-reset .mc-loud-video::-webkit-media-controls-start-playback-button { display: none!important; -webkit-appearance: none; } #_cm-css-reset .mc-loud-video::-webkit-media-controls { display:none !important; } #_cm-css-reset .mc-loud-video::-webkit-media-controls-enclosure { display:none !important; } #_cm-css-reset ._cm-video-ad-iframe { border: none; } #_cm-css-reset._cm-video-ad .video_controls.show{ display: block; margin: 0; padding: 0; } #_cm-css-reset._cm-video-ad .video_controls.show *{ position: absolute !important; display: block; margin: 0; padding: 0; background-color: transparent; } #_cm-css-reset._cm-video-ad .video_controls { width: 100%; height: 100%; z-index: 1000; left: 0; bottom: -32px; -webkit-transition: bottom 0.35s ease-in-out; -moz-transition: bottom 0.35s ease-in-out; -o-transition: bottom 0.35s ease-in-out; transition: bottom 0.35s ease-in-out; } #_cm-css-reset._cm-video-ad .video_controls .control { z-index: 100; } #_cm-css-reset._cm-video-ad .video_controls .interactive { pointer-events: all; cursor: pointer; } #_cm-css-reset._cm-video-ad .video_controls.hide, #_cm-css-reset._cm-video-ad .video_controls .hide { display: none; } #_cm-css-reset._cm-video-ad .video_controls.show, #_cm-css-reset._cm-video-ad .video_controls .show { display: block; } #_cm-css-reset._cm-video-ad .video_controls .cm_video_controls_progressbar_area { width: 100%; height: 5px; bottom: 0%; cursor: default; } #_cm-css-reset._cm-video-ad .video_controls .cm_video_controls_progressbar_area .cm_video_controls_progressbar { height: 100%; } #_cm-css-reset._cm-video-ad .video_controls .cm_video_controls_progressbar_area .cm_video_controls_progressbar_bg { width: 100%; height: 100%; } #_cm-css-reset._cm-video-ad .video_controls .white_bg { background: rgba(255,255,255,0.3); } #_cm-css-reset._cm-video-ad .video_controls .blue_bg { background: rgba(21,75,145,1); -webkit-transition : width 0.5s ease; -moz-transition : width 0.5s ease; -o-transition : width 0.5s ease; transition : width 0.5s ease; width: 0%; } #_cm-css-reset._cm-video-ad .video_controls .blue_bg.init_bg { -webkit-transition : none; -moz-transition : none; -o-transition : none; transition : none; } #_cm-css-reset._cm-video-ad .video_controls { width: 100%; height: 27px; } #_cm-css-reset._cm-video-ad .video_controls .cm_video_controls_main_area .play_pause { top: 3px; left: 5px; width: 20px; height: 20px; } #_cm-css-reset._cm-video-ad .video_controls .cm_video_controls_main_area .play_pause .pause { width: 40px; height: 27px; top: -7px; left: -8px; background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><rect class="cls-1" x="17.23" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/><rect class="cls-1" x="23.63" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/></svg>\'); background-size: 36px; } #_cm-css-reset._cm-video-ad .video_controls .cm_video_controls_main_area .play_pause .play { border-top: 5px solid transparent; border-left: 10px solid #fff; border-bottom: 5px solid transparent; left: 6px; top: 5px; z-index: 102; } #_cm-css-reset._cm-video-ad .video_controls .cm_video_controls_main_area .title { top: 7px; left: 30px; width: 140px; text-align: left; } #_cm-css-reset._cm-video-ad .video_controls .cm_video_controls_main_area .timer { top: 6px; right: 110px; } #_cm-css-reset._cm-video-ad .video_controls .text { color: white; font-size: 13px; font-weight: bold; font-family: Arial,Helvetica,sans-serif; top: 10px; left: 28px; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default; } #_cm-css-reset._cm-video-ad .video_controls .text.opt-out-hidden { left: 13px; } #_cm-css-reset._cm-video-ad .video_controls { width: 100%; height: 100%; right: 0px; bottom: 0; } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area .cm_video_controls_mute { width: 35px; height: 27px; right: 8px; bottom: 5px; background-size: 44px; box-sizing: content-box; background-position-y: center; } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area .cm_video_controls_mute.display_mute { background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><path class="cls-1" d="M20.22,26.66a.72.72,0,0,1-.41.65.71.71,0,0,1-.31.07.72.72,0,0,1-.46-.17L15.12,24H13a.72.72,0,0,1-.72-.72V20.38a.72.72,0,0,1,.72-.72h2.09L19,16.41a.72.72,0,0,1,1.18.55ZM26,27.76"/><rect class="cls-1" x="26.15" y="16.31" width="2.43" height="11.22" rx="1.22" ry="1.22" transform="translate(62.22 18.06) rotate(135)"/><rect class="cls-1" x="26.15" y="16.31" width="2.43" height="11.22" rx="1.22" ry="1.22" transform="translate(31.23 56.77) rotate(-135)"/></svg>\'); } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area .cm_video_controls_mute.display_unmute { background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><path class="cls-1" d="M22,27.26a.76.76,0,0,1-.44.69.75.75,0,0,1-.33.07.76.76,0,0,1-.49-.18l-4.19-3.47H14.33a.77.77,0,0,1-.77-.77V20.56a.77.77,0,0,1,.77-.77h2.23l4.19-3.47a.77.77,0,0,1,1.26.59Zm2.94-1.2h-.06a.76.76,0,0,1-.54-.22l-.1-.1a.77.77,0,0,1-.07-1,4.45,4.45,0,0,0-.12-5.46.77.77,0,0,1,.05-1l.1-.1a.75.75,0,0,1,.58-.22.77.77,0,0,1,.56.28,6.13,6.13,0,0,1,.16,7.55.76.76,0,0,1-.56.31Zm3.17,2.37a.77.77,0,0,1-.55.27h0a.77.77,0,0,1-.54-.22l-.1-.1a.77.77,0,0,1,0-1,8.16,8.16,0,0,0-.13-10.67.77.77,0,0,1,0-1l.1-.1a.75.75,0,0,1,.56-.23.77.77,0,0,1,.55.26,9.84,9.84,0,0,1,.16,12.87Zm0,0"/></svg>\'); } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area .video-controls-scroller-area { width: 80px; height: 100%; right: 5px; top: 0%; } #_cm-css-reset._cm-video-ad .playerSaveButton { position: absolute; border: 1px solid #fff; border-radius: 9px; width: 50px; height: 24px; top: 20%; left: 0; font-size: 14px; color: #fff; text-align: center; line-height: 24px; cursor: pointer; } #_cm-css-reset._cm-video-ad .video_controls_mobile { width: 100%; height: 100%; top: 0; left: 0; pointer-events: none; z-index: 1001; } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area { pointer-events: none; } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area .cm_video_controls_playpause.hide { display: none; } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area .cm_video_controls_playpause.show { display: block; } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area .cm_video_controls_playpause { bottom: 28px; left: 5px; } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area .cm_video_controls_playpause .pause { width: 40px; height: 27px; top: -10px; left: -8px; background-image: url(data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><rect class="cls-1" x="17.23" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/><rect class="cls-1" x="23.63" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/></svg>); background-size: 40px; } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area .cm_video_controls_playpause .play { border-top: 6px solid transparent; border-left: 10px solid #fff; border-bottom: 6px solid transparent; left: 7px; top: 3px; z-index: 102; } #_cm-css-reset .mc-play { width: 0; height: 0; border-top: 7px solid transparent; border-left: 9px solid #fff; border-bottom: 7px solid transparent; left: 14px; position: absolute; bottom: 10px; z-index: 1001; } #_cm-css-reset .mc-pause { display: block; width: 42px; height: 42px; left: -4px; position: absolute; bottom: -2px; z-index: 1001; background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><rect class="cls-1" x="17.23" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/><rect class="cls-1" x="23.63" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/></svg>\'); } #_cm-css-reset .mc-pause.hide, #_cm-css-reset .mc-play.hide { display: none; } #_cm-css-reset .mc-pause.show, #_cm-css-reset .mc-play.show { display: block; } #_cm-css-reset .mc-canvas { pointer-events: none; } #_cm-css-reset .mc-progressbar_area { width: 100%; height: 5px; bottom: 0%; position: absolute; z-index: 9999; } #_cm-css-reset .mc-progressbar_area .mc-progressbar_bg.white_bg { background: rgba(255,255,255,0.3); width: 100%; height: 100%; } #_cm-css-reset .mc-progressbar_area .mc-progressbar_bg.blue_bg { background: rgba(21,75,145,1); -webkit-transition : width 0.5s ease; -moz-transition : width 0.5s ease; -o-transition : width 0.5s ease; transition : width 0.5s ease; position: absolute; bottom: 0%; height: 100%; } #_cm-css-reset .mc-progressbar_area .mc-progressbar_bg.blue_bg.init_bg { -webkit-transition : none; -moz-transition : none; -o-transition : none; transition : none; } #_cm-css-reset > .multi-vpaids { height: 0px; } #_cm-css-reset *::-webkit-media-controls-panel { display: none!important; -webkit-appearance: none; } /* Old shadow dom for play button */ #_cm-css-reset *::-webkit-media-controls-play-button { display: none!important; -webkit-appearance: none; } /* New shadow dom for play button */ /* This one works! */ #_cm-css-reset *::-webkit-media-controls-start-playback-button { display: none!important; -webkit-appearance: none; } #_cm-css-reset .cm-ad-player { cursor: pointer; position: absolute; left: 0px; top: 0px; z-index: 0; } #_cm-css-reset ._cm-ad-choices-player { position: absolute; top: 16px; left: 13px; } #_cm-css-reset ._cm-ad-choices-player-anchor { display: inline-block; opacity: 0.5; vertical-align: middle; }',
this.replacedCssMacro=this.css&&this.css.indexOf("_PLAYERCSS_")==-1&&this.css.indexOf("_PLAYERWITHOUTCONTAINERCSS_")==-1,this.playerCssUrl=""+this.baseUrl+this.deployFolder+this.playerVersion+"/assets/"+this.filename+".css"}return s(t,[{key:"loadCSSResources",value:function(t){if(t){var e=null;this.useIframeOnVpaidWrapper&&this.replacedCssMacro?(e=document.createElement("style"),e.type="text/css",e.innerHTML=this.css):(e=document.createElement("link"),e.rel="stylesheet",e.type="text/css",e.href=this.playerCssUrl),t.head.appendChild(e)}}},{key:"loadExternalResource",value:function(t,e){var i=document.createElement("script");i.src=t,i.type="text/javascript",i.async=!0,i.onload=function(t){document.head.removeChild(i),e&&e(t)},document.head.appendChild(i)}}]),t}();e.default=n},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=i(17),a=s(o),d=i(3),l=(s(d),500),u=function(){function t(e,i){n(this,t),this.schedule={},this.parent=e,this.savedTime=-1,this.runningVpaid=!1,this.runningVpaidTagData={},this.runTimeId=0,this.bug_feature=e.options.bug_feature,this.vpaidCount=0,this._firstImpression=!1,this.minTimeBetweenRuns=5e3,this.store=i,this.lastEndedPlayedVpaid=-1e6,this.timeBetweenAds=this.store.get("schedule_auto"),this.store.on("stop",this.stop.bind(this)),this.useNewScheduler=this.store.get("evtbsschdl"),this.useNewScheduler&&(this._bindedLoop2=this._loop2.bind(this),this._bindedOnVpaidReady=this._onVpaidReady.bind(this),this._bindedOnVpaidEnded=this._onVpaidEnded.bind(this),this.loop2Ticker=setInterval(this._bindedLoop2,l))}return r(t,[{key:"stop",value:function(){this.stopped=!0,window.clearTimeout(this.runTimeId),this.runningVpaid&&!this.runningVpaid.finished?(this.runningVpaid.stop(),this.savedTime=-1,this.parent=void 0,this.runningVpaid=void 0,this.schedule=void 0):(this.parent,this.savedTime=-1,this.parent=void 0,this.runningVpaid=void 0,this.schedule=void 0),this.useNewScheduler&&(this.store.removeListener("vpaidReady",this._bindedOnVpaidReady),this.store.removeListener("vpaidEnded",this._bindedOnVpaidEnded),clearInterval(this.loop2Ticker))}},{key:"stopVpaid",value:function(){this.runningVpaid&&!this.runningVpaid.finished&&this.runningVpaid.stop()}},{key:"start",value:function(){window.clearTimeout(this.runTimeId),this.useNewScheduler?(this.vpaidToRun={vpaid:this.schedule["00:00"],time:"00:00"},this.store.on("vpaidReady",this._bindedOnVpaidReady),this.store.on("vpaidEnded",this._bindedOnVpaidEnded),this._bindedLoop2()):this._loop()}},{key:"disable",value:function(){this.isDisabled=!0}},{key:"_onVpaidReady",value:function(t){this._loop2()}},{key:"_onVpaidEnded",value:function(t){t.hadImpression&&(this.lastEndedPlayedVpaid=Date.now()),this._loop2()}},{key:"_loop2",value:function(){if(!this.stopped&&!this.store.get("playerClosed")&&!this.isDisabled&&0===this.store.get("ads_started")){var t=Date.now()-this.lastEndedPlayedVpaid;t>=1e3*this.timeBetweenAds&&this.runVpaid(this.vpaidToRun.vpaid,this.vpaidToRun.time)}}},{key:"_loop",value:function(){if(!this.isDisabled){window.clearTimeout(this.runTimeId);var t=this,e=Math.floor(this.parent.video.currentTime);if(this._isContentPaused()&&(e=NaN),1===this.timeBetweenAds||e!=this.savedTime&&!isNaN(e)&&"repeating"!=this.parent.status){this.savedTime>e&&(this.savedTime=-1);var i=(new Date).getTime();if(i-this.lastRun<this.minTimeBetweenRuns)return void(t.runTimeId=window.setTimeout(function(){t._loop()},1e3));isNaN(this.savedTime)&&(this.savedTime=0);var s=this.savedTime+1;s>e&&(s=e);for(var n={vpaid:!1,time:0};s<=e;){var r=this.parent.secondsToString(s);this.schedule[r]&&(n.vpaid=this.schedule[r],n.time=r),s++}if(n.vpaid){window.lastRun=Date.now();var o=this.runVpaid(n.vpaid,n.time);o&&(this.lastRun=i)}this.savedTime=e}t.runTimeId=window.setTimeout(function(e){t._loop()},700)}}},{key:"_isContentPaused",value:function(){return this.parent.canvas?"PAUSED"===this.parent.canvas.status:this.parent.video&&this.parent.video.paused}},{key:"runVpaid",value:function(t,e){return this.runningVpaidTagData=t,this.vpaidCount++,t.vpaidCount=this.vpaidCount,this.runningVpaid?this.runningVpaid.run():(this.runningVpaid=new a.default({isFirstImpression:this.isFirstImpression,vpaidTag:t,uid:e,parent:this.parent,isPreRoll:"00:00"===e&&0===this.vpaidCount},this.parent.options,this.store),!0)}},{key:"_checkFirstImpression",value:function(){var t=!this._firstImpression;return this._firstImpression=!0,t}},{key:"getTagData",value:function(){return!!this.gotVpaid&&this.runningVpaidTagData}},{key:"getVpaidLogs",value:function(){if(this.runningVpaid)return this.runningVpaid.getVpaidLogs()}},{key:"isFirstImpression",get:function(){return this._checkFirstImpression.bind(this)}},{key:"tagVolume",set:function(t){this.runningVpaidTagData.volume=t}},{key:"vpaid",get:function(){return this.gotVpaid?this.runningVpaid.vpaid:{}}},{key:"gotVpaid",get:function(){return!(!this.runningVpaid||this.runningVpaid.finished||!this.runningVpaid.vpaidCreated)}}]),t}();e.default=u},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),n=function(){function t(){i(this,t),this._startTime=0,this._stopTime=0,this._now=window.performance?window.performance.now.bind(window.performance):Date.now.bind(Date)}return s(t,[{key:"now",value:function(){return parseInt(this._now())}},{key:"start",value:function(){this._startTime=this.now()}},{key:"stop",value:function(){this._stopTime=this.now()}},{key:"reset",value:function(){this._stopTime=this._startTime=0}},{key:"duration",value:function(){if(this._startTime&&this._stopTime)return this._stopTime-this._startTime;throw"You did not use the stopwatch as expected!"}}]),t}();e.default=n},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),d=i(11),l=i(1),u=s(l),h=function(t){function e(t){n(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));i._maxListeners=100,i.data={},Object.assign(i.data,t);var s="9.4.5";i.data.full_player_version=s,s=s.replace(/\./g,""),s=parseInt(s),i.data.debugLevels=t.debug?t.debug:"",i.data.debug=t.debug.indexOf("*")!=-1,i.data.player_version=s;var o="",a="",d="";try{a=t.unit_name,o=t.abTest,d=t.unit_main_version}catch(t){}return i.data.ab_test=o,i.data.unit_type=a,i.data.unit_version=d,i.data.session_started=Date.now(),window.cmTag&&window.cmTag.config&&window.cmTag.config.contentClickUrl&&(i.data.contentClickUrl=window.cmTag.config.contentClickUrl),i.set("ua",u.parseUserAgent()),i}return o(e,t),a(e,[{key:"incr",value:function(t){c.exists(t,this.data)||c.set(t,0,this.data);var e=c.get(t,!0,this.data)||0;if("number"==typeof e)return c.set(t,e+1,this.data),c.get(t,!1,this.data)}},{key:"decr",value:function(t){var e=c.get(t,!1,this.data);if("number"==typeof e)return c.set(t,e-1,this.data),c.get(t,!1,this.data)}},{key:"get",value:function(t){return t=t.toString(),t.indexOf(".")===-1?this.data[t]:c.get(t,!1,this.data)}},{key:"getByAdvId",value:function(t,e){var i=this.get("dsm")||{};return i&&i.hasOwnProperty(e)&&i[e].hasOwnProperty(t)?i[e][t]:this.get(t,!1,this.data)}},{key:"getByLineItem",value:function(t,e){var i=this.get("dsm")||{},s=e?e.lineItem:"";return i&&i.hasOwnProperty(s)&&i[s].hasOwnProperty(t)?i[s][t]:this.getByCampaignId(t,e)}},{key:"getByTech",value:function(t,e){var i=this.get("dsm")||{};return i&&i.hasOwnProperty(e)&&i[e].hasOwnProperty(t)?i[e][t]:null}},{key:"getByCampaignId",value:function(t,e){var i=this.get("dsm")||{},s=e?e.campaignId:"";return i&&i.hasOwnProperty(s)&&i[s].hasOwnProperty(t)?i[s][t]:this.getByAdvId(t,e?e.advId:"")}},{key:"getLatestVersion",value:function(t){t=t.toString();var e=t+"_latest",i=this.get(e);if(void 0!==i)return i;var s=new RegExp(t+"[v]*\\d+$"),n={value:void 0,version:0};for(var r in this.data)if(s.exec(r)){var o=parseInt(r.match(/\d+$/)[0]);(!n.value||n.version<o)&&this.data[r]&&(n.version=o,n.value=this.data[r])}else 0===n.version&&r===t&&(n.value=this.data[r]);return this.set(e,n),n}},{key:"set",value:function(t,e){t=t.toString(),c.set(t,e,this.data)}},{key:"getWfData",value:function(){var t=this.get("dsm")||{},e=[];for(var i in t)/^\d+$/.test(i)&&t[i]&&t[i].hasOwnProperty("ftchVst")&&e.push({id:i,fv:t[i].ftchVst});return e}}]),e}(d.EventEmitter);e.default=h;var c=function(){var t=function(t,e,i){for(var s,n=i||data,r=0;n&&(s=t[r]);r++)n=s in n?n[s]:e?n[s]={}:void 0;return n};return{set:function(e,i,s){var n=e.split("."),r=n.pop(),o=t(n,!0,s);return o&&r?o[r]=i:void 0},get:function(e,i,s){return t(e.split("."),i,s)},exists:function(t,e){return void 0!==this.get(t,!1,e)}}}()},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=i(17),a=s(o),d=0,l=function(){function t(e,i){n(this,t),this.store=e,this.parent=i,this.initVpaid(),this.hadFirstImpression=!1}return r(t,[{key:"initVpaid",value:function(){var t=this.getVpaidTag(),e={"00:00":t,"00:01":t};this.store.set("contentSchedule",e),this.store.set("autoplay_on_pre_roll",!1),this.vpaidHandler=new a.default({isFirstImpression:this.isFirstImpression,vpaidTag:t,uid:d++,parent:this.parent},this.parent.options,this.store),this.vpaidHandler.runWaterfall("vforceInit")}},{key:"getVpaidTag",value:function(){var t=this.store.get("schedule"),e={};return t.forEach(function(t){t&&"pre-roll"===t.roll_type&&(e=t)}),e}},{key:"isFirstImpression",value:function(){return!this.hadFirstImpression&&(this.hadFirstImpression=!0,!0)}},{key:"getVpaidLogs",value:function(){if(this.vpaidHandler)return this.vpaidHandler.getVpaidLogs()}},{key:"getAd",value:function(t){return this.vpaidHandler.getAd(t)}},{key:"stop",value:function(){this.vpaidHandler&&!this.vpaidHandler.finished?this.vpaidHandler.stop():this.parent&&this.parent._onVpaidClosed(),this.vpaidHandler=void 0,this.schedule=void 0,this.parent=void 0,this.savedTime=-1}},{key:"pause",value:function(){this.vpaidHandler.pause()}},{key:"resume",value:function(){this.vpaidHandler.resume()}},{key:"volume",value:function(t){this.vpaidHandler.volume(t)}},{key:"mute",value:function(){this.volume(0)}},{key:"unmute",value:function(t){this.volume(t)}},{key:"resize",value:function(t,e,i){this.vpaidHandler.resize(t,e,i)}}]),t}();e.default=l},function(t,e){"use strict";var i=i||{};i.dSettings={203745:{fkadchcs:!0},203735:{adto:999999999,fkadchcs:!0},203391:{pxlnotsmtp:!0},1544895:{ad_controls:!1},1699035:{cstmdl:14,vpdcss:{".cm_video_controls_mute":{right:"3px",bottom:"25px"}}},1731795:{cstmdl:14,vpdcss:{".cm_video_controls_mute":{right:"3px",bottom:"25px"}}},1727795:{cstmdl:14,vpdcss:{".cm_video_controls_mute":{right:"3px",bottom:"25px"}}},1725135:{cstmdl:14,vpdcss:{".cm_video_controls_mute":{right:"3px",bottom:"25px"}}},204595:{fkadchcs:!0},202697:{fkadchcs:!0},1746345:{cmpltonstpd:!0},1746335:{cmpltonstpd:!0},1749845:{cmpltonstpd:!0},1749835:{cmpltonstpd:!0},1775385:{adddsttotvpaid:!0},1848995:{global_ad_timeout:24e4},8062425:{global_ad_timeout:999999999}},window.TRC&&(window.TRC.dsm=window.TRC.dsm||{},window.TRC.dsm[147]=i.dSettings)},function(t,e){"use strict";var i='function startProtection(){window.ReportHijackAttempt=window.ReportHijackAttempt||function(){};var t=new RegExp(["tags.bkrtx.com","lipikar_bodycare_awareness","gacdn","mirra.io","brtmedia","UA-57084257-7","coin-hive.com","bundle.clearstream.tv",".clrstm.com","video.leadzu.com",".leadzu.com","s0.2mdn.net/ads/richmedia/studio/pv2/60128696/","advertisingstory.com","mediagroupads.com","elitelmediaadvertising.com","vertamedia.com","mediagrouppro.com","highratedads.com","videogrammic.com","marketingvideonow.com","static.marketingvideonow.com","files.webvideoglobal.com","webvideoglobal.com","webmediaapp.com","files.webmediaapp.com","popovideoad.com","sb.voicefive.com","one.m4dc.com"].join("|"),"i"),e="//convusmp.basebanner.com/st?cijs=0&ttype=5&pix=51591248&dast=&";function o(e){return t.test(e)}function r(t,o){(new Image).src=e+(new Date).getTime(),window.ReportHijackAttempt(t,o)}function i(t){if(t.src)return t.src;if(t.childNodes.length)for(var e=0;e<t.childNodes.length;e++)if(t.childNodes[e]&&t.childNodes[e].src)return t.childNodes[e].src;return t.outerHTML}try{!function(){for(var t=document.scripts||[],e=0;e<t.length;e++)t[e].src&&o(t[e].src);var i=document.querySelectorAll("iframe")||[];for(e=0;e<i.length;e++)if(o(i[e].src)){r(i[e].src,!0);break}}(),HTMLIFrameElement.prototype.hasOwnProperty("_src")||(Object.defineProperty(HTMLIFrameElement.prototype,"_src",Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,"src")),Object.defineProperty(HTMLIFrameElement.prototype,"src",{get:function(){return this._src},set:function(t){o(t)?r(t,!1):this._src=t}})),HTMLIFrameElement.prototype._setAttribute=HTMLIFrameElement.prototype.setAttribute,HTMLIFrameElement.prototype.setAttribute=function(t,e){"src"==t.toLowerCase()&&o(e)?r(e,!1):this._setAttribute(t,e)},HTMLElement.prototype._insertBefore=HTMLElement.prototype.insertBefore,HTMLElement.prototype.insertBefore=function(t,e){if(!o(t.outerHTML))return this._insertBefore(t,e);r(i(t),!1)},HTMLElement.prototype._appendChild=HTMLElement.prototype.appendChild,HTMLElement.prototype.appendChild=function(t){if(!o(t.outerHTML))return this._appendChild(t);r(i(t),!1)},HTMLScriptElement.prototype.hasOwnProperty("_src")||(Object.defineProperty(HTMLScriptElement.prototype,"_src",Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype,"src")),Object.defineProperty(HTMLScriptElement.prototype,"src",{get:function(){return this._src},set:function(t){o(t)?r(t,!1):this._src=t}})),HTMLScriptElement.prototype._setAttribute=HTMLScriptElement.prototype.setAttribute,HTMLScriptElement.prototype.setAttribute=function(t,e){"src"==t.toLowerCase()&&o(e)?r(e,!1):this._setAttribute(t,e)},HTMLObjectElement.prototype._scrollIntoView=HTMLObjectElement.prototype.scrollIntoView,HTMLObjectElement.prototype.scrollIntoView=function(){return!1},HTMLDivElement.prototype._scrollIntoView=HTMLDivElement.prototype.scrollIntoView,HTMLDivElement.prototype.scrollIntoView=function(){return!1},XMLHttpRequest.prototype._open=XMLHttpRequest.prototype.open,XMLHttpRequest.prototype.open=function(t,e,i,n,c){o(e)?r(e,!1):this._open.apply(this,arguments)}}catch(t){}}startProtection();';try{HijackResponse(i)}catch(t){}window.TRC&&(window.TRC.hjk=window.TRC.hjk||{},window.TRC.hjk[213]=i)},function(t,e){"use strict";var i="!function(){if((window.ignoreGetVpaidAd||'function'==typeof window.getVPAIDAd)&&function(){try{return window.self!==window.top}catch(t){return!0}}()){function t(){for(var t=document.scripts||[],e=[],i=0;i<t.length;i++)e.push(t[i].src);return e}function e(){for(var t=document.querySelectorAll('iframe'),e=[],i=0;i<t.length;i++)e.push(t[i].src);return e}function i(i,r,o){var n=window._vaThis||this;if(window._vaThis){var s=t(),a=e();n.scripts=n.scripts.concat(s),n.iframes=n.iframes.concat(a),n.firstCount+=a.length+s.length}else n.data={},n.XHRUrls=[],n.XHRResponses=[],n.iframes=e(),n.scripts=t(),n.firstCount=n.iframes.length+n.scripts.length,n.timeoutLength=o.timeout||3e3,n.callback=r,n.adImpressionEvent='AdImpression',n.networkCallCounter=0,n.maxNetworkCalls=o.maxNetworkCalls||!1,n.networkCallsLimitExceeded=!1,n.latencies=[],n.iframesWeights={gen:8,ggl:4,pxls:2},n.isVideoUrlPublic=void 0,n.requestId=0,n.requestStartTimes={},Object.defineProperty(n,'AnalyticsData',{get:function(){return n.data},enumerable:!0,configurable:!1}),i&&n.subscribeToAdImpression(i);if(o&&(o.withXHR&&window.XMLHttpRequest&&this.createXMLHTTPHook(),o.withIframes&&void 0!==window.HTMLIFrameElement&&this.createIframesSrcHook(o),o.withScripts&&void 0!==window.HTMLScriptElement&&this.createScriptsSrcHook(),o.timeout&&(n.timeoutLength=o.timeout),o.iframesWeights))for(var c in o.iframesWeights)n.iframesWeights[c]=o.iframesWeights[c];window.destroyAnalyticsReporter=function(){n.data=n.XHRUrls=n.XHRResponses=n.iframes=n.scripts=n.timeoutLength=n.iframesWeights=n.requestStartTimes=void 0,window.getVpaidAnalyticsReport=window.destroyAnalyticsReporter=window.onNetworkCallsLimitExceeded=window.setIsVideoUrlPublic=void 0,window.AnalyticsReporter=void 0},window.getVpaidAnalyticsReport=function(){var e=window._vaThis||this,i=[],r={scripts:e.scripts.length>0?e.scripts.slice():t(),XHRUrls:e.XHRUrls.slice(),iframes:e.iframes.slice()};for(var o in r)i=i.concat(r[o]);r.totalRequests=i,r.totalRequestsCounter=i.length,r.firstCount=e.firstCount,r.latencies=e.latencies.slice();var n=r.latencies.reduce(function(t,e){return t+e},0);return r.averageLatency=r.latencies.length?n/r.latencies.length:0,r.averageIntLatency=parseInt(r.averageLatency),r}.bind(n),window.setIsVideoUrlPublic=function(t){(window._vaThis||this).isVideoUrlPublic=t}.bind(n)}i.prototype.subscribeToAdImpression=function(t){var e=window._vaThis||this;t.subscribe(function(){e.adImpFired=!0,setTimeout(function(){e.sendData()},e.timeoutLength)},e.adImpressionEvent,e)},i.prototype.sendData=function(){var t=window._vaThis||this;t.collectData(t.adImpressionEvent),t.callback(t.adImpressionEvent,t.AnalyticsData)},i.prototype.collectData=function(e){var i=window._vaThis||this,r={};r.eventName=e,r.scripts=i.scripts.length>0?i.scripts.slice():t(),r.XHRUrls=i.XHRUrls.slice(),r.XHRResponses=i.XHRResponses.slice(),r.iframes=i.iframes.slice(),i.data[e]=r},i.prototype.onUrlHooked=function(t,e,i){var r=window._vaThis||this;r[t].push(e),i._id=r.requestId++,r.requestStartTimes[i._id]=Date.now();var o=function(){r.requestStartTimes.hasOwnProperty(this._id)&&(r.latencies.push(Date.now()-r.requestStartTimes[this._id]),delete r.requestStartTimes[this._id]),this.removeEventListener('load',o)}.bind(i);i.addEventListener('load',o),'iframes'!==t||void 0===r.isVideoUrlPublic?r.networkCallCounter++:r.networkCallCounter+=r.getIframeWeight(e),r.isMaxNetworkCallsLimitExceeded()&&r.onNetworkCallsLimitExceeded()},i.prototype.getIframeWeight=function(t){var e=window._vaThis||this;return t.indexOf('imasdk')?e.iframesWeights.ggl:e.isVideoUrlPublic?e.iframesWeights.pxls:e.iframesWeights.gen},i.prototype.createXMLHTTPHook=function(){var t=window._vaThis||this;window.XMLHttpRequest.prototype._vaOpen=window.XMLHttpRequest.prototype.open,window.XMLHttpRequest.prototype.open=function(e,i,r,o,n){return t.onUrlHooked('XHRUrls',i,this),this.addEventListener('load',function(){t.XHRResponses.push('load: '+this.responseText)}),window.XMLHttpRequest.prototype._vaOpen.apply(this,arguments)}},i.prototype.createIframesSrcHook=function(t){var e=window._vaThis||this;Object.defineProperty(HTMLIFrameElement.prototype,'_vaSrc',Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,'src'));var i=function(i,r){if(e.onUrlHooked('iframes',i,r),t.deepIframes){var o=function(){try{r.removeEventListener('load',o),r.contentWindow.ignoreGetVpaidAd=!0,r.contentWindow._vaThis=e,r.contentWindow.eval(e.vpaidAnalyticsFunc),new r.contentWindow.AnalyticsReporter(null,function(){},t)}catch(t){}};r.addEventListener('load',o)}};Object.defineProperty(HTMLIFrameElement.prototype,'src',{get:function(){return this._vaSrc},set:function(t){i(t,this),this._vaSrc=t}}),HTMLIFrameElement.prototype._vaSetAttribute=HTMLIFrameElement.prototype.setAttribute,HTMLIFrameElement.prototype.setAttribute=function(t,e){'src'===t&&i(e,this),this._vaSetAttribute(t,e)}},i.prototype.createScriptsSrcHook=function(){var t=window._vaThis||this;Object.defineProperty(HTMLScriptElement.prototype,'_vaSrc',Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype,'src')),Object.defineProperty(HTMLScriptElement.prototype,'src',{get:function(){return this._vaSrc},set:function(e){t.onUrlHooked('scripts',e,this),this._vaSrc=e}}),HTMLScriptElement.prototype._vaSetAttribute=HTMLScriptElement.prototype.setAttribute,HTMLScriptElement.prototype.setAttribute=function(e,i){'src'===e&&t.onUrlHooked('scripts',i,this),this._vaSetAttribute(e,i)}},i.prototype.unHook=function(){var t=Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,'_vaSrc'),e=Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype,'_vaSrc');t&&(Object.defineProperty(HTMLIFrameElement.prototype,'src',t),HTMLIFrameElement.prototype.setAttribute=HTMLIFrameElement.prototype._vaSetAttribute),e&&(Object.defineProperty(HTMLIFrameElement.prototype,'src',e),HTMLScriptElement.prototype.setAttribute=HTMLScriptElement.prototype._vaSetAttribute),window.XMLHttpRequest.prototype._vaOpen&&(window.XMLHttpRequest.prototype.open=window.XMLHttpRequest.prototype._vaOpen)},i.prototype.onNetworkCallsLimitExceeded=function(){var t=window._vaThis||this;t.networkCallsLimitExceeded||(t.adImpFired||t.unHook(),t.networkCallsLimitExceeded=!0,t.sendData(),window.onNetworkCallsLimitExceeded())},i.prototype.isMaxNetworkCallsLimitExceeded=function(){var t=window._vaThis||this;return t.networkCallsLimitExceeded||t.maxNetworkCalls&&t.networkCallCounter>=t.maxNetworkCalls},window.AnalyticsReporter=i}}();";try{VpaidAnalytics(i)}catch(t){}window.TRC&&(window.TRC.vpaidAnalytics=window.TRC.vpaidAnalytics||{},window.TRC.vpaidAnalytics[25]=i)},function(t,e){"use strict";function i(t){var e=t.get("dtsvrurl"),i=new XMLHttpRequest;i.open("GET",e,!0),i.onreadystatechange=function(){if(i.readyState==XMLHttpRequest.DONE){var e=i.responseText,n={};try{n=JSON.parse(e)}catch(t){}s(n,t)}},i.send(null)}function s(t,e){var i=!!t.dataSaver;e&&(e.set(n,i),e.set("clientSideDataSaver",i),e.emit("dataSaverDetectionFinished"))}var n="dataSaver";t.exports={detect:i}},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=i(50),a=s(o),d=function(){function t(e){n(this,t),this.ServiceLoader=i(24),this.ServiceLoader.init(e.data),this.store=e}return r(t,[{key:"get",value:function(t,e,i,s,n){var r=this;this.ServiceLoader.get(t,e,function(t){r.store.get(i)||r.store.set(i,t)},function(){r.store.get("JSONPHandler")||(r.JSONPHandler=new a.default(r.store.get("base_url"))),r.JSONPHandler.load(s,n,function(t){r.store.get(i)||r.store.set(i,t)})})}},{key:"getDynamicSettings",value:function(){var t=this,e=this.store.get("dsu"),i=e.match(/(?:\/vpaid\/ds\/)(.*)\//);if(i&&2===i.length){var s=i[1];this.ServiceLoader.get("dsm",s,function(e){t.store.set("dsm",e)},function(){var e=t.store.get("base_url"),i=e+t.store.get("dsu");t.getScript(i,function(){t.store.set("dsm",cmTag.dSettings)})})}}},{key:"getScript",value:function(t,e){var i=document.createElement("script"),s=document.getElementsByTagName("script")[0];i.src=t,s.parentNode.insertBefore(i,s),i.onload=function(){e()}}}]),t}();e.default=d},function(t,e){"use strict";function i(t){var e={domain:window.location.hostname,cirf:"",referrer:document.referrer?document.referrer.split("//")[1]:window.location.hostname,vertical:"default",auc_dast:"0",title:"",description:"",keywords:"",default_ad_parameters:"",files:[],image:!1,target_id:"",height:!1,width:!1,controls:!0,aspect_ratio:"16:9",repeat:!0,mute:!1,oid:0,default_ad_timeout:30,volume:0,video_class_name:"video-js vjs-default-skin",schedule:[],schedule_auto:1,min_vpaid_run_time:4,debug:[],htmlVideoSupport:function(){return!!document.createElement("video").canPlayType}(),ga_factor:1,fire99:!0,ad_controls:!1,time_between_waterfall:10,tmbtwfs:function(t,e,i,s){return i.get("time_between_waterfall")},mntmbtwfsf:function(t,e,i,s){return i.get("mintimwf")},mintimwf:5e3,mntmbtwfs:5,mxtmbtwfs:900,queue_size:6,max_ready_vpaid:3,waterfall_watermark:0,base_url:"//vidstat.taboola.com",wf_path:"VideoBidRequestHandlerServlet",run_wf_when_empty:!0,kill_after_hour:0,kaxwnc:18e5,pstflrs:!0,pvpd:"javascript",pvidtp:"",sncad:!1,blkflshjs:!0,vjshndlrlgcy:!1,altmot:6e4,adimptmot:0,prtctv2:"/vpaid/hjk.184.js",hjkclb:"HijackResponse",jsnoflshdtct:!1,qsrtscr:function(t,e){return 100*e.alfrox},psthdrs:"text/plain",rstmrai:!0,vstprxy:!1,pxyurl:"http://vid.mikysrv.com/fetch?url=",global_ad_timeout:18e4,mprdct:void 0,uscnvsmpg:!0,forcecnvsmpg:!1,gtvid2:"//mpg.taboola.com/getts?url",cnvsldrt:5,mpgclrslv:["gcdn.2mdn.net"],dsu:"/vpaid/ds/117/dsm.js",run_wf_on_init:!0,useapforcntnt:!1,wf_dynmc_ps:!0,sprssviderr:!1,vForce:!1,get_ad_timeout_seconds:10,wf_manual:!1,disctxt:"By Taboola",httpsOverride:!1,usscrtgurl:!1,evtbsschdl:!0,timbtopps:2e3,cmbopps:!0,anltcsurlv4:"",anltcsurlv5:"",anltcsclb:"VpaidAnalytics",anltcsOptions:{withXHR:!0,withIframes:!0,withScripts:!0,maxNetworkCalls:0,timeout:3e3,deepIframes:!0,hideCountdown:!0},moat:!1,measureKPI:!1,prfsmpmsnt:5,prfsmitrvpmsnt:1500,kpitrvldrt:15e3,msrkpifctr:0,msrkpiintvl:15,moatPartnerCode:"taboolajsvideo2446883476",sndvltopp:!0,novdtrm:!1,dcdvdurl:!1,firstWaterfallNoaop:0,mxlifls:0,kbnul:"//vidanalytics.taboola.com",frcmtfrms:!0,frcvlm:!1,pxlnotsmtp:!1,cntonvfrc:!0,mxemptwf:0,dtsvrurl:"//vidutils.taboola.com",dtsvr:!1,mltads:!1,erlyai:!1,frcadvlmtrvl:1e3,dbncadvltm:50,stpfrcvlevnt:"AdVideoFirstQuartile",imapihok:!1,trmrdyvpaid:!0,dfltvlm:.4,usstrckisyn:!1,dlywf:!1,adto:3e5,vakll:3e5,ovrtgbydc:!1,strgprvdrttl:6048e5,frstlk:!1,pusvidprtctn:!1,encwfrs:!1,dsktmouttoadcmpltn:0,mbltmouttoadcmpltn:0,loadrsrc:!1,sptxadossrc:"//js.spotx.tv/directsdk/v1/{{chnl}}.js",wfv:1,aderrbfradlddopactv:!1,isMultiVpaidUnit:!1,vtrtlon:!1,hdeadsplypusbtn:!0,isIdleMode:!1,bfrmd:!1,mttst:"",mxntwrkclls:0,rplvpdactv:!1,rvfctr:0,dnapmxvl:0,usopsla:!1,opslavrsn:"1.0.7",mcrsrvcsnmspc:"trc",bllblevt:"",ifrmswghts:{gen:15,ggl:6,pxls:30},dskVidMuted:!1,ovrdnonntvfnclst:{},fkadchcs:!1,istblvpd:!1,usifrmonvpdwrpr:!1,mtdhkactv:!1,addprld:!1,blckbrngtofrnt:!1,tglifrmcntndsplyactv:!1,cmpltonstpddmn:["innovid.com"],syncmthds:!1,cmpltonstpdms:0,aduntldflbfruntld:!1,adwrprstoplrdst:!0,bckflldlyms:5e3,mxbckflldlyitms:0,bfprty:0,lgvpdtxtelmnts:!1,shwadmtebtn:!0,wtfradpsdbfrrsmad:!1,pstnnaggops:!1,mtfctr:0,noplrcntr:!1,plyrcss:"player",vpdcntrcstmcss:"",dsbgl:!1,cntdwnrgx:"",msnifrmsrchk:!0,prvaupl:!1,onPlayerReady:function(t){},onPlayerLoadError:function(t){},onPlayerError:function(t){},onPlayerPlay:function(t){},onPlayerStop:function(t){},onPlayerClose:function(t){},onPlayerPause:function(t){},onPlayerResume:function(t){},onPlayerSeek:function(t){},onPlayerRepeat:function(t){},onPlayerComplete:function(t){},onAdLoadError:function(t,e){},onAdError:function(t,e){},onAdStopped:function(t,e){},onAdImpression:function(t,e){},onAdVideoStart:function(t,e){},onAdVideoEnd:function(t,e){},onAdClick:function(t,e,i){}};for(var i in e)void 0==t[i]&&(t[i]=e[i]);t.description||(t.description=t.title),t.keywords||(t.keywords=t.title),parseFloat(t.width)||parseFloat(t.height)||(t.width="377",t.height="314");var s=parseInt(100*Math.random())+1<=t.ron_percent;return t.tagDefault={ad_controls:t.ad_controls,url:"",pubid:"",tagid:"",vidlength:"",video_url:t.files[0],title:t.title,cirf:t.cirf,description:t.description,keywords:t.keywords,ad_parameters:t.default_ad_parameters,muted:t.mute?1:0,auc_dast:t.auc_dast,referrer:t.referrer,domain:t.domain,vertical:t.vertical,roll_type:"mid-roll",oid:t.oid,ad_timeout:t.default_ad_timeout,rs:"1",st:"1",sts:"1",type:"wf",noaop:"10",sortOrderType:0,mfp:4,afbp:t.use_flash_bypass,isRon:s,isvideo:0,mindur:1,maxdur:t.default_ad_timeout,minbr:1,maxbr:1e4,plmd:0,defaultTagTimeout:30,totaltimeout:60,use_as_is:!1,skip_vast:!1},t}function s(){var t={};try{t=window.cmTag.config}catch(t){return{}}var e={};for(var i in t)if(0===i.indexOf("player.settings.")){var s=i.substr(16,i.length-16);e[s]=n(t[i])}return e}function n(t){var e=/^\d+$/.test(t);if(e)return parseInt(t);var i=/^true$|^false$/g.test(t);return i?"true"===t||t===!0:t}Object.defineProperty(e,"__esModule",{value:!0}),e.getDefaults=i,e.getUnitParams=s},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=i(6),d=s(a),l=i(8),u=(s(l),i(54)),h=s(u),c=i(3),p=s(c),v=i(65),f=s(v),m=i(4),g=s(m),y=i(48),_=s(y),b=i(24),w=(i(104),0),A=function(){function t(e,i,s){n(this,t),this.vpaidHandler=i,this.store=s,this.vpaidCount=1,this.version="VPAID-1.0.0",this.VPAIDversion="1.1",this.debugTracker=new p.default(this.version),this.beacon=new d.default(this),this.vpaidParameters=this._defaultVpaidParameters,this.config=this._defaultVpaidConfig;var r={};this._createIframesDetector(),this.store.get("mltads")&&this.store.on("resizeVpaidWrapper",this._onResizeAd.bind(this));for(var o in e)r[o.toUpperCase()]=e[o];this.config.creatives=Object.assign({},this._defaultVpaidParameters,r),this.store.get("cmbopps")&&this.store.get("usopsla")&&this._loadOppsula(),this.manager=!1,this._initWaterfall();for(var a in this.vpaidEvents)this.beacon.addEventListener(this.vpaidEvents[a],this._runEventFunction.bind(this));this.beacon.dispatchEvent(this.vpaidEvents.AdLoaded,""),this.store.emit("mainVpaidCreated",this.config)}return o(t,[{key:"_createIframesDetector",value:function(){this.store.set("iframesDetector",new _.default(this.store.get("ifrmswghts")))}},{key:"setVpaidId",value:function(t){this.version="["+t.wfIndex+"_"+t.dp+"]"}},{key:"_loadOppsula",value:function(){var t=this;b.init(this.store.data),b.get("oppsula",this.store.get("opslavrsn"),function(e){t.store.set("ms_data",{opps_base_path:t.store.get("opps_base_path")||t.config.creatives.CM_DOMAIN});var i=new e(t.store.get("unit_model"),t.store);t.store.set("oppsula",i),t.store.emit("oppsulaCreated",i);
},function(){t.debugTracker.error("Load Oppsula","Error while loading from service loader")})}},{key:"_onResizeAd",value:function(t){this.config&&(this.config.width=t.width,this.config.height=t.height)}},{key:"trigger",value:function(t,e){this.vpaidHandler.emit(t,e)}},{key:"runWaterfall",value:function(t){this.waterfallManager.runWaterfall(t)}},{key:"getVpaidReadyCount",value:function(){return this.manager.getVpaidReadyCount()}},{key:"_initWaterfall",value:function(){this.waterfallManager=new f.default(this.store),this.config.creativeData=this._getCreativeData(this.config),this.waterfallManager.init(this.config.creatives,this.config.creativeData.AdParameters),this.waterfallManager.SetWaterfallError(this._waterfallError.bind(this)),this.waterfallManager.SetWaterfallSuccess(this._waterfallSuccess.bind(this));var t=this;this.waterfallManager.SetShouldRun(function(){var e=this.store.get("max_ready_vpaid")||2,i=this.store.get("waterfall_watermark")||0;return!t.manager||t.manager.getVpaidReadyCount()+i<e})}},{key:"_getSlot",value:function(t){var e=!1;switch("undefined"==typeof t?"undefined":r(t)){case"string":document.getElementById(t)&&(e=document.getElementById(t));break;case"object":t.style&&t.tagName&&(e=t);break;default:this.debugTracker.error("initAd","Bad slot in 'environmentVars'")}return e}},{key:"_getCreativeData",value:function(t){var e=!1;switch("undefined"==typeof t?"undefined":r(t)){case"object":Object.keys(t).length>0&&(e=!0);break;case"string":if(t.length>0)try{t=new Function("return "+t+";")(),e=!0}catch(t){}}if(e){for(var i in this.config.creatives)(void 0==t[i]||this.config.protectedCreatives.indexOf(i)>-1)&&(t[i]=this.config.creatives[i]);t.AdParameters&&(t.AdParameters=this._handleAdParams(t.AdParameters))}return t}},{key:"_handleAdParams",value:function(t){var e={};switch("undefined"==typeof t?"undefined":r(t)){case"object":Object.keys(t).length>0&&(e=t);break;case"string":if(t.length>0)try{e=new Function("return "+t+";")()}catch(t){}}return e}},{key:"_dataFromUrl",value:function(t){var e=t.replace(/\?\?+/g,"?").replace(/&&+/g,"&").split(/\?(.+)?/gi,2);if(2!=e.length)return this.debugTracker.warn("dataFromUrl","Bad source parameter!"),this.vpaidParameters;var i=e[1].split(/\?|&/gi);for(var s in i)if(i[s]){var n=i[s].split(/=(.+)?/gi,2);if(2==n.length){var r=n[0].replace(/\-/gi,"_").toUpperCase();if(void 0!=this.vpaidParameters[r])switch(r){case"ISVIDEO":case"PLMD":case"MINDUR":case"MAXDUR":case"MINBR":case"MAXBR":case"VPD":case"VPTD":case"RS":case"ST":case"PLAYER_WIDTH":case"PLAYER_HEIGHT":case"PUBID":case"STS":case"MFP":case"ADTO":case"B2B":case"VMT":case"SORTORDERTYPE":case"TAGID":case"VIDLENGTH":case"DEFAULTTAGTIMEOUT":case"TOTALTIMEOUT":this.vpaidParameters[r]=isNaN(parseInt(n[1]))?0:parseInt(n[1]);break;case"MUTED":case"AFBP":case"DEBUG":case"PAUSE_ON_START":switch(n[1]){case"1":case"true":case"TRUE":this.vpaidParameters[r]=!0;break;case"0":case"false":case"FALSE":this.vpaidParameters[r]=!1}break;case"WP":case"SERVICE":case"PV":case"PT":case"SDID":break;default:this.vpaidParameters[r]=n[1]}else this.debugTracker.warn("dataFromUrl","Parameter '"+n[0]+"' is not supported!")}}return this.vpaidParameters}},{key:"_runEventFunction",value:function(t){this["on"+t.type]&&this["on"+t.type](t)}},{key:"_waterfallError",value:function(t){w||(w=!0)}},{key:"_waterfallSuccess",value:function(t,e){this.manager&&(this.config.waterfall=t,this.manager.fillSchedule(t,e))}},{key:"_onManagerStopped",value:function(){this.beacon.dispatchEvent(this.vpaidEvents.AdStopped)}},{key:"getTime",value:function(){var t=new Date;return t.getTime()}},{key:"initAd",value:function(t,e,i,s,n,r){this.config.inited||(this.config.target=this._getSlot(r.slot),this.config.target&&(this.config.videoSlotControls=this.store.get("ad_controls"),this.config.videoSlotCanAutoPlay=!0,this.config.width=parseInt(t),this.config.height=parseInt(e),this.config.bitrate=s,this.config.viewMode=i,this.config.creatives.PLAYER_WIDTH=this.config.width,this.config.creatives.PLAYER_HEIGHT=this.config.height,this.config.creativeData=this._getCreativeData(n),this.config.inited=!0,this.manager||(this.manager=new h.default(this,this.store)),this.manager.onStop=this._onManagerStopped.bind(this),this.beacon.dispatchEvent(this.vpaidEvents.AdLoaded,"")))}},{key:"subscribe",value:function(t,e){return this.beacon?void(this.vpaidEvents[e]&&this.beacon.addEventListener(e,t)):void this.debugTracker.error("subscribe"," Null ConvertVpaidMain::Beacon ")}},{key:"unsubscribe",value:function(t,e){if(this.vpaidEvents[e]){if(void 0==t)return;this.beacon.removeEventListener(e,t)}}},{key:"handshakeVersion",value:function(t){return this.VPAIDversion}},{key:"startAd",value:function(t){this.manager.playFromQueue(t),this.config.started=!0}},{key:"fire99",value:function(t,e){this.manager&&this.manager.fire99({waterfallTagId:t,dast:e})}},{key:"resizeAd",value:function(t,e,i){this.config.width=t,this.config.height=e,this.config.viewMode=i,this.manager&&this.manager.resizeAd(t,e,i)}},{key:"stopAd",value:function(){this.manager?this.manager.stop():this.beacon.dispatchEvent(this.vpaidEvents.AdStopped)}},{key:"setAdVolume",value:function(t){if(!this.store.get("isMobile"))return t=t>1?t/100:t,!isNaN(parseFloat(t))&&void(this.manager&&!this.store.get("isMobile")&&this.manager.setAdVolume(t))}},{key:"getAdVolume",value:function(){return this.manager?this.manager.callWorkingVpaid("getAdVolume",[],0):0}},{key:"getAdLinear",value:function(){return!this.manager||this.manager.callWorkingVpaid("getAdLinear",[],!0)}},{key:"getAdWidth",value:function(){return this.manager?this.manager.callWorkingVpaid("getAdWidth",[],this.config.width):this.config.width}},{key:"getAdHeight",value:function(){return this.manager?this.manager.callWorkingVpaid("getAdHeight",[],this.config.height):this.config.height}},{key:"getAdExpanded",value:function(){return!this.manager||this.manager.callWorkingVpaid("getAdExpanded",[],!0)}},{key:"getAdSkippableState",value:function(){return!!this.manager&&this.manager.callWorkingVpaid("getAdSkippableState",[],!1)}},{key:"getAdSkippableRemainingTime",value:function(){return this.manager?this.manager.callWorkingVpaid("getAdSkippableRemainingTime",[],-1):-1}},{key:"getAdRemainingTime",value:function(){return this.manager?this.manager.callWorkingVpaid("getAdRemainingTime",[],-1):-1}},{key:"getAdDuration",value:function(){return this.manager?this.manager.callWorkingVpaid("getAdDuration",[],-1):-1}},{key:"getAdCompanions",value:function(){return this.manager?this.manager.callWorkingVpaid("getAdCompanions",[],[]):[]}},{key:"getAdIcons",value:function(){return this.manager?this.manager.callWorkingVpaid("getAdIcons",[],[]):[]}},{key:"pauseAd",value:function(){this.manager&&this.manager.callWorkingVpaid("pauseAd",[],!0)}},{key:"resumeAd",value:function(){this.manager&&this.manager.callWorkingVpaid("resumeAd",[],!0)}},{key:"expandAd",value:function(){this.manager&&this.manager.callWorkingVpaid("expandAd",[],!0)}},{key:"collapseAd",value:function(){this.manager&&this.manager.callWorkingVpaid("collapseAd",[],!0)}},{key:"skipAd",value:function(){this.manager&&this.manager.callWorkingVpaid("skipAd",[],!0)}},{key:"getVpaidLogs",value:function(){if(this.manager)return this.manager.getVpaidLogs()}},{key:"getAd",value:function(t){if(this.manager)return this.manager.getAd(t)}},{key:"onAdLoaded",value:function(){}},{key:"onAdStarted",value:function(){}},{key:"onAdStopped",value:function(){}},{key:"onAdSkipped",value:function(){}},{key:"onAdSkippableStateChange",value:function(){}},{key:"onAdSizeChange",value:function(){}},{key:"onAdLinearChange",value:function(){}},{key:"onAdDurationChange",value:function(){}},{key:"onAdExpandedChange",value:function(){}},{key:"onAdVolumeChange",value:function(){}},{key:"onAdImpression",value:function(){}},{key:"onAdVideoStart",value:function(){}},{key:"onAdVideoFirstQuartile",value:function(){}},{key:"onAdVideoMidpoint",value:function(){}},{key:"onAdVideoThirdQuartile",value:function(){}},{key:"onAdVideoComplete",value:function(){}},{key:"onAdClickThru",value:function(){}},{key:"onAdInteraction",value:function(){}},{key:"onAdUserAcceptInvitation",value:function(){}},{key:"onAdUserMinimize",value:function(){}},{key:"onAdUserClose",value:function(){}},{key:"onAdPaused",value:function(){}},{key:"onAdPlaying",value:function(){}},{key:"onAdLog",value:function(){}},{key:"onAdError",value:function(){}},{key:"onVpaidSpecial",value:function(){}},{key:"onSonudViolation",value:function(){}},{key:"vpaidEvents",set:function(t){},get:function(){return g.default}},{key:"_defaultVpaidParameters",set:function(t){},get:function(){return{VIEW_MODE:"normal",REFERRER:"",VIDEO_URL:"",DOMAIN:"",PUBID:0,TAGID:0,VPD:0,VPTD:0,AUC_DAST:"",VIDLENGTH:0,KEY_WORDS:"",DESCRIPTION:"",SERVICE:"WhiteLabelBidRequestHandlerServlet",VERTICAL:"",SCHEMA:"vast2-vpaid",TYPE:"application/javascript",PV:this.version,RS:1,ST:1,WP:1,PT:5,CIRF:"",SDID:1,STS:0,CB:"",VOLUME:0,TAG:"",PAGE_URL:"",TIME_STAMP:"",TITLE:"",MFP:4,ISVIDEO:1,PLMD:2,MINDUR:1,MAXDUR:60,MINBR:1,MAXBR:512,AFBP:!1,ADTO:60,B2B:1,VMT:0,SORTORDERTYPE:0,DEFAULTTAGTIMEOUT:30,OID:"",NOAOP:"",TOTALTIMEOUT:60,CM_DOMAIN:"http://exchange.basebanner.com",OFFSET:0,MODE:"paralel",MUTED:!1,DEBUG:!1,PAUSE_ON_START:!1,PLAYER_WIDTH:0,PLAYER_HEIGHT:0}}},{key:"_defaultVpaidConfig",set:function(t){},get:function(){return{waterfall:{},source:this.src,videoSlotCanAutoPlay:!0,videoSlotControls:!1,vpaid_protect_path:!1,running:!1,inited:!1,stopped:!1,started:!1,target:!1,video:!1,bitrate:512,creatives:{},protectedCreatives:["WP","PV","PT","SDID","CM_DOMAIN","SERVICE"]}}}]),t}();e.default=A},function(t,e){"use strict";t.exports={tags:7,dCPM:9,CPCV:14}},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),n=function(){function t(e){i(this,t),this.iframesWeights=e}return s(t,[{key:"detect",value:function(t,e){var i=this,s={};return t.map(function(t){var n=i._detectIframeTypeFromUrl(t,e);s[n]=s[n]||{urls:[],counter:0},s[n].urls.push(t),s[n].counter++}),s}},{key:"_detectIframeTypeFromUrl",value:function(t,e){return t.indexOf("imasdk")>-1?"ggl":e?"pxls":"gen"}},{key:"calculateWeightsByIframeType",value:function(t){var e=0;for(var i in t)e+=this.iframesWeights[i]*t[i].counter;return e}}]),t}();e.default=n},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=i(1),a=s(o),d=function(){function t(e,i,s){n(this,t),this.iframe=e,this.channel=void 0,this.sid=void 0,this.store=i,this.vpaidLog=s,this.protocol=this.store.get("httpsOverride")?"https:":window.location.protocol||"http:",a.logToBI(this.vpaidLog,"imaapi_ctor",{event:"ctor"})}return r(t,[{key:"listenToMessages",value:function(){this.iframe.contentWindow.addEventListener("message",this.onmessage.bind(this))}},{key:"removeMessagesListener",value:function(){this.iframe.contentWindow.removeEventListener("message",this.onmessage.bind(this))}},{key:"onmessage",value:function(t){if(t){var e={};try{e=JSON.parse(t.data.replace("ima://",""))}catch(e){return void a.logToBI(this.vpaidLog,"imaapi_message_ex",{ex:e,msg:t})}"viewabilityMeasurement"!==e.type&&(void 0!==e.channel&&void 0===this.channel&&(this.channel=e.channel),void 0!==e.sid&&"*"!==e.sid&&void 0===this.sid&&(this.sid=e.sid),a.logToBI(this.vpaidLog,"imaapi_message",{data:e})),void 0!==this.channel&&void 0!==this.sid&&this.removeMessagesListener()}}},{key:"callApi",value:function(t,e){if(this.channel&&this.sid&&this.iframe){var i={name:"adsManager",type:t.replace("Ad",""),sid:this.sid,channel:this.channel};"volume"==t&&(i.data={volume:e}),a.logToBI(this.vpaidLog,"imaapi_postmessage",{msg:i}),this.iframe.contentWindow.eval("\n                    var ifrms = document.querySelectorAll('iframe');\n\n                    ifrms.forEach(ifrm => {\n                        if (ifrm.src.indexOf('imasdk.googleapis.com') > -1 && ifrm.src.indexOf('bridge') > -1 && (ifrm.src.indexOf('#"+this.sid+"') > -1 || ifrm.src.indexOf('#"+this.channel+"') > -1)) {\n                            ifrm.contentWindow.postMessage('ima://"+a.stringify(i)+"', '"+this.protocol+"//imasdk.googleapis.com');\n                        }\n                    });\n                ")}}}]),t}();e.default=d},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),n=function(){function t(e){i(this,t),this.baseUrl=e}return s(t,[{key:"load",value:function(t,e,i){t&&t.length&&window.cmTag&&(this._setWindowLoaderObject(),this._registerOnLoaderResponse(e),this._loadScript(t,e,i))}},{key:"_setWindowLoaderObject",value:function(){window.cmTag.cmLoader||(window.cmTag.cmLoader={addLoaderCb:function(t,e){window.cmTag.cmLoader[t]=window.cmTag.cmLoader[t]||{callbacks:[]},window.cmTag.cmLoader[t].callbacks.push(e)}})}},{key:"_registerOnLoaderResponse",value:function(t){window[t]||(window[t]=function(e){window.cmTag.cmLoader[t].callbacks.map(function(t){try{t(e)}catch(t){}})})}},{key:"_loadScript",value:function(t,e,i){window.cmTag.cmLoader.addLoaderCb(e,i);var s=document.createElement("script");s.src=this.baseUrl+t,document.body.appendChild(s)}}]),t}();e.default=n},function(t,i,s){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),d=s(3),l=r(d),u=s(4),h=r(u),c=s(1),p=n(c),v=function(){function t(e,i,s){o(this,t),this.vpaidLog=i,this.store=s,this.type="vpaid",this.stopped=!1,this.version="1.1",this.target=e.slot,this.video=e.videoSlot,this.mediaFiles=e.vpaidFiles,this.videoSlotControls=e.videoSlotControls,this.videoSlotCanAutoPlay=e.videoSlotCanAutoPlay,this.debugTracker=new l.default("JsVpaid");var n=this.store.get("prtct");this.baseUrl=this.store.get("base_url"),this._VpaidProtection=this.baseUrl+n,this._onReady=e.onReady,this._onError=e.onError,this.vpaidEvents=Object.assign({},h.default),this.iframe=this._createIframe(),this.VPAID={},this.mediaUrl}return a(t,[{key:"_onIframeWindowError",value:function(t){this.debugTracker.warn("IframeError",t);var e=this.store.get("debug");return!e}},{key:"_createIframe",value:function(){if(!this.stopped){var t=document.createElement("iframe");if(t.style.display="none",this.target.parentNode)this.target.appendChild(t);else{var e=document.getElementsByTagName("body")[0]||document.getElementsByTagName("div")[0];e.appendChild(t)}return t.onload=this._onIframeLoaded.bind(this,t),t.contentWindow.document.open(),t.contentWindow.document.write("<html><head>"+(this._VpaidProtection?"<script type='text/javascript' src='"+this._VpaidProtection+"'></script>":"")+"</head><body></body></html>"),t.contentWindow.document.close(),t}}},{key:"_onIframeLoaded",value:function(t,e){if(!this.stopped){this.debugTracker.info("Loading","Iframe was loaded!");var i=t.contentWindow;i.ReportHijackAttempt=this._onHijackAttempt;var s=this.store.get("dlgverr")||!1;s&&(i.onerror=this._onIframeWindowError.bind(this));var n=i.document.createElement("script");n.onerror=this._onVpaidLoadError.bind(this),this.mediaUrl=this.mediaFiles[0].url,n.src=this.mediaUrl,n.onload=this._onVpaidLoadSuccess.bind(this,t),i.document.body.appendChild(n)}}},{key:"_onVpaidLoadError",value:function(t){this.debugTracker.error("ErrorLoadingVpaid",t),this.stopped||this._onError(this,t)}},{key:"_onVpaidLoadSuccess",value:function(t,i){if(!this.stopped)try{var s=t.contentWindow;this.VPAID=s.getVPAIDAd(),this._onReady(this)}catch(t){p.logToBI(this.vpaidLog,"initJsError",{err:e.message}),this._onVpaidLoadError(t)}}},{key:"_safeCall",value:function(t,e){if(!this.stopped)try{return this.VPAID[t].apply(this.VPAID,e)}catch(t){return p.logToBI(this.vpaidLog,"jsCallError",{err:t.message}),this._onAdError(t),!1}}},{key:"restartAd",value:function(){this.video.currentTime=0,this.video.play()}},{key:"handshakeVersion",value:function(t){return this._safeCall("handshakeVersion",[t])}},{key:"resizeAd",value:function(t,e,i){this.target.style.width=t+"px",this.target.style.height=e+"px",this.target.setAttribute("width",t),this.target.setAttribute("height",e),this._safeCall("resizeAd",[t,e,i])}},{key:"initAd",value:function(t,e,i,s,n,r){this._safeCall("initAd",[t,e,i,s,n,r])}},{key:"stopAd",value:function(){this._safeCall("stopAd",[]),window.setTimeout(this._stopAd.bind(this),1)}},{key:"_stopAd",value:function(){this.stopped||(this.iframe&&this.iframe.parentNode.removeChild(this.iframe),this.iframe=this.VPAID=this.mediaFiles=this.video=this.vpaidEvents=this.target=this.debugTracker=void 0,this.vpaidLog=null,this.stopped=!0,this.onAfterStop())}},{key:"pauseAd",value:function(){this._safeCall("pauseAd",[])}},{key:"resumeAd",value:function(){this._safeCall("resumeAd",[])}},{key:"skipAd",value:function(){this._safeCall("skipAd",[])}},{key:"startAd",value:function(){this._safeCall("startAd",[])}},{key:"expandAd",value:function(){this._safeCall("expandAd",[])}},{key:"collapseAd",value:function(){this._safeCall("collapseAd",[])}},{key:"setAdVolume",value:function(t){this._safeCall("setAdVolume",[t])}},{key:"getAdWidth",value:function(){return this._safeCall("getAdWidth",[])}},{key:"getAdHeight",value:function(){return this._safeCall("getAdWidth",[])}},{key:"getAdSkippableRemainingTime",value:function(){return this._safeCall("getAdSkippableRemainingTime",[])}},{key:"getAdRemainingTime",value:function(){return this._safeCall("getAdRemainingTime",[])}},{key:"getAdDuration",value:function(){return this._safeCall("getAdDuration",[])}},{key:"getAdSkippableState",value:function(){return this._safeCall("getAdSkippableState",[])}},{key:"getAdVolume",value:function(t){return this._safeCall("getAdVolume",[t])}},{key:"getAdIcons",value:function(){return this._safeCall("getAdIcons",[])}},{key:"getAdCompanions",value:function(){return this._safeCall("getAdCompanions",[])}},{key:"getAdExpanded",value:function(){return this._safeCall("getAdExpanded",[])}},{key:"getAdLinear",value:function(){return this._safeCall("getAdLinear",[])}},{key:"subscribe",value:function(t,e){this.vpaidEvents[e]&&(e==this.vpaidEvents.AdError&&(this._onAdError=t),e==this.vpaidEvents.HijackAttempt?this._onHijackAttempt=t:this._safeCall("subscribe",[t,e],!0))}},{key:"unsubscribe",value:function(t,e){if(this.vpaidEvents[e]){if(void 0==t)return;this._safeCall("unsubscribe",[t,e],!0)}}},{key:"onAfterStop",value:function(){}},{key:"_onAdError",value:function(){}},{key:"_onHijackAttempt",value:function(){}},{key:"_getMediaUrl",value:function(){return this.mediaUrl}}]),t}();i.default=v},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=i(3),d=n(a),l=i(4),u=n(l),h=i(6),c=n(h),p=i(1),v=s(p),f=i(49),m=n(f),g=i(14),y=function(){function t(e,i,s){var n=this;r(this,t),this.vpaidLog=i,this.store=s,this.type="vpaid",this.stopped=!1,this.version="1.1",this.target=e.slot,this.video=e.videoSlot,this.mediaFiles=e.vpaidFiles,this.mediaUrl,this.videoSlotControls=e.videoSlotControls,this.videoSlotCanAutoPlay=e.videoSlotCanAutoPlay,this.debugTracker=new d.default("JsVpaid"),this.baseUrl=this.store.get("base_url"),this._onReady=e.onReady,this._onError=e.onError,this.vpaidEvents=Object.assign({},u.default),this.beacon=new c.default(this),this.volume=0,this.isMuted=!0,this.callIMAApi=void 0,this.pauseVideoProtectionDuration=500,this.registerAnalyticsToVpaidLog=e.extra.registerAnalyticsToVpaidLog,this.analyticsRegistered=!1,this.adLoaded=!1,this.playerDAST=e.playerDAST,this.logVpaidTextElements=this.store.get("lgvpdtxtelmnts"),this.countdownRegex=this.store.get("cntdwnrgx"),this.countdownRegex&&(this.countdownRegex=new RegExp(this.countdownRegex,"ig")),setTimeout(function(){n._onReady()},2)}return o(t,[{key:"_safeCall",value:function(t,e){if(!this.stopped&&this.adUnit)try{return this.adUnit[t].apply(this.adUnit,e)}catch(e){return v.logToBI(this.vpaidLog,"initJsError",{err:e.message,funcName:t,stack:e.stack}),this._onAdError(e),!1}}},{key:"restartAd",value:function(t,e){if(v.logToBI(this.vpaidLog,"restartAd",{videoRestarted:!0,isStopped:this.stopped}),!this.stopped)if(this.clickThruUrl=e,""===this._getVideoSrc(this.video)){if(!t)return void v.logToBI(this.vpaidLog,"restartAd",{videoUrlReplaced:!1});v.logToBI(this.vpaidLog,"restartAd",{videoUrlReplaced:!0}),this.video.src=t,this._bindedOnRestartVideoLoad=this._onRestartVideoLoad.bind(this),this.video.addEventListener("canplay",this._bindedOnRestartVideoLoad),this.video.load()}else this._onRestartVideoLoad()}},{key:"_onRestartVideoLoad",value:function(){var t=this;this.adRestarted=!0,this._bindedOnRestartVideoLoad&&(this.video.removeEventListener("canplay",this._bindedOnRestartVideoLoad),this._bindedOnRestartVideoLoad=void 0),this.video.currentTime=0,this._resizeVideotoParentSize(),this.video.play();var e=function(){v.logToBI(t.vpaidLog,"restartAd",{videoClicked:!0,url:t.clickThruUrl}),t.beacon.dispatchEvent(t.vpaidEvents.AdClickThru,{url:t.clickThruUrl,playerHandles:!0})},i=function i(){v.logToBI(t.vpaidLog,"restartAd",{videoComplete:!0}),t.video.removeEventListener("ended",i),t.video.removeEventListener("click",e),t._allEventsHandler(t.vpaidEvents.AdVideoComplete,{})};this.video.addEventListener("ended",i),this.video.addEventListener("click",e)}},{key:"isReplayable",value:function(){return this.video&&""!==this._getVideoSrc(this.video)}},{key:"_resizeVideotoParentSize",value:function(){this.video.style.width=this.target.style.width,this.video.style.height=this.target.style.height}},{key:"handshakeVersion",value:function(t){return"2.0"}},{key:"resizeAd",value:function(t,e,i){this.target.style.width=t+"px",this.target.style.height=e+"px",this.target.setAttribute("width",t),this.target.setAttribute("height",e),this._safeCall("resizeAd",[t,e,i])}},{key:"initAd",value:function(t,e,i,s,n,r){function o(s,r){function o(s,o){r.initAd(t,e,i,-1,n,{})}if(!l.stopped){if(s)return v.logToBI(l.vpaidLog,"loadVPAIDJSScript",{scriptLoadedError:!0}),void(l.store&&l.store.get("aduntldflbfruntld")&&!l.adUnit?l._onError(s,"adUnitLoadFailed"):l._onError());v.logToBI(l.vpaidLog,"loadVPAIDJSScript",{scriptLoaded:!0}),l.adUnit=r,l.store.get("imapihok")&&(l.imaApi=new m.default(l.adUnit._iframe,l.store,l.vpaidLog),l.imaApi.listenToMessages(),l.callIMAApi=l.imaApi.callApi.bind(l.imaApi)),l._bindIframe(r),l._bindAdUnitEvents(r),r.handshakeVersion("2.0",o);var a=l.store.get("cmpltonstpddmn");a&&a.length>0&&l.mediaUrl.search(new RegExp(a.join("|"),"i"))!=-1&&(l.completeOnAdStop=!0)}}var a=this.mediaFiles[0];if(this.playerDAST.set({vbr:a.bitrate,vwd:a.width,vht:a.height,ot:a.originalType,st:a.subType}),this.mediaUrl=a.url,!this.stopped){this.debugTracker.info("Loading","Iframe was loaded!");var d=new g(this.target,this.video,{},null,this.store);this.vpaid=d,d.loadAdUnit(this.mediaUrl,o);var l=this}}},{key:"checkUnfriendlyIframe",value:function(){var t=v.getDeepestIframe(this.target),e="";try{return t&&t.contentDocument,!1}catch(i){return e=t.src,v.logToBI(this.vpaidLog,"unfriendlyIframe",{src:e}),!0}}},{key:"_bindIframe",value:function(t){var e=t._iframe;this.analyticsRegistered=this.registerAnalyticsToVpaidLog(e),this.store.get("hjkFuncString")?(e.contentWindow.ReportHijackAttempt=this._onHijackAttempt,e.contentWindow.eval(this.store.get("hjkFuncString"))):v.logToBI(this.vpaidLog,"missingHjk",{});var i=this.store.get("debug");i||(e.contentWindow.onerror=function(){return!0},v._suppressConsoleMethods(e.contentWindow.console)),this._soundProtection(this.video),this.store.get("blkflshjs")||!1,this._blockDOMObjectInWin(e.contentWindow)}},{key:"_bindAdUnitEvents",value:function(t){var e=this;for(var i in this.vpaidEvents)!function(i){t.subscribe(i,function(t){e._allEventsHandler(i,t)})}(i)}},{key:"_blockDOMObjectInWin",value:function(t){var e=this.store.get("jsnoflshdtct"),i="window.navigator.__defineGetter__('plugins', function () { return []; });",s='\n        \n\n        Object.defineProperty(\n            HTMLObjectElement.prototype,\n            "_data",\n            Object.getOwnPropertyDescriptor(\n                HTMLObjectElement.prototype,\n                "data"\n            )\n        );\n\n        Object.defineProperty(\n            HTMLObjectElement.prototype,\n            "data", {\n                set : function(val){\n                    console.log(\'HTMLObjectElement block\');\n                    return;\n                }\n            }\n        );';e&&(s=i+s);try{t.eval(s)}catch(t){console.log(t)}}},{key:"_soundProtection",value:function(t){var e=this;t.addEventListener("volumechange",function(){e.adLoaded&&e.isMuted&&0!=t.volume&&e.beacon.dispatchEvent(e.vpaidEvents.SoundViolation,{vol:t.volume}),t.volume!==e.volume&&(v.logToBI(this.vpaidLog,"soundProtection",{selfSound:e.volume,videoSound:t.volume}),t.volume=e.volume)})}},{key:"_allEventsHandler",value:function(t,e){if(!this.stopped){if("AdImpression"===t){var i=this.video.src;i&&v.logToBI(this.vpaidLog,"videoUrl",{url:i})}t===this.vpaidEvents.AdStopped&&(this.completionOnAdStoppedTimeout=clearTimeout(this.completionOnAdStoppedTimeout)),"AdLoaded"===t&&(this.adLoaded=!0),this.beacon.dispatchEvent(t,e)}}},{key:"stopAd",value:function(){this._safeCall("stopAd",[]),window.setTimeout(this._stopAd.bind(this),1)}},{key:"_stopAd",value:function(){if(this.adUnit){if(this.adUnit._iframe&&this.adUnit._iframe.contentWindow&&(this.adUnit._iframe.contentWindow.ReportHijackAttempt=null,this.analyticsRegistered))try{this.adUnit._iframe.contentWindow.destroyAnalyticsReporter&&(this.adUnit._iframe.contentWindow.destroyAnalyticsReporter(),v.logToBI(this.vpaidLog,"vpaidAnalyticsDestroy",{success:!0}))}catch(t){v.logToBI(this.vpaidLog,"vpaidAnalyticsDestroy",{success:!1,ex:t})}this.adUnit._destroy()}this.completionOnAdStoppedTimeout=clearTimeout(this.completionOnAdStoppedTimeout),this.iframe=this.vpaid=this.imaApi=this.callIMAApi=this.adUnit=this.mediaFiles=this.video=this.vpaidEvents=this.target=this.debugTracker=this.registerAnalyticsToVpaidLog=void 0,this.vpaidLog=null,this.store=void 0,this.stopped=!0,this.onAfterStop()}},{key:"pauseAd",value:function(){var t=this,e=function(){};(this.store.get("pusvidprtctn")||this.adRestarted)&&(e=function(){t.adRestarted||(t.pauseAdProtectionTimeout=clearTimeout(t.pauseAdProtectionTimeout))},this.pauseAdProtectionTimeout||(this.pauseAdProtectionTimeout=setTimeout(function(){t.video&&(v.logToBI(t.vpaidLog,"pauseAdProtection",{state:!1,adRestarted:t.adRestarted}),t.video.pause())},this.pauseVideoProtectionDuration))),this._safeCall("pauseAd",[e])}},{key:"resumeAd",value:function(){var t=this,e=function(){};this.adRestarted&&(e=function(){t.video.play()}),this._safeCall("resumeAd",[e])}},{key:"skipAd",value:function(){this._safeCall("skipAd",[])}},{key:"startAd",value:function(){this._safeCall("startAd",[])}},{key:"expandAd",value:function(){this._safeCall("expandAd",[])}},{key:"collapseAd",value:function(){this._safeCall("collapseAd",[])}},{key:"setAdVolume",value:function(t){var e=this;this.volume=t,this.isMuted=0===this.volume,this.store.get("frcvlm")&&(this.video.volume=t,this.beacon.dispatchEvent(this.vpaidEvents.AdVolumeChange,{dispatcher:this})),this._safeCall("setAdVolume",[t,function(){e.adRestarted&&(e.video.volume=t,e.video.muted=0===t)}])}},{key:"getAdWidth",value:function(){return this._safeCall("getAdWidth",[])}},{key:"getAdHeight",value:function(){return this._safeCall("getAdWidth",[])}},{key:"getAdSkippableRemainingTime",value:function(){return this._safeCall("getAdSkippableRemainingTime",[])}},{key:"getAdRemainingTime",value:function(){return this._safeCall("getAdRemainingTime",[])}},{key:"getAdDuration",value:function(t){return this._safeCall("getAdDuration",[t])}},{key:"getAdSkippableState",value:function(){return this._safeCall("getAdSkippableState",[])}},{key:"getAdVolume",value:function(t){return this._safeCall("getAdVolume",[t])}},{key:"getAdIcons",value:function(t){this._safeCall("getAdIcons",[t])}},{key:"getAdCompanions",value:function(){return this._safeCall("getAdCompanions",[])}},{key:"getAdExpanded",value:function(){return this._safeCall("getAdExpanded",[])}},{key:"getAdLinear",value:function(){return this._safeCall("getAdLinear",[])}},{key:"getDOMContainer",value:function(){return this.target}},{key:"subscribe",value:function(t,e){this.vpaidEvents[e]&&this.beacon.addEventListener(e,t)}},{key:"unsubscribe",value:function(t,e){if(this.vpaidEvents[e]){if(!t)return;this.beacon.removeEventListener(e,t)}}},{key:"onAfterStop",value:function(){}},{key:"_onAdError",value:function(){}},{key:"_getMediaUrl",value:function(){return this.mediaUrl}},{key:"getVideoUrl",value:function(){return this._getVideoSrc(this.video)||this._findVideoUrlInIframes(this.target.querySelectorAll("iframe"))}},{key:"getVPAIDVideoElement",value:function(){return this.vpaidVideoElement||null}},{key:"logVideoUrl",value:function(){var t=this.getVideoUrl();t?(v.logToBI(this.vpaidLog,"jsVpaidVideoUrl",{videoUrl:t}),this.vpaidLog.friendlyVideoUrl=!0):v.logToBI(this.vpaidLog,"jsVpaidUnfriendlyVideo",{unfriendlyVideo:!0})}},{key:"_findVideoUrlInIframes",value:function(t){var e=this,i="";if(!t||0===t.length)return i;try{v.DOMIterator(t[0],"iframe",function(t){t.forEach(function(t){i||(e.vpaidVideoElement=t,i=e._getVideoSrc(t))})},"video",this.store.get("debug")),i||(i=this._findVideoUrlInIframes(t[0].contentDocument.querySelectorAll("iframe")))}catch(t){}return i}},{key:"_getVideoSrc",value:function(t){if(t.src)return t.src;var e="";if(t.childNodes.length>0)for(var i=t.querySelectorAll("source"),s=0;s<i.length;s++)if(i[s].src){e=i[s].src;break}return e}},{key:"onMuteChanged",value:function(t){this.isMuted=t}},{key:"toggleIframeContentDisplay",value:function(t){try{var e="none";"hide"===t?e="hidden":"show"===t&&(e="visible"),this.adUnit._iframe.contentWindow.document.body.style.visibility=e}catch(t){v.logToBI(this.vpaidLog,"toggleIframeContentDisplayFail",{ex:t})}}},{key:"setCompletionOnAdStoppedTimeout",value:function(){var t=this,e=this.store.getByLineItem("cmpltonstpdms");e>0&&(this.completionOnAdStoppedTimeout||(this.completionOnAdStoppedTimeout=setTimeout(function(){
t.stopped||t.beacon.dispatchEvent(t.vpaidEvents.AdStopped)},e)))}},{key:"handleVpaidContent",value:function(){var t=this;this.adUnit._iframe&&(this.logVpaidTextElements||this.countdownRegex)&&setTimeout(function(){t.vpaidTextElements={},t._getAndHandleVpaidContent(t.adUnit._iframe),Object.keys(t.vpaidTextElements).length>0&&v.logToBI(t.vpaidLog,"vpaidTextElements",t.vpaidTextElements)},1)}},{key:"_getAndHandleVpaidContent",value:function(t){try{for(var e=t.contentWindow.document.body.getElementsByTagName("*")||[],i=0;i<e.length;i++){var s=e[i],n=s.nodeName.toLowerCase();if("script"!==n)if("iframe"===n)this._getAndHandleVpaidContent(s);else{var r=s.textContent?s.textContent.trim():"";r&&(this._logVpaidTextElements(s,n,r),this._hideVpaidCountdowns(s,r))}}}catch(t){}}},{key:"_logVpaidTextElements",value:function(t,e,i){this.logVpaidTextElements&&(this.vpaidTextElements[e]=this.vpaidTextElements[e]||[],this.vpaidTextElements[e].push({id:t.id,className:t.className,text:i}))}},{key:"_hideVpaidCountdowns",value:function(t,e){if(this.countdownRegex){var i=this.countdownRegex.exec(e)||this.countdownRegex.exec(t.className)||this.countdownRegex.exec(t.id);i&&i.length&&(t.style.display="none",v.logToBI(this.vpaidLog,"hideCountdown",{rgx:!0,text:e,id:t.id,className:t.className}))}}}]),t}();e.default=y},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=i(3),d=n(a),l=i(4),u=n(l),h=i(6),c=n(h),p=i(1),v=s(p),f=i(12),m=n(f),g=i(14),y=0,_=function(){function t(e,i,s){var n=this;r(this,t),this.vpaidLog=i,this.store=s,this.type="vpaid",this.tech="javascript",this.stopped=!1,this.version="1.1",this.target=e.slot,this.video=e.videoSlot,this.mediaFiles=e.vpaidFiles,this.mediaUrl,this.videoSlotControls=e.videoSlotControls,this.videoSlotCanAutoPlay=e.videoSlotCanAutoPlay,this.debugTracker=new d.default("JsVpaid"),this._onReady=e.onReady,this._onError=e.onError,this.tag=e.tag,this.vpaidEvents=Object.assign({},u.default),this.beacon=new c.default(this),this.volume=0,this.isMuted=!0,this.pauseVideoProtectionDuration=500,this.registerAnalyticsToVpaidLog=e.extra.registerAnalyticsToVpaidLog,this.analyticsRegistered=!1,this.store.get("ua"),this.video.muted=!0,this.video.setAttribute("vcounter",y++),this.video.setAttribute("playsinline",""),this.useCanvasMpeg=this.store.get("uscnvsmpg")||!1,this.hasAutoPlay=this.store.get("hasAutoPlay")||!1,this.isCanvasMpeg=this._decideCanvas(),this.canvasReady=!1,this.playerDAST=e.playerDAST,this.logVpaidTextElements=this.store.get("lgvpdtxtelmnts"),this.countdownRegex=this.store.get("cntdwnrgx"),this.countdownRegex&&(this.countdownRegex=new RegExp(this.countdownRegex,"ig"));var o=this.store.get("sprssviderr");if(o&&this._hookeEventListener(e.videoSlot),this.isCanvasMpeg){this.playerDAST.set({cnv:!0}),this.canvas=new m.default(this.video,this,null,null,s),this._onSwitchFromCanvasToVideo=e.onSwitchFromCanvasToVideo,this.canvas.on("ready",function(){}),this.canvas.on("play",function(){n.beacon.dispatchEvent(n.vpaidEvents.AdStarted)}),this.canvas.on("newVidCreated",function(t){n.playerDAST.set({ctv:!0}),n.newVidCreated=!0,v.logToBI(n.vpaidLog,"canvasToVideo",{newVidCreated:!0}),t.addEventListener("ended",function(){n.beacon.dispatchEvent(n.vpaidEvents.AdVideoComplete)}),n._onSwitchFromCanvasToVideo&&n._onSwitchFromCanvasToVideo(t)});var a=document.getElementsByClassName("vpaid-ad-controls")[0];a&&(a.className+=" hide")}setTimeout(function(){n._onReady()},2),v.logToBI(this.vpaidLog,"vpaidInit",{hasAutoPlay:this.hasAutoPlay,isCanvasMpeg:this.isCanvasMpeg,forceCavnas:this.store.get("forcecnvsmpg"),useAutoPlayForContent:this.store.get("useapforcntnt"),isMobile:!0}),this.canvas&&this.canvas.on("canvasEnded",function(){n._allEventsHandler("AdVideoComplete",[])})}return o(t,[{key:"muteClick",value:function(){this.stopped||(this.canvas?this.canvas.muteButtonClick():this.volume?this.setAdVolume(0):this.setAdVolume(.7))}},{key:"_hookeEventListener",value:function(t){var e=t.addEventListener;t.addEventListener=function(i,s){"error"!==i&&e.apply(t,[i,s])}}},{key:"_decideCanvas",value:function(){if(!this.store.get("uscnvsmpg"))return!1;var t=this.store.get("dsm")||{},e=t.mobAp||[],i=this.tag.advId;if(e.indexOf(i)>-1)return v.logToBI(this.vpaidLog,"canvasOptOutByAdvId",{advId:i}),!1;var s=this.store.get("forcecnvsmpg")||!1;return this.useCanvasMpeg&&!this.hasAutoPlay||s}},{key:"_resizeAd",value:function(t){this.stopped||this.canvas&&this.canvas.onResize(t[0],t[1])}},{key:"_safeCall",value:function(t,e){if(!this.stopped&&this.adUnit){"resizeAd"===t&&this._resizeAd(e);try{return this.adUnit[t].apply(this.adUnit,e)}catch(i){return v.logToBI(this.vpaidLog,"initJsError",{err:i.message,funcName:t,args:e,stack:i.stack}),!1}}}},{key:"restartAd",value:function(t,e){if(v.logToBI(this.vpaidLog,"restartAd",{videoRestarted:!0,isStopped:this.stopped}),!this.stopped)if(this.clickThruUrl=e,""===this._getVideoSrc(this.video)){if(!t)return void v.logToBI(this.vpaidLog,"restartAd",{videoUrlReplaced:!1});v.logToBI(this.vpaidLog,"restartAd",{videoUrlReplaced:!0}),this.video.src=t,this._bindedOnRestartVideoLoad=this._onRestartVideoLoad.bind(this),this.video.addEventListener("canplay",this._bindedOnRestartVideoLoad),this.video.load()}else this._onRestartVideoLoad()}},{key:"_onRestartVideoLoad",value:function(){var t=this;this.adRestarted=!0,this._bindedOnRestartVideoLoad&&(this.video.removeEventListener("canplay",this._bindedOnRestartVideoLoad),this._bindedOnRestartVideoLoad=void 0),this.video.currentTime=0,this._resizeVideotoParentSize(),this.video.play();var e=function(){v.logToBI(t.vpaidLog,"restartAd",{videoClicked:!0,url:t.clickThruUrl}),t.beacon.dispatchEvent(t.vpaidEvents.AdClickThru,{url:t.clickThruUrl,playerHandles:!0})},i=function i(){v.logToBI(t.vpaidLog,"restartAd",{videoComplete:!0}),t.video.removeEventListener("ended",i),t.video.removeEventListener("click",e),t._allEventsHandler(t.vpaidEvents.AdVideoComplete,{})};this.video.addEventListener("ended",i),this.video.addEventListener("click",e)}},{key:"isReplayable",value:function(){return!this.canvas&&this.video&&""!==this._getVideoSrc(this.video)}},{key:"_resizeVideotoParentSize",value:function(){this.video.style.width=this.target.style.width,this.video.style.height=this.target.style.height}},{key:"handshakeVersion",value:function(t){return"2.0"}},{key:"resizeAd",value:function(t,e,i){this.stopped||(this.target.style.width=t+"px",this.target.style.height=e+"px",this.target.setAttribute("width",t),this.target.setAttribute("height",e),this._safeCall("resizeAd",[t,e,i]),this.canvas&&this.canvas.onResize(t,e))}},{key:"initAd",value:function(t,e,i,s,n,r){function o(s,r){try{var o=function(s,o){s?v.logToBI(l.vpaidLog,"handshakeVPAIDJSScript",{handshake:!1,error:s}):v.logToBI(l.vpaidLog,"handshakeVPAIDJSScript",{handshake:!0}),r.initAd(t,e,i,-1,n,{})};if(l.stopped)return void v.logToBI(l.vpaidLog,"loadVPAIDJSScript",{stopped:!0});if(s)return v.logToBI(l.vpaidLog,"loadVPAIDJSScript",{scriptLoadedError:!0}),void(l.store.get("aduntldflbfruntld")&&l.adUnit?l._onError():l._onError(s,"adUnitLoadFailed"));v.logToBI(l.vpaidLog,"loadVPAIDJSScript",{scriptLoaded:!0}),l.adUnit=r,l.adUnit.syncmthds=l.store.get("syncmthds"),l._bindIframe(r),l._bindAdUnitEvents(r),r.handshakeVersion("2.0",o);var a=l.store.get("cmpltonstpddmn");a&&a.length>0&&l.mediaUrl.search(new RegExp(a.join("|"),"i"))!=-1&&(l.completeOnAdStop=!0)}catch(t){v.logToBI(l.vpaidLog,"loadVPAIDJSScriptErr",{err:t.message})}}if(!this.stopped){var a=this.mediaFiles[0];this.playerDAST.set({vbr:a.bitrate,vwd:a.width,vht:a.height,ot:a.originalType,st:a.subType}),this.mediaUrl=a.url,this.debugTracker.info("Loading","Iframe was loaded!");var d=new g(this.target,this.video,{},null,this.store);this.vpaid=d,d.loadAdUnit(this.mediaUrl,o);var l=this}}},{key:"checkUnfriendlyIframe",value:function(){var t=v.getDeepestIframe(this.target),e="";try{return t&&t.contentDocument,!1}catch(i){return e=t.src,v.logToBI(this.vpaidLog,"unfriendlyIframe",{src:e}),!0}}},{key:"_bindIframe",value:function(t){var e=t._iframe;this.analyticsRegistered=this.registerAnalyticsToVpaidLog(e),this.store.get("hjkFuncString")?(e.contentWindow.ReportHijackAttempt=this._onHijackAttempt,e.contentWindow.eval(this.store.get("hjkFuncString"))):v.logToBI(this.vpaidLog,"missingHjk",{});var i=this.store.get("debug");i||(e.contentWindow.onerror=function(){return!0},v._suppressConsoleMethods(e.contentWindow.console)),this._unmuteHook()}},{key:"_bindAdUnitEvents",value:function(t){var e=this;for(var i in this.vpaidEvents)!function(i){t.subscribe(i,function(t){e._allEventsHandler(i,t)})}(i)}},{key:"_unmuteHook",value:function(){this.store.get("mtdhkactv")&&(this.video.__defineSetter__("_muted",this.video.__lookupSetter__("muted")),this.video.__defineSetter__("muted",function(t){return this._mutedChangeByUserGesture?(this._muted=t,void this.__defineSetter__("muted",this.__lookupSetter__("_muted"))):void(this._muted=!0)}))}},{key:"_allEventsHandler",value:function(t,e){var i=this;if(!this.stopped)if(t===this.vpaidEvents.AdStopped&&(this.completionOnAdStoppedTimeout=clearTimeout(this.completionOnAdStoppedTimeout)),"AdImpression"===t){var s=this.video.src;s&&v.logToBI(this.vpaidLog,"videoUrl",{url:s}),this.canvas&&!this.canvas.loaded?this.canvas.on("ready",function(){i.beacon.dispatchEvent("AdImpression",[])}):this.beacon.dispatchEvent(t,e)}else this.beacon.dispatchEvent(t,e)}},{key:"stopAd",value:function(){this._safeCall("stopAd",[]),window.setTimeout(this._stopAd.bind(this),1)}},{key:"_stopAd",value:function(){if(!this.stopped){if(this.stopped=!0,this.adUnit&&this.adUnit._iframe&&this.adUnit._iframe.contentWindow&&(this.adUnit._iframe.contentWindow.ReportHijackAttempt=null,this.analyticsRegistered))try{this.adUnit._iframe.contentWindow.destroyAnalyticsReporter&&(this.adUnit._iframe.contentWindow.destroyAnalyticsReporter(),v.logToBI(this.vpaidLog,"vpaidAnalyticsDestroy",{success:!0}))}catch(t){v.logToBI(this.vpaidLog,"vpaidAnalyticsDestroy",{success:!1,ex:t})}this.adUnit&&this.adUnit._destroy(),this.vpaid&&this.vpaid.destroy(),this.canvas&&this.canvas.destroy(),this.completionOnAdStoppedTimeout=clearTimeout(this.completionOnAdStoppedTimeout),this.iframe=this.vpaid=this.adUnit=this.mediaFiles=this.video=this.vpaidEvents=this.target=this.debugTracker=this.beacon=this.registerAnalyticsToVpaidLog=this._onSwitchFromCanvasToVideo=void 0,this.vpaidLog=null,this.tag=void 0,this.store=void 0,this.onAfterStop()}}},{key:"pauseAd",value:function(){var t=this,e=function(){};(this.store.get("pusvidprtctn")||this.adRestarted)&&(e=function(){t.adRestarted||(t.pauseAdProtectionTimeout=clearTimeout(t.pauseAdProtectionTimeout))},this.pauseAdProtectionTimeout||(this.pauseAdProtectionTimeout=setTimeout(function(){t.video&&(v.logToBI(t.vpaidLog,"pauseAdProtection",{state:!1,adRestarted:t.adRestarted}),t.video.pause())},this.pauseVideoProtectionDuration))),this._safeCall("pauseAd",[e])}},{key:"resumeAd",value:function(){var t=this,e=function(){};this.canvas&&!this.newVidCreated&&(e=function(){t.video.play()}),this.adRestarted&&(e=function(){t.video.play()}),this._safeCall("resumeAd",[e])}},{key:"skipAd",value:function(){this._safeCall("skipAd",[])}},{key:"startAd",value:function(){v.logToBI(this.vpaidLog,"jsMobileStartAd",{start:!0}),this.video.muted=!0,this.video.setAttribute("playsinline",""),this.canvas&&this.canvas.emitStartAd(),this._safeCall("startAd",[])}},{key:"expandAd",value:function(){this._safeCall("expandAd",[])}},{key:"collapseAd",value:function(){this._safeCall("collapseAd",[])}},{key:"setAdVolume",value:function(t,e){var i=this;this.volume=t,this.video._mutedChangeByUserGesture=e,this.video.muted=this.isMuted=0===this.volume,this._safeCall("setAdVolume",[t,function(){i.adRestarted&&(i.video.volume=t,i.video.muted=0===t)}])}},{key:"getAdWidth",value:function(){return this._safeCall("getAdWidth",[])}},{key:"getAdHeight",value:function(){return this._safeCall("getAdWidth",[])}},{key:"getAdSkippableRemainingTime",value:function(){return this._safeCall("getAdSkippableRemainingTime",[])}},{key:"getAdRemainingTime",value:function(){return this._safeCall("getAdRemainingTime",[])}},{key:"getAdDuration",value:function(t){return this._safeCall("getAdDuration",[t])}},{key:"getAdSkippableState",value:function(){return this._safeCall("getAdSkippableState",[])}},{key:"getAdVolume",value:function(t){return this._safeCall("getAdVolume",[t])}},{key:"getAdIcons",value:function(t){this._safeCall("getAdIcons",[t])}},{key:"getAdCompanions",value:function(){return this._safeCall("getAdCompanions",[])}},{key:"getAdExpanded",value:function(){return this._safeCall("getAdExpanded",[])}},{key:"getAdLinear",value:function(){return this._safeCall("getAdLinear",[])}},{key:"getDOMContainer",value:function(){return this.target}},{key:"subscribe",value:function(t,e){this.stopped||this.vpaidEvents[e]&&this.beacon.addEventListener(e,t)}},{key:"unsubscribe",value:function(t,e){if(!this.stopped&&this.vpaidEvents[e]){if(!t)return;this.beacon.removeEventListener(e,t)}}},{key:"onAfterStop",value:function(){}},{key:"_onAdError",value:function(){}},{key:"_getMediaUrl",value:function(){return this.mediaUrl}},{key:"getVideoUrl",value:function(){return this._getVideoSrc(this.video)||this._findVideoUrlInIframes(this.target.querySelectorAll("iframe"))}},{key:"getVPAIDVideoElement",value:function(){return this.vpaidVideoElement||null}},{key:"logVideoUrl",value:function(){var t=this.getVideoUrl();t?(v.logToBI(this.vpaidLog,"jsVpaidVideoUrl",{videoUrl:t}),this.vpaidLog.friendlyVideoUrl=!0):v.logToBI(this.vpaidLog,"jsVpaidUnfriendlyVideo",{unfriendlyVideo:!0})}},{key:"_findVideoUrlInIframes",value:function(t){var e=this,i="";if(!t||0===t.length)return i;try{v.DOMIterator(t[0],"iframe",function(t){t.forEach(function(t){i||(e.vpaidVideoElement=t,i=e._getVideoSrc(t))})},"video",this.store.get("debug")),i||(i=this._findVideoUrlInIframes(t[0].contentDocument.querySelectorAll("iframe")))}catch(t){}return i}},{key:"_getVideoSrc",value:function(t){if(t.src)return t.src;var e="";return t.childNodes.length>0&&t.querySelectorAll("source").forEach(function(t){!e&&t.src&&(e=t.src)}),e}},{key:"toggleIframeContentDisplay",value:function(t){try{var e="none";"hide"===t?e="hidden":"show"===t&&(e="visible"),this.adUnit._iframe.contentWindow.document.body.style.visibility=e}catch(t){v.logToBI(this.vpaidLog,"toggleIframeContentDisplayFail",{ex:t})}}},{key:"setCompletionOnAdStoppedTimeout",value:function(){var t=this,e=this.store.getByLineItem("cmpltonstpdms");e>0&&(this.completionOnAdStoppedTimeout||(this.completionOnAdStoppedTimeout=setTimeout(function(){t.stopped||t.beacon.dispatchEvent(t.vpaidEvents.AdStopped)},e)))}},{key:"handleVpaidContent",value:function(){var t=this;this.adUnit._iframe&&(this.logVpaidTextElements||this.countdownRegex)&&setTimeout(function(){t.vpaidTextElements={},t._getAndHandleVpaidContent(t.adUnit._iframe),Object.keys(t.vpaidTextElements).length>0&&v.logToBI(t.vpaidLog,"vpaidTextElements",t.vpaidTextElements)},1)}},{key:"_getAndHandleVpaidContent",value:function(t){try{for(var e=t.contentWindow.document.body.getElementsByTagName("*")||[],i=0;i<e.length;i++){var s=e[i],n=s.nodeName.toLowerCase();if("script"!==n)if("iframe"===n)this._getAndHandleVpaidContent(s);else{var r=s.textContent?s.textContent.trim():"";r&&(this._logVpaidTextElements(s,n,r),this._hideVpaidCountdowns(s,r))}}}catch(t){}}},{key:"_logVpaidTextElements",value:function(t,e,i){this.logVpaidTextElements&&(this.vpaidTextElements[e]=this.vpaidTextElements[e]||[],this.vpaidTextElements[e].push({id:t.id,className:t.className,text:i}))}},{key:"_hideVpaidCountdowns",value:function(t,e){if(this.countdownRegex){var i=this.countdownRegex.exec(e)||this.countdownRegex.exec(t.className)||this.countdownRegex.exec(t.id);i&&i.length&&(t.style.display="none",v.logToBI(this.vpaidLog,"hideCountdown",{rgx:!0,text:e,id:t.id,className:t.className}))}}}]),t}();e.default=_},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=i(64),d=n(a),l=i(3),u=n(l),h=i(71),c=n(h),p=i(9),v=n(p),f=i(21),m=n(f),g=i(1),y=s(g);m.default.config({cancellation:!0});var _=function(){function t(e,i){var s=this;r(this,t),this.mainVpaid=e,this.store=i,this.time=(new Date).getTime(),this.sequenceId=((new Date).getTime()+"").substring(3,11),this.loops=0,this.stopped=!1,this.started=!1,this.schedule=[],this.timedTimeout=0,this.waterfall={},this.adSlots=1,this.filledSlots=0,this.adIsPlaying=!1,this.debugTracker=new u.default("Manager"),this.isVideoThrottleOn=this.store.get("vtrtlon"),this.isBufferModeOn=this.store.get("bfrmd"),this.oppsID=v.default,this.queueSize=this.store.get("queue_size")||10,this.isVforce=i.get("vForce"),this.store.on("stop",this.stop.bind(this)),this.store.on("emitQueueStatus",this._emitQueueStatus.bind(this)),this.store.get("debug")&&setInterval(function(){s._postMessageSchedule()},1e3),this.dontTrimMp4=this.store.get("novdtrm"),this.maxBackfillDelayItems=this.store.get("mxbckflldlyitms"),this.maxBackfillDelayItems&&(this.backfilldelayTime=this.store.get("bckflldlyms"),this.backfillPriority=this.store.get("bfprty"))}return o(t,[{key:"_postMessageSchedule",value:function(){if(window.cmPlayerDeubg){var t=this.schedule,e=this.store;try{window.cmPlayerDeubg({schedule:t,store:e})}catch(t){console.log(t)}}}},{key:"trigger",value:function(t,e,i){if(this._handleAllEvents({type:t,dispatcher:e}),this.store.emit(t,e),e.working||t===this.mainVpaid.vpaidEvents.AdImpression){var s={type:t,dispatcher:e};t===this.mainVpaid.vpaidEvents.AdImpression&&(s.tag=e.tag),s.vpaidReady=this.getVpaidReadyCount(),s.qsize=this.schedule.length,s.dp=e&&e.tag?e.tag.dp:"na",s.adImpMS=e?e.adImpInMS:0,s.readyInMS=e?e.readyInMS:0,s.loadToImpMS=e?e.adImpInMS-e.readyInMS:0,s.clickThru={url:i?i.url:"",playerHandles:i&&i.playerHandles!==!1},this.mainVpaid.trigger(t,s)}}},{key:"getVpaidReadyCount",value:function(){var t=0;return this.schedule.map(function(e){e&&e.vpaidWrapper&&"ready"===e.vpaidWrapper.status&&t++}),t}},{key:"subscribeToVpaid",value:function(t){this.stopped||t.subscribe(this._handleError.bind(this),this.mainVpaid.vpaidEvents.AdError)}},{key:"_handleAllEvents",value:function(t){var e=this;t.type!==this.mainVpaid.vpaidEvents.AdVideoStart&&t.type!==this.mainVpaid.vpaidEvents.AdImpression&&t.type!==this.mainVpaid.vpaidEvents.AdPlaying||!t.dispatcher.isPlaying||this.trigger("viewAdPlayer",t.dispatcher.tag),t.type===this.mainVpaid.vpaidEvents.AdLoaded&&this.shouldPlayWhenAvialable&&!this.store.get("evtbsschdl")&&(setTimeout(function(){e.playFromQueue(e.shouldPlayWhenAvialable)},2),t.dispatcher?t.dispatcher.tag:{},this.shouldPlayWhenAvialable=!1),t.type===this.mainVpaid.vpaidEvents.AdImpression&&(t.dispatcher.options&&t.dispatcher.options.getAdContext?(t.dispatcher.gotAd=!0,this.debugTracker.info("gotAd",t.dispatcher,{color:"#5EB9FF"}),y.logToBI(t.dispatcher.vpaidLog,"getAdContexIsEmpty",{empty:!1}),t.dispatcher.options.getAdContext.getAdCallback(t.dispatcher)):t.dispatcher&&t.dispatcher.vpaidLog&&y.logToBI(t.dispatcher.vpaidLog,"getAdContexIsEmpty",{empty:!0}))}},{key:"_runNextAd",value:function(){}},{key:"_handleError",value:function(t){var e=t.dispatcher;this.adIsPlaying&&e.isStarted&&!e.hadImpression&&!this.store.get("evtbsschdl")&&this.playFromQueue()}},{key:"initVpaidInQue",value:function(t){if(!this.stopped)for(var e=this.schedule,i={},s="",n=0;n<e.length;n++)i=e[n],s=n+"-"+i.waterfallTagId,i.vpaidWrapper||(this.maxBackfillDelayItems&&i.priority===this.backfillPriority?i.backfillDelay=setTimeout(this._createVpaidWrapper.bind(this,i,s,t),this.backfilldelayTime):this._createVpaidWrapper(i,s,t))}},{key:"_createVpaidWrapper",value:function(t,e,i){t.backfillDelay&&(t.backfillDelay=window.clearTimeout(t.backfillDelay),t.isBackfillDelayed=!0),t.sequenceId=t.wfIndex,t.vpaidWrapper=new d.default({tag:t,creatives:this.mainVpaid.config.creatives,vpaidEvents:this.mainVpaid.vpaidEvents,config:this.mainVpaid.config,tagid:e,manager:this,wfStats:t.wfStats},this.mainVpaid,this.store,i);var s=this;t.vpaidWrapper.on("vpaidCleaned",function(){s.cleanExpierd(s.queueSize)}),this.isVideoThrottleOn&&t.vpaidWrapper.on("throttleVideo",this._throttleVideo.bind(this)),this.isBufferModeOn&&t.vpaidWrapper.on("setBufferModeForAdvertiser",this._setBufferModeForAdvertiser.bind(this)),this.subscribeToVpaid(t.vpaidWrapper)}},{key:"unsubscribeFromVpaid",value:function(t){this.stopped||(t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdError),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdFound),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdStopped),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdSkipped),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdImpression),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdSkippableStateChange),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdSizeChange),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdLinearChange),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdDurationChange),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdExpandedChange),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdVolumeChange),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdVideoStart),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdVideoFirstQuartile),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdVideoMidpoint),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdVideoThirdQuartile),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdVideoComplete),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdClickThru),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdInteraction),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdUserAcceptInvitation),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdUserMinimize),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdUserClose),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdPaused),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdPlaying),t.unsubscribe(null,this.mainVpaid.vpaidEvents.AdLog))}},{key:"cleanExpierd",value:function(t){var e=this;if(this.schedule.map(function(t,i){if(t&&t.vpaidWrapper&&!t.vpaidWrapper.working&&("error"===t.vpaidWrapper.status||"stopped"===t.vpaidWrapper.status)){t.vpaidWrapper._status=t.vpaidWrapper.status,e.unsubscribeFromVpaid(e.schedule[i].vpaidWrapper);var s="error"===t.vpaidWrapper.status,n=s?e.oppsID.vastError:e.oppsID.adError;e.schedule[i].vpaidWrapper.stop("cleanExpierd",n),e.schedule[i]&&(e.schedule[i].vpaidWrapper=null),e.schedule[i]=void 0}}),this.schedule=this.schedule.filter(function(t){return t}),this.schedule=c.default.sort(this.schedule,this.store),this.schedule.length>t){var i=(this.mainVpaid.config.creatives,this.mainVpaid.config.creatives.ADTO||6e4),s=this.store.get("trmrdyvpaid");this.schedule.map(function(n,r){if(e.schedule[r]&&!n.vpaidWrapper.working&&(s||"ready"!==n.vpaidWrapper.status)){var o=Date.now()-e.schedule[r].vpaidWrapper.created;if(n&&(r<e.schedule.length-t||o>i)){e.unsubscribeFromVpaid(e.schedule[r].vpaidWrapper);var a=o>i?"queueExpired":"queueTrimmed";if(!e._canTrim(a,n))return;e.schedule[r].vpaidWrapper.stop(a,e.oppsID[a]),e.schedule[r]=void 0}}})}this.schedule=this.schedule.filter(function(t){return t})}},{key:"_canTrim",value:function(t,e){return"queueTrimmed"!==t||!(e.vpaidWrapper&&"mp4"===e.vpaidWrapper.type&&this.dontTrimMp4)}},{key:"fillSchedule",value:function(t,e){this.schedule.length>this.queueSize&&this.cleanExpierd(this.queueSize),this.started=!0,this.stopped=!1;var i={},s=0,n=this.mainVpaid.config.creatives;n.ADTO=parseInt(n.ADTO)>1?parseInt(n.ADTO):60,n.ADTO=n.ADTO<1e3?1e3*n.ADTO:n.ADTO,this.adSlots=parseInt(n.B2B)&&parseInt(n.B2B)>1?parseInt(n.B2B):1;var r=0,o=n.DEFAULTTAGTIMEOUT<1e3?1e3*n.DEFAULTTAGTIMEOUT:n.DEFAULTTAGTIMEOUT;for(s=0;s<t.tags.length;s++)this._shouldInsertToQueue(t.tags[s])?(i=t.tags[s],i.active=!1,i.adFound=!1,i.offset=r,i.tagStart=r,i.tagTimeout=o,i.queueNumber=0,i.ADTO=n.ADTO,i.vpaidWrapper=!1,i.tagEnd=1*i.tagStart+1*i.tagTimeout,i.wfStats=t.data,this.store.get("frstlk")&&this._updateItemFirstLook(i),this.schedule.push(i)):e.push("tagResponse_"+s+"_backfillThrown",!0);this._printQueue(this.schedule),this.mainVpaid.setVpaidId(i),this.time=(new Date).getTime(),this.initVpaidInQue(e),this.store.set("queueLength",this.schedule.length),this.store.set("vpaidReadyCount",this.getVpaidReadyCount())}},{key:"_shouldInsertToQueue",value:function(t){return!this.maxBackfillDelayItems||t.priority!==this.backfillPriority||t.priority===this.backfillPriority&&this._getBackfillCount()<this.maxBackfillDelayItems}},{key:"_printQueue",value:function(t){var e=t.map(function(t){return{dp:t.dp,lineItem:t.lineItem,alfrox:t.alfrox,waterfallIndex:t.wfIndex,status:t.vpaidWrapper?t.vpaidWrapper.status:"",videoUrl:t.vpaidWrapper?t.vpaidWrapper.getVideoUrl():""}});this.debugTracker.table(e)}},{key:"_updateItemFirstLook",value:function(t){t.flad&&(this.store.get("first_look_ad_loaded")?(t.flad_delay=t.flad,delete t.flad):this._startFladTimeout(t.flad))}},{key:"_startFladTimeout",value:function(t){this.store.set("first_look_ad_loaded",t),this.fladTimeout=setTimeout(this._onFladTimeout.bind(this),1e3*t)}},{key:"_onFladTimeout",value:function(){for(var t=null,e=0;e<this.schedule.length;e++)if(t=this.schedule[e],t.flad_delay)return t.flad=t.flad_delay,delete t.flad_delay,void this._startFladTimeout(t.flad);this.store.set("first_look_ad_loaded",!1),this.store.emit("fladInactive")}},{key:"stop",value:function(){if(!this.stopped){this.stopped=!0,window.clearTimeout(this.timedTimeout);for(var t=0;t<this.schedule.length;t++)this.schedule[t].backfillDelay?window.clearTimeout(this.schedule[t].backfillDelay):this.schedule[t].vpaidWrapper.stop("playerClosed",this.oppsID.playerClosed)}}},{key:"managerEnd",value:function(){}},{key:"playFromQueue",value:function(t){if(!this.store.get("isIdleMode")&&!this.stopped){var e=Date.now();this.store.set("playFromQueue",e);var i=this.getVpaidReadyCount();(0===i||t)&&(this.store.get("vForce")||(this.shouldPlayWhenAvialable=!0)),this.store.get("first_look")||this.store.get("first_look_ad_loaded")||(this.schedule=c.default.sort(this.schedule,this.store));var s=this.mainVpaid.config.creatives.ADTO||6e4;s+=1e4;for(var n=!1,r=this._getItemScores(),o=this._getItemDps(),a=this.schedule.length-1;a>=0;a--){var d=this.schedule[a];d&&(this._setItemScores(d,a,r),this._setItemDps(d,a,o),"ready"!==d.vpaidWrapper.status||d.vpaidWrapper.working||d.vpaidWrapper.isStarted||n||this.store.get("first_look_ad_loaded")&&!d.flad||(this.store.set("playFromQueueFound",e),d.vpaidWrapper.bringToFront(),d.vpaidWrapper.workingVpaid=!0,this.store.set("ad_controls",this.store.getByLineItem("ad_controls",d.vpaidWrapper.tag)!==!1),d.vpaidWrapper.working=!0,d.vpaidWrapper.isPlaying=!0,this.adIsPlaying=!0,n=!0,d.vpaidWrapper.startAd(),y.logToBI(d.vpaidWrapper.vpaidLog,"startFromQ",{score:d.score})))}var l=this.store.get("run_wf_when_empty");l&&0===i&&this.store.emit("playFromEmptyQueue")}}},{key:"_getItemScores",value:function(){for(var t=[],e=this.schedule.length-1;e>=0;e--){var i=this.schedule[e];i&&t.push(i.score)}return t}},{key:"_getItemDps",value:function(){for(var t=[],e=this.schedule.length-1;e>=0;e--){var i=this.schedule[e];i&&t.push(i.dp)}return t}},{key:"_setItemScores",value:function(t,e,i){t.vpaidWrapper&&t.vpaidWrapper.vpaidLog&&t.vpaidWrapper.vpaidLog.data&&(t.vpaidWrapper.vpaidLog.data.itemScore=t.score,i&&y.logToBI(t.vpaidWrapper.vpaidLog,"itemScores",{index:e,scores:i}))}},{key:"_setItemDps",value:function(t,e,i){t.vpaidWrapper&&i&&y.logToBI(t.vpaidWrapper.vpaidLog,"itemDps",{index:e,dps:i})}},{key:"resizeAd",value:function(t,e,i){if(!this.stopped){this.mainVpaid.config.creatives.PLAYER_WIDTH=this.mainVpaid.config.width=parseInt(t),this.mainVpaid.config.creatives.PLAYER_HEIGHT=this.mainVpaid.config.height=parseInt(e),this.mainVpaid.config.creatives.VIEW_MODE=this.mainVpaid.config.viewMode=i;for(var s=0;s<this.schedule.length;s++)this.schedule[s].vpaidWrapper&&!this.schedule[s].vpaidWrapper.stopped&&this.schedule[s].vpaidWrapper.workingVpaid&&this.schedule[s].vpaidWrapper.callVpaidMethod("resizeAd",[t,e,i],0)}}},{key:"setAdVolume",value:function(t,e){if(!this.stopped){if(t=t>1?t/100:t,isNaN(parseFloat(t)))return!1;t=parseFloat(t),e||(this.mainVpaid.config.creatives.VOLUME=t),this.mainVpaid.config.creatives.MUTED=0==t;for(var i=0;i<this.schedule.length;i++)this.schedule[i].vpaidWrapper&&!this.schedule[i].vpaidWrapper.stopped&&this.schedule[i].vpaidWrapper.workingVpaid&&this.schedule[i].vpaidWrapper.setAdVolume(t)}}},{key:"callWorkingVpaid",value:function(t,e,i){if(!this.stopped)for(var s=0;s<this.schedule.length;s++){var n=this.schedule[s].vpaidWrapper;if(n&&n.workingVpaid)return n.callVpaidMethod(t,e,i)}}},{key:"getVpaidLogs",value:function(){for(var t=[],e=0;e<this.schedule.length;e++){var i=this.schedule[e];i&&i.vpaidWrapper&&i.vpaidWrapper.vpaidLog&&t.push(i.vpaidWrapper.vpaidLog)}return t}},{key:"getAd",value:function(t){this.store.incr("getAdData.count");var e=this;return this.debugTracker.info("getAd",t?t:"empty getAd",{color:"#5EB9FF"}),new m.default(function(i,s,n){t=t||{};var r={getAdCallback:i};t.getAdContext=r,t.getAdContext.getAdTimeout=setTimeout(function(){t.getAdContext=void 0,s({name:"error",message:"couldn't find a suitable ad to play"})},1e3*e.store.get("get_ad_timeout_seconds")),e.getAdFromQueue(t),n(function(){e.cancelGetAd(t),this.debugTracker.info("getAd","getAd cancelled!",{color:"#5EB9FF"})}.bind(e))})}},{key:"cancelGetAd",value:function(t){this.store.decr("getAdData.count"),clearTimeout(t.getAdContext.getAdTimeout),t.getAdContext=void 0}},{key:"getAdFromQueue",value:function(t){if(!this.store.get("isIdleMode")&&!this.stopped&&(t=t||{},t&&t.getAdContext&&(!t.requiredViewability||!document.hidden))){this.store.get("first_look")||this.store.get("first_look_ad_loaded")||(this.schedule=c.default.sort(this.schedule,this.store));for(var e=!1,i=this.schedule.length-1;i>=0;i--){var s=this.schedule[i];if(this._updateStatusesOnGetAd(s,t),this._setItemScores(s,i),this.isViewabilityMatch(s,t)&&"ready"===s.vpaidWrapper.status&&!s.vpaidWrapper.working&&!s.vpaidWrapper.isStarted&&(!this.store.get("first_look_ad_loaded")||s.flad)){s.vpaidWrapper.bringToFront(),s.vpaidWrapper.working=!0,s.vpaidWrapper.isPlaying=!0,this.adIsPlaying=!0,e=!0,s.vpaidWrapper.startAd(t),y.logToBI(s.vpaidWrapper.vpaidLog,"startFromQ",{score:s.score}),clearTimeout(t.getAdContext.getAdTimeout),t.getAdContext.getAdTimeout=void 0;break}}var n=this.store.get("run_wf_when_empty");n&&0==this.getVpaidReadyCount()&&this.store.emit("playFromEmptyQueue"),e||(this.nextAdFromQueue=setTimeout(this.getAdFromQueue.bind(this,t),1e3))}}},{key:"_updateStatusesOnGetAd",value:function(t,e){t.vpaidWrapper&&t.vpaidWrapper.vpaidLog&&!t.vpaidWrapper.gotAd&&t.vpaidWrapper.updateStatusesOnGetAd(e)}},{key:"isViewabilityMatch",value:function(t,e){return!(!t||!t.vpaidWrapper)&&("undefined"==typeof e.requiredViewability||(e.requiredViewability?t.requiredViewability:!t.requiredViewability))}},{key:"onStop",value:function(){}},{key:"isActivePausedAd",value:function(){
for(var t=0;t<this.schedule.length;t++){var e=this.schedule[t];if(e&&e.vpaidWrapper&&e.vpaidWrapper.isPlaying&&!e.vpaidWrapper.isUnPaused)return!0}return!1}},{key:"isWorkingVpaidItem",value:function(t){var e=!1;return this.schedule.map(function(i){i&&i.vpaidWrapper&&i.vpaidWrapper==t&&i.vpaidWrapper.working&&(e=!0)}),e}},{key:"_saveCountersToStore",value:function(t,e,i){!e&&this.store&&i&&this.store.set(t,i)}},{key:"callAllWorkingVpaids",value:function(t){this.schedule.map(function(e){e.vpaidWrapper&&!e.vpaidWrapper.stopped&&e.vpaidWrapper.workingVpaid&&t(e.vpaidWrapper)})}},{key:"mute",value:function(){this.callAllWorkingVpaids(function(t){return t.mute()})}},{key:"unmute",value:function(){this.callAllWorkingVpaids(function(t){return t.unmute()})}},{key:"play",value:function(){this.callAllWorkingVpaids(function(t){return t.resumeAd()})}},{key:"pause",value:function(){this.callAllWorkingVpaids(function(t){return t.pauseAd()})}},{key:"getCurrentWorkingVpaidVolume",value:function(){var t=null;return this.callAllWorkingVpaids(function(e){null===t&&(t=e.getCurrentVolume())}),t||0}},{key:"_throttleVideo",value:function(t){var e=this;setTimeout(function(){e.stopped||e.store.emit("onThrottleEnd_"+t.videoUrl)},t.delay)}},{key:"_setBufferModeForAdvertiser",value:function(t){var e=this;setTimeout(function(){if(!e.stopped){var i=e.store.get("bufferModeList")||[];i.splice(i.indexOf(t.advId),1),e.store.set("bufferModeList",i)}},t.delay)}},{key:"_emitQueueStatus",value:function(){this.store.emit("queueStatus",this._getQueueStatus())}},{key:"_getQueueStatus",value:function(){for(var t={requiredViewabilityCount:0},e=0;e<this.schedule.length;e++){var i=this.schedule[e];i.requiredViewability&&t.requiredViewabilityCount++}return t}},{key:"_getBackfillCount",value:function(){var t=this,e=0;return this.schedule.map(function(i){i&&i.priority===t.backfillPriority&&e++}),e}}]),t}();e.default=_},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e,i,s,n){var r=document.createElement("script"),o=[];e={adData:{ids:e,duration:i,url:n},dispatchEvent:function(t){this.sendEvent?(o&&(o.push(t),t=o,o=!1),this.sendEvent(t)):o.push(t)}},i="_moatApi"+Math.floor(1e8*Math.random());var a,d;try{a=t.ownerDocument,d=a.defaultView||a.parentWindow}catch(t){a=document,d=window}return d[i]=e,r.type="text/javascript",t&&t.insertBefore(r,t.childNodes[0]||null),r.src="https://z.moatads.com/"+s+"/moatvideo.js#"+i,e}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=i(1),d=s(a),l=function(){function t(e){n(this,t);var i=e.store.getByLineItem("mttst",e.tag);i&&(i+="_"),i=""+i+(e.store.get("unit_type")||"")+(e.store.get("isMobile")?"_Mobile":""),this.moatApiReference=r(e.container||document.body,e.tag?{level1:i,level2:e.tag.advId,level3:e.tag.lineItemId,level4:e.store.get("domain")||"",slicer1:e.url,slicer2:e.tag.tagId}:{level1:"",level2:"",level3:"",level4:"",slicer1:"",slicer2:""},e.duration||0,e.moatPartnerCode,e.url),d.logToBI(e.vpaidLog,"moatTracker",{abTest:i,partnerCode:e.moatPartnerCode})}return o(t,[{key:"dispatch",value:function(t){this.moatApiReference&&this.moatApiReference.dispatchEvent(t)}},{key:"dispose",value:function(){this.moatApiReference=void 0}}]),t}();e.default=l},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=i(3),d=n(a),l=i(1),u=s(l),h=i(8),c=n(h),p=function(){function t(e,i){r(this,t),this.store=e,this.debugTracker=new d.default("OpportunityAggregator"),this.opps=[];var s=this.store.get("opps_base_path")||i.CM_DOMAIN;this.url=u.setUrlPrefix(s)+(/.*\/$/g.test(s)?"":"/")+"OpportunityServlet",this.postHeaders=this.store.get("psthdrs")||"application/json",this.onFail=this._onFail.bind(this),this.onSuccess=this._onSuccess.bind(this);var n=this._sendTicker.bind(this);setInterval(n,this.store.get("timbtopps")),this.store.on("sendOpps",n),this.store.on("beforeunload",n)}return o(t,[{key:"send",value:function(t){this.opps.push(t)}},{key:"_sendTicker",value:function(){this.opps.length>0&&(0,c.default)(this.url,u.stringify(this.opps),this.onSuccess,this.onFail,void 0,!1,5e3,this.postHeaders,!1),this.opps=[]}},{key:"_onSuccess",value:function(t){}},{key:"_onFail",value:function(t){this.debugTracker.warn("Error Firing Opps",t)}}]),t}();e.default=p},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=i(3),d=(n(a),i(20)),l=s(d),u=i(68),h=s(u),c=i(1),p=s(c),v=i(4),f=n(v),m=function(){function t(e){r(this,t),this.trackingPixels=Object.assign({},l),this.pixelDataLoaded=!1,this.events=[],this.done=[],this.store=e,this.vpaidEvents=f.default,this.state="",this.clickThruUrl="",this._isPaused=!1,this.buildPixelsRestrictions(),this._isPaused=!1}return o(t,[{key:"buildPixelsRestrictions",value:function(){this.pixelsRestrictions={},this.pixelsRestrictions.baseState=this.vpaidEvents.AdVideoThirdQuartile,this.pixelsRestrictions[this.vpaidEvents.AdVideoComplete]=this.vpaidEvents.AdVideoThirdQuartile}},{key:"loadPixelData",value:function(t){this.pixelDataLoaded,this.pixelDataLoaded=!0,this.trackingPixels=t}},{key:"getClickThruUrl",value:function(){if(!this.clickThruUrl)for(var t=["adclickthrough","clickthrough","adclickthru","clickthru"],e=0;e<t.length;e++){var i=t[e];if(this.trackingPixels.hasOwnProperty(i)&&this.trackingPixels[i].length>0){this.clickThruUrl=this.trackingPixels[i][0];break}}return this.clickThruUrl}},{key:"firePixel",value:function(t,e,i){if(this._isPaused)return!1;if(!this.isValid(t,i))return p.logToBI(e,"firePixelStateViolation",{event:t,pixelManagerState:this.state}),!1;var s=t.toLowerCase().replace(/^advideo|^aduser|^ad/gi,""),n=[];switch(s){case"clickthrough":case"clickthru":n=n.concat(this._checkConcatPixels(this.trackingPixels.adclicktracking)),n=n.concat(this._checkConcatPixels(this.trackingPixels.clicktracking));break;case"progress":i&&i.hasOwnProperty("eventData")&&i.eventData<this.trackingPixels[s].length&&(n=n.concat(this.trackingPixels[s][i.eventData].pixel));break;case"start":this.trackingPixels.hasOwnProperty("creativeview")&&this.trackingPixels.creativeview.map(function(t){n.push(t)});default:n=n.concat(this._checkConcatPixels(this.trackingPixels[s])),n=n.concat(this._checkConcatPixels(this.trackingPixels["aduser"+s])),n=n.concat(this._checkConcatPixels(this.trackingPixels["advideo"+s])),n=n.concat(this._checkConcatPixels(this.trackingPixels["ad"+s]))}for(var r=0;r<n.length;r++)!this._sendPixel(n[r],t,e);return this.events.push(t),""===this.state&&t===this.pixelsRestrictions.baseState&&(this.state=this.pixelsRestrictions.baseState),!0}},{key:"isValid",value:function(t,e){if(!this.pixelsRestrictions.hasOwnProperty(t))return!0;if(t===this.vpaidEvents.AdVideoComplete&&e&&e.newCompletion===!0)return!0;var i=this.pixelsRestrictions[t];return i===this.state&&(this.state=t,!0)}},{key:"destroy",value:function(){this.trackingPixels=this.done=this.events=this.vpaidEvents=this.pixelsRestrictions=this.state=this.clickThruUrl=void 0}},{key:"_checkConcatPixels",value:function(t){return t&&t.length?t:[]}},{key:"_sendPixel",value:function(t,e,i){var s=i?i.data:null;if(h.reportPixel(t,e,s),this.done.indexOf(t)===-1){h.reportCleanPixel(t,e,s);var n=i&&i.tag?i.tag.advId:null;this.done.push(t);try{return t=this._replaceMacros(t),n&&(this.store.getByAdvId("pxlnotsmtp",n)||(t+=(t.search(/\?/)>-1?"&":"?")+(new Date).getTime())),(new Image).src=t,!0}catch(t){return!1}}}},{key:"_replaceMacros",value:function(t){var e=Date.now().toString(),i=e.substring(5);return t=t.replace("[CACHEBUSTING]",i)}},{key:"pause",value:function(){this._isPaused=!0}}]),t}();e.default=m},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=i(1),a=s(o),d=function(){function t(e){n(this,t),this.store=e,this.onNavigatorConnectionChange=this._onNavigatorConnectionChange.bind(this),this.store.on("navigatorConnectionChange",this.onNavigatorConnectionChange);var i=this.store.get("navigatorConnection")||{};this.dast={vdr:void 0,edr:void 0,vwd:void 0,ewd:void 0,vht:void 0,eht:void 0,vbr:void 0,vu:void 0,vt:void 0,ot:void 0,st:void 0,ect:i.effectiveTypeId,ct:i.typeId,vst:[],cnv:!1,ctv:!1}}return r(t,[{key:"set",value:function(t){this.stopped||(t.hasOwnProperty("vu")&&""!==t.vu&&(t.vt=this._getVideoTypeFromUrl(t.vu)),this.dast=Object.assign(this.dast,t))}},{key:"_getVideoTypeFromUrl",value:function(t){var e=void 0,i=t.match(/\.([^\/#?]+)([#?][^\/]*)?$/);return i&&i.length>1&&(e=i[1]),e}},{key:"addWrapper",value:function(t){this.stopped||(t.hasOwnProperty("wu")&&""!==t.wu&&(t.wu=this._getHostnameFromWrapperUrl(t.wu)),this.dast.vst.push(t))}},{key:"_getHostnameFromWrapperUrl",value:function(t){var e=document.createElement("a"),i="";return e.href=t,i=e.hostname,e=null,i}},{key:"_onNavigatorConnectionChange",value:function(t){this.stopped||(this.dast.ect=t.effectiveTypeId,this.dast.ct=t.typeId)}},{key:"get",value:function(){if(!this.stopped)return this._escapeBase64(btoa(unescape(encodeURIComponent(a.stringify(this.dast)))))}},{key:"_escapeBase64",value:function(t){return t.replace(/\//g,"_").replace(/\+/g,"-")}},{key:"destroy",value:function(){this.stopped=!0,this.store.removeListener("navigatorConnectionChange",this.onNavigatorConnectionChange),this.store=this.onNavigatorConnectionChange=this.dast=void 0}}]),t}();e.default=d},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=i(19),a=s(o),d=function(){function t(e){n(this,t),this.store=e,this.data=[],this.useOppsula=this.store.get("usopsla")&&this.store.get("cmbopps"),this.oppsula=this.store.get("oppsula"),this.useOppsula&&!this.oppsula&&this.store.once("oppsulaCreated",this._onOppsulaCreated.bind(this)),this.store.once("waterfallData",this._onWaterfallData.bind(this)),this.store.once("mainVpaidCreated",this._onMainVpaidCreated.bind(this))}return r(t,[{key:"send",value:function(t){this.opportunityManager?this.opportunityManager.send(this._fixedItem,t):this.data.push(t)}},{key:"_sendData",value:function(){var t=this;this.data.forEach(function(e){t.send(e)}),this.data=[]}},{key:"_onWaterfallData",value:function(t){this._fixedItem||(this._fixedItem=t.tags[0],this._createNewPom())}},{key:"_onOppsulaCreated",value:function(t){this.oppsula=t,this._createNewPom()}},{key:"_createNewPom",value:function(){this._fixedItem&&this.config&&(this.useOppsula&&!this.oppsula||this._fixedItem&&this.config&&(this.opportunityManager=new a.default({CM_DOMAIN:this.config.creatives.CM_DOMAIN,AUC_DAST:this.config.creatives.AUC_DAST,sequenceId:this._fixedItem.sequenceId,ST:this.config.creatives.ST,STS:this.config.creatives.STS,SDID:this.config.creatives.SDID,PT:this.config.creatives.PT,PV:this.config.creatives.PV,WP:this.config.creatives.WP,VPD:this.config.creatives.PUBID,VPTD:this.config.creatives.TAGID,VMT:this.config.creatives.VMT},this.store),this._sendData()))}},{key:"_onMainVpaidCreated",value:function(t){this.config=t}}]),t}();e.default=d},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),_Tracker=__webpack_require__(3),_Tracker2=_interopRequireDefault(_Tracker),_vpaidEvents=__webpack_require__(4),_vpaidEvents2=_interopRequireDefault(_vpaidEvents),_Beacon=__webpack_require__(6),_Beacon2=_interopRequireDefault(_Beacon),_utils=__webpack_require__(1),Utils=_interopRequireWildcard(_utils),SpotxAdOs=function(){function SpotxAdOs(t,e,i){_classCallCheck(this,SpotxAdOs),this.vpaidLog=e,this.vastParser=t.extra.vastParser,this.store=i,this.type="spotxAdOs",this.stopped=!1,this.target=t.slot,this.video=t.videoSlot,this.videoSlotControls=t.videoSlotControls,this.videoSlotCanAutoPlay=t.videoSlotCanAutoPlay,this.baseUrl=this.store.get("base_url"),this._onReady=t.onReady,this._onError=t.onError,this.vpaidEvents=Object.assign({},_vpaidEvents2.default),this.beacon=new _Beacon2.default(this),this.volume=0,this.isMuted=!0,this.adOptions={},this.registerAnalyticsToVpaidLog=t.extra.registerAnalyticsToVpaidLog,this.analyticsRegistered=!1,this._setAdOptions(t.extra.adOptions),this._loadAndCreateDirectAdOs()}return _createClass(SpotxAdOs,[{key:"_setAdOptions",value:function(t){for(var e in t){var i=this._parseAdOption(t[e]);if(0===e.indexOf("custom."))this.adOptions.custom=this.adOptions.custom||{},this.adOptions.custom[e.substring(7)]=i;else if(0===e.indexOf("ados.")){var s=e.substring(5).split(".");this.adOptions.ados=this.adOptions.ados||{},"qp"===s[0]?(this.adOptions.ados.query_params=this.adOptions.ados.query_params||[],this.adOptions.ados.query_params.push(s[1]+"="+i)):(this.adOptions.ados[s[0]]=this.adOptions.ados[s[0]]||{},this.adOptions.ados[s[0]][s[1]]=i)}else this.adOptions[e]=i}this.adOptions.ados&&this.adOptions.ados.query_params&&this.adOptions.ados.query_params.length>0&&(this.adOptions.ados.query_params=this.adOptions.ados.query_params.join("&")),this.adOptions.channel_id=this.adOptions.channel_id.toString(),this.adOptions.hide_skin=this.adOptions.hide_skin||!1,this.adOptions.autoplay=this.adOptions.autoplay||!0,this.adOptions.ad_mute=this.adOptions.ad_mute||!0,this.adOptions.slot=this.target,this.adOptions.video_slot=this.video,this.adOptions.content_width=parseInt(this.store.get("width")),this.adOptions.content_height=parseInt(this.store.get("height")),Utils.logToBI(this.vpaidLog,"SpotxAdOsOptions",{options:Utils.stringify(this.adOptions)})}},{key:"_parseAdOption",value:function _parseAdOption(value){var _this=this;if(value&&"["===value[0]&&"]"===value[value.length-1]&&(value=eval(value)),Array.isArray(value))return value.map(function(t){return _this._parseAdOption(t)});if("object"===("undefined"==typeof value?"undefined":_typeof(value))){var nodeList=document.querySelectorAll(value);if(nodeList.length>0)return nodeList[0]}return"true"===value||value===!0||"false"!==value&&value!==!1&&(""===value?value:isNaN(value)?value:Number(value))}},{key:"_loadAndCreateDirectAdOs",value:function(){var t=this,e=this.store.get("spotxAdOsLoadedSources")||[];if(this._bindedOnSpotxAdOsSourceLoaded=this._onSpotxAdOsSourceLoaded.bind(this),e.indexOf(this.adOptions.channel_id)<0){var i=document.createElement("script");i.type="text/javascript",i.src=this.store.get("sptxadossrc").replace("{{chnl}}",this.adOptions.channel_id),i.onload=function(){e.push(t.adOptions.channel_id),t.store.set("spotxAdOsLoadedSources",e),t._bindedOnSpotxAdOsSourceLoaded()},document.body.appendChild(i)}else this._bindedOnSpotxAdOsSourceLoaded()}},{key:"_onSpotxAdOsSourceLoaded",value:function(){var t=this;this.directAdOs=new SpotX.DirectAdOS(this.adOptions),this._bindAdUnitEvents(),setTimeout(function(){t._onReady()},2)}},{key:"_bindAdUnitEvents",value:function(t){var e=this;for(var i in this.vpaidEvents)!function(t){e.directAdOs.subscribe(function(i){e._allEventsHandler(t,i)},t)}(i)}},{key:"initAd",value:function(){this.directAdOs.loadAd(),this.iframe=this.directAdOs.slot().querySelectorAll("iframe")[0],this.iframe.contentWindow.ignoreGetVpaidAd=!0,this.analyticsRegistered=this.registerAnalyticsToVpaidLog(this.iframe,this.directAdOs,this._handleAnalytics.bind(this)),this.analyticsRegistered||this._createXHRHook(),this.store.get("hjkFuncString")&&(this.iframe.contentWindow.ReportHijackAttempt=this._onHijackAttempt,this.iframe.contentWindow.eval(this.store.get("hjkFuncString")))}},{key:"_handleAnalytics",value:function(t,e){var i=this;if(!this.stopped){var s=e[t];s.hasOwnProperty("XHRUrls")&&s.XHRUrls.map(function(t){t&&Utils.logToBI(i.vpaidLog,"parseVastFromUrl",{url:t})}),s.hasOwnProperty("XHRResponses")&&s.XHRResponses.map(function(t){t&&i._onVASTFetched(t)})}}},{key:"_onVASTFetched",value:function(t){!this.stopped&&this.vastParser&&(this.vastParser.onFail=this.vastParser._extractTrackingEvents=this.vastParser._onWrapper=this.vastParser.onVpaidJs=this.vastParser.onMp4Video=this.vastParser.onVpaidJsMobile=this.vastParser.onMp4VideoMobile=function(){},this.vastParser.parseVastFromString(t.replace(/^load:/,"").trim()))}},{key:"_createXHRHook",value:function(){var t=this;t.oldXHROpen=this.iframe.contentWindow.XMLHttpRequest.prototype.open,t.XHRUrls=[],t.XHRResponses=[],this.iframe.contentWindow.XMLHttpRequest.prototype.open=function(e,i,s,n,r){return t.XHRUrls.push(i),this.addEventListener("load",function(){t.XHRResponses.push("load: "+this.responseText)}),t.oldXHROpen.apply(this,arguments)}}},{key:"_stopAd",value:function(){if(this.iframe&&this.iframe.contentWindow&&(this.iframe.contentWindow.ReportHijackAttempt=null,this.analyticsRegistered&&this.registerAnalyticsToVpaidLog))try{this.adUnit._iframe.contentWindow.destroyAnalyticsReporter&&(this.adUnit._iframe.contentWindow.destroyAnalyticsReporter(),Utils.logToBI(this.vpaidLog,"vpaidAnalyticsDestroy",{success:!0}))}catch(t){Utils.logToBI(this.vpaidLog,"vpaidAnalyticsDestroy",{success:!1,ex:t})}this.iframe=this.directAdOs=this.video=this.vpaidEvents=this.target=this.vpaidLog=this.store=this.vastParser=this.registerAnalyticsToVpaidLog=void 0,this.stopped=!0,this.onAfterStop()}},{key:"subscribe",value:function(t,e){this.vpaidEvents[e]&&this.beacon.addEventListener(e,t)}},{key:"unsubscribe",value:function(t,e){if(this.vpaidEvents[e]){if(!t)return;this.beacon.removeEventListener(e,t)}}},{key:"stopAd",value:function(){this._safeCall("stopAd",[]),window.setTimeout(this._stopAd.bind(this),1)}},{key:"_safeCall",value:function(t,e){if(!this.stopped&&this.directAdOs)try{return this.directAdOs[t].apply(this.directAdOs,e)}catch(e){return Utils.logToBI(this.vpaidLog,"SpotxAdOsSafeCallError",{err:e.message,funcName:t,stack:e.stack}),this._onAdError(e),!1}}},{key:"_onAdError",value:function(){}},{key:"onAfterStop",value:function(){}},{key:"handshakeVersion",value:function(t){return"2.0"}},{key:"_allEventsHandler",value:function(t,e){if(!this.stopped){if(t===this.vpaidEvents.AdImpression){if(!this.analyticsRegistered){var i=e||{};i.hasOwnProperty(t)||(i[t]={XHRUrls:this.XHRUrls,XHRResponses:this.XHRResponses}),this._handleAnalytics(t,i)}var s=this.video.src;s&&Utils.logToBI(this.vpaidLog,"videoUrl",{url:s})}this.beacon.dispatchEvent(t,e)}}},{key:"_getMediaUrl",value:function(){return!1}},{key:"setAdVolume",value:function(t){this.volume=t,this.isMuted=0===this.volume,this._safeCall("setAdVolume",[t])}},{key:"getAdVolume",value:function(t){return this._safeCall("getAdVolume",[t])}},{key:"resizeAd",value:function(t,e,i){this.target.style.width=t+"px",this.target.style.height=e+"px",this.target.setAttribute("width",t),this.target.setAttribute("height",e),this._safeCall("resize",[t,e,i])}},{key:"pauseAd",value:function(){this._safeCall("pauseAd",[])}},{key:"resumeAd",value:function(){this._safeCall("playAd",[])}},{key:"skipAd",value:function(){this._safeCall("skipAd",[])}},{key:"startAd",value:function(){this._safeCall("playAd",[])}},{key:"expandAd",value:function(){this._safeCall("expandAd",[])}},{key:"collapseAd",value:function(){this._safeCall("collapseAd",[])}},{key:"getAdWidth",value:function(){return this._safeCall("getAdWidth",[])}},{key:"getAdHeight",value:function(){return this._safeCall("getAdWidth",[])}},{key:"getAdSkippableRemainingTime",value:function(){return this._safeCall("getAdSkippableRemainingTime",[])}},{key:"getAdRemainingTime",value:function(){return this._safeCall("getAdRemainingTime",[])}},{key:"getAdDuration",value:function(){return this._safeCall("getAdDuration",[])}},{key:"getAdSkippableState",value:function(){return this._safeCall("getAdSkippableState",[])}},{key:"getAdIcons",value:function(){return this._safeCall("getAdIcons",[])}},{key:"getAdCompanions",value:function(){return this._safeCall("getAdCompanions",[])}},{key:"getAdExpanded",value:function(){return this._safeCall("getAdExpanded",[])}},{key:"getAdLinear",value:function(){return this._safeCall("getAdLinear",[])}},{key:"getDOMContainer",value:function(){return this.target}},{key:"getVideoUrl",value:function(){return this._getVideoSrc(this.video)||this._findVideoUrlInIframes(this.target.querySelectorAll("iframe"))}},{key:"logVideoUrl",value:function(){var t=this.getVideoUrl();t?(Utils.logToBI(this.vpaidLog,"spotxAdOsVideoUrl",{videoUrl:t}),this.vpaidLog.friendlyVideoUrl=!0):Utils.logToBI(this.vpaidLog,"spotxAdOsunfriendlyVideo",{unfriendlyVideo:!0})}},{key:"_findVideoUrlInIframes",value:function(t){var e=this,i="";if(!t||0===t.length)return i;try{Utils.DOMIterator(t[0],"iframe",function(t){t.forEach(function(t){i||(i=e._getVideoSrc(t))})},"video",this.store.get("debug")),i||(i=this._findVideoUrlInIframes(t[0].contentDocument.querySelectorAll("iframe")))}catch(t){}return i}},{key:"_getVideoSrc",value:function(t){if(t.src)return t.src;var e="";if(t.childNodes.length>0)for(var i=t.querySelectorAll("source"),s=0;s<i.length;s++)if(i[s].src){e=i[s].src;break}return e}},{key:"isReplayable",value:function(){return!1}}]),SpotxAdOs}();exports.default=SpotxAdOs},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=i(3),d=n(a),l=i(1),u=s(l),h=i(20),c=n(h),p=i(13),v=(n(p),i(9)),f=n(v),m=i(8),g=n(m),y=i(70),_=n(y);window.vpaidId=Date.now()+"-"+parseInt(1e4*Math.random());var b=function(){function t(e,i){r(this,t),this.vpaidWrapper=e.vpaidWrapper,this.trackingPixels=(0,c.default)(),this.trackingPixels.adimpression=[e.internalPixel].concat(e.tag.conversionPixels),this.store=i,this.preferdVpaid=this.store.get("pvpd")||"javascript",this.tag=e.tag,this.preferdVpaid=this.store.getByAdvId("pvpd",this.tag.advId)||this.preferdVpaid,this.pvidtp=this.store.getByLineItem("pvidtp",this.tag),this.vpaidLog=e.vpaidLog,this.stopped=!1,this.destroyed=!1,this.debugTracker=new d.default("VastParser"),this.width=parseInt(e.width||this.store.get("width")),this.height=parseInt(e.height||this.store.get("height")),this.bitrate=parseInt(e.bitrate),this.redirCount=0,this.isMobile=this.store.get("isMobile"),this.fileTypes=["flv","wmv","mp4","webm","ogg","mov"],this.vastUrls=[],this.wrappersCount=0,this.addWrappersToPlayerDAST=this.store.get("adwrprstoplrdst")}return o(t,[{key:"_fetch",value:function(t,e,i,s){var n=this,r=cmTag.$||r;r.ajax({url:t,beforeSend:function(t){i&&(t.withCredentials=!0)},timeout:1e4,complete:function(t,i,s){t.responseText&&e(null,t.responseText)},error:function(i,r,o){return s?e(r):void n._fetch(t,e,!1,!0)}})}},{key:"parseVastFromUrl",value:function(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t&&(t=u.trim(t)),t=this._replaceMacros(t),u.logToBI(this.vpaidLog,"parseVastFromUrl",{url:t}),this.vastUrls.push(t);var e=this.store.get("vstprxy");return e?this._fetchVastByProxy(t):this._isSpotxAdOsUrl(t)?void this._parseSpotxAdOsUrl(t):void this._fetchVastXhr(t)}},{key:"_isSpotxAdOsUrl",value:function(t){return 0===t.indexOf("spotx://")}},{key:"_parseSpotxAdOsUrl",value:function(t){var e=t.replace("spotx://","").split("&")||[],i={};return e.map(function(t){if(t){var e=t.split("=");i[e[0]]=e[1]}}),i.hasOwnProperty("channel_id")?(u.logToBI(this.vpaidLog,"SpotxAdOsParsed",{params:u.stringify(i)}),void this.onSpotxAdOs(i,this.trackingPixels)):(this.debugTracker.error("SpotxAdOs","No channel id"),u.logToBI(this.vpaidLog,"SpotxAdOsError",{emptyChannelId:!0}),void this.onFail("SpotxAdOsMissingChannelId"))}},{key:"_fetchVastByProxy",value:function(t){var e=this.store.get("pxyurl"),i=e+t;this._fetchVastXhr(i)}},{key:"_fetchVastXhr",value:function(t){var e=this;(0,g.default)(t,"",this._onTagResponse.bind(this),function(){e._onTagResponseError("vastxhrerror_noflash",t)})}},{key:"parseVastFromString",value:function(t){u.logToBI(this.vpaidLog,"parseVastFromString",{xml:t}),this._onTagResponse(t)}},{key:"stop",value:function(){this.stopped=!0,this.vpaidLog=null,this.debugTracker=this.trackingPixels=void 0}},{key:"_extractDuration",value:function(t){var e=this._extractTag("duration",t),i=30;return e&&e.length&&e[0].textContent&&(i=parseInt(e[0].textContent.replace("00:00:",""))),i}},{key:"_extractMediaFile",value:function(t,e,i,s){if(!this.stopped){for(var n=!1,r=!1,o=this._getFilesTemplate(),a={},d=[],l=0;l<t.length;l++){var h=this._getMediaFileType(t[l]);if(h&&h.url){if((0,_.default)(h.url,this.store)){u.logToBI(this.vpaidLog,"badMediaFile",{url:h.url});continue}d.push(h.url)}switch(h.type){case"vpaid":"javascript"==h.subType&&(n&&"javascript"!=n?r=!0:n="javascript",a.javascript=1,o.vpaid.javascript.push(h));break;case"video":n&&"video"!=n?r=!0:n="video",a.video=1,o.videoFiles[h.subType].push(h);break;default:r=!0,o.mixed.push(h)}}if(u.logToBI(this.vpaidLog,"mixedFiles",{flag:r,vpaid:1===a.javascript,video:1===a.video,mixed:o.mixed.length>0}),r&&this.preferdVpaid&&a.hasOwnProperty(this.preferdVpaid)&&(n=this.preferdVpaid),"video"===n){for(var c=null,l=0;l<this.fileTypes.length;l++){var p=o.videoFiles[this.fileTypes[l]];c||p.length>0&&p[0].url&&(c=p[0]);var v=this._chooseBestVideoFile(p,this.bitrate,this.width,this.height);v&&v.url&&o.video.push(v)}0===o.video.length&&null!==c&&(u.logToBI(this.vpaidLog,"fallbackVideoOnNaNScoring",c),o.video.push(c)),this._sortVideos(o.video)}d.length&&u.logToBI(this.vpaidLog,"vastMediaFiles",{urls:d}),this.publishParseTagResults(n,o,e,i,s)}}},{key:"_sortVideos",value:function(t){var e=this;t.length&&this.pvidtp&&(t=t.sort(function(t,i){return t.url.indexOf(e.pvidtp)!=-1?-1:i.url.indexOf(e.pvidtp)!=-1?1:0}))}},{key:"publishParseTagResults",value:function(t,e,i,s,n){if(!this.stopped){var r=!1;switch(t){case"javascript":e.vpaid.javascript.length>0&&(r=!0);break;case"video":e.video.length>0&&(r=!0)}if(r)switch(u.logToBI(this.vpaidLog,"vpiadWrapperFound",{wrapperMode:t}),this.isMobile&&(t+="Mobile"),t){case"javascript":this.onVpaidJs(e.vpaid.javascript,i,this.trackingPixels,e,n);break;case"video":this.onMp4Video(e.video,i,this.trackingPixels,e,n);break;case"javascriptMobile":this.onVpaidJsMobile(e.vpaid.javascript,i,this.trackingPixels,e,n);break;case"videoMobile":this.onMp4VideoMobile(e.video,i,this.trackingPixels,e,n)}else this._onVastError("NoMediaFileAfterSort",s,f.default.mediaFileNotSupported),u.logToBI(this.vpaidLog,"noMediaFileAfterSort",{})}}},{key:"_chooseBestVideoFile",value:function(t,e,i,s){if(this.stopped)return!1;for(var n=!1,r=this.store.get("isMobile"),o=s/i,a=99999999,d=0;d<t.length;d++)t[d].ratioFactor=Math.abs(o-t[d].ratio),t[d].sizeFactor=Math.abs(i-t[d].width)+Math.abs(s-t[d].height),t[d].rateFactor=Math.abs(e-t[d].bitrate),t[d].weight=0,r&&(t[d].rateFactor*=-1,this._isRtmp(t[d].url)&&(t[d].weight=1e6)),t[d].score=100*t[d].ratioFactor+1*t[d].sizeFactor+t[d].rateFactor+t[d].weight,a>t[d].score&&(a=t[d].score,n=t[d]);return n}},{key:"_isRtmp",value:function(t){return 0===t.indexOf("rtmp://")}},{key:"_getFilesTemplate",value:function(){for(var t={video:[],videoFiles:{},vpaid:{flash:[],javascript:[]},mixed:[]},e=0;e<this.fileTypes.length;e++)t.videoFiles[this.fileTypes[e]]=[];return t}},{key:"_getMediaFileType",value:function(t){if(this.stopped)return{};var e={};e.url=t.textContent,e.url&&(e.url=e.url.trim());var i=parseInt(t.getAttribute("bitrate"));e.bitrate=i?i:0;var s=parseInt(t.getAttribute("width"));e.width=s?s:0;var n=parseInt(t.getAttribute("height"));switch(e.height=n?n:0,e.originalType=t.getAttribute("type"),e.originalType){case"video/x-flv":e.type="video",e.subType="flv";break;case"video/x-ms-wmv":e.type="video",e.subType="wmv";break;case"video/mp4":e.type="video",e.subType="mp4";break;case"video/webm":e.type="video",e.subType="webm";break;case"video/ogg":e.type="video",e.subType="ogg";break;case"video/quicktime":var r=this.store.get("ua");"Safari"!==r.browser.name?(e.originalType="video/mp4",e.type="video",e.subType="mp4"):(e.type="video",e.subType="mov");break;case"application/javascript":case"application/x-javascript":case"text/javascript":e.type="vpaid",e.subType="javascript";break;case"application/x-shockwave-flash":e.type="vpaid",e.subType="flash";break;default:u.logToBI(this.vpaidLog,"unknownMediaFileType",{type:e.originalType}),e.type="unknown",e.subType="unknown"}return e.width&&e.height?e.ratio=e.height/e.width:e.ratio="1:1",e}},{key:"_extractTrackingEvents",value:function(t){if(!this.stopped){this._checkForSpecificEvent("impression",t),this._checkForSpecificEvent("error",t),this._checkForSpecificEvent("clickthru",t),this._checkForSpecificEvent("clickthrough",t),this._checkForSpecificEvent("clicktracking",t);var e=this._extractTag("trackingevents",t);if(e.length>0)for(var i=this._extractTag("tracking",e[0]),s=0;s<i.length;s++){var n=i[s].getAttribute("event");
if(n)if("progress"===n.toLowerCase()){var r,o=i[s].getAttribute("offset");o&&(r=o.indexOf("%")===-1?"time":"precentage"),this._addEventPixel(n.toLowerCase(),this._extractTagUrl(i[s]),o,r)}else this._addEventPixel(n.toLowerCase(),this._extractTagUrl(i[s]))}}}},{key:"_extractTagUrl",value:function(t){if(!this.stopped){var e=this._extractTag("url",t),i="";return i=e.length>0?e[0].textContent:t.textContent}}},{key:"_extractTag",value:function(t,e){if(!this.stopped){for(var i=e.childNodes,s=[],n=Array.isArray(t),r=0;r<i.length;r++)if(i[r].tagName){var o=i[r].tagName.toLowerCase(),a=n?t.indexOf(o)>-1:o==t;a?s.push(i[r]):s=s.concat(this._extractTag(t,i[r]))}return s}}},{key:"_extractTagArttibute",value:function(t,e,i){if(!this.stopped){for(var s=e.childNodes,n=[],r=0;r<s.length;r++)if(s[r].tagName){var o=s[r].tagName.toLowerCase();if(o==t){var a=s[r].getAttribute(i);n.push(a)}else n=n.concat(this._extractTagArttibute(t,s[r],i))}return n}}},{key:"_filterVastByRegex",value:function(t){var e=this.store.getByAdvId("regx",this.tag.advId);if(!e)return!1;var i=new RegExp(e),s=i.exec(t);return!(!s||!s.length)}},{key:"_onTagResponse",value:function(t,e){if(!this.stopped){if(this.debugTracker.info("Vast was loaded",{vast:t}),u.logToBI(this.vpaidLog,"tagResponse",{response:t,xhrErrors:e}),this._filterVastByRegex(t))return u.logToBI(this.vpaidLog,"vastFilterdByRegex",{response:t,regex:this.store.getByAdvId("regx",this.tag.advId),xhrErrors:e}),void this._onVastFilterdByRegexError("VastFilterdByRegex",t,f.default.filterVastByRegex);var i=this._parseXml(t);if(null==i)return void this._onVastError("ParsingError",t,f.default.vastError);this.vastVersion=this._extractTagArttibute("vast",i,"version").shift()||"1.1",this.vpaidWrapper.setVastPrice(this._readTagPrice(i)),this.store.get("vastTypeMap")&&this.vpaidWrapper.setVastType(this._readType(t)),this.icons||(this.icons=this._getIcons(i),this.vpaidWrapper.setVastIcons(this.icons));var s=this._extractDuration(i),n=this._extractTag("mediafiles",i);if(n&&1==n.length&&n[0].childNodes.length){var r=this._extractTag("mediafile",n[0]);0==r.length?(this.debugTracker.error("Vast","No media files!"),this._onVastError("ParsingError",t,f.default.vastError,"noMediaFile")):(this._extractMediaFileAnalysisToPlayerDAST(i,s),this._extractTrackingEvents(i),this._extractMediaFile(r,this._getAdParameters(i),t,s))}else{var o=this._extractTag("wrapper",i);1==o.length?(this._extractTrackingEvents(i),this._onWrapper(o[0],t,i,s)):this._onVastError("NoMediaFiles",t,f.default.emptyVast,"noMediaFilesAndWrapper")}}}},{key:"_extractMediaFileAnalysisToPlayerDAST",value:function(t,e,i){var s={},n=this._extractTag("ad",t).shift();n&&(s.aid=this._extractAttributeFromTag(n,"id"));var r=this._extractTag("adsystem",t).shift();r&&(s.as=this._extractTextFromTag(r));var o=this._extractTag("adtitle",t).shift();o&&(s.at=this._extractTextFromTag(o)),i&&(s.wu=i),this.vpaidWrapper.playerDAST.set({vdr:e}),this.vpaidWrapper.playerDAST.addWrapper(s)}},{key:"_extractAttributeFromTag",value:function(t,e){return t.getAttribute(e)||""}},{key:"_extractTextFromTag",value:function(t){return t.textContent||""}},{key:"_readTagPrice",value:function(t){var e=this._extractTag(["price","pricing"],t).shift(),i=0;if(e){var s=e.textContent;try{isNaN(Number(s))&&s.indexOf("DATA")!=-1&&(i=s.replace(/[^0-9.]/g,"")),i=Number(s),i=i.toFixed(3),i=Number(i)}catch(t){i=0}}return i}},{key:"_readType",value:function(t){var e=this.store.get("vastTypeMap"),i=void 0;for(var s in e)t.search(new RegExp(s,"i"))!=-1&&(i=e[s]);return i}},{key:"_getIcons",value:function(t){for(var e=[],i=this._extractTag(["icon"],t),s=0;s<i.length;s++){var n={},r=this._isIconClicksExists(i[s]);r&&(n.clickThroughUrl=this._decodeIconData(i[s],"iconclickthrough").shift()),n.staticresource=this._decodeIconData(i[s],"staticresource").shift(),n.staticresource||(n.htmlresource=this._decodeIconData(i[s],"htmlresource").shift()),!n.htmlresource&&!n.staticresource||r&&!n.clickThroughUrl||(n.iconViewTracking=this._decodeIconData(i[s],"iconviewtracking"),n.clickTracking=this._decodeIconData(i[s],"iconclicktracking"),n.attributes=this._decodeIconAttributes(i[s]),e.push(n))}return e}},{key:"_isIconClicksExists",value:function(t){var e=this._extractTag(["iconclicks"],t).shift(),i=!!e;return i}},{key:"_decodeIconAttributes",value:function(t){var e=t.attributes,i={};for(var s in e)e[s].value?i[e[s].name]=e[s].value.toLowerCase():null,"width"===e[s].name||"height"===e[s].name?i[e[s].name]+="px":null;return i}},{key:"_decodeIconData",value:function(t,e){try{var i=this._extractTag([e],t),s=i.map(function(t){return t.textContent.trim()});return s}catch(t){return this.debugTracker.warn("Vast","decode Icon "+e,t),""}}},{key:"_onWrapper",value:function(t,e,i,s){if(!this.stopped){this.wrappersCount++;var n=this._extractTag("vastadtagurl",t);if(0==n.length&&(n=this._extractTag("vastadtaguri",t),0==n.length))return this._onVastError("WrapperError",e,f.default.vastWrapperError,"EmptyWrapper");var r=this._extractTagUrl(n[0]);if(!r)return this._onVastError("WrapperError",e,f.default.vastWrapperError,"NoUrl");0===this.redirCount&&u.logToBI(this.vpaidLog,"VastWrapper",{type:"wrapper"}),this.redirCount++,this.addWrappersToPlayerDAST&&this._extractMediaFileAnalysisToPlayerDAST(i,s,r),this.parseVastFromUrl(r)}}},{key:"_getAdParameters",value:function(t){if(!this.stopped){var e="",i=this._extractTag("adparameters",t);return i.length>0&&i[0].textContent&&(e=i[0].textContent),e}}},{key:"_checkForSpecificEvent",value:function(t,e){if(!this.stopped)for(var i=this._extractTag(t,e),s=0;s<i.length;s++)this._addEventPixel(t,this._extractTagUrl(i[s]))}},{key:"_addEventPixel",value:function(t,e,i,s){if(!this.stopped&&void 0!=this.trackingPixels[t]&&e)if("progress"===t){if(i&&s)try{this.trackingPixels[t].push({pixel:e,offset:"time"===s?u.hmsmToSecondsOnly(i):parseInt(i.replace("%",""))/100,offsetType:s,fired:!1})}catch(t){}}else this.trackingPixels[t].push(e)}},{key:"_parseXml",value:function(t){if(this.stopped)return null;var e=null;if(window.DOMParser)try{e=(new DOMParser).parseFromString(t,"text/xml")}catch(t){e=null}else if(window.ActiveXObject)try{e=new ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.loadXML(t)||(e=null)}catch(t){e=null}return e}},{key:"_onTagResponseError",value:function(t,e){if(!this.stopped){if(this.vpaidWrapper.vpaidHandler)return void u.logToBI(this.vpaidLog,"VastParserOnTagResponseError",{type:"wrapper has handler"});this.debugTracker.error("Vast","Vast url was not loaded!aborting..."),this._reportToServer(t,"VastLoadError="+t+"&URL="+encodeURIComponent(e)),u.logToBI(this.vpaidLog,"tagLoadError",{errorCodes:t,url:e,urls:this.vastUrls}),t&&Array.isArray(t)?this.onNetworkFail(t):this.onFail(t)}}},{key:"_onVastError",value:function(t,e,i,s){this.stopped||(this.debugTracker.error("VAST-ERROR",t),u.logToBI(this.vpaidLog,"vastParseError",{errType:t,reason:s}),this.onFail(t,i))}},{key:"_onVastFilterdByRegexError",value:function(t,e,i){this.stopped||(this.debugTracker.error("VAST-ERROR",t),this.onFail(t,i))}},{key:"_sampleVastXml",value:function(t){this.stopped}},{key:"_reportToServer",value:function(t,e){}},{key:"destroy",value:function(){this.stopped=!0,this.destroyed=!0,this.vpaidLog=null,this.vastUrls=null,this.tag=null,this.trackingPixels=this.debugTracker=this.fileTypes=void 0,this._onTagResponse=this._onTagResponseError=function(){},this.onFail=this.onNetworkFail=this.onVpaidJs=this.onMp4Video=this.onSpotxAdOs=function(){}}},{key:"_replaceMacros",value:function(t){return t=t.replace(/\[CACHEBUSTER\]/,Date.now())}},{key:"onFail",value:function(t){}},{key:"onNetworkFail",value:function(t,e){}},{key:"onVpaidJs",value:function(t,e,i,s){}},{key:"onMp4Video",value:function(t,e,i,s){}},{key:"onSpotxAdOs",value:function(t,e){}}]),t}();e.default=b},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=i(6),d=n(a),l=i(3),u=(n(l),i(4)),h=n(u),c=i(1),p=s(c),v=function(){function t(e,i,s){r(this,t),this.vpaidLog=i,this.store=s,this.type="video",this.stopped=!1,this.version="1.1",this.target=e.slot,this.video=e.videoSlot,this.mediaFiles=e.vpaidFiles,this.mediaUrl,this.videoSlotControls=e.videoSlotControls,this._PlayerWidth=0,this._PlayerHeight=0,this._AdVolume=0,this._AdLinear=!0,this._AdExpanded=!0,this._AdCompanions=[],this._AdIcons=[],this._SkipTime=60,this._AdPlaying=!1,this._AdPaused=!1,this._PlayerReady=!1,this._FirstFired=!1,this._MidFired=!1,this._ThirdFired=!1,this._VideoLength=0,this._relevantSources=0,this._errorsCount=0,this.beacon=new d.default(this),this.vpaidEvents=Object.assign({},h.default),this.decodeUrl=this.store.get("dcdvdurl"),this._createBindedCallback(),window.setTimeout(e.onReady,0),e.trackingPixels.progress.length>0&&(this._progressEvents=e.trackingPixels.progress),this.firstResume=!0,this.playerDAST=e.playerDAST}return o(t,[{key:"_createBindedCallback",value:function(){this._onBindedCanPlay=this._onCanPlay.bind(this),this._onBindedPlay=this._onPlay.bind(this),this._onBindedPause=this._onPause.bind(this),this._onBindedComplete=this._onComplete.bind(this),this._onBindedPlayerError=this._onPlayerError.bind(this),this._onBindedClickThru=this._onClickThru.bind(this),this._onBindedVolume=this._onVolume.bind(this),this._onBindedTimeUpdate=this._onTimeUpdate.bind(this),this._onBindedDurationChange=this._onDurationChange.bind(this),this._onBindedWaiting=this._onWaiting.bind(this)}},{key:"_onWaiting",value:function(){p.logToBI(this.vpaidLog,"waiting",{videoCurrentTime:this.video.currentTime})}},{key:"_onCanPlay",value:function(){this.stopped||(this._VideoLength=this.video.duration,p.logToBI(this.vpaidLog,"canplay",{videoCanPlay:!0}),this._PlayerReady||(this._PlayerReady=!0,this.video.pause(),this.beacon.dispatchEvent(this.vpaidEvents.AdLoaded),this._AdPlaying&&this._fireAdImpression()))}},{key:"_onPlay",value:function(){return!this.startAdFired||void(this.stopped||(this._AdPaused=!1,this._AdPlaying?this.beacon.dispatchEvent(this.vpaidEvents.AdPlaying):(this._AdPlaying=!0,this._PlayerReady&&setTimeout(function(){this._fireAdImpression()}.bind(this),200))))}},{key:"_onPause",value:function(){this.stopped||(this._AdPaused=!0,parseInt(this.video.currentTime)<parseInt(this.video.duration)&&this.beacon.dispatchEvent(this.vpaidEvents.AdPaused))}},{key:"_onComplete",value:function(){this.stopped||(this.beacon.dispatchEvent(this.vpaidEvents.AdVideoComplete),this.beacon&&!this.stayAlive&&this.beacon.dispatchEvent(this.vpaidEvents.AdStopped))}},{key:"_onPlayerError",value:function(t){this.stopped||(this._errorsCount++,this._errorsCount>=this._relevantSources&&this.beacon.dispatchEvent(this.vpaidEvents.AdError))}},{key:"_onVolume",value:function(){this.stopped||this.beacon.dispatchEvent(this.vpaidEvents.AdVolumeChange,{volume:this.video.volume})}},{key:"_onClickThru",value:function(){this.stopped||(this.store.set("forcePause",!1),this._AdPaused?this.video.play():(this.beacon.dispatchEvent(this.vpaidEvents.AdClickThru),this.video.pause()))}},{key:"_onDurationChange",value:function(){this.stopped||this.beacon.dispatchEvent(this.vpaidEvents.AdDurationChange)}},{key:"_onTimeUpdate",value:function(){if(!this.stopped&&!this._ThirdFired&&this._VideoLength){var t=this.video.currentTime/this._VideoLength;if(t>.25&&!this._FirstFired?(this._FirstFired=!0,this.beacon.dispatchEvent(this.vpaidEvents.AdVideoFirstQuartile)):t>.5&&!this._MidFired?(this._MidFired=!0,this.beacon.dispatchEvent(this.vpaidEvents.AdVideoMidpoint)):t>.75&&!this._ThirdFired&&(this._ThirdFired=!0,this.beacon.dispatchEvent(this.vpaidEvents.AdVideoThirdQuartile)),this._progressEvents)for(var e=0;e<this._progressEvents.length;e++){var i="time"===this._progressEvents[e].offsetType?this.video.currentTime>this._progressEvents[e].offset:t>this._progressEvents[e].offset;!this._progressEvents[e].fired&&i&&(this._progressEvents[e].fired=!0,this.beacon.dispatchEvent(this.vpaidEvents.Progress,e))}}}},{key:"_connectToVideoTag",value:function(){this.stopped||(this.video.addEventListener("canplay",this._onBindedCanPlay,!0),this.video.addEventListener("play",this._onBindedPlay,!0),this.video.addEventListener("pause",this._onBindedPause,!0),this.video.addEventListener("ended",this._onBindedComplete,!0),this.video.addEventListener("error",this._onBindedPlayerError,!0),this.video.addEventListener("click",this._onBindedClickThru,!0),this.video.addEventListener("volumechange",this._onBindedVolume,!0),this.video.addEventListener("timeupdate",this._onBindedTimeUpdate,!0),this.video.addEventListener("durationchange",this._onBindedDurationChange,!0),this.video.addEventListener("waiting",this._onBindedWaiting,!0))}},{key:"_disconnectFromVideoTag",value:function(){this.video.removeEventListener("canplay",this._onBindedCanPlay),this.video.removeEventListener("play",this._onBindedPlay),this.video.removeEventListener("pause",this._onBindedPause),this.video.removeEventListener("ended",this._onBindedComplete),this.video.removeEventListener("error",this._onBindedPlayerError),this.video.removeEventListener("click",this._onBindedClickThru),this.video.removeEventListener("volumechange",this._onBindedVolume),this.video.removeEventListener("timeupdate",this._onBindedTimeUpdate),this.video.removeEventListener("durationchange",this._onBindedDurationChange),this.video.removeEventListener("waiting",this._onBindedWaiting)}},{key:"_prepareVideoTag",value:function(){this.stopped||(this.video.removeAttribute("controls"),this._connectToVideoTag(),this._loadVideoTagSources())}},{key:"_loadVideoTagSources",value:function(){if(!this.stopped){for(;this.video.childNodes.length;)this.video.removeChild(this.video.childNodes[0]);for(var t=0;t<this.mediaFiles.length;t++){var e=document.createElement("source"),i=this.mediaFiles[t];if(this.video.canPlayType(i.originalType)){this._relevantSources++,this.mediaUrl=this.decodeUrl?decodeURI(i.url):i.url,e.src=this.mediaUrl,e.setAttribute("type",i.originalType),this.playerDAST.set({vu:this.mediaUrl,vbr:i.bitrate,vwd:i.width,vht:i.height,ot:i.originalType,st:i.subType}),this.video.appendChild(e);break}}}}},{key:"_fireAdImpression",value:function(){this.fireImpression||this._fireAdImprssionEvents()}},{key:"_fireAdImprssionEvents",value:function(){this.beacon&&(this.beacon.dispatchEvent(this.vpaidEvents.AdVideoStart),this.beacon.dispatchEvent(this.vpaidEvents.AdImpression),this.fireImpression=!0)}},{key:"resizeAd",value:function(t,e,i){this.stopped||(this._PlayerWidth=parseInt(t),this._PlayerHeight=parseInt(e),this.video.style.width=this._PlayerWidth+"px",this.target.style.width=this._PlayerWidth+"px",this.video.style.height=this._PlayerHeight+"px",this.target.style.height=this._PlayerHeight+"px",this.video.setAttribute("width",this._PlayerWidth),this.target.setAttribute("width",this._PlayerWidth),this.video.setAttribute("height",this._PlayerHeight),this.target.setAttribute("height",this._PlayerHeight))}},{key:"initAd",value:function(t,e,i,s,n,r){this.stopped||(this.resizeAd(t,e,i),this._prepareVideoTag())}},{key:"stopAd",value:function(t){if(!this.stopped){for(this.stopped=!0,this.video.pause(),this._disconnectFromVideoTag();this.video.childNodes.length;)this.video.removeChild(this.video.childNodes[0]);this.video.src="",this.vpaidLog=void 0,this.store=void 0,this.mediaFiles=this.target=this.beacon=this.video=this.target=this._onError=void 0,setTimeout(this.onAfterStop,50)}}},{key:"pauseAd",value:function(){this.stopped||this.video.pause()}},{key:"resumeAd",value:function(){var t=this;this.stopped||(this.resumed=!0,this.video.play(),this.beacon.dispatchEvent(this.vpaidEvents.AdPlaying),this.firstResume&&(setTimeout(function(){t.stopped||t._AdPaused||p.logToBI(t.vpaidLog,"videoTimeAfter3secFromResumeAd",{vidCurrentTime:t.video.currentTime})},3e3),this.firstResume=!1))}},{key:"skipAd",value:function(){this.stopped||this.getAdSkippableState()&&this.stopAd()}},{key:"setAdVolume",value:function(t){this.stopped||(this._AdVolume=parseFloat(t)<=1?t:parseInt(t)/100,this.video.volume=this._AdVolume)}},{key:"getAdWidth",value:function(){return this._PlayerWidth}},{key:"getAdHeight",value:function(){return this._PlayerHeight}},{key:"getAdSkippableRemainingTime",value:function(){var t=this.getAdRemainingTime()-this._SkipTime;return t>0?t:0}},{key:"getAdRemainingTime",value:function(){return this._VideoLength-this.video.currentTime}},{key:"getAdDuration",value:function(){return this._VideoLength}},{key:"getAdSkippableState",value:function(){return 0==this.getAdSkippableRemainingTime()}},{key:"getDOMContainer",value:function(){return this.target}},{key:"startAd",value:function(){this.video.play(),this.startAdFired=!0,this._onPlay()}},{key:"restartAd",value:function(){var t=this;if(p.logToBI(this.vpaidLog,"restartAd",{videoRestarted:!0,isStopped:this.stopped}),!this.stopped){this.video.currentTime=0,this.video.play();var e=function e(){p.logToBI(t.vpaidLog,"restartAd",{videoComplete:!0}),t.video.removeEventListener("ended",e),t._onComplete()};this.video.addEventListener("ended",e)}}},{key:"isReplayable",value:function(){return!0}},{key:"expandAd",value:function(){}},{key:"collapseAd",value:function(){}},{key:"getAdVolume",value:function(t){t&&t(null,this._AdVolume)}},{key:"getAdIcons",value:function(){return this._AdIcons}},{key:"getAdCompanions",value:function(){return this._AdCompanions}},{key:"getAdExpanded",value:function(){return this._AdExpanded}},{key:"getAdLinear",value:function(){return this._AdLinear}},{key:"handshakeVersion",value:function(){return this.version}},{key:"subscribe",value:function(t,e){this.vpaidEvents[e]&&this.beacon.addEventListener(e,t)}},{key:"unsubscribe",value:function(t,e){if(this.vpaidEvents[e]){if(void 0==t)return;this.beacon.removeEventListener(e,t)}}},{key:"onAfterStop",value:function(){}},{key:"dontDie",value:function(){this.stayAlive=!0}},{key:"_getMediaUrl",value:function(){return this.mediaUrl}},{key:"getVideoUrl",value:function(){if(this.video.src)return this.video.src;var t="";if(this.video.childNodes.length>0)for(var e=this.video.querySelectorAll("source"),i=0;i<e.length;i++)if(e[i].src){t=e[i].src;break}return t}}]),t}();e.default=v},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=i(6),d=n(a),l=i(3),u=(n(l),i(4)),h=n(u),c=i(12),p=n(c),v=i(1),f=s(v),m=function(){function t(e,i,s){var n=this;r(this,t),this.vpaidLog=i,this.store=s,this.type="video",this.stopped=!1,this.version="1.1",this.target=e.slot,this.video=e.videoSlot,this.clickableTarget=e.clickableTarget||null,this.useCanvasMpeg=this.store.get("uscnvsmpg")||!1,this.hasAutoPlay=this.store.get("hasAutoPlay")||!1,this.tag=e.tag,this.isCanvasMpeg=this._decideCanvas(),this._firedAdLoaded=!1,this.vpaidEvents=Object.assign({},h.default),this.lastClickTime=null,this.playerDAST=e.playerDAST;var o=this.store.get("ua");if(this.isIOS="iOS"===o.os.name,e.trackingPixels.progress.length>0&&(this._progressEvents=e.trackingPixels.progress),this.isCanvasMpeg){this.playerDAST.set({cnv:!0}),this.canvas=new p.default(this.video,this,null,null,s),this._onSwitchFromCanvasToVideo=e.onSwitchFromCanvasToVideo,this.canvas.on("newVidCreated",function(t){n.playerDAST.set({ctv:!0}),f.logToBI(n.vpaidLog,"canvasToVideo",{newVidCreated:!0}),t.style.pointerEvents="all",t.style.zIndex=t.style.zIndex||n.zIndex,n._AdPaused=t.paused,n._onSwitchFromCanvasToVideo&&n._onSwitchFromCanvasToVideo(t)}),this.canvas.on("ready",function(){n._fireAdLoaded()});var a=document.getElementsByClassName("vpaid-ad-controls")[0];a&&(a.className+=" hide")}else setTimeout(function(){n.beacon&&n.beacon.dispatchEvent(n.vpaidEvents.AdLoaded)},2e3);f.logToBI(this.vpaidLog,"vpaidInit",{hasAutoPlay:this.hasAutoPlay,isCanvasMpeg:this.isCanvasMpeg,forceCavnas:this.store.get("forcecnvsmpg"),useAutoPlayForContent:this.store.get("useapforcntnt"),isMobile:!0}),this.mediaFiles=e.vpaidFiles,this.mediaUrl,this.videoSlotControls=e.videoSlotControls,this.videoSlotCanAutoPlay=e.videoSlotCanAutoPlay,this._PlayerWidth=0,this._PlayerHeight=0,this.volume=0,this._AdLinear=!0,this._AdExpanded=!0,this._AdCompanions=[],this._AdIcons=[],this._SkipTime=60,this._AdPlaying=!1,this._AdPaused=!1,this._PlayerReady=!1,this._FirstFired=!1,this._MidFired=!1,this._ThirdFired=!1,this._VideoLength=e.extra.duration||30,this._relevantSources=0,this._errorsCount=0,this.beacon=new d.default(this),this.decodeUrl=this.store.get("dcdvdurl"),window.setTimeout(e.onReady,0),this.firstResume=!0}return o(t,[{key:"_dispatchQuartileEvent",value:function(t){this.beacon.dispatchEvent(t)}},{key:"_fireAdLoaded",value:function(){this._firedAdLoaded||this.beacon.dispatchEvent(this.vpaidEvents.AdLoaded),this._firedAdLoaded=!0}},{key:"_decideCanvas",value:function(){if(!this.store.get("uscnvsmpg"))return!1;var t=this.store.get("dsm")||{},e=t.mobAp||[],i=this.tag.advId;if(e.indexOf(i)>-1)return f.logToBI(this.vpaidLog,"canvasOptOutByAdvId",{advId:i}),!1;var s=this.store.get("forcecnvsmpg")||!1;return this.useCanvasMpeg&&!this.hasAutoPlay||s}},{key:"muteClick",value:function(){this.stopped||(this.canvas?this.canvas.muteButtonClick():this.volume?this.setAdVolume(0):this.setAdVolume(.7))}},{key:"playButtonClick",value:function(){this.stopped||(this.canvas?this.canvas.playButtonClick():this._AdPaused?this.play():this.pause())}},{key:"_onCanPlay",value:function(){this.stopped||(this._VideoLength=this.video.duration,f.logToBI(this.vpaidLog,"canplay",{videoCanPlay:!0,hasAutoPlay:this.hasAutoPlay,isCanvasMpeg:this.isCanvasMpeg}),this._PlayerReady||(this._PlayerReady=!0,this._fireAdLoaded(),this._AdPlaying&&this._fireAdImpression()))}},{key:"_onPlaying",value:function(){this.stopped||f.logToBI(this.vpaidLog,"videoPlaying",{vidCurrentTime:this.video.currentTime})}},{key:"_onPlay",value:function(){var t=this;if(!this.stopped){if(!this.canvas&&this.store.get("dataSaverDetected")||(this._AdPaused=!1,this.video.play()),this.startAdFired)return this.store.emit("onVideoVpaidMobilePlayPauseChanged",!0),this.beacon.dispatchEvent(this.vpaidEvents.AdPlaying),!0;if(this.beacon.dispatchEvent(this.vpaidEvents.AdVideoStart),!this.stopped){this._AdPlaying?this.beacon.dispatchEvent(this.vpaidEvents.AdPlaying):(this._AdPlaying=!0,setTimeout(function(){t._fireAdImpression()},2e3));var e=this;setTimeout(function(){e.stopped||f.logToBI(e.vpaidLog,"videoTimeAfter5sec",{vidCurrentTime:t.video.currentTime,hasAutoPlay:t.hasAutoPlay,isCanvasMpeg:t.isCanvasMpeg})},5e3),this.timeUpdateInterval=setInterval(function(){e.stopped||e._onTimeUpdate()},1e3)}}}},{key:"_onPause",value:function(){this.stopped||(this._AdPaused=!0,parseInt(this.video.currentTime)<parseInt(this.video.duration)&&this.beacon.dispatchEvent(this.vpaidEvents.AdPaused))}},{key:"_onComplete",value:function(){this.stopped||(this.beacon.dispatchEvent(this.vpaidEvents.AdVideoComplete),this.beacon&&this.beacon.dispatchEvent(this.vpaidEvents.AdStopped))}},{key:"_onPlayerError",value:function(t){this.isCanvasMpeg||(f.logToBI(this.vpaidLog,"videoError",{value:t,hasAutoPlay:this.hasAutoPlay,isCanvasMpeg:this.isCanvasMpeg}),this.stopped||(this._errorsCount++,this._errorsCount>=this._relevantSources&&this.beacon.dispatchEvent(this.vpaidEvents.AdError)))}},{key:"_onVolume",value:function(){this.stopped||(f.logToBI(this.vpaidLog,"volumeChange",{value:this.video.volume,hasAutoPlay:this.hasAutoPlay,isCanvasMpeg:this.isCanvasMpeg}),this.beacon.dispatchEvent(this.vpaidEvents.AdVolumeChange,{volume:this.video.volume}))}},{key:"_onClickThru",value:function(t){if(t.preventDefault(),t.stopPropagation(),!this.stopped){if(this.isIOS){var e=(new Date).getTime();if(null!==this.lastClickTime&&e-this.lastClickTime<=100)return;this.lastClickTime=e}this._AdPaused||this.store.get("dataSaverDetected")&&0===this.video.currentTime?(this.video.play(),this.beacon.dispatchEvent(this.vpaidEvents.AdPlaying)):(this.beacon.dispatchEvent(this.vpaidEvents.AdClickThru),this.video.pause())}}},{key:"_onDurationChange",value:function(){this.stopped||this.beacon.dispatchEvent(this.vpaidEvents.AdDurationChange)}},{key:"_onTimeUpdate",value:function(){if(!this.stopped&&!this._ThirdFired){var t=this.getAdDuration();if(t){var e=this.video.currentTime/t;if(e>.25&&!this._FirstFired?(this._FirstFired=!0,this.beacon.dispatchEvent(this.vpaidEvents.AdVideoFirstQuartile)):e>.5&&!this._MidFired?(this._MidFired=!0,this.beacon.dispatchEvent(this.vpaidEvents.AdVideoMidpoint)):e>.75&&!this._ThirdFired&&(this._ThirdFired=!0,this.beacon.dispatchEvent(this.vpaidEvents.AdVideoThirdQuartile)),this._progressEvents)for(var i=0;i<this._progressEvents.length;i++){var s="time"===this._progressEvents[i].offsetType?this.video.currentTime>this._progressEvents[i].offset:e>this._progressEvents[i].offset;!this._progressEvents[i].fired&&s&&(this._progressEvents[i].fired=!0,this.beacon.dispatchEvent(this.vpaidEvents.Progress,i))}}}}},{key:"_connectToVideoTag",value:function(){this.stopped||(this.video.addEventListener("canplay",this._onCanPlay.bind(this),!0),this.video.addEventListener("play",this._onPlay.bind(this),!0),this.video.addEventListener("playing",this._onPlaying.bind(this),!0),this.video.addEventListener("pause",this._onPause.bind(this),!0),this.video.addEventListener("ended",this._onComplete.bind(this),!0),this.video.addEventListener("error",this._onPlayerError.bind(this),!0),this.video.addEventListener("volumechange",this._onVolume.bind(this),!0),this.video.addEventListener("timeupdate",this._onTimeUpdate.bind(this),!0),this.video.addEventListener("durationchange",this._onDurationChange.bind(this),!0),this.video.addEventListener("waiting",this._onWaiting.bind(this),!0),this._bindedOnClick=this._onClickThru.bind(this),this.video.addEventListener("click",this._bindedOnClick,!0),this.isIOS&&this.clickableTarget&&this.clickableTarget.addEventListener("click",this._bindedOnClick,!0))}},{key:"_disconnectFromVideoTag",value:function(){this.video.removeEventListener("canplay",this._onCanPlay),this.video.removeEventListener("play",this._onPlay),this.video.removeEventListener("pause",this._onPause),this.video.removeEventListener("ended",this._onComplete),this.video.removeEventListener("error",this._onPlayerError),this.video.removeEventListener("volumechange",this._onVolume),this.video.removeEventListener("timeupdate",this._onTimeUpdate),this.video.removeEventListener("durationchange",this._onDurationChange),this.video.removeEventListener("click",this._bindedOnClick,!0),this.video.removeEventListener("waiting",this._onWaiting),this.isIOS&&this.clickableTarget&&this.clickableTarget.removeEventListener("click",this._bindedOnClick,!0)}},{key:"_onWaiting",value:function(){f.logToBI(this.vpaidLog,"waiting",{videoCurrentTime:this.video.currentTime})}},{key:"_prepareVideoTag",value:function(){this.stopped||(this.video.removeAttribute("controls"),this.isCanvasMpeg||this.video.classList.remove("vjs-default-skin"),this.video.muted=!0,this.video.setAttribute("playsinline",""),this._connectToVideoTag(),this._loadVideoTagSources())}},{key:"_loadVideoTagSources",value:function(){if(!this.stopped){for(;this.video.childNodes.length;)this.video.removeChild(this.video.childNodes[0]);this._sortMediaFiles();for(var t=null,e=0;e<this.mediaFiles.length;e++){var i=this.mediaFiles[e];this.video.canPlayType(i.originalType)&&(this._relevantSources++,this.mediaUrl=this.decodeUrl?decodeURI(i.url):i.url,t=i,this.video.src=this.mediaUrl)}t&&this.playerDAST.set({vu:this.mediaUrl,vbr:i.bitrate,vwd:i.width,vht:i.height,ot:i.originalType,st:i.subType})}}},{key:"_sortMediaFiles",value:function(){var t=this._PlayerWidth;this.mediaFiles.sort(function(e,i){var s=Math.abs(t-e.width),n=Math.abs(t-i.width);return s-n}),this.mediaFiles.sort(function(t,e){return t.bitRate-e.bitRate})}},{key:"_fireAdImpression",value:function(){this.stopped||this.fireImpression||(this.beacon.dispatchEvent(this.vpaidEvents.AdVideoStart),this.beacon.dispatchEvent(this.vpaidEvents.AdImpression),this.fireImpression=!0)}},{key:"resizeAd",value:function(t,e,i){this.stopped||(this._PlayerWidth=parseInt(t),this._PlayerHeight=parseInt(e),this.video.style.width=this._PlayerWidth+"px",this.target.style.width=this._PlayerWidth+"px",this.video.style.height=this._PlayerHeight+"px",this.target.style.height=this._PlayerHeight+"px",this.video.setAttribute("width",this._PlayerWidth),this.target.setAttribute("width",this._PlayerWidth),this.video.setAttribute("height",this._PlayerHeight),this.target.setAttribute("height",this._PlayerHeight),this.canvas&&this.canvas.onResize(t,e))}},{key:"initAd",value:function(t,e,i,s,n,r){this.stopped||(this.resizeAd(t,e,i),this._prepareVideoTag())}},{key:"stopAd",value:function(t){if(!this.stopped){for(this.stopped=!0,this.video.pause(),this._disconnectFromVideoTag(),this.canvas&&this.canvas.destroy();this.video.childNodes.length;)this.video.removeChild(this.video.childNodes[0]);this.video.src="",this.vpaidLog=void 0,this.store=void 0,this._bindedOnClick=void 0,this.mediaFiles=this.target=this.beacon=this.video=this.target=this._onError=this._onSwitchFromCanvasToVideo=void 0,clearTimeout(this.timeUpdateInterval),setTimeout(this.onAfterStop,50)}}},{key:"pauseAd",value:function(){this.stopped||this.video.pause()}},{key:"resumeAd",value:function(){var t=this;this.stopped||(this.video.play(),this.beacon.dispatchEvent(this.vpaidEvents.AdPlaying),this.firstResume&&(setTimeout(function(){t.stopped||t._AdPaused||f.logToBI(t.vpaidLog,"videoTimeAfter3secFromResumeAd",{vidCurrentTime:t.video.currentTime})},3e3),this.firstResume=!1))}},{key:"skipAd",value:function(){this.stopped||this.getAdSkippableState()&&this.stopAd()}},{key:"setAdVolume",value:function(t){this.stopped||(this.video.muted=0==t,this.video.volume=this.volume=parseFloat(t)<=1?t:parseInt(t)/100)}},{key:"getAdWidth",value:function(){return this._PlayerWidth}},{key:"getAdHeight",value:function(){return this._PlayerHeight}},{key:"getAdSkippableRemainingTime",value:function(){var t=this.getAdRemainingTime()-this._SkipTime;return t>0?t:0}},{key:"getAdRemainingTime",value:function(){return this.getAdDuration()-this.video.currentTime}},{key:"getAdDuration",value:function(){return this.video.duration||this._VideoLength}},{key:"getAdSkippableState",value:function(){return 0==this.getAdSkippableRemainingTime()}},{key:"startAd",value:function(){this._onPlay(),this.startAdFired=!0}},{key:"restartAd",value:function(){var t=this;if(f.logToBI(this.vpaidLog,"restartAd",{videoRestarted:!0,isStopped:this.stopped}),!this.stopped){this.video.currentTime=0,this.video.play();var e=function e(){f.logToBI(t.vpaidLog,"restartAd",{videoComplete:!0}),t.video.removeEventListener("ended",e),t._onComplete()};this.video.addEventListener("ended",e)}}},{key:"isReplayable",value:function(){return!this.canvas}},{key:"expandAd",value:function(){}},{key:"collapseAd",value:function(){}},{key:"getAdVolume",value:function(t){t&&t(null,this.volume)}},{key:"getAdIcons",value:function(){return this._AdIcons}},{key:"getAdCompanions",value:function(){return this._AdCompanions}},{key:"getAdExpanded",value:function(){return this._AdExpanded;
}},{key:"getAdLinear",value:function(){return this._AdLinear}},{key:"getDOMContainer",value:function(){return this.target}},{key:"handshakeVersion",value:function(){return this.version}},{key:"subscribe",value:function(t,e){this.stopped||this.vpaidEvents[e]&&this.beacon.addEventListener(e,t)}},{key:"unsubscribe",value:function(t,e){if(!this.stopped&&this.vpaidEvents[e]){if(void 0==t)return;this.beacon.removeEventListener(e,t)}}},{key:"onAfterStop",value:function(){}},{key:"_getMediaUrl",value:function(){return this.mediaUrl}},{key:"getVideoUrl",value:function(){if(this.video.src)return this.video.src;var t="";return this.video.childNodes.length>0&&this.video.querySelectorAll("source").forEach(function(e){!t&&e.src&&(t=e.src)}),t}}]),t}();e.default=m},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var d=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),l=i(6),u=n(l),h=i(3),c=n(h),p=i(61),v=n(p),f=i(1),m=s(f),g=i(60),y=n(g),_=i(62),b=n(_),w=i(52),A=n(w),k=i(51),T=n(k),C=i(53),E=n(C),I=i(63),V=n(I),x=i(57),S=n(x),P=i(13),L=n(P),F=i(19),B=n(F),D=i(9),O=n(D),M=i(11),R=i(55),U=n(R),j=i(102),W=n(j),N=i(16),H=n(N),Q=i(47),z=n(Q),q=i(58),X=n(q),G=i(103),Y=0,Z=0,J=function(t){function e(t,i,s,n){r(this,e);var a=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));a.mainVpaid=i,a.store=s,a.wflog=n,a.wflog&&a.wflog.increaseNumberOfConnectedVpaids(),a.isVForceActive=a.store.get("vForce"),a.created=Date.now(),a.loadedEvent="",a.manager=t.manager,a.index=++Y,a.vpaidWrapperIndex="VpaidWrapper"+a.index,a.tagid=t.tagid,a.tag=t.tag,a.tag.vpaidWrapperData={},a.error="",a.readyInMS=0,a.isMultiAdsActive=a.store.get("mltads"),a.isMultiVpaidUnit=a.store.get("isMultiVpaidUnit"),a.isAdErrorBeforeAdLoadedActive=a.store.get("aderrbfradlddopactv"),a.adLoadedFired=!1,a.hijackFired=!1,a.latestVpaidAnalytics=a.store.getLatestVersion("anltcsurl"),a.registerAnalytics=a.latestVpaidAnalytics&&a.latestVpaidAnalytics.value||a.store.get("mltprpsrvsurl")?a._registerAnalytics.bind(a):function(){},a.maxNetworkCalls=a.store.getByLineItem("mxntwrkclls",a.tag)||0,a.iframesWeights=a.store.get("ifrmswghts"),a.blockBringToFront=a.isMultiVpaidUnit&&a.store.get("blckbrngtofrnt"),a.toggleIframeContentDisplayActive=a.store.get("tglifrmcntndsplyactv"),a.waitForAdPausedBeforeResumeAd=a.store.get("wtfradpsdbfrrsmad");var d=a.store.getByLineItem("cstmdl",a.tag);if(void 0===d&&(d=a.tag.cstmdl),a.isCPCV=a.fireCompletionPixelOnNewCompletionEvent=d===z.default.CPCV,a.isVideoThrottleOn=a.store.get("vtrtlon"),a.videoThrottleLength=void 0,a.isBufferModeOn=a.store.get("bfrmd"),a.isBufferModeOn&&(a.bufferModeDelay=a.store.getByLineItem("bm",a.tag),a.bufferModeDelay&&(a.bufferModeDelay=m.normalizeMilliseconds(a.bufferModeDelay))),a.playerDAST=new X.default(a.store),a.creatives={},a.stayAlive=!1,a.oldStatus="",a.stopReason="",a.config={},a.vast=[],a.iconsPrograms=[],a.isMobile=a.store.get("isMobile")||!1,a.isIOS=!1,a.isMobile){var l=a.store.get("ua");a.isIOS="iOS"===l.os.name}a.timeoutLengthToAdCompletion=a.store.getByLineItem((a.isMobile?"mbl":"dsk")+"tmouttoadcmpltn",a.tag),a.fireNewCompletionPixel=a.timeoutLengthToAdCompletion>0,a.fireNewCompletionPixel&&(a.timeoutLengthToAdCompletion=m.normalizeMilliseconds(a.timeoutLengthToAdCompletion)),a.timeoutToAdCompletion=null,a.timeoutToAdCompletionStartTime=0,a.newCompletionEventFired=!1,a.globalAdTimeout=null,a.globalAdTimeoutStartTime=0,a.globalAdTimeoutLength=a.store.getByLineItem("global_ad_timeout",a.tag),a.globalAdTimeoutLength&&a.globalAdTimeoutLength>0&&(a.globalAdTimeoutLength=m.normalizeMilliseconds(a.globalAdTimeoutLength)),a.store.get("dbncadvltm")?a.setAdVolume=G(a._setAdVolume,a.store.get("dbncadvltm"),{leading:!0}):a.setAdVolume=a._setAdVolume,a.tag.advId&&a._pushUniqueAdvIdsToWaterfallLog();var h={auctionId:a.tag.auctionId,advId:a.tag.advId,dast:a.tag.dast,price:a.tag.price,queueNumber:a.tag.queueNumber,cpmFloor:a.tag.cpmFloor,dp:a.tag.dp,rollType:a.tag.rollType,lineItem:a.tag.lineItem,unitType:a.store.get("unit_type"),unitVersion:a.store.get("unit_version"),isMobile:a.isMobile,rpox:a.tag.rpox,alfrox:a.tag.alfrox,frox:a.tag.frox,waterfallIndex:a.tag.wfIndex,itemType:a.tag.itemType,requiredViewability:a.tag.requiredViewability,requiredViewabilityDrawn:a.tag.requiredViewabilityDrawn,flad:a.tag.flad||a.tag.flad_delay||0,brand:a.tag.brand,priority:a.tag.priority,costModel:a.isCPCV,backfillDelayed:!!a.tag.isBackfillDelayed};if(a.tag.crId){var p={stId:a.tag.stId,cmpgnId:a.tag.cmpgnId,itemType:a.tag.itemType};h=Object.assign(h,p)}if(a.pwov=a.tag.pwov,a.vpaidLog=new L.default(h,a.store),a._copyFromStoreToBi("connectionType"),a._copyFromStoreToBi("navigatorConnection"),a._wfStats=t.wfStats,a._wfStats.increaseVpaidsCount(),a.oppsID=O.default,a.shouldMuteVid=a.store.get("dskVidMuted")&&!a.store.get("isMobile"),a.opportunityManager=new B.default({CM_DOMAIN:i.config.creatives.CM_DOMAIN,AUC_DAST:i.config.creatives.AUC_DAST,sequenceId:a.sequenceId,ST:i.config.creatives.ST,STS:i.config.creatives.STS,SDID:i.config.creatives.SDID,PT:i.config.creatives.PT,PV:i.config.creatives.PV,WP:i.config.creatives.WP,VPD:i.config.creatives.PUBID,VPTD:i.config.creatives.TAGID,VMT:i.config.creatives.VMT},a.store,a.vpaidLog),a.vpaidEventToPixelId={},a.vpaidEventToPixelId[a.mainVpaid.vpaidEvents.AdVideoFirstQuartile]=a.oppsID.videoFirstQuartile,a.vpaidEventToPixelId[a.mainVpaid.vpaidEvents.AdVideoMidpoint]=a.oppsID.videoMidpoint,a.vpaidEventToPixelId[a.mainVpaid.vpaidEvents.AdVideoThirdQuartile]=a.oppsID.videoThirdQuartile,a.vpaidEventToPixelId[a.mainVpaid.vpaidEvents.AdVideoComplete]=a.oppsID.videoComplete,a._sendOpp(a.oppsID.tagStarted),a.debugTracker=new c.default(a.vpaidWrapperIndex),a.pixelManager=new S.default(s),t.creatives)for(var f in t.creatives)a.creatives[f]=t.creatives[f];if(t.config)for(var f in t.config)a.config[f]=t.config[f];a.adVolume=m.normalizeVolume(parseInt(a.config.VOLUME)?parseInt(a.config.VOLUME):0),a.vpaidEvents=t.vpaidEvents,a.useIframeOnVpaidWrapper=a.isMobile&&a.store.get("usifrmonvpdwrpr"),m.logToBI(a.vpaidLog,"wrapVpaidInIframe",{active:a.useIframeOnVpaidWrapper}),a.localTarget=a._createLocalTarget(a.config.target),a.localIframe=a._createLocalIframe(a.config.target),a.store.get("vpdcntrcstmcss")&&((a.adTarget||a.localTarget).style.cssText+=a.store.get("vpdcntrcstmcss")),a.isIOS&&(a.clickableTarget=a._createClickableTarget(a.localTarget)),a.localVideo=a._createLocalVideo(a.localTarget),a.beacon=new u.default(a),a.parser=new v.default({vpaidLog:a.vpaidLog,width:a.config.width,height:a.config.height,bitrate:a.config.bitrate,internalPixel:a.tag.pixel,tag:a.tag,vpaidWrapper:a},a.store),a.parser.onFail=a._onParserError.bind(a),a.parser.onNetworkFail=a._onNetworkError.bind(a),a.parser.onVpaidJs=a._onVpaidJs.bind(a),a.parser.onMp4Video=a._onMp4Video.bind(a),a.parser.onMp4VideoMobile=a._onMp4VideoMobile.bind(a),a.parser.onVpaidJsMobile=a._onVpaidJsMobile.bind(a),a.parser.onSpotxAdOs=a._onSpotxAdOs.bind(a),a.adFoundDispatched=!1,a.vpaidHandler=!1,a.stopped=!1,a._startParser();var g={lastDelayBetweenWfs:a.store.get("dynamicWf.lastDelayBetweenWfs"),currentDelayBetweenWfs:a.store.get("dynamicWf.currentDelayBetweenWfs")};return m.logToBI(a.vpaidLog,"dynamicWf",g),a.isVForceActive=a.store.get("vForce")||!1,m.logToBI(a.vpaidLog,"vForce",{vForceIsActive:a.isVForceActive}),a._initTimers(),a.store.get("useVideoControls")&&a.store.getByLineItem("ad_controls",a.tag)!==!1&&(a.VideoControls=new H.default(a.localVideo,a.store,a.localTarget,"ad",a),a.VideoControls.setVpaidHandler(a),a.VideoControls.setOnSoundChangeCallback(a._onSoundChange.bind(a))),a.handelsEarlyAI=a.store.get("erlyai"),a._handleDataSaver(),a.store.get("debug")&&a._addCopyToClipboardBtn(),a.isReplayable=!1,a._onGotAdIconsBinded=a._onGotAdIcons.bind(a),a._appendVpaidCSS(),a}return a(e,t),d(e,[{key:"_addCopyToClipboardBtn",value:function(){var t=this,e=document.createElement("div");e.className="playerSaveButton",e.style.zIndex=Z+10,e.innerHTML="SAVE",this.localVideo.parentElement.appendChild(e),e.addEventListener("click",function(){(0,W.default)(t.vpaidLog.toString())})}},{key:"_startParser",value:function(){this.parser.stopped||(this.tag.vast?this.parser.parseVastFromString(this.tag.vast):this.parser.parseVastFromUrl(this.tag.url))}},{key:"_initTimers",value:function(){this._waitForEvent(this.vpaidEvents.AdLoaded,this.store.getByLineItem("altmot",this.tag)||this.tag.ADTO,this._onAdLoadedEvent.bind(this),this._onAdLoadedTimeout.bind(this)),this._setTimers()}},{key:"_setTimers",value:function(){var t=this._initTimersStart?Date.now()-this._initTimersStart:0;this._initTimersStart=Date.now(),this._initTillAdstartTimeout(t),this._initAutoKillTimeOut(t)}},{key:"_initTillAdstartTimeout",value:function(t){var e=this;this.tillAdstartTimeout&&clearTimeout(this.tillAdstartTimeout);var i=this.type&&this.store.getByTech("adto",this.type)||this.store.getByLineItem("adto",this.tag)||this.tag.ADTO;i-=t,i>0&&(this.tillAdstartTimeout=setTimeout(function(){m.logToBI(e.vpaidLog,"AdStopADTO",{timeout:i}),e.error="adto",e.stop(e.error,e.oppsID.adtoTimeout)},i))}},{key:"_initAutoKillTimeOut",value:function(t){var e=this;this.autoKill&&clearTimeout(this.autoKill);var i=this.type&&this.store.getByTech("vakll",this.type)||this.store.getByLineItem("vakll",this.tag)||9e4;i-=t,i>0&&(this.autoKill=setTimeout(function(){m.logToBI(e.vpaidLog,"AutoKill",{timeout:i}),e.error="autoKill",e.beacon.dispatchEvent(e.vpaidEvents.AdVideoComplete,e),e.stop(e.error,e.oppsID.globalTimeout)},i))}},{key:"_killTimers",value:function(){if(clearTimeout(this.autoKill),clearTimeout(this.tillAdstartTimeout),clearTimeout(this.adloadedTimeout),this.pendingEvents)for(var t in this.pendingEvents)this.pendingEvents[t].timeoutId!=-1&&clearTimeout(this.pendingEvents[t].timeoutId);this.pendingEvents={}}},{key:"_createClickableTarget",value:function(t){if(!this.stopped){var e=document.createElement("div"),i=this.store.get("width"),s=this.store.get("height");return e.className="cm-ad-click-target",e.style.cssText="width: "+i+"px; height: "+s+"px; cursor: pointer; position: absolute; top: 0px; left: 0px;",e.style.display="",e.setAttribute("width",i),e.setAttribute("height",s),t.appendChild(e),e}}},{key:"_createLocalVideo",value:function(t){var e=this;if(!this.stopped){var i=document.createElement("video"),s=this.store.get("width"),n=this.store.get("height");return i.className="cm-ad-player",i.style.cssText="width: "+s+"px; height: "+n+"px;",i.style.display="",i.volume=0,this.shouldMuteVid&&(i.muted=!0),i.setAttribute("width",s),i.setAttribute("height",n),this.isMobile&&(i.muted=!0,i.setAttribute("muted","")),i.addEventListener("timeupdate",function(t){e._onTimeupdate(i)}),this.config.videoSlotControls&&i.removeAttribute("controls"),this.store.get("addprld")&&(i.setAttribute("preload","auto"),m.logToBI(this.vpaidLog,"preload",{preload:!0})),t.appendChild(i),i}}},{key:"_createLocalTarget",value:function(t){if(!this.stopped){var e=document.createElement("div");return this.store.get("noplrcntr")&&(e.id="_cm-css-reset"),e=this._styleElement(e,t),this.useIframeOnVpaidWrapper?e:(this._createAdTargetElement(e),t.appendChild(this.adTarget?this.adTarget:e),e)}}},{key:"_createLocalIframe",value:function(t){var e=this;if(!this.stopped&&this.useIframeOnVpaidWrapper){var i=document.createElement("iframe");return i.onload=function(){i.onload=null;var t=e.store.get("resourceLoader");t.loadCSSResources(i.contentWindow.document);var s=i.contentWindow.document.createElement("div");s.id="_cm-css-reset",s.appendChild(e.localTarget),i.contentWindow.document.body.style.margin="0",i.contentWindow.document.body.appendChild(s),i.contentWindow.addEventListener("message",function(t){window.postMessage(t.data,t.origin)}),m.logToBI(e.vpaidLog,"localIframeOrigin",{origin:i.contentWindow.location.origin}),e.iframeWrapperLoaded=!0;var n=e.store.get("vpaidWrapper"+e.index+"Handler");n&&e._createHandler(n.filesArray,n.AdParamString,n.handlerType,n.options,n.trackingPixels)},this.iframeWrapperLoaded=!1,i=this._styleElement(i,t),i.classList.add("_cm-video-ad-iframe"),this._createAdTargetElement(i),t.appendChild(this.adTarget?this.adTarget:i),i}}},{key:"_styleElement",value:function(t,e){return this.store.get("noplrcntr")||(t.style.cssText=e.style.cssText),t.style.position="absolute",t.style.overflow="hidden",t.style.top="0",t.style.height="0",t.style.left="0",t.style.zIndex="1",t.style.background="transparent",this.store.get("noplrcntr")?t.className=this.vpaidWrapperIndex:t.className=(e.className?e.className:"")+" "+this.vpaidWrapperIndex,this.isMultiAdsActive&&t.className.indexOf("_cm-video-ad")<0&&(t.className="_cm-video-ad "+t.className),t}},{key:"_createAdTargetElement",value:function(t){(this.isMultiVpaidUnit||this.isMultiAdsActive)&&(m.removeClass(t,"multi-vpaids"),this.adTarget=document.createElement("div"),this.adTarget.className="_cm-ad",this.adTarget.id="_cm-css-reset",this.adTarget.appendChild(t))}},{key:"_onHandlerError",value:function(t,e){m.logToBI(this.vpaidLog,"earlyError",{errMsg:t}),this.loadedEvent||(this.status="error",this.stopped||(this.beacon.dispatchEvent(this.vpaidEvents.AdError,t),"adUnitLoadFailed"===e&&(m.logToBI(this.vpaidLog,"adUnitLoadFailed",{errMsg:t}),this.stop("adUnitLoadFailed",O.default.adUnitLoadFailed)),m.logToBI(this.vpaidLog,"handlerError",{errMsg:t})))}},{key:"_onHandlerCreated",value:function(){this.stopped||(m.logToBI(this.vpaidLog,"createdVpaidHandler",{}),this._connectToVpaidHandler(),this.vpaidHandler.handshakeVersion("2.0"),m.logToBI(this.vpaidLog,"initAd",{adInited:!0}),this.VideoControls&&this.vpaidHandler.canvas&&this.VideoControls.setCanvas(this.vpaidHandler.canvas),this.vpaidHandler.initAd(this.config.width,this.config.height,this.config.viewMode,this.config.bitrate,{AdParameters:this.creatives.AdParameters},{slot:this.localTarget,videoSlot:this.localVideo,videoSlotControls:!!this.config.videoSlotControls,videoSlotCanAutoPlay:!!this.config.videoSlotCanAutoPlay}))}},{key:"_connectToVpaidHandler",value:function(){if(!this.stopped)for(var t in this.vpaidEvents)this.vpaidHandler.subscribe(this._handleVpaidEvents.bind(this,this.vpaidEvents[t]),this.vpaidEvents[t])}},{key:"_adLoadedHandler",value:function(t){var e=this;if(!this.stopped){if(this.adLoadedFired=!0,this.loadedEvent=this.loadedEvent+" "+t,this.readyInMS=Date.now()-this.created,this.debugTracker.info("Ad loaded now => pause it srcEvent",t),this._sendOpp(O.default.adLoaded),this.isMobile&&this.vpaidHandler.canvas&&(this.muted=!0),this.status="ready",this.isUnPaused=!0,this.store.emit("vpaidReady",this),this.asyncAdimpression=this.store.getByLineItem("asyncAdimpression",this.tag),this.asyncAdimpression){var i=this.store.getByLineItem("aaViewability",this.tag)?"unit::viewability":"unit::conversion";m.logToBI(this.vpaidLog,"asyncAdimpression",{event:i}),this.on(i,function(){m.logToBI(e.vpaidLog,"asyncAdimpressionEvent",{event:i}),e.onAsyncAdmpression()})}this.setAdVolume(this.adVolume),this.adFoundDispatched=!0,this.vpaidHandler.checkUnfriendlyIframe&&(this.isUnfriendlyIframe=this.vpaidHandler.checkUnfriendlyIframe()),this.type&&"javascript"==this.type&&this.logVpaidFamily(),this.setVpaidAnalyticsIsVideoUrlPublic&&this.setVpaidAnalyticsIsVideoUrlPublic(""!==this.getVideoUrl()),this.tag.requiredViewability&&this.store.emit("emitQueueStatus")}}},{key:"startAd",value:function(t){var e=this;this.adStarted=!0,this.setAdVolume(this.adVolume),this._startForceAdVolumeInterval(),this.options=Object.assign(t||{},this.store.get("getAdData")),this.isStarted=!0,this.store.incr("ads_started"),this._sendOpp(this.oppsID.startAd),m.logToBI(this.vpaidLog,"adOptions",this.options),m.logToBI(this.vpaidLog,"startAd",{adStarted:!0}),this.earlyAdImpression||this._waitForEvent(this.vpaidEvents.AdImpression,this.store.get("adimptmot"),this._onAdImpressionEvent.bind(this),this._onAdImpressionTimeout.bind(this)),this.isUnPaused?this.vpaidHandler.startAd():this.vpaidHandler.resumeAd(),clearTimeout(this.tillAdstartTimeout),this.working=!0,this.bringToFront(),this.earlyAdImpression&&setTimeout(function(){e._onAdImpression()},500)}},{key:"_startForceAdVolumeInterval",value:function(){var t=this;if(!this.isMobile){var e=this.store.get("frcadvlmtrvl");if(!this.setAdVolumeInterval&&e>0){var i=this.store.get("stpfrcvlevnt")||this.vpaidEvents.AdVideoFirstQuartile;this.vpaidHandler.subscribe(function(){t._stopForceAdVolumeInterval()},i),this.setAdVolumeInterval=setInterval(function(){t.vpaidHandler&&!t.vpaidHandler.stopped?t.setAdVolume(t.adVolume):clearInterval(t.setAdVolumeInterval)},e)}}}},{key:"_stopForceAdVolumeInterval",value:function(){this.isMobile||(clearInterval(this.setAdVolumeInterval),this.setAdVolumeInterval=0)}},{key:"restartAd",value:function(){var t=this;this.isReplayable&&(this.opportunityManager.unpause(),this._sendOpp(this.oppsID.replayAd),this.opportunityManager.pause(),this.pixelManager.pause(),this.working=this.isStarted=this.adStarted=!0,this.store.incr("ads_started"),this.clickThruUrl=this.clickThruUrl||this.pixelManager.getClickThruUrl(),this.vpaidHandler.restartAd(this.videoUrl,this.clickThruUrl),setTimeout(function(){t.bringToFront()}))}},{key:"isReplayableVpaid",value:function(){return this.isVForceActive&&this.store.getByLineItem("rplvpdactv",this.tag)&&this.vpaidHandler&&this.vpaidHandler.isReplayable()}},{key:"dontDie",value:function(){this.stayAlive=!0,this.vpaidHandler&&this.vpaidHandler.dontDie&&this.vpaidHandler.dontDie(),this._killTimers()}},{key:"_handleStopped",value:function(t){this.moveToBack(),this.stop(t.type,t.oppType),this.working=!1}},{key:"pauseAd",value:function(){this.stopped||(m.logToBI(this.vpaidLog,"pauseAd",{api:!0}),this.waitForAdPausedBeforeResumeAd&&(this.isUnPaused&&(this.adPausedFired=!1),this.resumeOnAdPaused&&(this.resumeOnAdPaused=!1)),this.pauseAdStartTime=Date.now(),this.working=!1,this.vpaidHandler.pauseAd(),this._pauseAdTimeoutToCompletion(),this._pauseGlobalAdTimeout())}},{key:"resumeAd",value:function(){if(!this.stopped&&(this.isMultiAdsActive||!this.store.get("forcePause"))){if(this.waitForAdPausedBeforeResumeAd&&!this.adPausedFired)return this.resumeOnAdPaused=!0,void m.logToBI(this.vpaidLog,"resumeAdDelay",{delay:!0});this.resumeOnAdPaused=!1,m.logToBI(this.vpaidLog,"resumeAd",{api:!0}),this.working=!0,this.vpaidHandler.resumeAd(),this.isMultiVpaidUnit&&this.resizeAd(this.store.get("width"),this.store.get("height")),this.VideoControls&&!this.workingVpaid&&(this.VideoControls.resetAdControls(),this.isMobile&&this.store.emit("playerStatusChanged","ad")),this.store.set("ad_controls",this.store.getByLineItem("ad_controls",this.tag)!==!1),this.workingVpaid=!0,this.isVForceActive&&(this._setTimeoutToAdCompletion(),this._bringLocalIframeToFront(),this._setGlobalAdTimeout(),this.vpaidHandler&&this.vpaidHandler.handleVpaidContent&&this.vpaidHandler.handleVpaidContent())}}},{key:"_bringLocalIframeToFront",value:function(){this.localIframe&&(this.localIframe.style.zIndex=this.localTarget.style.zIndex)}},{key:"_setGlobalAdTimeout",value:function(){var t=this;this.globalAdTimeoutLength&&this.globalAdTimeoutLength>0&&!this.globalAdTimeout&&(this.globalAdTimeoutStartTime=Date.now(),this.globalAdTimeout=setTimeout(function(){t.stopped||(m.logToBI(t.vpaidLog,"globalAdTimeout",{}),t.stop("global_ad_timeout",t.oppsID.globalAdTimeout))},this.globalAdTimeoutLength))}},{key:"_pauseGlobalAdTimeout",value:function(){this.globalAdTimeout&&(this.globalAdTimeout=clearTimeout(this.globalAdTimeout),this.globalAdTimeoutLength-=Date.now()-this.globalAdTimeoutStartTime)}},{key:"_setTimeoutToAdCompletion",value:function(){var t=this;!this.timeoutToAdCompletion&&this.timeoutLengthToAdCompletion>0&&!this.newCompletionEventFired&&(this.timeoutToAdCompletionStartTime=Date.now(),this.timeoutToAdCompletion=setTimeout(function(){t.stopped||t._newCompletionHandler("timerEnded")},this.timeoutLengthToAdCompletion))}},{key:"_pauseAdTimeoutToCompletion",value:function(){this.timeoutToAdCompletion&&(this.timeoutToAdCompletion=clearTimeout(this.timeoutToAdCompletion),this.timeoutLengthToAdCompletion-=Date.now()-this.timeoutToAdCompletionStartTime)}},{key:"_fireNewCompletionEvent",value:function(t){if(!this.newCompletionEventFired){var e=this.localVideo.currentTime;m.logToBI(this.vpaidLog,"newCompletionEvent",{newCompletion:!0,reason:t,currentTime:e}),this._sendOpp(this.oppsID.newCompletion),this.newCompletionEventFired=!0,this.fireCompletionPixelOnNewCompletionEvent&&this._firePixel(this.vpaidEvents.AdVideoComplete,{newCompletion:!0})}}},{key:"getVideoUrl",value:function(){return this.videoUrl||(this.videoUrl=this.vpaidHandler.getVideoUrl?this.vpaidHandler.getVideoUrl():"",this._setVideoDataToPlayerDAST()),this.videoUrl}},{key:"_setVideoDataToPlayerDAST",value:function(){var t={vu:this.videoUrl},e=this.localVideo;this.vpaidHandler&&this.vpaidHandler.getVPAIDVideoElement&&(e=this.vpaidHandler.getVPAIDVideoElement()||e),e&&(t.edr=e.duration,t.ewd=parseInt(e.videoWidth),t.eht=parseInt(e.videoHeight)),this.playerDAST.set(t)}},{key:"_setVideoThrottle",value:function(){this.videoThrottleLength=this.store.getByLineItem("vtrtl",this.tag),this.videoThrottleLength&&(this.videoThrottleLength=m.normalizeMilliseconds(this.videoThrottleLength),this.videoUrl=this.getVideoUrl(),this.videoUrl?m.logToBI(this.vpaidLog,"videoThrottle",{videoUrl:this.videoUrl,delay:this.videoThrottleLength}):(this.videoThrottleLength=0,m.logToBI(this.vpaidLog,"videoThrottle",{videoUrlEmpty:!0})))}},{key:"_throttleVideo",value:function(){if(!this._isVideoThrottled()){var t=this.store.get("videosToThrottleList")||{},e={videoUrl:this.videoUrl,delay:this.videoThrottleLength};this.emit("throttleVideo",e),t[this.videoUrl]=e,this.store.set("videosToThrottleList",t),m.logToBI(this.vpaidLog,"videoThrottleDelayStart",e)}}},{key:"_isVideoThrottled",value:function(){var t=this.store.get("videosToThrottleList")||{};return t.hasOwnProperty(this.videoUrl)}},{key:"_delayAdLoadUntilVideoThrottleEnd",value:function(){m.logToBI(this.vpaidLog,"adLoadedEventThrotlled",{videoUrl:this.videoUrl,delayStarted:!0}),this._sendOpp(this.oppsID.videoThrottle),this.onThrottleEndEventName="onThrottleEnd_"+this.videoUrl,this.onRemovedFromThrottleListenersEventName="onRemovedFromThrottleListeners_"+this.videoUrl,this._bindedOnAdLoadVideoThrottleDelayEnd=this._onAdLoadVideoThrottleDelayEnd.bind(this),this._bindedOnRemovedFromVideoThrottleListeners=this._onRemovedFromVideoThrottleListeners.bind(this),this.store.removeAllListeners(this.onThrottleEndEventName),this.store.emit(this.onRemovedFromThrottleListenersEventName),this.store.on(this.onThrottleEndEventName,this._bindedOnAdLoadVideoThrottleDelayEnd),this.store.on(this.onRemovedFromThrottleListenersEventName,this._bindedOnRemovedFromVideoThrottleListeners)}},{key:"_onAdLoadVideoThrottleDelayEnd",value:function(){if(!this.stopped){m.logToBI(this.vpaidLog,"adLoadedEventThrotlled",{videoUrl:this.videoUrl,delayEnded:!0},!0);var t=this.store.get("videosToThrottleList")||{};delete t[this.videoUrl],this.store.set("videosToThrottleList",t),this.store.removeListener(this.onThrottleEndEventName,this._bindedOnAdLoadVideoThrottleDelayEnd),this.store.removeListener(this.onRemovedFromThrottleListenersEventName,this._bindedOnRemovedFromVideoThrottleListeners),this._adLoadedHandler(event)}}},{key:"_onRemovedFromVideoThrottleListeners",value:function(){this.stop("removedFromVideoThrottleListeners",null,{eventData:{videoUrl:this.videoUrl}})}},{key:"_shouldBufferAdvertiser",value:function(){if(this.isBufferModeOn){var t=this.store.get("bufferModeList")||[];return this.bufferModeDelay&&t.indexOf(this.tag.advId)<0}return!1}},{key:"_setBufferModeForAdvertiser",value:function(){var t=this.store.get("bufferModeList")||[],e={advId:this.tag.advId,delay:this.bufferModeDelay};this.emit("setBufferModeForAdvertiser",e),m.logToBI(this.vpaidLog,"bufferMode",e),t.push(e.advId),this.store.set("bufferModeList",t)}},{key:"_logVideoUrlCounter",value:function(){var t=this.getVideoUrl();t||(t="na");var e=this.store.get("videoUrlsCounter")||{};e[t]=e.hasOwnProperty(t)?++e[t]:1,m.logToBI(this.vpaidLog,"videoUrlCounter",{videoUrl:t,counter:e[t]});var i=Object.keys(e);m.logToBI(this.vpaidLog,"sessionUniqueVideoUrls",{counter:i.length,urls:i},!0),this.store.set("videoUrlsCounter",e)}},{key:"_handleVpaidEvents",value:function(t,e){var i=this;if(this.vpaidEvents){if("vpaid"===this.vpaidHandler.type&&(this.store.getByLineItem("cmpltonstpd",this.tag)||this.vpaidHandler.completeOnAdStop)){if(t===this.vpaidEvents.AdVideoComplete)return void(this.vpaidHandler&&this.vpaidHandler.setCompletionOnAdStoppedTimeout&&this.vpaidHandler.setCompletionOnAdStoppedTimeout());t===this.vpaidEvents.AdStopped&&(t=this.vpaidEvents.AdVideoComplete,m.logToBI(this.vpaidLog,"completeOnAdStop",{value:!0,domain:m.stripDomain(this.vpaidHandler.mediaUrl)}))}!this.isFirstVpaidEvent&&this.vpaidHandler._getMediaUrl()&&(this.isFirstVpaidEvent=!0,m.logToBI(this.vpaidLog,"mediaUrl",{url:this.vpaidHandler._getMediaUrl()}),this._checkIfGoogle());var s=!0;if(!this.stopped){var n=this._firePixel(t,e);switch(this.debugTracker.info("VpaidHandler-event",t),this.moatTracker&&this.moatTracker.dispatch({type:t,adVolume:this.adVolume}),this._onEvent(t),t){case this.vpaidEvents.AdLoaded:if(this.isVideoThrottleOn&&void 0===this.videoThrottleLength&&this._setVideoThrottle(),this.videoThrottleLength&&this._isVideoThrottled()?this._delayAdLoadUntilVideoThrottleEnd():this._adLoadedHandler(t),this.vpaidLog.getVpaidAnalyticsReport){var r=this.vpaidLog.getVpaidAnalyticsReport();m.logToBI(this.vpaidLog,"vpaidAnalyticsUntilAdloaded",r)}this.vpaidHandler.getAdIcons&&this.vpaidHandler.getAdIcons(this._onGotAdIconsBinded);break;case this.vpaidEvents.AdImpression:if(s=this._onAdImpression(t),this._pushConversionDataToWaterfallLog(),this._logVideoUrlCounter(),this.videoThrottleLength&&this._throttleVideo(),this._shouldBufferAdvertiser()&&this._setBufferModeForAdvertiser(),this.earlyAdImpression)return;this.isVForceActive||(this._setTimeoutToAdCompletion(),this._bringLocalIframeToFront(),this._setGlobalAdTimeout(),this.vpaidHandler&&this.vpaidHandler.handleVpaidContent&&this.vpaidHandler.handleVpaidContent()),this._setVideoDataToPlayerDAST();break;case this.vpaidEvents.AdVideoStart:this.setAdVolume(this.adVolume),this.adFoundDispatched||(this.adFoundDispatched=!0,this.beacon.dispatchEvent(this.vpaidEvents.AdFound)),this.beacon.dispatchEvent(this.vpaidEvents.AdVideoStart);break;case this.vpaidEvents.AdSkipped:this.adStoppedHandler(t),this._handleStopped({type:t,oppType:this.oppsID.adSkiped});break;case this.vpaidEvents.AdStopped:this.adStoppedHandler(t),this._handleStopped({type:t});break;case this.vpaidEvents.AdLog:this.debugTracker.info("VpaidHandler-Log",arguments);break;case this.vpaidEvents.AdError:var o=this.oppsID.adError;this.isAdErrorBeforeAdLoadedActive&&!this.adLoadedFired&&(o=this.oppsID.adErrorBeforeLoad),"mp4"===this.type?(m.logToBI(this.vpaidLog,"Mp4AdError",{}),this.stop("Mp4AdError",o)):this.stop("AdError",o,e);break;case this.vpaidEvents.SoundViolation:this.store.get("sndvltopp")&&!this.alreadySentSoundViolation&&(this.alreadySentSoundViolation=!0,this._sendOpp(this.oppsID.soundViolation));break;case this.vpaidEvents.AdPaused:m.logToBI(this.vpaidLog,"pauseAdLength",{fromPauseAd:this.pauseAdStartTime?Math.round(Date.now()-this.pauseAdStartTime):void 0}),this.pauseAdStartTime=void 0,this.adPausedFired=!0,this.waitForAdPausedBeforeResumeAd&&this.resumeOnAdPaused&&this.resumeAd();case this.vpaidEvents.AdClickThru:e=this._adClickThruHandler(e),this.isUnPaused=!1,this._pauseAdTimeoutToCompletion(),this._pauseGlobalAdTimeout();break;case this.vpaidEvents.AdPlaying:m.logToBI(this.vpaidLog,"resumeAdDelay",{adPlaying:!0}),this._setTimeoutToAdCompletion(),this._setGlobalAdTimeout();case this.vpaidEvents.AdStarted:case this.vpaidEvents.AdVideoStart:this.isUnPaused=!0;break;case this.vpaidEvents.AdVideoFirstQuartile:this.beacon.dispatchEvent(t),this.isUnPaused||m.logToBI(this.vpaidLog,"firstQuartileOnPause",{isPaused:!0});break;case this.vpaidEvents.AdVolumeChange:this.isMobile&&e&&e.eventData&&e.eventData.volume&&(this.adVolume=m.normalizeVolume(e.eventData.volume));break;default:this.beacon.dispatchEvent(t)}this.emit(t,{type:t,data:e});var a=!document.hidden,d=this.localVideo.currentTime;if(m.logToBI(this.vpaidLog,"event_"+t,{qsize:this.manager.queueSize,vpaidReadyInQue:this.manager.getVpaidReadyCount(),adsPlaying:this.store.get("ads_playing"),tabVis:!document.hidden,isViewable:a,vidCurrentime:d,lastKpi:this.store.get("last_kpi"),kpiDelta:this.store.get("last_kpi")-this.store.get("first_kpi"),lastWF:this.store.get("last_wf_duration"),eventDataStr:e?m.stringify(e.eventData):null}),n&&this.vpaidEventToPixelId.hasOwnProperty(t)&&this.hadImpression&&this._sendOpp(this.vpaidEventToPixelId[t]),this.vpaidEvents)if(t===this.vpaidEvents.AdClickThru)this.clickThruUrl=e&&e.eventData?e.eventData.url:"",this._newCompletionHandler(this.vpaidEvents.AdClickThru);else if(t==this.vpaidEvents.AdVideoComplete){if(this._newCompletionHandler(this.vpaidEvents.AdVideoComplete,n),this.stayAlive)return this.globalAdTimeout&&(this.globalAdTimeout=clearTimeout(this.globalAdTimeout)),void this.emit("end");this.vpaidHandler.stopAd(),setTimeout(function(){i.working=!1,i.workingVpaid=!1,i.stop("AdVideoComplete"),i.status="stopped"},2)}this.manager&&s&&this.manager.trigger(t,this,e?e.eventData:null)}}}},{key:"_onGotAdIcons",value:function(t,e){m.logToBI(this.vpaidLog,"ad_choices",{vpaid:{error:t,result:e}})}},{key:"_newCompletionHandler",value:function(t,e){if(!this.newCompletionEventFired&&(this.timeoutToAdCompletion||this.fireNewCompletionPixel)){if(this.timeoutToAdCompletion=clearTimeout(this.timeoutToAdCompletion),this._validateNewCompletionFiring(t,e))return void this._fireNewCompletionEvent(t);m.logToBI(this.vpaidLog,"fireNewCompletionPrevented",{reason:t,isCmpFireValid:e})}}},{key:"_validateNewCompletionFiring",value:function(t,e){return t===this.vpaidEvents.AdClickThru||(t===this.vpaidEvents.AdVideoComplete?e&&this.opportunityManager.alreadySent(this.tag,this.oppsID.videoComplete):"timerEnded"===t&&this.opportunityManager.alreadySent(this.tag,this.oppsID.videoFirstQuartile))}},{key:"_adClickThruHandler",value:function(t){if(t&&t.eventData&&t.eventData.url)return t;var e=this.pixelManager.getClickThruUrl();if(e){var i={url:e};t?t.eventData=Object.assign(t.eventData||{},i):t={eventData:i}}return t}},{key:"_checkIfGoogle",value:function(){var t=this.localTarget.querySelector("iframe");if(t){var e=m.domIframeIterator(t,this.store.get("debug"));for(this.isGoogleIframe=!1;!this.isGoogleIframe&&e.hasNext();)this._isGoogleIframe(e.current)&&(this.isGoogleIframe=!0);this.isGoogleIframe&&m.logToBI(this.vpaidLog,"googleDemand",{value:!0})}}},{key:"_isGoogleIframe",value:function(t){return t&&t.src.indexOf("imasdk.googleapis.com")>-1&&t.src.indexOf("bridge")>-1}},{key:"_onAdImpression",value:function(){var t=!0,e=this.store.get("rstmrai");if(this.fireViewTracking&&this.fireViewTracking(),e&&this._killTimers(),!this.adStarted&&this.handelsEarlyAI)return this.earlyAdImpression=!0,
this.pauseAd(),this.isUnPaused=!1,m.logToBI(this.vpaidLog,"earlyAdImpression",{early:!0}),clearTimeout(this.tillAdstartTimeout),this._fireAdImpression(),!1;if(this.hadImpression)m.logToBI(this.vpaidLog,"doubleImpression",{value:!0}),t=!1;else{var i=this.store.get("conversionsCount")+1;this.store.set("conversionsCount",i),m.logToBI(this.vpaidLog,"success",{count:i},!0),this.setAdVolume(this.adVolume),this.beacon.dispatchEvent(this.vpaidEvents.AdImpression),this._fireAdImpression(),this.adImpInMS=Date.now()-this.created,this.hadImpression=!0,this._wfStats.increaseSuccess(),this.vpaidHandler&&this.vpaidHandler.logVideoUrl&&this.vpaidHandler.logVideoUrl(),this.isReplayable=this.isReplayableVpaid(),m.logToBI(this.vpaidLog,"restartAd",{isReplayable:this.isReplayable})}return this.earlyAdImpression&&this.manager&&this.manager.trigger("AdImpression",this,null),t}},{key:"_firePixel",value:function(t,e){if("AdVideoComplete"!==t||this.hadImpression){if(!(t===this.vpaidEvents.AdImpression&&this.hadImpression||this.asyncAdimpression))return this.pixelManager.firePixel(t,this.vpaidLog,e)}else m.logToBI(this.vpaidLog,"pixelViolation",{event:t});return!0}},{key:"_fireAdImpression",value:function(t){this.adimpFired||this.asyncAdimpression&&!t||(m.logToBI(this.vpaidLog,"fireAsyncAdimpression",{end:!0}),this._sendOpp(this.oppsID.tagImpression),this.pixelManager.firePixel(this.vpaidEvents.AdImpression,this.vpaidLog),this.adimpFired=!0)}},{key:"onAsyncAdmpression",value:function(){m.logToBI(this.vpaidLog,"fireAsyncAdimpression",{start:!0}),this._fireAdImpression(!0)}},{key:"adStoppedHandler",value:function(t){var e=this;this.stop(),setTimeout(function(){e._cleanVpaid()},1e4)}},{key:"_setAdVolume",value:function(t,e){var i=this;this.stopped||(t=m.normalizeVolume(t),this.adVolume=t,this.shouldMuteVid&&(this.localVideo.muted=0===t),this.adVolume>0&&this.setAdVolumeInterval&&this._stopForceAdVolumeInterval(),this.store.get("frcmtfrms")&&this._setVolumeInIframes(this.localTarget.getElementsByTagName("iframe"),t),this.vpaidHandler&&(this.vpaidHandler.setAdVolume(t,e),this.vpaidHandler.callIMAApi&&this.vpaidHandler.callIMAApi("volume",t),this.vpaidHandler.getAdVolume(function(t,e){e!=i.adVolume&&m.logToBI(i.vpaidLog,"inconsistencyAdVolume",{set:i.adVolume,get:e})})))}},{key:"_setVolumeInIframes",value:function(t,e){var i=this;m.DOMIterator(t[0],"iframe",function(t){t.forEach(function(t){i._overideVolumeInIframe(t),t.setAttribute("tbvol",e),t.volume=e,i.shouldMuteVid&&(t.muted=0===e)})},"video",this.store.get("debug"))}},{key:"_overideVolumeInIframe",value:function(t){if(!t||!t.sv){var e=this;t.sv=!0,t.addEventListener("volumechange",function(){t.volume!==parseFloat(this.getAttribute("tbvol"))?(t.volume=0,e.beacon.dispatchEvent(e.vpaidEvents.SoundViolation,{})):t.volume=e.adVolume})}}},{key:"_onParserError",value:function(t,e){this.stopped||(this.status="error",this.error=t||"",this.isPlaying=!1,m.logToBI(this.vpaidLog,"AdError",{readyInMS:this.readyInMS,errType:t,isPraserError:!0}),this.stop(this.error,e))}},{key:"_onNetworkError",value:function(t){this.stopped||(this.status="error",this.error=t?"xhrStatuses_"+t:"",this.isPlaying=!1,m.logToBI(this.vpaidLog,"networkError",{readyInMS:this.readyInMS,errType:"networkError",isNetworkError:!0}),this.stop(this.error,O.default.networkError))}},{key:"_updateAdVideoDurationOnVideoControls",value:function(t){this.VideoControls&&this.VideoControls.setState({vidDuration:t,vidCurrentTime:0})}},{key:"_registerAnalytics",value:function(t,e,i){var s=this,n=this.store.get("analyticsFuncString");if(n)try{var r=this.store.get("anltcsOptions");return this.maxNetworkCalls&&(r.maxNetworkCalls=this.maxNetworkCalls),this.iframesWeights&&(r.iframesWeights=this.iframesWeights),t.contentWindow.eval(n),r.deepIframes&&(t.contentWindow.AnalyticsReporter.prototype.vpaidAnalyticsFunc=n),r.hideCountdown&&(t.contentWindow.AnalyticsReporter.prototype._onHideCountdown=function(){m.logToBI(s.vpaidLog,"hideCountdown",{analytics:!0})}),new t.contentWindow.AnalyticsReporter(e||this.vpaidHandler,i||function(){},r),t.contentWindow.setIsVideoUrlPublic&&(this.setVpaidAnalyticsIsVideoUrlPublic=t.contentWindow.setIsVideoUrlPublic),this.vpaidLog.getVpaidAnalyticsReport=t.contentWindow.getVpaidAnalyticsReport,t.contentWindow.onNetworkCallsLimitExceeded=function(){s.stopped||(m.logToBI(s.vpaidLog,"vpaidAnalyticsCallLimit",{adImpression:s.adimpFired,limitExceeded:!0,maxNetworkCalls:s.maxNetworkCalls}),s.adimpFired||s.stop("networkCallsLimitExceeded",O.default.maxNetworkCalls))},m.logToBI(this.vpaidLog,"vpaidAnalyticsEval",{success:!0,maxNetworkCalls:this.maxNetworkCalls,vaVersion:this.latestVpaidAnalytics}),!0}catch(t){m.logToBI(this.vpaidLog,"vpaidAnalyticsEval",{success:!1,ex:t})}return!1}},{key:"_onVpaidJs",value:function(t,e,i,s,n){this.tag.vpaidWrapperData.mediatype=2,this.debugTracker.info("ParserResponded[JavaScript]",s),this.pixelManager.loadPixelData(i),this.type="javascript";var r=null;this.store.get("vjshndlrlgcy")?(r=T.default,this.vpaidHandlerType="JsVpaidLegacey"):(r=A.default,this.vpaidHandlerType="JsVpaid"),this._createHandler(t,e,r,{registerAnalyticsToVpaidLog:this.registerAnalytics}),this._updateAdVideoDurationOnVideoControls(n)}},{key:"_onMp4Video",value:function(t,e,i,s,n){this.tag.vpaidWrapperData.mediatype=1,this.debugTracker.info("ParserResponded[Video]",s),this.type="mp4",this.vpaidHandlerType="VideoVpaid",this.pixelManager.loadPixelData(i),this._createHandler(t,e,b.default,{},i),this._updateAdVideoDurationOnVideoControls(n)}},{key:"_onVpaidJsMobile",value:function(t,e,i,s,n){this.clickableTarget&&this.localTarget.removeChild(this.clickableTarget),this.tag.vpaidWrapperData.mediatype=2,this.debugTracker.info("ParserResponded[JsMobile]",s),this.type="javascript",this.vpaidHandlerType="JsVpaidMobile",this.pixelManager.loadPixelData(i),this._createHandler(t,e,E.default,{registerAnalyticsToVpaidLog:this.registerAnalytics}),this._updateAdVideoDurationOnVideoControls(n)}},{key:"_onMp4VideoMobile",value:function(t,e,i,s,n){this.tag.vpaidWrapperData.mediatype=1,this.debugTracker.info("ParserResponded[VideoMobile]",s),this.type="mp4",this.vpaidHandlerType="VideoVpaidMobile",this.pixelManager.loadPixelData(i),this._createHandler(t,e,V.default,{duration:n},i),this._updateAdVideoDurationOnVideoControls(n)}},{key:"_onSpotxAdOs",value:function(t,e){this.clickableTarget&&this.localTarget.removeChild(this.clickableTarget),this.tag.vpaidWrapperData.mediaType=4,this.debugTracker.info("ParserResponded[SpotxAdOs]",t),this.type="spotxAdOs",this.vpaidHandlerType="SpotxAdOs",this.pixelManager.loadPixelData(e),this._createHandler([],"",y.default,{vastParser:this.parser,adOptions:t,registerAnalyticsToVpaidLog:this.registerAnalytics})}},{key:"_createHandler",value:function(t,e,i,s,n){if(!this.stopped){if(this.useIframeOnVpaidWrapper&&!this.iframeWrapperLoaded)return void this.store.set("vpaidWrapper"+this.index+"Handler",{filesArray:t,AdParamString:e,handlerType:i,options:s,trackingPixels:n});if(this.vpaidLog.setVastWrapperCount(this.parser.wrappersCount),m.logToBI(this.vpaidLog,"creatingVpaidHandler",{type:this.vpaidHandlerType}),this._setTimers(),this.creatives.AdParameters=e,this.vpaidHandler=new i({applyBypass:!!this.creatives.AFBP,slot:this.localTarget,videoSlot:this.localVideo,videoSlotControls:!!this.config.videoSlotControls,videoSlotCanAutoPlay:!!this.config.videoSlotCanAutoPlay,protection:this.config.vpaid_protect_path,adParams:e,vpaidFiles:t,tag:this.tag,onReady:this._onHandlerCreated.bind(this),onError:this._onHandlerError.bind(this),onSwitchFromCanvasToVideo:this._onSwitchFromCanvasToVideo.bind(this),extra:s||{},trackingPixels:n,clickableTarget:this.clickableTarget||null,playerDAST:this.playerDAST},this.vpaidLog,this.store),this.vpaidHandler._onHijackAttempt=this.hijackAttempt.bind(this),this.store.getByLineItem("moat",this.tag))if(this.moatTracker)m.logToBI(this.vpaidLog,"doubleMoat",{text:"tried to initiate moat more than once"});else{if(!this.store.get("moat")){var r=this.store.getByLineItem("mtfctr",this.tag);if(m.getRandomInt(0,100)>r)return}this.moatTracker=new U.default({container:this.vpaidHandler.getDOMContainer(),tag:this.tag,moatPartnerCode:this.store.getByLineItem("moatPartnerCode",this.tag),duration:this.vpaidHandler.getAdDuration(),url:this.vpaidHandler.mediaFiles[0].url,store:this.store,vpaidLog:this.vpaidLog})}}}},{key:"_cleanVpaid",value:function(){if(!(this.clean||this.stayAlive&&this.isReplayable)){if(this.clean=!0,this.vpaidLog&&(this.vpaidLog.saveToDb(),this.vpaidLog.getVpaidAnalyticsReport=void 0),this.wflog&&(this.wflog.complete(),this.wflog=void 0),this.pixelManager&&this.pixelManager.destroy(),this.beacon&&(this.beacon.listEvents(),this.beacon.destroy()),this.localTarget){this.localVideo.parentElement&&this.localTarget.removeChild(this.localVideo);var t=this.localTarget.querySelectorAll("iframe");this._clearIframe(t&&t.length?t[0]:null),this.localTarget.parentNode.removeChild(this.localTarget)}this.localIframe&&this.localIframe.parentElement&&this.localIframe.parentElement.removeChild(this.localIframe),this.adTarget&&this.adTarget.parentNode.removeChild(this.adTarget),this.timeoutToAdCompletion=clearTimeout(this.timeoutToAdCompletion),this.globalAdTimeout=clearTimeout(this.globalAdTimeout),this._killTimers(),this.parser.destroy(),this.vpaidHandler&&(this.vpaidHandler._onHijackAttempt=null),this.moatTracker&&this.moatTracker.dispose(),this.status="stopped",this.working=!1,this.VideoControls&&this.VideoControls.destroy(),this.playerDAST&&this.playerDAST.destroy(),this.store&&(this._bindedOnAdLoadVideoThrottleDelayEnd&&(this.store.removeListener(this.onThrottleEndEventName,this._bindedOnAdLoadVideoThrottleDelayEnd),this._bindedOnAdLoadVideoThrottleDelayEnd=void 0),this._bindedOnRemovedFromVideoThrottleListeners&&(this.store.removeListener(this.onRemovedFromThrottleListenersEventName,this._bindedOnRemovedFromVideoThrottleListeners),this._bindedOnRemovedFromVideoThrottleListeners=void 0)),this.creatives=this.vpaidLog=this.parser=this.debugTracker=this.manager=this.tag=this.vast=this.beacon=this.pixelManager=this.config=this.vpaidEvents=this.localTarget=this.localIframe=this.vpaidHandler=this.store=this._wfStats=this.localVideo=this.VideoControls=void 0,this.isPlaying=!1,window.setTimeout(this.onAfterStop,0),this.emit("vpaidCleaned")}}},{key:"_clearIframe",value:function(t){t&&(m.DOMIterator(t,"iframe",function(t){var e=cmTag.$;t.forEach(function(t){e(t).remove()})},"*",this.store.get("debug")),t&&t.parentNode.removeChild(t))}},{key:"bringToFront",value:function(){if(this.localTarget&&!this.blockBringToFront){var t=this.store.get("height");this.localTarget.style.display="block",this.localTarget.style.height=t+"px";var e=Z++ +99;this.localTarget.style.zIndex=e,this.localIframe&&(this.localIframe.style.display="block",this.localIframe.style.height=t+"px"),this.clickableTarget&&(this.clickableTarget.style.zIndex=e),this.vpaidHandler&&(this.vpaidHandler.zIndex=e),this.VideoControls&&this.VideoControls.setState({isVisible:!0}),this.toggleIframeContentDisplay("hide")}}},{key:"moveToBack",value:function(){this.localTarget&&(this.localTarget.style.zIndex=0,this.localIframe&&(this.localIframe.style.zIndex=0),this.clickableTarget&&(this.clickableTarget.style.zIndex=0))}},{key:"subscribe",value:function(t,e){this.stopped||this.vpaidEvents[e]&&this.beacon.addEventListener(e,t)}},{key:"unsubscribe",value:function(t,e){this.vpaidEvents&&this.vpaidEvents[e]&&this.beacon.removeEventListener(e,t)}},{key:"stop",value:function(t,e,i){var s=this;if(!("global_ad_timeout"!==t&&this.stayAlive&&this.isReplayable||this.stopped)){if(t&&"hijackAttempt"!==t&&(i&&i.eventData?m.logToBI(this.vpaidLog,t,{eventDataStr:m.stringify(i.eventData),status:this.status}):m.logToBI(this.vpaidLog,t,{status:this.status})),this._stopForceAdVolumeInterval(),!this.hadImpression){var n=this.store.get("failsCount")+1;this.store.set("failsCount",n),m.logToBI(this.vpaidLog,"fails",{count:n},!0)}this._wfStats&&(this.hadImpression||this._wfStats.increaseFailure(),m.logToBI(this.vpaidLog,"wfStats",{data:this._wfStats.getData()})),this.isStarted&&this.store.decr("ads_started"),this.stopReason=t,this.oldStatus+=this.status,this.isPlaying=!1,void 0!==e&&this._sendOpp(e),this.stopped=!0,this.vpaidHandler&&(this.vpaidHandler.onAfterStop=this._cleanVpaid.bind(this),this.vpaidHandler.stopAd()),this.emit("end"),this.store.emit("vpaidEnded",this),setTimeout(function(){s._cleanVpaid()},2),"global_ad_timeout"===t&&(this.isReplayable=!1,this.isVForceActive||this.store.emit("hideAdPlayer"))}}},{key:"callVpaidMethod",value:function(t,e,i){if(!this.stopped){if(this.vpaidHandler&&this.vpaidHandler.callIMAApi&&("pauseAd"!=t&&"resumeAd"!=t||this.vpaidHandler.callIMAApi(t)),m.logToBI(this.vpaidLog,"vpaidApi_"+t,{}),"setAdVolume"==t&&(this.adVolume=m.normalizeVolume(e[0])),"pauseAd"==t&&(this.isUnPaused=!1),"resizeAd"==t&&this._resizeContainers(e[0],e[1],e[2]),!this.vpaidHandler||!this.vpaidHandler[t])return i;try{return this.vpaidHandler[t].apply(this.vpaidHandler,e)}catch(t){return i}}}},{key:"_resizeContainers",value:function(t,e,i){this.localVideo.style.width=t+"px",this.localVideo.style.height=e+"px",this.localVideo.setAttribute("width",t),this.localVideo.setAttribute("height",e),this.localTarget.style.width=t+"px",this.localTarget.style.height=e+"px",this.localTarget.setAttribute("width",t),this.localTarget.setAttribute("height",e),this.localIframe&&(this.localIframe.style.width=t+"px",this.localIframe.style.height=e+"px",this.localIframe.setAttribute("width",t),this.localIframe.setAttribute("height",e))}},{key:"onAfterStop",value:function(){}},{key:"hijackAttempt",value:function(t,e){if(!this.hijackFired){this.hijackFired=!0,(new Image).src="//convusmp.basebanner.com/st?cijs=0&ttype=5&pix=31542217&dast="+this.tag.dast+"&"+(new Date).getTime(),m.logToBI(this.vpaidLog,"hijackAttempt",{badUrl:t,earlyHijack:!!e&&e});var i=this.store.get("hjkstp")!==!1;i&&this.stop("hijackAttempt",O.default.hijackAttempt)}}},{key:"fire99",value:function(){this._sendOpp(this.oppsID.firstImpression)}},{key:"_onEvent",value:function(t,e){if(this.pendingEvents&&this.pendingEvents.hasOwnProperty(t)){var i=this.pendingEvents[t];i.timeoutId!=-1&&clearTimeout(i.timeoutId),i.cb&&"function"==typeof i.cb&&i.cb(e),delete this.pendingEvents[t]}}},{key:"_waitForEvent",value:function(t,e,i,s){var n=function(){},r=-1,o=this;e>0&&s&&"function"==typeof s&&(r=setTimeout(function(){m.logToBI(this.vpaidLog,"vpaidTimeout_"+t,{}),s(),delete o.pendingEvents[t],r=null,i=n,s=n}.bind(this),e)),this.pendingEvents||(this.pendingEvents={}),this.pendingEvents[t]={cb:i,timeoutId:r}}},{key:"_onAdLoadedTimeout",value:function(){this.error="adloadedTimeout",this.stop(this.error,this.oppsID.adloadedTimeout)}},{key:"_onAdLoadedEvent",value:function(){}},{key:"_onAdImpressionTimeout",value:function(){this.error="adImpressionTimeout",this.stop(this.error)}},{key:"_onAdImpressionEvent",value:function(){}},{key:"setVastPrice",value:function(t){this.tag.vpaidWrapperData.vastPrice=t,t>0&&m.logToBI(this.vpaidLog,"vastPrice",{value:t})}},{key:"setVastType",value:function(t){this.tag.vpaidWrapperData.vastType=t}},{key:"setVastIcons",value:function(t){var e=this.store.getByLineItem("fkadchcs",this.tag);e?(this.hasAdChoices=!0,m.logToBI(this.vpaidLog,"ad_choices",{fakeAdChoices:!0})):(this.tag.vpaidWrapperData.icons=t,this.hasAdChoices=t.length,this.hasAdChoices&&(this._addAdChoiceDiv(t),m.logToBI(this.vpaidLog,"ad_choices",{vast:t})))}},{key:"_addAdChoiceDiv",value:function(t){var e=!0,i=!1,s=void 0;try{for(var n,r=t[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var o=n.value;if(o.attributes.program&&this.iconsPrograms.indexOf(o.attributes.program)===-1){this.iconsPrograms.push(o.attributes.program);var a=document.createElement("div");a.className="_cm-ad-choices-player",a.style.zIndex=""+(Z+10),o.attributes.xPosition&&(a.style.left="initial",a.style[o.attributes.xPosition]="13px"),o.attributes.yPosition&&(a.style.top="initial",a.style[o.attributes.yPosition]="16px");var d=document.createElement("a");if(o.clickThroughUrl&&(d.href=o.clickThroughUrl),d.onclick=this._appendOnClick(o),d.target="_blank",d.className="_cm-ad-choices-player-anchor",d.style.width=o.attributes.width||"19px",d.style.height=o.attributes.height||"15px",o.staticresource)d.style.background="#fff url("+o.staticresource+") no-repeat center center";else if(o.htmlresource){var l=document.createElement("template");l.innerHTML=o.htmlresource,d.appendChild(l.content.childNodes[0])}if(o.iconViewTracking.length){var u=o.iconViewTracking;this.fireViewTracking=function(){setTimeout(function(t){var e=!0,i=!1,s=void 0;try{for(var n,r=t[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var o=n.value;(new Image).src=o}}catch(t){i=!0,s=t}finally{try{!e&&r.return&&r.return()}finally{if(i)throw s}}},5e3,u)}}a.appendChild(d),this.localVideo.parentElement.appendChild(a)}}}catch(t){i=!0,s=t}finally{try{!e&&r.return&&r.return()}finally{if(i)throw s}}}},{key:"_appendOnClick",value:function(t){return function(){var e=!0,i=!1,s=void 0;try{for(var n,r=t.clickTracking[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var o=n.value;(new Image).src=o}}catch(t){i=!0,s=t}finally{try{!e&&r.return&&r.return()}finally{if(i)throw s}}}}},{key:"_copyFromStoreToBi",value:function(t){this.store.get(t)&&m.logToBI(this.vpaidLog,t,this.store.get(t))}},{key:"_handleDataSaver",value:function(){this.isMobile&&!this.vpaidHandler.canvas&&this.store.get("dataSaverDetected")&&(this.isUnPaused=!1,m.logToBI(this.vpaidLog,"dataSaverDetected",{value:!0}))}},{key:"mute",value:function(){this.adVolume=0,this.VideoControls&&this.VideoControls.setState({isMuted:!0})}},{key:"unmute",value:function(){if(this.adVolume=m.normalizeVolume(this.store.get("dfltvlm")),this.VideoControls){if(this.store.get("forceMute"))return void(this.adVolume=0);this.VideoControls.setState({isMuted:!1}),this.adVolume=m.normalizeVolume(this.VideoControls.getValueFromControlsState("volume"))}}},{key:"updateStatusesOnGetAd",value:function(t){m.logToBI(this.vpaidLog,"statusesOnGetAd",{status:this.status,hadImpression:!!this.hadImpression,isStarted:!!this.isStarted,requiredViewability:t.requiredViewability})}},{key:"logVpaidFamily",value:function(){var t=[],e=[];if(this.vpaidHandler.adUnit._iframe&&this.vpaidHandler.adUnit._iframe.contentWindow)for(var i=this.vpaidHandler.adUnit._iframe.contentWindow.document.scripts,s=0;s<i.length;s++)if(i[s].src.indexOf("z.moatads.com")>-1&&i[s].src.split("/").length>4&&t.push(i[s].src.split("/")[3]),i[s].src.indexOf("sc.iasds01.com")>-1){var n=i[s].src.match(/EntityId=([^&]*)/);2===n.length&&e.push("ias-"+n[1])}var r=""+this.tag.dp+(t.length>0?t.join("_"):"")+(e.length>0?e.join("_"):"")+(this.isGoogleIframe?"_ggl":"")+(this.isUnfriendlyIframe?"_ui":"");r!==this.tag.dp&&m.logToBI(this.vpaidLog,"vpaidFamily",{family:r})}},{key:"resizeAd",value:function(t,e,i){if(!this.stopped)try{(void 0==t||isNaN(parseInt(t)))&&(t=!1),(void 0==e||isNaN(parseInt(e)))&&(e=!1);var s=0,n=0;if(!t&&!e)return void this.debugTracker.error("resize","No `height` or `width` specified!");if(e&&t)n=this._convertSizeFromNumberToPixels(e),s=this._convertSizeFromNumberToPixels(t);else{var r;i=i&&i.split(":").length>1?i:this.store.get("playerAspectRatio"),i=i.split(":"),t?(r=parseInt(fullAspectRatio[1])/parseInt(fullAspectRatio[0]),s=this._convertSizeFromNumberToPixels(t),n=this._convertSizeFromNumberToPixels(Math.floor(parseFloat(s)*r))):(r=parseInt(fullAspectRatio[0])/parseInt(fullAspectRatio[1]),n=this._convertSizeFromNumberToPixels(e),s=this._convertSizeFromNumberToPixels(Math.floor(parseFloat(n)*r)))}if(s&&n){var o=parseFloat(s),a=parseFloat(n);this.localTarget.style.width=s,this.localTarget.style.height=n,this.localTarget.setAttribute("width",o),this.localTarget.setAttribute("height",a),this.localIframe&&(this.localIframe.style.width=s,this.localIframe.style.height=n,this.localIframe.setAttribute("width",o),this.localIframe.setAttribute("height",a)),this.localVideo.style.width=s,this.localVideo.style.height=n,this.localVideo.setAttribute("width",o),this.localVideo.setAttribute("height",a),this.isMultiAdsActive&&(this.store.set("width",o.toString()),this.store.set("height",a.toString()),this.store.emit("resizeVpaidWrapper",{width:o,height:a}),this.vpaidHandler.resizeAd(o,a,this.config.viewMode||"normal"))}this.blockBringToFront&&(this.blockBringToFront=!1,this.bringToFront())}catch(t){this.debugTracker.error("resize","Resizing component failed!")}}},{key:"_convertSizeFromNumberToPixels",value:function(t){var e=t+"";return e.search(/px$/g)<0&&(e+="px"),e}},{key:"getCurrentVolume",value:function(){return this.VideoControls?this.VideoControls.getValueFromControlsState("volume"):this.adVolume}},{key:"_onSoundChange",value:function(t){this.vpaidHandler&&this.vpaidHandler.onMuteChanged&&this.vpaidHandler.onMuteChanged(t)}},{key:"_pushConversionDataToWaterfallLog",value:function(){if(this.wflog){var t=this.getVideoUrl();if(t){var e=this.store.get("wfLogUniqueVideoUrls_"+this.wflog.index)||[];e.indexOf(t)<0&&(e.push(t),this.wflog.push("uniqueVideoUrlsCounter",e.length),this.store.set("wfLogUniqueVideoUrls_"+this.wflog.index,e))}this.wflog.push("wfConversionsCounter",this.wflog.get("wfConversionsCounter",0)+1),this.wflog.sendDataOnConversion()}}},{key:"_pushUniqueAdvIdsToWaterfallLog",value:function(){if(this.wflog){var t=this.store.get("wfLogUniqueAdvIds_"+this.wflog.index)||[];t.indexOf(this.tag.advId)<0&&(t.push(this.tag.advId),this.wflog.push("uniqueAdvIdsCounter",t.length),this.store.set("wfLogUniqueAdvIds_"+this.wflog.index,t))}}},{key:"_appendVpaidCSS",value:function(){var t=this.store.getByLineItem("vpdcss",this.tag),e=[];if(void 0!==t){for(var i in t){var s=null;if(s=this.localTarget.className.indexOf(i)>-1?this.localTarget:this.localTarget.querySelectorAll(i)[0])for(var n in t[i])s.style[n]=t[i][n];else e.push("No element matching "+i)}m.logToBI(this.vpaidLog,"appendVpaidCSS",{success:0===e.length,style:m.stringify(t),errors:e.join(",")})}}},{key:"toggleIframeContentDisplay",value:function(t){this.isMultiVpaidUnit&&this.toggleIframeContentDisplayActive&&this.vpaidHandler.toggleIframeContentDisplay&&this.vpaidHandler.toggleIframeContentDisplay(t)}},{key:"_sendOpp",value:function(t){!this.stopped&&this.opportunityManager&&this.opportunityManager.send(this.tag,t,this.playerDAST.get(),this.localVideo?this.localVideo.currentTime:void 0)}},{key:"getAdDuration",value:function(){var t=this;isNaN(this.localVideo.duration)?this.vpaidHandler&&this.vpaidHandler.getAdDuration(function(e,i){t._setVideoControlsDuration(i)}):this._setVideoControlsDuration(this.localVideo.duration)}},{key:"_setVideoControlsDuration",value:function(t){this.VideoControls&&this.VideoControls.setState({vidDuration:t})}},{key:"registerToVPAIDVideoTimeupdateEvent",value:function(){var t=this;if(this.vpaidHandler&&this.vpaidHandler.getVPAIDVideoElement){var e=this.vpaidHandler.getVPAIDVideoElement();null!==e&&e.addEventListener("timeupdate",function(i){t._onTimeupdate(e)})}}},{key:"_onTimeupdate",value:function(t){this.workingVpaid&&t.currentTime>0&&this.VideoControls&&this.VideoControls.setState({preventAdTicker:!0,vidDuration:t.duration,vidCurrentTime:t.currentTime})}},{key:"_onSwitchFromCanvasToVideo",value:function(t){var e=this;t&&t.addEventListener("timeupdate",function(i){e._onTimeupdate(t)})}}]),e}(M.EventEmitter);e.default=J},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=i(3),d=n(a),l=i(8),u=n(l),h=i(1),c=s(h),p=i(13),v=(n(p),i(67)),f=n(v),m=i(66),g=n(m),y=i(18),_=n(y),b=-1,w=1,A=function(){function t(e){var i=this;r(this,t),this.store=e,this.store.set("waterfallFailsInARow",0),this.store.set("waterfallSuccessesInARow",0),this.store.set("waterfallIndex",w),this.encryptWaterfallResponse=this.store.get("encwfrs"),this.wfv=this.store.get("wfv"),this.isBufferModeOn=this.store.get("bfrmd"),this.requiredViewabilityFactor=this.store.get("rvfctr"),this.dynamicNoaopMaxValue=this.store.get("dnapmxvl"),this.mimeEnum=[{id:5,mime:"application/javascript",video:!1},{id:8,mime:"video/x-ms-wmv",video:!0},{id:10,mime:"video/mp4",video:!0},{id:11,mime:"video/ogg",video:!0},{id:12,mime:"video/webm",video:!0}],this.creatives={},this.inHttpsProtocol="https:"===window.location.protocol,this.debugTracker=new d.default("WaterfallManager"),this.cachedTags=!1,this.cacheAge=0,this.staticWf=this.store.get("static_schedule"),this.shouldRun=function(){return!0},this._runBindedWaterfallTicker=this._runWaterfallTicker.bind(this),this._roundTripAverageDuration=0,this._roundTripsCount=0,this._initDynamicWfsValues(),this.store.get("wf_manual")||this.startNextWfTimeout(),this.store.on("stop",this._stop.bind(this)),this.store.on("pausePlayer",this._stop.bind(this));var s=this.store.get("wf_dynmc_ps");s&&(this.store.on("contentPaused",this._stop.bind(this)),this.store.on("contentResumed",this.startNextWfTimeout.bind(this))),this.isFirstRun=!0,this.igonreWfWhenHidden=this.store.get("ignrwfhdn"),this.lineitemMaxFails=this.store.get("mxlifls"),this._registerQueueEvent(),this.maxAllowedEmptyWaterfalls=this.store.get("mxemptwf"),this.store.set("emptyWaterfallsInARow",0),this.store.on("startWf",function(){i.store.set("dlywf",!1),i.runWaterfall("startWf")})}return o(t,[{key:"_shouldDelayWaterfall",value:function(){return this.store.get("dlywf")}},{key:"startNextWfTimeout",value:function(){var t=this;this.wfInterval&&clearTimeout(this.wfInterval),this._calcDynamicWfsValues(),this._delayBetweenWfs>0?this.wfInterval=setTimeout(function(){t._runBindedWaterfallTicker()},this._delayBetweenWfs):this.store.emit("closePlayer")}},{key:"_initDynamicWfsValues",value:function(){this.maxTimeBetweenWaterfalls=this.store.get("mxtmbtwfs"),this.minTimeBetweenWaterfalls=this.store.get("mntmbtwfs"),this.defaultTimeBetweenWaterfalls=this.store.get("time_between_waterfall"),this.timeBetweenWfFunc=this.store.get("tmbtwfs"),"function"!=typeof this.timeBetweenWfFunc&&(this.timeBetweenWfFunc=void 0),this.minTimeBetweenWfFunc=this.store.get("mntmbtwfsf"),"function"!=typeof this.minTimeBetweenWfFunc&&(this.minTimeBetweenWfFunc=void 0),this.defaultMinTimeBetweenWf=this.store.get("mintimwf")||5e3,this.store.set("dynamicWf.lastDelayBetweenWfs",-1),this.store.set("dynamicWf.currentDelayBetweenWfs",-1),this._calcDynamicWfsValues()}},{key:"_calcDynamicWfsValues",value:function(){this._delayBetweenWfs=1e3*this._calcDelayBetweenWf(),this._delayBetweenWfs>0&&(this._minTimeBetweenWf=this._calcMinDelayBetweenWfs()),this._saveDynamicWfsValues()}},{key:"_calcDelayBetweenWf",value:function(){var t=b;if(this.timeBetweenWfFunc)try{t=this.timeBetweenWfFunc(this.store.get("waterfallSuccessesInARow"),this.store.get("waterfallFailsInARow"),this.store,!document.hidden)}catch(e){t=this.defaultTimeBetweenWaterfalls}return t>this.maxTimeBetweenWaterfalls?t=b:t<this.minTimeBetweenWaterfalls&&(t=this.minTimeBetweenWaterfalls),t}},{key:"_calcMinDelayBetweenWfs",value:function(){var t=this.defaultMinTimeBetweenWf;if(this.minTimeBetweenWfFunc)try{t=this.minTimeBetweenWfFunc(this.store.get("waterfallSuccessesInARow"),this.store.get("waterfallFailsInARow"),this.store,!document.hidden)}catch(e){t=this.defaultMinTimeBetweenWf}return t}},{key:"_saveDynamicWfsValues",value:function(){this.store.set("dynamicWf.lastDelayBetweenWfs",this.store.get("dynamicWf.currentDelayBetweenWfs")),this.store.set("dynamicWf.currentDelayBetweenWfs",this._delayBetweenWfs)}},{key:"_registerQueueEvent",value:function(){var t=this.store.get("run_wf_when_empty");t&&this.store.on("playFromEmptyQueue",this.runWaterfall.bind(this,"queueEmpty"))}},{key:"_isInIdleMode",value:function(){return this.store.get("isIdleMode")}},{key:"_runWaterfallTicker",value:function(){this.startNextWfTimeout(),this.runWaterfall("interval")}},{key:"init",value:function(t,e){this.creatives=t,this.store.set("creatives",t),this.adParams=e,this._shouldRunWaterfallOnInit()&&this.runWaterfall("run_wf_on_init")}},{key:"_shouldRunWaterfallOnInit",value:function(){return this.store.get("run_wf_on_init")}},{key:"_serveStaticWf",value:function(t){this._getRollType();var e=0;"mid-roll"==this.currentRollType?e=1:"post-roll"==this.currentRollType&&(e=2);var i=new Function("try { return "+this.staticWf[e].ad_parameters+";} catch(e){}")();this._handleWaterfallSuccess(c.stringify(i.waterfall),t)}},{key:"runWaterfall",value:function(t){var e=this;if(!this.passedMaxEmptyWaterfalls()&&!this.store.get("first_look")&&("function"!=typeof this.shouldRun||this.shouldRun())&&!this._shouldDelayWaterfall()&&!this._isInIdleMode()){var i=this,s=(new Date).getTime(),n=this.lastRun?s-this.lastRun:this._minTimeBetweenWf;if(!(n<this._minTimeBetweenWf)){this.lastRun=s;var r=new f.default(this.store);if(this.staticWf)return void setTimeout(function(){e._serveStaticWf(r)},20);1===w&&c.reportDebug("player_waterfall","firstwf",{type:"debug",message:"firstwf",fullPageUrl:this.store.get("fullPageUrl"),player_id:this.store.get("player_id")},this.store);var o=this.store.get("pstflrs")===!0,a=this.store.get("psthdrs")||"application/json";this.lastRun=s,r.requestTime=Date.now(),r.ignoredLineitems=[],r.push("reason",t),r.push("waterfallIndex",w),r.push("sinceLastWf",n),r.push("queueLength",this.store.get("queueLength")),r.push("vpaidReadyCount",this.store.get("vpaidReadyCount")),r.push("vpaidPendingCount",this.store.get("queueLength")-this.store.get("vpaidReadyCount")),r.push("failsInARow",this.store.get("waterfallFailsInARow")),r.push("successesInARow",this.store.get("waterfallSuccessesInARow")),r.push("lastDelayBetweenWfs",this.store.get("dynamicWf.lastDelayBetweenWfs")),r.push("currentDelayBetweenWfs",this.store.get("dynamicWf.currentDelayBetweenWfs")),r.push("emptyWaterfallsInARow",this.store.get("emptyWaterfallsInARow")),r.push("maxAllowedEmptyWaterfalls",this.maxAllowedEmptyWaterfalls),r.push("encryptedResponse",this.encryptWaterfallResponse),r.push("waterfallVersion",this.wfv),r.push("navigatorConnection",this.store.get("navigatorConnection")),this.isBufferModeOn&&r.push("bufferMode",this.store.get("bufferModeList")||[]);var d=function(t){i._handleWaterfallError(t,r)},l=function(t){i._handleWaterfallSuccess(t,r)},h=this._generateWaterfallUrl(this.creatives,this._runMimeTypeCheck());r.push("url",h);try{for(var p,v=h.split("?")[1].split("&"),m={},g=0;g<v.length;g++)p=v[g],m[p.split("=")[0]]=p.split("=")[1];r.push("urlParams",m)}catch(t){}if(r.push("noaop",this.isFirstRun?this.store.get("firstWaterfallNoaop"):this.creatives.NOAOP),h){if(this.adParams&&this.adParams.waterfall)window.setTimeout(this._handleWaterfallSuccess.bind(this,c.stringify(this.adParams.waterfall)),0);else{if(!o)return(0,u.default)(h,"",l,d,!0,!0),w++,this.store.set("waterfallIndex",w),void(this.isFirstRun&&(this.isFirstRun=!1));var y=this._buildPostData();r.push("postData",y),(0,u.default)(h,y,l,d,!0,!0,5e3,a),this.isFirstRun&&(this.isFirstRun=!1)}w++,this.store.set("waterfallIndex",w)}}}}},{key:"_buildPostData",value:function(){var t={fv:[]},e=this.store.get("sessionData");if(e&&(t.sd=e),this.encryptWaterfallResponse&&(t.en=1),t.wfv=this.wfv,this.isBufferModeOn){var i=this.store.get("bufferModeList")||[];i.length>0&&(t.bm=i)}var s=this.store.get("lineItems")||[];if(s.length>0){var n=this;s.map(function(e){var i=n.store.get(e);t.fv.push({li:e,f:i.fails,fr:i.failsRow,c:i.conversions,t:i.tries})})}var r=this.store.getWfData();t.adv=r,!this.sentCookiesData&&this.store.get("EP_PLAYER")&&(t.ls=this.store.get("EP_PLAYER"),
this.sentCookiesData=!0);var o=this.store.get("navigatorConnection")||{};t.cdl=o.downlink||0,t.cet=o.effectiveTypeId||0,t.ct=o.typeId||0,t.crt=o.rtt||0,t.csd=o.saveData===!0?1:0;var a=c.stringify(t);return a}},{key:"_runMimeTypeCheck",value:function(){var t=document.createElement("video"),e=[];e.push(5);for(var i=0;i<this.mimeEnum.length;i++){var s=this.mimeEnum[i];s.video&&t.canPlayType(s.mime)&&e.push(s.id)}return t=void 0,e}},{key:"passedMaxEmptyWaterfalls",value:function(){return!!this.maxAllowedEmptyWaterfalls&&this.store.get("emptyWaterfallsInARow")>this.maxAllowedEmptyWaterfalls}},{key:"_handleWaterfallSuccess",value:function(t,e){if(this.store.incr("emptyWaterfallsInARow"),!this.igonreWfWhenHidden){if(this._addRoundTripDuration(),!t)return this.debugTracker.info("runWaterfall","Empty Waterfall!"),this.store.incr("waterfallFailsInARow"),this.store.set("waterfallSuccessesInARow",0),void this._handleWaterfallError("empty-response",e);this.encryptWaterfallResponse&&(t=this._decodeText(t));var i=new Function("try { return "+t+";} catch(e){}")();if(!(i&&i.tags&&i.tags.length)){var s=i&&i.tags?"Failed to decode empty server response":"Failed to decode server response!";return this.debugTracker.warn("runWaterfall",s),this.store.incr("waterfallFailsInARow"),this.store.set("waterfallSuccessesInARow",0),void this._handleWaterfallError("no-tags",e)}this.store.set("emptyWaterfallsInARow",0),this.debugTracker.info("Waterfall number "+(e.index+1)+" received",i.tags,{color:"#D15EFF"}),this.store.set("sessionData",i.sd),i&&i.pixel_piggies&&this._firePiggies(i.pixel_piggies);var n=[];for(var r in i.tags){var o=i.tags[r];if(o.url||o.vast){o.score=-1,o.waterfallTagId=r,o.created=(new Date).getTime(),o.dp=(o.lp&&o.lp.length>0&&o.lp[0]?o.lp[0]:"").replace(/http:\/\/|.com|https:\/\/|.com/g,"")||"na",o.dpFull=o.lp&&o.lp.length>0?o.lp[0]:"na",o.conversionPixels=o.conversionPixels||[],o.ts=Date.now(),o.wfIndex=e?e.get("waterfallIndex",-1):w,o.url=o.url?c.replaceMacros(o.url,this.store):"",o.vast=o.vast?c.replaceMacros(o.vast,this.store):"",o.pixel=o.pixel?this._getPixel(o.pixel):"",o.brand=o.brand||"",o.rollType=this.currentRollType,o.pubId=this.pubid,o.tagId=this.tagid,o.isRon=this.isRon,o.cstmdl=o.cstmdl||-1;var a=o.pixel.match("cirid=([^&]*)");a&&a.length&&(o.cirid=a[1]),o.dast=o.pixel?this._getDastFromPixel(o.pixel):"",o.vidDast=o.pixel?this._getVidDastFromPixel(o.pixel):"",o.campaignId=this._getCampaignId(o.vidDast),o.lineItem=o.lineItemId||this._getDastVal(o.dast,"cicmp"),o.lineItem=o.lineItem.toString(),o.url&&0===o.url.indexOf("http:")&&(this.store.get("usscrtgurl")||this.inHttpsProtocol&&this.store.get("httpsOverride"))&&(o.url=o.url.replace("http:","https:")),this._overrideParamsByDemand(o),this._decodeItemParams(o),this.requiredViewabilityFactor>0&&!o.requiredViewability&&(o.requiredViewability=this._drawRequiredViewabilityByFactor(o)),this._ignoreLineitem(o.lineItem)?(e.ignoredLineitems.push(o.lineItem),e.push("ignoreLineitems",e.ignoredLineitems),this.store.get(o.lineItem+".failsRow")?this.store.incr(o.lineItem+".failsRow"):this.store.set(o.lineItem+".failsRow",1)):n.push(o),this.store.get(o.lineItem)||this.store.set(o.lineItem,{failsRow:0,tries:0,conversions:0,fails:0}),o.lineItemStats=c.deepClone(this.store.get(o.lineItem))}}n.length>0?(this._pushTagsResponseToWaterfallLog(e,n),i.tags=n,i.data=new g.default(this.store,w),this.onWaterfallSuccess(i,e),e&&(e.push("duration",Date.now()-e.requestTime),e.push("response",t),e.push("tagsCount",n.length),e.push("success",!0),this._sendWfLog(e)),this.store.emit("waterfallData",i)):(this.debugTracker.error("runWaterfall","Failed to get any tags!"),this._handleWaterfallError("no-clean-tags",e))}}},{key:"_drawRequiredViewabilityByFactor",value:function(t){var e=!!(c.getRandomInt(0,100)<=this.requiredViewabilityFactor&&t&&t.brand);return e&&(t.requiredViewabilityDrawn=!0),e}},{key:"_pushTagsResponseToWaterfallLog",value:function(t,e){t&&e.map(function(e,i){var s=Object.assign({},e);t.push("tagResponse_"+i,c.flattenObject(s))})}},{key:"_overrideParamsByDemand",value:function(t){this.store.get("ovrtgbydc")&&(t=Object.assign(t,this.store.getByAdvId("ovrdtag",t.advId)))}},{key:"_sendWfLog",value:function(t){var e={wfRoundTripAverageDuration:this.store.get("performance.wfRoundTripAverageDuration"),performanceMeasurment:this.store.get("performance.performanceMeasurment")};t.push("performance",e),t.push("conversionsCount",this.store.get("conversionsCount")),t.push("unit",{width:this.store.get("width"),height:this.store.get("height")}),this.store.get("vForce")&&t.push("getAdData",this.store.get("getAdData"))}},{key:"_addRoundTripDuration",value:function(){var t=Date.now()-this.lastRun;this._roundTripAverageDuration=parseInt((this._roundTripAverageDuration*this._roundTripsCount+t)/(this._roundTripsCount+1)),this.store.set("waterfall_data.last_duration",t),this.store.set("waterfall_data.average_duration",this._roundTripAverageDuration),this._roundTripsCount++}},{key:"_ignoreLineitem",value:function(t){if(this.lineitemMaxFails>0){var e=this.store.get(t),i=e?e.failsRow:-1;return i>this.lineitemMaxFails}return!1}},{key:"_getVidDastFromPixel",value:function(t){var e=t.match('vid-dast=([^&|"]*)');return e&&e.length?e[1]:""}},{key:"_decodeItemParams",value:function(t){t.rpox=this._decodeValue(t.rpox),t.alfrox=this._decodeValue(t.alfrox),t.frox=this._decodeValue(t.frox),t.ex&&(t.crId=t.ex.ecrid,t.stId=t.ex.s,t.cmpgnId=t.ex.ecid,t.ex.b&&(t.brand=this.encryptWaterfallResponse?t.ex.b:this._decodeText(t.ex.b))),t.itemType=t.t}},{key:"_decodeValue",value:function(t){return this.encryptWaterfallResponse?t:(2530^t)/1e3}},{key:"_decodeText",value:function(t){var e;try{e=atob(t)}catch(t){return!1}for(var i,s="",n="PlAyER",r=0;r<e.length;r++)i=r%n.length,s+=String.fromCharCode(e[r].charCodeAt(0).toString(10)^n[i].charCodeAt(0).toString(10));return s}},{key:"_firePiggies",value:function(t){var e=this.store.get("fire_piggies");if(e&&!(w>=5))for(var i=0;i<t.length;i++){var s=t[i];if(s.url){var n=c.setUrlPrefix(s.url);try{(new Image).src=n}catch(t){this.debugTracker.error("_fireIframePig - Malformed url!",t)}}}}},{key:"_fireIframePig",value:function(t){var e=document.createElement("iframe");e.src=t,e.style.display="none";var i=document.getElementsByTagName("body")[0];i||(i=document.getElementsByTagName("html")[0]),i||(i=document.getElementsByTagName("div")[0]),i?i.appendChild(e):this.debugTracker.warn("_fireIframePig","Failed to fire piggies.")}},{key:"_handleWaterfallError",value:function(t,e){this.store.incr("emptyWaterfallsInARow"),this._addRoundTripDuration(),e&&(e.push("duration",Date.now()-e.requestTime),e.push("error",t),e.push("success",!1),this._sendWfLog(e)),this.onWaterfallError(t)}},{key:"_decideNoap",value:function(t){var e;if(this.isFirstRun)e=this.store.get("firstWaterfallNoaop");else if(this.dynamicNoaopMaxValue>0){var i=this.store.get("max_ready_vpaid")||0,s=this.store.get("vpaidReadyCount")||0;e=Math.min(this.dynamicNoaopMaxValue,i-s)}else e=t;return e||t}},{key:"_generateWaterfallUrl",value:function(t,e){var i=this.store.get("wf_base_path")||t.CM_DOMAIN;i+=/.*\/$/g.test(i)?"":"/",i=c.setUrlPrefix(i);var s=[],n=!document.hidden,r=this._getRollType();if(!r)return"";var o=(new Date).getTimezoneOffset();o*=-1;var a=t.SORTORDERTYPE,d=this.store.get("ab_test"),l=this.store.get("mprdct");s.push("oid="+t.OID),s.push("width="+(t.PLAYER_WIDTH||t["PLAYER-WIDTH"])),s.push("height="+(t.PLAYER_HEIGHT||t["PLAYER-HEIGHT"])),s.push("pubid="+(this.pubid||t.PUBID)),s.push("tagid="+(this.tagid||t.TAGID)),s.push("crid="+(this.store.get("creativeId")||"")),s.push("noaop="+this._decideNoap(t.NOAOP)),s.push("sortOrderType="+a),s.push("cb="+(new Date).getTime()),s.push("mimes="+e.join(",")),s.push("isvideo="+t.ISVIDEO),s.push("plmd="+t.PLMD),s.push("mindur="+t.MINDUR),s.push("maxdur="+t.MAXDUR),s.push("minbr="+t.MINBR),s.push("maxbr="+t.MAXBR),s.push("st="+c.getStreamType(r.roll_type)),s.push("seq="+w),s.push("pv="+(this.store.get("player_version")||999)),s.push("pt="+c.crc32(d||999)),s.push("tz="+o),s.push("viewable="+n),s.push("ddast="+this.store.get("auc_dast")),s.push("proto=2,3,5,6"),this.store.get("dtagid")&&s.push("dtagid="+this.store.get("dtagid")),this.store.get("dpubid")&&s.push("dpubid="+this.store.get("dpubid")),d&&s.push("abtst="+d),"undefined"!=typeof l&&s.push("mPre="+l),s.push("encoded=1");var u=this.store.get("pstn")||1;s.push("pstn="+u),t.CIRF&&s.push("cirf="+encodeURIComponent(decodeURIComponent(t.CIRF))),s.push("callback=");var h=this.store.get("wf_xrta");if(h&&s.push(h),this.encryptWaterfallResponse&&s.push("en=1"),s.push("wfv="+this.wfv),this.isBufferModeOn){var p=this.store.get("bufferModeList")||[];p.length>0&&s.push("bm="+p.join(","))}s.push("cdb="+(this.store.get("cdb")||"")),s.push("gdprApplies="+(this.store.get("gdprApplies")||!1));var v=this.store.get("wf_path")||t.SERVICE;return window.lastWfUrl=i+v+"?"+s.join("&"),i+v+"?"+s.join("&")}},{key:"_getPixel",value:function(t){var e=t.split(/<script.*?src="(.*?)"/g);if(1==e.length){if(e=t.split(/<script.*?src='(.*?)'/g),e[1])return e[1].replace(/^http(s:|:)/g,"")}else if(e[1])return e[1].replace(/^http(s:|:)/g,"");return t.replace(/^http(s:|:)/g,"")}},{key:"_getDastFromPixel",value:function(t){var e=t.replace(/\?\?+/g,"?").replace(/&&+/g,"&").split(/\?(.+)?/gi,2);if(2!=e.length)return"";var i=e[1].split(/\?|&/gi);for(var s in i)if(i[s]){var n=i[s].split(/=(.+)?/gi,2);if(2==n.length&&"dast"==n[0])return n[1]}return""}},{key:"onWaterfallError",value:function(){}},{key:"onWaterfallSuccess",value:function(){}},{key:"SetWaterfallError",value:function(t){this.onWaterfallError=t}},{key:"SetWaterfallSuccess",value:function(t){this.onWaterfallSuccess=t}},{key:"SetShouldRun",value:function(t){this.shouldRun=t||function(){}}},{key:"GetCounter",value:function(){return w}},{key:"_getRollType",value:function(){var t,e=this.store.get("contentSchedule")||{},i=null,s=Object.keys(e)||[];return 1===w?(t=s[0],i=e[t]):s.length>0&&(t=s[1],i=e[t]),this.currentRollType=i?i.roll_type:"",this.pubid=i?i.pubid:0,this.tagid=i?i.tagid:0,i}},{key:"_getDastVal",value:function(t,e){var i="";try{i=atob(t)}catch(t){return}var s=i.match(e+"=([^&]*)");return s&&s.length>1?s[1]:""}},{key:"_stop",value:function(){clearTimeout(this.wfInterval)}},{key:"start",value:function(){this.startNextWfTimeout()}},{key:"stop",value:function(){this._stop()}},{key:"_getCampaignId",value:function(t){try{var e=new _.default(t,this.store),i=e.fetchResults();return i&&i.cipid?i.cipid:-1}catch(t){return-1}}}]),t}();e.default=A},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=i(1),a=s(o),d=function(){function t(e,i){n(this,t),this.id=Date.now()+"_"+a.generateGuid(20),this.index=i,this.store=e,this.vpaidsCount=0,this.reportedVpaidsCount=0,this.success=0,this.fails=0,this.isSuccessed=!1}return r(t,[{key:"increaseVpaidsCount",value:function(){this.vpaidsCount++}},{key:"increaseSuccess",value:function(){this.success++,this._update()}},{key:"increaseFailure",value:function(){this.fails++,this._update()}},{key:"_update",value:function(){this.reportedVpaidsCount++,this.isSuccessed||(1===this.success?(this.store.incr("waterfallSuccessesInARow"),this.store.set("waterfallFailsInARow",0),this.isSuccessed=!0):this.reportedVpaidsCount===this.vpaidsCount&&(this.store.incr("waterfallFailsInARow"),this.store.set("waterfallSuccessesInARow",0)))}},{key:"getData",value:function(){return{id:this.id,index:this.index,allVpaidsReported:this.vpaidsCount===this.reportedVpaidsCount,wf_sr:this.store.get("waterfallSuccessesInARow"),wf_fr:this.store.get("waterfallFailsInARow")}}}]),t}();e.default=d},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=i(1),d=s(a),l=0,u=1e4,h=function(){function t(e){var i=this;n(this,t),this.index=l++,this.numberOfConnectedVpaids=0,this.dataChanged=!0,this.store=e,this.created=Date.now(),this.data={_id:d.generateGuid(10),player_id:this.store.get("player_id"),isMobile:this.store.get("isMobile"),created:(new Date).toISOString(),unitType:this.store.get("unit_type"),fullPageUrl:this.store.get("fullPageUrl"),updatesCount:0,taboolaVpaid:this.store.get("istblvpd")},this.sendDataInterval=setInterval(function(){i.dataChanged&&i._sendData()},u)}return o(t,[{key:"push",value:function(t,e){this.data.hasOwnProperty(t)&&!this._hasValueChanged(this.data,t,e)||(this.dataChanged=!0),this.data[t]=e}},{key:"_hasValueChanged",value:function(t,e,i){if("object"!==("undefined"==typeof i?"undefined":r(i)))return t[e]!==i;if(Array.isArray(i)){for(var s=0;s<i.length;s++)if(t[e].indexOf(i[s])<0)return!0;return!1}for(var n in i)if(this._hasValueChanged(this.data[e],n,i[n]))return!0;return!1}},{key:"get",value:function(t,e){return this.data.hasOwnProperty(t)?this.data[t]:e}},{key:"_sendData",value:function(){this.data&&(this.data.updatesCount++,d.reportDebug("player_waterfall","WfLog",this.data,this.store),this.dataChanged=!1)}},{key:"sendDataOnConversion",value:function(){var t=this;setTimeout(function(){t._sendData()},2e3)}},{key:"increaseNumberOfConnectedVpaids",value:function(){this.numberOfConnectedVpaids++}},{key:"complete",value:function(){0==--this.numberOfConnectedVpaids&&(this._sendData(),this.data=this.store=void 0,this.sendDataInterval=clearInterval(this.sendDataInterval))}}]),t}();e.default=h},function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t,e,i){u.indexOf(t)>-1||u.push(t)}function r(t,e,i){u.indexOf(t)>-1||u.push(t)}function o(t){var e=l.crc32(t);u.indexOf(e)>-1||h.push(t)}function a(t,e,i,s){var n=l.crc32(t),r=n+":"+e;return c.indexOf(r)>-1?void l.reportDebug("player_waterfall","doubleOppsPerVidDast",{crcVidDast:n,oppsID:e,tagItem:l.stringify(i)},s):void c.push(r)}Object.defineProperty(e,"__esModule",{value:!0}),e.reportOppsPerVidDastDuplications=e.reportCleanPixel=e.reportVast=e.reportPixel=void 0;var d=i(1),l=s(d),u=[],h=[],c=[];e.reportPixel=n,e.reportVast=o,e.reportCleanPixel=r,e.reportOppsPerVidDastDuplications=a},function(t,e){"use strict";function i(t,e){return new n.Player(t,e)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n={Player:null,VideoElement:null,BitBuffer:null,Source:{},Demuxer:{},Decoder:{},Renderer:{},AudioOutput:{},Now:function(){return window.performance?window.performance.now()/1e3:Date.now()/1e3},CreateVideoElements:function(){for(var t=document.querySelectorAll(".jsmpeg"),e=0;e<t.length;e++)new n.VideoElement(t[e])},Fill:function(t,e){if(t.fill)t.fill(e);else for(var i=0;i<t.length;i++)t[i]=e}};"complete"===document.readyState?n.CreateVideoElements():document.addEventListener("DOMContentLoaded",n.CreateVideoElements),n.VideoElement=function(){var t=function t(e){var i=e.dataset.url;if(!i)throw"VideoElement has no `data-url` attribute";var s=function(t,e){for(var i in e)t.style[i]=e[i]};this.container=e,s(this.container,{display:"inline-block",position:"relative",minWidth:"80px",minHeight:"80px"}),this.canvas=document.createElement("canvas"),this.canvas.width=960,this.canvas.height=540,s(this.canvas,{display:"block",width:"100%"}),this.container.appendChild(this.canvas),this.playButton=document.createElement("div"),this.playButton.innerHTML=t.PLAY_BUTTON,s(this.playButton,{zIndex:2,position:"absolute",top:"0",bottom:"0",left:"0",right:"0",maxWidth:"75px",maxHeight:"75px",margin:"auto",opacity:"0.7",cursor:"pointer"}),this.container.appendChild(this.playButton);var r={canvas:this.canvas};for(var o in e.dataset)try{r[o]=JSON.parse(e.dataset[o])}catch(t){r[o]=e.dataset[o]}if(this.player=new n.Player(i,r),!r.poster||r.autoplay||this.player.options.streaming||(r.decodeFirstFrame=!1,this.poster=new Image,this.poster.src=r.poster,this.poster.addEventListener("load",this.posterLoaded),s(this.poster,{display:"block",zIndex:1,position:"absolute",top:0,left:0,bottom:0,right:0}),this.container.appendChild(this.poster)),this.player.options.streaming||this.container.addEventListener("click",this.onClick.bind(this)),(r.autoplay||this.player.options.streaming)&&(this.playButton.style.display="none"),this.player.audioOut&&!this.player.audioOut.unlocked){var a=this.container;(r.autoplay||this.player.options.streaming)&&(this.unmuteButton=document.createElement("div"),this.unmuteButton.innerHTML=t.UNMUTE_BUTTON,s(this.unmuteButton,{zIndex:2,position:"absolute",bottom:"10px",right:"20px",width:"75px",height:"75px",margin:"auto",opacity:"0.7",cursor:"pointer"}),this.container.appendChild(this.unmuteButton),a=this.unmuteButton),this.unlockAudioBound=this.onUnlockAudio.bind(this,a),a.addEventListener("touchstart",this.unlockAudioBound,!1),a.addEventListener("click",this.unlockAudioBound,!0)}};return t.prototype.onUnlockAudio=function(t,e){this.unmuteButton&&(e.preventDefault(),e.stopPropagation()),this.player.audioOut.unlock(function(){this.unmuteButton&&(this.unmuteButton.style.display="none"),t.removeEventListener("touchstart",this.unlockAudioBound),t.removeEventListener("click",this.unlockAudioBound)}.bind(this))},t.prototype.onClick=function(t){this.player.isPlaying?(this.player.pause(),this.playButton.style.display="block"):(this.player.play(),this.playButton.style.display="none",this.poster&&(this.poster.style.display="none"))},t.PLAY_BUTTON='<svg style="max-width: 75px; max-height: 75px;" viewBox="0 0 200 200" alt="Play video"><circle cx="100" cy="100" r="90" fill="none" stroke-width="15" stroke="#fff"/><polygon points="70, 55 70, 145 145, 100" fill="#fff"/></svg>',t.UNMUTE_BUTTON='<svg style="max-width: 75px; max-height: 75px;" viewBox="0 0 75 75"><polygon class="audio-speaker" stroke="none" fill="#fff" points="39,13 22,28 6,28 6,47 21,47 39,62 39,13"/><g stroke="#fff" stroke-width="5"><path d="M 49,50 69,26"/><path d="M 69,50 49,26"/></g></svg>',t}(),n.Player=function(){var t=function(t,e){this.options=e||{},t.match(/^wss?:\/\//)?(this.source=new n.Source.WebSocket(t,e),e.streaming=!0):e.progressive!==!1?(this.source=new n.Source.AjaxProgressive(t,e),e.streaming=!1):(this.source=new n.Source.Ajax(t,e),e.streaming=!1),this.maxAudioLag=e.maxAudioLag||.25,this.loop=e.loop!==!1,this.autoplay=!!e.autoplay||e.streaming,this.onFinished=e.onfinished,this.demuxer=new n.Demuxer.TS(e),this.source.connect(this.demuxer),e.video!==!1&&(this.video=new n.Decoder.MPEG1Video(e),this.renderer=!e.disableGl&&n.Renderer.WebGL.IsSupported()?new n.Renderer.WebGL(e):new n.Renderer.Canvas2D(e),this.demuxer.connect(n.Demuxer.TS.STREAM.VIDEO_1,this.video),this.video.connect(this.renderer)),e.audio!==!1&&n.AudioOutput.WebAudio.IsSupported()&&(this.audio=new n.Decoder.MP2Audio(e),this.audioOut=new n.AudioOutput.WebAudio(e),this.demuxer.connect(n.Demuxer.TS.STREAM.AUDIO_1,this.audio),this.audio.connect(this.audioOut)),Object.defineProperty(this,"currentTime",{get:this.getCurrentTime,set:this.setCurrentTime}),Object.defineProperty(this,"volume",{get:this.getVolume,set:this.setVolume}),this.unpauseOnShow=!1,e.pauseWhenHidden!==!1&&document.addEventListener("visibilitychange",this.showHide.bind(this)),this.source.start(),this.autoplay&&this.play()};return t.prototype.showHide=function(t){"hidden"===document.visibilityState?(this.unpauseOnShow=this.wantsToPlay,this.pause()):this.unpauseOnShow&&this.play()},t.prototype.play=function(t){this.animationId=requestAnimationFrame(this.update.bind(this)),this.wantsToPlay=!0},t.prototype.pause=function(t){cancelAnimationFrame(this.animationId),this.wantsToPlay=!1,this.isPlaying=!1,this.audio&&this.audio.canPlay&&(this.audioOut.stop(),this.seek(this.currentTime))},t.prototype.getVolume=function(){return this.audioOut?this.audioOut.volume:0},t.prototype.setVolume=function(t){this.audioOut&&(this.audioOut.volume=t)},t.prototype.stop=function(t){this.pause(),this.seek(0),this.video&&this.options.decodeFirstFrame!==!1&&this.video.decode()},t.prototype.seek=function(t){var e=this.audio&&this.audio.canPlay?this.audio.startTime:this.video.startTime;this.video&&this.video.seek(t+e),this.audio&&this.audio.seek(t+e),this.startTime=n.Now()-t},t.prototype.getCurrentTime=function(){return this.audio&&this.audio.canPlay?this.audio.currentTime-this.audio.startTime:this.video.currentTime-this.video.startTime},t.prototype.setCurrentTime=function(t){this.seek(t)},t.prototype.update=function(){return this.animationId=requestAnimationFrame(this.update.bind(this)),this.source.established?(this.isPlaying||(this.isPlaying=!0,this.startTime=n.Now()-this.currentTime),void(this.options.streaming?this.updateForStreaming():this.updateForStaticFile())):void(this.renderer&&this.renderer.renderProgress(this.source.progress))},t.prototype.updateForStreaming=function(){if(this.video&&this.video.decode(),this.audio){var t=!1;do this.audioOut.enqueuedTime>this.maxAudioLag&&(this.audioOut.resetEnqueuedTime(),this.audioOut.enabled=!1),t=this.audio.decode();while(t);this.audioOut.enabled=!0}},t.prototype.updateForStaticFile=function(){var t=this,e=!1,i=0;if(this.audio&&this.audio.canPlay){for(;!e&&this.audio.decodedTime-this.audio.currentTime<.25;)e=!this.audio.decode();this.video&&this.video.currentTime<this.audio.currentTime&&(e=!this.video.decode()),i=this.demuxer.currentTime-this.audio.currentTime}else if(this.video){var s=n.Now()-this.startTime+this.video.startTime,r=s-this.video.currentTime,o=1/this.video.frameRate;this.video&&r>0&&(r>2*o&&(this.startTime+=r),e=!this.video.decode()),i=this.demuxer.currentTime-s}this.source.resume(i),e&&this.source.completed&&(this.loop?this.seek(0):(this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout(function(){t.onFinished()},500),this.pause()))},t}(),n.BitBuffer=function(){var t=function t(e,i){"object"===("undefined"==typeof e?"undefined":s(e))?(this.bytes=e instanceof Uint8Array?e:new Uint8Array(e),this.byteLength=this.bytes.length):(this.bytes=new Uint8Array(e||1048576),this.byteLength=0),this.mode=i||t.MODE.EXPAND,this.index=0};return t.prototype.resize=function(t){var e=new Uint8Array(t);0!==this.byteLength&&(this.byteLength=Math.min(this.byteLength,t),e.set(this.bytes,0,this.byteLength)),this.bytes=e,this.index=Math.min(this.index,this.byteLength<<3)},t.prototype.evict=function(t){var e=this.index>>3,i=this.bytes.length-this.byteLength;return this.index===this.byteLength<<3||t>i+e?(this.byteLength=0,void(this.index=0)):void(0!==e&&(this.bytes.copyWithin?this.bytes.copyWithin(0,e,this.byteLength):this.bytes.set(this.bytes.subarray(e,this.byteLength)),this.byteLength=this.byteLength-e,this.index-=e<<3))},t.prototype.write=function(e){var i="object"===s(e[0]),n=0,r=this.bytes.length-this.byteLength;if(i)for(var n=0,o=0;o<e.length;o++)n+=e[o].byteLength;else n=e.byteLength;if(n>r)if(this.mode===t.MODE.EXPAND){var a=Math.max(2*this.bytes.length,n-r);this.resize(a)}else this.evict(n);if(i)for(var o=0;o<e.length;o++)this.appendSingleBuffer(e[o]);else this.appendSingleBuffer(e)},t.prototype.appendSingleBuffer=function(t){t=t instanceof Uint8Array?t:new Uint8Array(t),this.bytes.set(t,this.byteLength),this.byteLength+=t.length},t.prototype.findNextStartCode=function(){for(var t=this.index+7>>3;t<this.byteLength;t++)if(0==this.bytes[t]&&0==this.bytes[t+1]&&1==this.bytes[t+2])return this.index=t+4<<3,this.bytes[t+3];return this.index=this.byteLength<<3,-1},t.prototype.findStartCode=function(t){for(var e=0;;)if(e=this.findNextStartCode(),e===t||e===-1)return e;return-1},t.prototype.nextBytesAreStartCode=function(){var t=this.index+7>>3;return t>=this.byteLength||0==this.bytes[t]&&0==this.bytes[t+1]&&1==this.bytes[t+2]},t.prototype.peek=function(t){for(var e=this.index,i=0;t;){var s=this.bytes[e>>3],n=8-(7&e),r=n<t?n:t,o=n-r,a=255>>8-r;i=i<<r|(s&a<<o)>>o,e+=r,t-=r}return i},t.prototype.read=function(t){var e=this.peek(t);return this.index+=t,e},t.prototype.skip=function(t){return this.index+=t},t.prototype.rewind=function(t){this.index=Math.max(this.index-t,0)},t.prototype.has=function(t){return(this.byteLength<<3)-this.index>=t},t.MODE={EVICT:1,EXPAND:2},t}(),n.Source.Ajax=function(){var t=function(t,e){this.url=t,this.destination=null,this.request=null,this.completed=!1,this.established=!1,this.progress=0,this.onReadyCblk=e.onload};return t.prototype.connect=function(t){this.destination=t},t.prototype.start=function(){this.request=new XMLHttpRequest,this.request.onreadystatechange=function(){this.request.readyState===this.request.DONE&&200===this.request.status&&(this.onLoad(this.request.response),this.onReadyCblk())}.bind(this),this.request.onprogress=this.onProgress.bind(this),this.request.open("GET",this.url),this.request.responseType="arraybuffer",this.request.send()},t.prototype.resume=function(t){},t.prototype.abort=function(){this.request.abort()},t.prototype.onProgress=function(t){this.progress=t.loaded/t.total},t.prototype.onLoad=function(t){this.established=!0,this.completed=!0,this.progress=1,this.destination&&this.destination.write(t)},t}(),n.Source.AjaxProgressive=function(){var t=function(t,e){this.url=t,this.destination=null,this.request=null,this.completed=!1,this.established=!1,this.progress=0,this.fileSize=0,this.loadedSize=0,this.chunkSize=e.chunkSize||1048576,this.isLoading=!1,this.loadStartTime=0,this.throttled=e.throttled!==!1};return t.prototype.connect=function(t){this.destination=t},t.prototype.start=function(){this.request=new XMLHttpRequest,this.request.onreadystatechange=function(){this.request.readyState===this.request.DONE&&(this.fileSize=parseInt(this.request.getResponseHeader("Content-Length")),this.loadNextChunk())}.bind(this),this.request.onprogress=this.onProgress.bind(this),this.request.open("HEAD",this.url),this.request.send()},t.prototype.resume=function(t){if(!this.isLoading&&this.throttled){var e=8*this.loadTime+2;e>t&&this.loadNextChunk()}},t.prototype.abort=function(){this.request.abort()},t.prototype.loadNextChunk=function(){var t=this.loadedSize,e=Math.min(this.loadedSize+this.chunkSize-1,this.fileSize-1);return t>=this.fileSize?void(this.completed=!0):(this.isLoading=!0,this.loadStartTime=n.Now(),this.request=new XMLHttpRequest,this.request.onreadystatechange=function(){this.request.readyState===this.request.DONE&&this.request.status>=200&&this.request.status<300?this.onChunkLoad(this.request.response):this.request.readyState===this.request.DONE&&this.loadFails++<3&&this.loadNextChunk()}.bind(this),0===t&&(this.request.onprogress=this.onProgress.bind(this)),this.request.open("GET",this.url+"?"+t+"-"+e),this.request.setRequestHeader("Range","bytes="+t+"-"+e),this.request.responseType="arraybuffer",void this.request.send())},t.prototype.onProgress=function(t){this.progress=t.loaded/t.total},t.prototype.onChunkLoad=function(t){this.established=!0,this.progress=1,this.loadedSize+=t.byteLength,this.loadFails=0,this.isLoading=!1,this.destination&&this.destination.write(t),this.loadTime=n.Now()-this.loadStartTime,this.throttled||this.loadNextChunk()},t}(),n.Source.WebSocket=function(){var t=function(t,e){this.url=t,this.socket=null,this.callbacks={connect:[],data:[]},this.destination=null,this.reconnectInterval=e.reconnectInterval||5,this.shouldAttemptReconnect=!!this.reconnectInterval,this.completed=!1,this.established=!1,this.progress=0};return t.prototype.connect=function(t){this.destination=t},t.prototype.abort=function(){this.shouldAttemptReconnect=!1,this.socket.close()},t.prototype.start=function(){this.shouldAttemptReconnect=!!this.reconnectInterval,this.progress=0,this.established=!1,this.socket=new WebSocket(this.url),this.socket.binaryType="arraybuffer",this.socket.onmessage=this.onMessage.bind(this),this.socket.onopen=this.onOpen.bind(this),this.socket.onerror=this.onClose.bind(this),this.socket.onclose=this.onClose.bind(this)},t.prototype.resume=function(t){},t.prototype.onOpen=function(){this.progress=1,this.established=!0},t.prototype.onClose=function(){this.shouldAttemptReconnect&&setTimeout(function(){this.start()}.bind(this),1e3*this.reconnectInterval)},t.prototype.onMessage=function(t){this.destination&&this.destination.write(t.data)},t}(),n.Demuxer.TS=function(){var t=function(t){this.bits=null,this.leftoverBytes=null,this.guessVideoFrameEnd=!0,this.pidsToStreamIds={},this.pesPacketInfo={},this.startTime=0,this.currentTime=0};return t.prototype.connect=function(t,e){this.pesPacketInfo[t]={destination:e,currentLength:0,totalLength:0,pts:0,buffers:[]}},t.prototype.write=function(t){if(this.leftoverBytes){var e=t.byteLength+this.leftoverBytes.byteLength;this.bits=new n.BitBuffer(e),this.bits.write([this.leftoverBytes,t])}else this.bits=new n.BitBuffer(t);for(;this.bits.has(1504);)this.parsePacket();var i=this.bits.byteLength-(this.bits.index>>3);this.leftoverBytes=i>0?this.bits.bytes.subarray(this.bits.index>>3):null},t.prototype.parsePacket=function(){var t=(this.bits.index>>3)+188;if(71!==this.bits.read(8))throw"Sync Token not found";var e=(this.bits.read(1),this.bits.read(1)),i=(this.bits.read(1),this.bits.read(13)),s=(this.bits.read(2),this.bits.read(2)),n=(this.bits.read(4),this.pidsToStreamIds[i]);if(e&&n){var r=this.pesPacketInfo[n];r&&r.currentLength&&this.packetComplete(r)}if(1&s){if(2&s){var o=this.bits.read(8);this.bits.skip(o<<3)}if(e&&this.bits.nextBytesAreStartCode()){this.bits.skip(24),n=this.bits.read(8),this.pidsToStreamIds[i]=n;var a=this.bits.read(16);this.bits.skip(8);var d=this.bits.read(2);this.bits.skip(6);var l=this.bits.read(8),u=this.bits.index+(l<<3),r=this.pesPacketInfo[n];if(r){var h=0;if(2&d){this.bits.skip(4);var c=this.bits.read(3);this.bits.skip(1);var p=this.bits.read(15);this.bits.skip(1);var v=this.bits.read(15);this.bits.skip(1),h=(1073741824*c+32768*p+v)/9e4,this.currentTime=h,this.startTime===-1&&(this.startTime=h)}var f=a?a-l-3:0;this.packetStart(r,h,f)}this.bits.index=u}if(n){var r=this.pesPacketInfo[n];if(r){var m=this.bits.index>>3,g=this.packetAddData(r,m,t),y=!e&&2&s;(g||this.guessVideoFrameEnd&&y)&&this.packetComplete(r)}}}this.bits.index=t<<3},t.prototype.packetStart=function(t,e,i){t.totalLength=i,t.currentLength=0,t.pts=e},t.prototype.packetAddData=function(t,e,i){t.buffers.push(this.bits.bytes.subarray(e,i)),t.currentLength+=i-e;var s=0!==t.totalLength&&t.currentLength>=t.totalLength;return s},t.prototype.packetComplete=function(t){t.destination.write(t.pts,t.buffers),t.totalLength=0,t.currentLength=0,t.buffers=[]},t.STREAM={PACK_HEADER:186,SYSTEM_HEADER:187,PROGRAM_MAP:188,PRIVATE_1:189,PADDING:190,PRIVATE_2:191,AUDIO_1:192,VIDEO_1:224,DIRECTORY:255},t}(),n.Decoder.Base=function(){var t=function(t){this.destination=null,this.canPlay=!1,this.collectTimestamps=!t.streaming,this.timestamps=[],this.timestampIndex=0,this.startTime=0,this.decodedTime=0,Object.defineProperty(this,"currentTime",{get:this.getCurrentTime
})};return t.prototype.connect=function(t){this.destination=t},t.prototype.write=function(t,e){this.collectTimestamps&&(0===this.timestamps.length&&(this.startTime=t,this.decodedTime=t),this.timestamps.push({index:this.bits.byteLength<<3,time:t})),this.bits.write(e),this.canPlay=!0},t.prototype.seek=function(t){if(this.collectTimestamps){this.timestampIndex=0;for(var e=0;e<this.timestamps.length&&!(this.timestamps[e].time>t);e++)this.timestampIndex=e;var i=this.timestamps[this.timestampIndex];i?(this.bits.index=i.index,this.decodedTime=i.time):(this.bits.index=0,this.decodedTime=this.startTime)}},t.prototype.decode=function(){this.advanceDecodedTime(0)},t.prototype.advanceDecodedTime=function(t){if(this.collectTimestamps){for(var e=-1,i=this.timestampIndex;i<this.timestamps.length&&!(this.timestamps[i].index>this.bits.index);i++)e=i;if(e!==-1&&e!==this.timestampIndex)return this.timestampIndex=e,void(this.decodedTime=this.timestamps[this.timestampIndex].time)}this.decodedTime+=t},t.prototype.getCurrentTime=function(){return this.decodedTime},t}(),n.Decoder.MPEG1Video=function(){var t=function(t){n.Decoder.Base.call(this,t);var e=t.videoBufferSize||524288,i=t.streaming?n.BitBuffer.MODE.EVICT:n.BitBuffer.MODE.EXPAND;this.bits=new n.BitBuffer(e,i),this.customIntraQuantMatrix=new Uint8Array(64),this.customNonIntraQuantMatrix=new Uint8Array(64),this.blockData=new Int32Array(64),this.currentFrame=0,this.decodeFirstFrame=t.decodeFirstFrame!==!1};return t.prototype=Object.create(n.Decoder.Base.prototype),t.prototype.constructor=t,t.prototype.write=function(e,i){if(n.Decoder.Base.prototype.write.call(this,e,i),!this.hasSequenceHeader){if(this.bits.findStartCode(t.START.SEQUENCE)===-1)return!1;this.decodeSequenceHeader(),this.decodeFirstFrame&&this.decode()}},t.prototype.decode=function(){return!!this.hasSequenceHeader&&(this.bits.findStartCode(t.START.PICTURE)===-1?(this.bits.byteLength-(this.bits.index>>3),!1):(this.decodePicture(),this.advanceDecodedTime(1/this.frameRate),!0))},t.prototype.readHuffman=function(t){var e=0;do e=t[e+this.bits.read(1)];while(e>=0&&0!==t[e]);return t[e+2]},t.prototype.frameRate=30,t.prototype.decodeSequenceHeader=function(){var e=this.bits.read(12),i=this.bits.read(12);if(this.bits.skip(4),this.frameRate=t.PICTURE_RATE[this.bits.read(4)],this.bits.skip(30),e===this.width&&i===this.height||(this.width=e,this.height=i,this.initBuffers(),this.destination&&this.destination.resize(e,i)),this.bits.read(1)){for(var s=0;s<64;s++)this.customIntraQuantMatrix[t.ZIG_ZAG[s]]=this.bits.read(8);this.intraQuantMatrix=this.customIntraQuantMatrix}if(this.bits.read(1)){for(var s=0;s<64;s++){var n=t.ZIG_ZAG[s];this.customNonIntraQuantMatrix[n]=this.bits.read(8)}this.nonIntraQuantMatrix=this.customNonIntraQuantMatrix}this.hasSequenceHeader=!0},t.prototype.initBuffers=function(){this.intraQuantMatrix=t.DEFAULT_INTRA_QUANT_MATRIX,this.nonIntraQuantMatrix=t.DEFAULT_NON_INTRA_QUANT_MATRIX,this.mbWidth=this.width+15>>4,this.mbHeight=this.height+15>>4,this.mbSize=this.mbWidth*this.mbHeight,this.codedWidth=this.mbWidth<<4,this.codedHeight=this.mbHeight<<4,this.codedSize=this.codedWidth*this.codedHeight,this.halfWidth=this.mbWidth<<3,this.halfHeight=this.mbHeight<<3,this.currentY=new Uint8ClampedArray(this.codedSize),this.currentY32=new Uint32Array(this.currentY.buffer),this.currentCr=new Uint8ClampedArray(this.codedSize>>2),this.currentCr32=new Uint32Array(this.currentCr.buffer),this.currentCb=new Uint8ClampedArray(this.codedSize>>2),this.currentCb32=new Uint32Array(this.currentCb.buffer),this.forwardY=new Uint8ClampedArray(this.codedSize),this.forwardY32=new Uint32Array(this.forwardY.buffer),this.forwardCr=new Uint8ClampedArray(this.codedSize>>2),this.forwardCr32=new Uint32Array(this.forwardCr.buffer),this.forwardCb=new Uint8ClampedArray(this.codedSize>>2),this.forwardCb32=new Uint32Array(this.forwardCb.buffer)},t.prototype.currentY=null,t.prototype.currentCr=null,t.prototype.currentCb=null,t.prototype.pictureType=0,t.prototype.forwardY=null,t.prototype.forwardCr=null,t.prototype.forwardCb=null,t.prototype.fullPelForward=!1,t.prototype.forwardFCode=0,t.prototype.forwardRSize=0,t.prototype.forwardF=0,t.prototype.decodePicture=function(e){if(this.currentFrame++,this.bits.skip(10),this.pictureType=this.bits.read(3),this.bits.skip(16),!(this.pictureType<=0||this.pictureType>=t.PICTURE_TYPE.B)){if(this.pictureType===t.PICTURE_TYPE.PREDICTIVE){if(this.fullPelForward=this.bits.read(1),this.forwardFCode=this.bits.read(3),0===this.forwardFCode)return;this.forwardRSize=this.forwardFCode-1,this.forwardF=1<<this.forwardRSize}var i=0;do i=this.bits.findNextStartCode();while(i===t.START.EXTENSION||i===t.START.USER_DATA);for(;i>=t.START.SLICE_FIRST&&i<=t.START.SLICE_LAST;)this.decodeSlice(255&i),i=this.bits.findNextStartCode();if(i!==-1&&this.bits.rewind(32),this.destination&&this.destination.render(this.currentY,this.currentCr,this.currentCb),this.pictureType===t.PICTURE_TYPE.INTRA||this.pictureType===t.PICTURE_TYPE.PREDICTIVE){var s=this.forwardY,n=this.forwardY32,r=this.forwardCr,o=this.forwardCr32,a=this.forwardCb,d=this.forwardCb32;this.forwardY=this.currentY,this.forwardY32=this.currentY32,this.forwardCr=this.currentCr,this.forwardCr32=this.currentCr32,this.forwardCb=this.currentCb,this.forwardCb32=this.currentCb32,this.currentY=s,this.currentY32=n,this.currentCr=r,this.currentCr32=o,this.currentCb=a,this.currentCb32=d}}},t.prototype.quantizerScale=0,t.prototype.sliceBegin=!1,t.prototype.decodeSlice=function(t){for(this.sliceBegin=!0,this.macroblockAddress=(t-1)*this.mbWidth-1,this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0,this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.quantizerScale=this.bits.read(5);this.bits.read(1);)this.bits.skip(8);do this.decodeMacroblock();while(!this.bits.nextBytesAreStartCode())},t.prototype.macroblockAddress=0,t.prototype.mbRow=0,t.prototype.mbCol=0,t.prototype.macroblockType=0,t.prototype.macroblockIntra=!1,t.prototype.macroblockMotFw=!1,t.prototype.motionFwH=0,t.prototype.motionFwV=0,t.prototype.motionFwHPrev=0,t.prototype.motionFwVPrev=0,t.prototype.decodeMacroblock=function(){for(var e=0,i=this.readHuffman(t.MACROBLOCK_ADDRESS_INCREMENT);34===i;)i=this.readHuffman(t.MACROBLOCK_ADDRESS_INCREMENT);for(;35===i;)e+=33,i=this.readHuffman(t.MACROBLOCK_ADDRESS_INCREMENT);if(e+=i,this.sliceBegin)this.sliceBegin=!1,this.macroblockAddress+=e;else{if(this.macroblockAddress+e>=this.mbSize)return;for(e>1&&(this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.pictureType===t.PICTURE_TYPE.PREDICTIVE&&(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0));e>1;)this.macroblockAddress++,this.mbRow=this.macroblockAddress/this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth,this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb),e--;this.macroblockAddress++}this.mbRow=this.macroblockAddress/this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth;var s=t.MACROBLOCK_TYPE[this.pictureType];this.macroblockType=this.readHuffman(s),this.macroblockIntra=1&this.macroblockType,this.macroblockMotFw=8&this.macroblockType,0!==(16&this.macroblockType)&&(this.quantizerScale=this.bits.read(5)),this.macroblockIntra?(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0):(this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.decodeMotionVectors(),this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb));for(var n=0!==(2&this.macroblockType)?this.readHuffman(t.CODE_BLOCK_PATTERN):this.macroblockIntra?63:0,r=0,o=32;r<6;r++)0!==(n&o)&&this.decodeBlock(r),o>>=1},t.prototype.decodeMotionVectors=function(){var e,i,s=0;this.macroblockMotFw?(e=this.readHuffman(t.MOTION),0!==e&&1!==this.forwardF?(s=this.bits.read(this.forwardRSize),i=(Math.abs(e)-1<<this.forwardRSize)+s+1,e<0&&(i=-i)):i=e,this.motionFwHPrev+=i,this.motionFwHPrev>(this.forwardF<<4)-1?this.motionFwHPrev-=this.forwardF<<5:this.motionFwHPrev<-this.forwardF<<4&&(this.motionFwHPrev+=this.forwardF<<5),this.motionFwH=this.motionFwHPrev,this.fullPelForward&&(this.motionFwH<<=1),e=this.readHuffman(t.MOTION),0!==e&&1!==this.forwardF?(s=this.bits.read(this.forwardRSize),i=(Math.abs(e)-1<<this.forwardRSize)+s+1,e<0&&(i=-i)):i=e,this.motionFwVPrev+=i,this.motionFwVPrev>(this.forwardF<<4)-1?this.motionFwVPrev-=this.forwardF<<5:this.motionFwVPrev<-this.forwardF<<4&&(this.motionFwVPrev+=this.forwardF<<5),this.motionFwV=this.motionFwVPrev,this.fullPelForward&&(this.motionFwV<<=1)):this.pictureType===t.PICTURE_TYPE.PREDICTIVE&&(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0)},t.prototype.copyMacroblock=function(t,e,i,s,n){var r,o,a,d,l,u,h,c,p,v=this.currentY32,f=this.currentCb32,m=this.currentCr32;r=this.codedWidth,o=r-16,a=t>>1,d=e>>1,l=1===(1&t),u=1===(1&e),h=((this.mbRow<<4)+d)*r+(this.mbCol<<4)+a,c=this.mbRow*r+this.mbCol<<2,p=c+(r<<2);var g,y,_,b;if(l)if(u)for(;c<p;){for(y=i[h]+i[h+r],h++,g=0;g<4;g++)_=i[h]+i[h+r],h++,b=y+_+2>>2&255,y=i[h]+i[h+r],h++,b|=y+_+2<<6&65280,_=i[h]+i[h+r],h++,b|=y+_+2<<14&16711680,y=i[h]+i[h+r],h++,b|=y+_+2<<22&4278190080,v[c++]=b;c+=o>>2,h+=o-1}else for(;c<p;){for(y=i[h++],g=0;g<4;g++)_=i[h++],b=y+_+1>>1&255,y=i[h++],b|=y+_+1<<7&65280,_=i[h++],b|=y+_+1<<15&16711680,y=i[h++],b|=y+_+1<<23&4278190080,v[c++]=b;c+=o>>2,h+=o-1}else if(u)for(;c<p;){for(g=0;g<4;g++)b=i[h]+i[h+r]+1>>1&255,h++,b|=i[h]+i[h+r]+1<<7&65280,h++,b|=i[h]+i[h+r]+1<<15&16711680,h++,b|=i[h]+i[h+r]+1<<23&4278190080,h++,v[c++]=b;c+=o>>2,h+=o}else for(;c<p;){for(g=0;g<4;g++)b=i[h],h++,b|=i[h]<<8,h++,b|=i[h]<<16,h++,b|=i[h]<<24,h++,v[c++]=b;c+=o>>2,h+=o}r=this.halfWidth,o=r-8,a=t/2>>1,d=e/2>>1,l=1===(t/2&1),u=1===(e/2&1),h=((this.mbRow<<3)+d)*r+(this.mbCol<<3)+a,c=this.mbRow*r+this.mbCol<<1,p=c+(r<<1);var w,A,k,T,C,E;if(l)if(u)for(;c<p;){for(w=s[h]+s[h+r],T=n[h]+n[h+r],h++,g=0;g<2;g++)A=s[h]+s[h+r],C=n[h]+n[h+r],h++,k=w+A+2>>2&255,E=T+C+2>>2&255,w=s[h]+s[h+r],T=n[h]+n[h+r],h++,k|=w+A+2<<6&65280,E|=T+C+2<<6&65280,A=s[h]+s[h+r],C=n[h]+n[h+r],h++,k|=w+A+2<<14&16711680,E|=T+C+2<<14&16711680,w=s[h]+s[h+r],T=n[h]+n[h+r],h++,k|=w+A+2<<22&4278190080,E|=T+C+2<<22&4278190080,m[c]=k,f[c]=E,c++;c+=o>>2,h+=o-1}else for(;c<p;){for(w=s[h],T=n[h],h++,g=0;g<2;g++)A=s[h],C=n[h++],k=w+A+1>>1&255,E=T+C+1>>1&255,w=s[h],T=n[h++],k|=w+A+1<<7&65280,E|=T+C+1<<7&65280,A=s[h],C=n[h++],k|=w+A+1<<15&16711680,E|=T+C+1<<15&16711680,w=s[h],T=n[h++],k|=w+A+1<<23&4278190080,E|=T+C+1<<23&4278190080,m[c]=k,f[c]=E,c++;c+=o>>2,h+=o-1}else if(u)for(;c<p;){for(g=0;g<2;g++)k=s[h]+s[h+r]+1>>1&255,E=n[h]+n[h+r]+1>>1&255,h++,k|=s[h]+s[h+r]+1<<7&65280,E|=n[h]+n[h+r]+1<<7&65280,h++,k|=s[h]+s[h+r]+1<<15&16711680,E|=n[h]+n[h+r]+1<<15&16711680,h++,k|=s[h]+s[h+r]+1<<23&4278190080,E|=n[h]+n[h+r]+1<<23&4278190080,h++,m[c]=k,f[c]=E,c++;c+=o>>2,h+=o}else for(;c<p;){for(g=0;g<2;g++)k=s[h],E=n[h],h++,k|=s[h]<<8,E|=n[h]<<8,h++,k|=s[h]<<16,E|=n[h]<<16,h++,k|=s[h]<<24,E|=n[h]<<24,h++,m[c]=k,f[c]=E,c++;c+=o>>2,h+=o}},t.prototype.dcPredictorY=0,t.prototype.dcPredictorCr=0,t.prototype.dcPredictorCb=0,t.prototype.blockData=null,t.prototype.decodeBlock=function(e){var i,s=0;if(this.macroblockIntra){var r,o;if(e<4?(r=this.dcPredictorY,o=this.readHuffman(t.DCT_DC_SIZE_LUMINANCE)):(r=4===e?this.dcPredictorCr:this.dcPredictorCb,o=this.readHuffman(t.DCT_DC_SIZE_CHROMINANCE)),o>0){var a=this.bits.read(o);0!==(a&1<<o-1)?this.blockData[0]=r+a:this.blockData[0]=r+(-1<<o|a+1)}else this.blockData[0]=r;e<4?this.dcPredictorY=this.blockData[0]:4===e?this.dcPredictorCr=this.blockData[0]:this.dcPredictorCb=this.blockData[0],this.blockData[0]<<=8,i=this.intraQuantMatrix,s=1}else i=this.nonIntraQuantMatrix;for(var d=0;;){var l=0,u=this.readHuffman(t.DCT_COEFF);if(1===u&&s>0&&0===this.bits.read(1))break;65535===u?(l=this.bits.read(6),d=this.bits.read(8),0===d?d=this.bits.read(8):128===d?d=this.bits.read(8)-256:d>128&&(d-=256)):(l=u>>8,d=255&u,this.bits.read(1)&&(d=-d)),s+=l;var h=t.ZIG_ZAG[s];s++,d<<=1,this.macroblockIntra||(d+=d<0?-1:1),d=d*this.quantizerScale*i[h]>>4,0===(1&d)&&(d-=d>0?1:-1),d>2047?d=2047:d<-2048&&(d=-2048),this.blockData[h]=d*t.PREMULTIPLIER_MATRIX[h]}var c,p,v;e<4?(c=this.currentY,v=this.codedWidth-8,p=this.mbRow*this.codedWidth+this.mbCol<<4,0!==(1&e)&&(p+=8),0!==(2&e)&&(p+=this.codedWidth<<3)):(c=4===e?this.currentCb:this.currentCr,v=(this.codedWidth>>1)-8,p=(this.mbRow*this.codedWidth<<2)+(this.mbCol<<3)),this.macroblockIntra?1===s?(t.CopyValueToDestination(this.blockData[0]+128>>8,c,p,v),this.blockData[0]=0):(t.IDCT(this.blockData),t.CopyBlockToDestination(this.blockData,c,p,v),n.Fill(this.blockData,0)):1===s?(t.AddValueToDestination(this.blockData[0]+128>>8,c,p,v),this.blockData[0]=0):(t.IDCT(this.blockData),t.AddBlockToDestination(this.blockData,c,p,v),n.Fill(this.blockData,0)),s=0},t.CopyBlockToDestination=function(t,e,i,s){for(var n=0;n<64;n+=8,i+=s+8)e[i+0]=t[n+0],e[i+1]=t[n+1],e[i+2]=t[n+2],e[i+3]=t[n+3],e[i+4]=t[n+4],e[i+5]=t[n+5],e[i+6]=t[n+6],e[i+7]=t[n+7]},t.AddBlockToDestination=function(t,e,i,s){for(var n=0;n<64;n+=8,i+=s+8)e[i+0]+=t[n+0],e[i+1]+=t[n+1],e[i+2]+=t[n+2],e[i+3]+=t[n+3],e[i+4]+=t[n+4],e[i+5]+=t[n+5],e[i+6]+=t[n+6],e[i+7]+=t[n+7]},t.CopyValueToDestination=function(t,e,i,s){for(var n=0;n<64;n+=8,i+=s+8)e[i+0]=t,e[i+1]=t,e[i+2]=t,e[i+3]=t,e[i+4]=t,e[i+5]=t,e[i+6]=t,e[i+7]=t},t.AddValueToDestination=function(t,e,i,s){for(var n=0;n<64;n+=8,i+=s+8)e[i+0]+=t,e[i+1]+=t,e[i+2]+=t,e[i+3]+=t,e[i+4]+=t,e[i+5]+=t,e[i+6]+=t,e[i+7]+=t},t.IDCT=function(t){for(var e,i,s,n,r,o,a,d,l,u,h,c,p,v,f,m,g,y,_=0;_<8;++_)e=t[32+_],i=t[16+_]+t[48+_],s=t[40+_]-t[24+_],o=t[8+_]+t[56+_],a=t[24+_]+t[40+_],n=t[8+_]-t[56+_],r=o+a,d=t[0+_],p=(473*n-196*s+128>>8)-r,l=p-(362*(o-a)+128>>8),u=d-e,h=(362*(t[16+_]-t[48+_])+128>>8)-i,c=d+e,v=u+h,f=c+i,m=u-h,g=c-i,y=-l-(473*s+196*n+128>>8),t[0+_]=r+f,t[8+_]=p+v,t[16+_]=m-l,t[24+_]=g-y,t[32+_]=g+y,t[40+_]=l+m,t[48+_]=v-p,t[56+_]=f-r;for(var _=0;_<64;_+=8)e=t[4+_],i=t[2+_]+t[6+_],s=t[5+_]-t[3+_],o=t[1+_]+t[7+_],a=t[3+_]+t[5+_],n=t[1+_]-t[7+_],r=o+a,d=t[0+_],p=(473*n-196*s+128>>8)-r,l=p-(362*(o-a)+128>>8),u=d-e,h=(362*(t[2+_]-t[6+_])+128>>8)-i,c=d+e,v=u+h,f=c+i,m=u-h,g=c-i,y=-l-(473*s+196*n+128>>8),t[0+_]=r+f+128>>8,t[1+_]=p+v+128>>8,t[2+_]=m-l+128>>8,t[3+_]=g-y+128>>8,t[4+_]=g+y+128>>8,t[5+_]=l+m+128>>8,t[6+_]=v-p+128>>8,t[7+_]=f-r+128>>8},t.PICTURE_RATE=[0,23.976,24,25,29.97,30,50,59.94,60,0,0,0,0,0,0,0],t.ZIG_ZAG=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),t.DEFAULT_INTRA_QUANT_MATRIX=new Uint8Array([8,16,19,22,26,27,29,34,16,16,22,24,27,29,34,37,19,22,26,27,29,34,34,38,22,22,26,27,29,34,37,40,22,26,27,29,32,35,40,48,26,27,29,32,35,40,48,58,26,27,29,34,38,46,56,69,27,29,35,38,46,56,69,83]),t.DEFAULT_NON_INTRA_QUANT_MATRIX=new Uint8Array([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]),t.PREMULTIPLIER_MATRIX=new Uint8Array([32,44,42,38,32,25,17,9,44,62,58,52,44,35,24,12,42,58,55,49,42,33,23,12,38,52,49,44,38,30,20,10,32,44,42,38,32,25,17,9,25,35,33,30,25,20,14,7,17,24,23,20,17,14,9,5,9,12,12,10,9,7,5,2]),t.MACROBLOCK_ADDRESS_INCREMENT=new Int16Array([3,6,0,9,12,0,0,0,1,15,18,0,21,24,0,27,30,0,33,36,0,0,0,3,0,0,2,39,42,0,45,48,0,0,0,5,0,0,4,51,54,0,57,60,0,0,0,7,0,0,6,63,66,0,69,72,0,75,78,0,81,84,0,-1,87,0,-1,90,0,93,96,0,99,102,0,105,108,0,111,114,0,0,0,9,0,0,8,117,120,0,123,126,0,129,132,0,135,138,0,0,0,15,0,0,14,0,0,13,0,0,12,0,0,11,0,0,10,141,-1,0,-1,144,0,147,150,0,153,156,0,159,162,0,165,168,0,171,174,0,177,180,0,183,-1,0,-1,186,0,189,192,0,195,198,0,201,204,0,207,210,0,213,216,0,219,222,0,0,0,21,0,0,20,0,0,19,0,0,18,0,0,17,0,0,16,0,0,35,0,0,34,0,0,33,0,0,32,0,0,31,0,0,30,0,0,29,0,0,28,0,0,27,0,0,26,0,0,25,0,0,24,0,0,23,0,0,22]),t.MACROBLOCK_TYPE_INTRA=new Int8Array([3,6,0,-1,9,0,0,0,1,0,0,17]),t.MACROBLOCK_TYPE_PREDICTIVE=new Int8Array([3,6,0,9,12,0,0,0,10,15,18,0,0,0,2,21,24,0,0,0,8,27,30,0,33,36,0,-1,39,0,0,0,18,0,0,26,0,0,1,0,0,17]),t.MACROBLOCK_TYPE_B=new Int8Array([3,6,0,9,15,0,12,18,0,24,21,0,0,0,12,27,30,0,0,0,14,39,42,0,36,33,0,0,0,4,0,0,6,54,48,0,45,51,0,0,0,8,0,0,10,-1,57,0,0,0,1,60,63,0,0,0,30,0,0,17,0,0,22,0,0,26]),t.MACROBLOCK_TYPE=[null,t.MACROBLOCK_TYPE_INTRA,t.MACROBLOCK_TYPE_PREDICTIVE,t.MACROBLOCK_TYPE_B],t.CODE_BLOCK_PATTERN=new Int16Array([6,3,0,9,18,0,12,15,0,24,33,0,36,39,0,27,21,0,30,42,0,60,57,0,54,48,0,69,51,0,81,75,0,63,84,0,45,66,0,72,78,0,0,0,60,105,120,0,132,144,0,114,108,0,126,141,0,87,93,0,117,96,0,0,0,32,135,138,0,99,123,0,129,102,0,0,0,4,90,111,0,0,0,8,0,0,16,0,0,44,150,168,0,0,0,28,0,0,52,0,0,62,183,177,0,156,180,0,0,0,1,165,162,0,0,0,61,0,0,56,171,174,0,0,0,2,0,0,40,153,186,0,0,0,48,192,189,0,147,159,0,0,0,20,0,0,12,240,249,0,0,0,63,231,225,0,195,219,0,252,198,0,0,0,24,0,0,36,0,0,3,207,261,0,243,237,0,204,213,0,210,234,0,201,228,0,216,222,0,258,255,0,264,246,0,-1,282,0,285,291,0,0,0,33,0,0,9,318,330,0,306,348,0,0,0,5,0,0,10,279,267,0,0,0,6,0,0,18,0,0,17,0,0,34,339,357,0,309,312,0,270,276,0,327,321,0,351,354,0,303,297,0,294,288,0,300,273,0,342,345,0,315,324,0,336,333,0,363,375,0,0,0,41,0,0,14,0,0,21,372,366,0,360,369,0,0,0,11,0,0,19,0,0,7,0,0,35,0,0,13,0,0,50,0,0,49,0,0,58,0,0,37,0,0,25,0,0,45,0,0,57,0,0,26,0,0,29,0,0,38,0,0,53,0,0,23,0,0,43,0,0,46,0,0,42,0,0,22,0,0,54,0,0,51,0,0,15,0,0,30,0,0,39,0,0,47,0,0,55,0,0,27,0,0,59,0,0,31]),t.MOTION=new Int16Array([3,6,0,12,9,0,0,0,0,18,15,0,24,21,0,0,0,-1,0,0,1,27,30,0,36,33,0,0,0,2,0,0,-2,42,45,0,48,39,0,60,54,0,0,0,3,0,0,-3,51,57,0,-1,69,0,81,75,0,78,63,0,72,66,0,96,84,0,87,93,0,-1,99,0,108,105,0,0,0,-4,90,102,0,0,0,4,0,0,-7,0,0,5,111,123,0,0,0,-5,0,0,7,114,120,0,126,117,0,0,0,-6,0,0,6,153,162,0,150,147,0,135,138,0,156,141,0,129,159,0,132,144,0,0,0,10,0,0,9,0,0,8,0,0,-8,171,198,0,0,0,-9,180,192,0,168,183,0,165,186,0,174,189,0,0,0,-10,177,195,0,0,0,12,0,0,16,0,0,13,0,0,14,0,0,11,0,0,15,0,0,-16,0,0,-12,0,0,-14,0,0,-15,0,0,-11,0,0,-13]),t.DCT_DC_SIZE_LUMINANCE=new Int8Array([6,3,0,18,15,0,9,12,0,0,0,1,0,0,2,27,24,0,21,30,0,0,0,0,36,33,0,0,0,4,0,0,3,39,42,0,0,0,5,0,0,6,48,45,0,51,-1,0,0,0,7,0,0,8]),t.DCT_DC_SIZE_CHROMINANCE=new Int8Array([6,3,0,12,9,0,18,15,0,24,21,0,0,0,2,0,0,1,0,0,0,30,27,0,0,0,3,36,33,0,0,0,4,42,39,0,0,0,5,48,45,0,0,0,6,51,-1,0,0,0,7,0,0,8]),t.DCT_COEFF=new Int32Array([3,6,0,12,9,0,0,0,1,21,24,0,18,15,0,39,27,0,33,30,0,42,36,0,0,0,257,60,66,0,54,63,0,48,57,0,0,0,513,51,45,0,0,0,2,0,0,3,81,75,0,87,93,0,72,78,0,96,90,0,0,0,1025,69,84,0,0,0,769,0,0,258,0,0,1793,0,0,65535,0,0,1537,111,108,0,0,0,1281,105,102,0,117,114,0,99,126,0,120,123,0,156,150,0,162,159,0,144,147,0,129,135,0,138,132,0,0,0,2049,0,0,4,0,0,514,0,0,2305,153,141,0,165,171,0,180,168,0,177,174,0,183,186,0,0,0,2561,0,0,3329,0,0,6,0,0,259,0,0,5,0,0,770,0,0,2817,0,0,3073,228,225,0,201,210,0,219,213,0,234,222,0,216,231,0,207,192,0,204,189,0,198,195,0,243,261,0,273,240,0,246,237,0,249,258,0,279,276,0,252,255,0,270,282,0,264,267,0,0,0,515,0,0,260,0,0,7,0,0,1026,0,0,1282,0,0,4097,0,0,3841,0,0,3585,315,321,0,333,342,0,312,291,0,375,357,0,288,294,0,-1,369,0,285,303,0,318,363,0,297,306,0,339,309,0,336,348,0,330,300,0,372,345,0,351,366,0,327,354,0,360,324,0,381,408,0,417,420,0,390,378,0,435,438,0,384,387,0,0,0,2050,396,402,0,465,462,0,0,0,8,411,399,0,429,432,0,453,414,0,426,423,0,0,0,10,0,0,9,0,0,11,0,0,5377,0,0,1538,0,0,771,0,0,5121,0,0,1794,0,0,4353,0,0,4609,0,0,4865,444,456,0,0,0,1027,459,450,0,0,0,261,393,405,0,0,0,516,447,441,0,516,519,0,486,474,0,510,483,0,504,498,0,471,537,0,507,501,0,522,513,0,534,531,0,468,477,0,492,495,0,549,546,0,525,528,0,0,0,263,0,0,2562,0,0,2306,0,0,5633,0,0,5889,0,0,6401,0,0,6145,0,0,1283,0,0,772,0,0,13,0,0,12,0,0,14,0,0,15,0,0,517,0,0,6657,0,0,262,540,543,0,480,489,0,588,597,0,0,0,27,609,555,0,606,603,0,0,0,19,0,0,22,591,621,0,0,0,18,573,576,0,564,570,0,0,0,20,552,582,0,0,0,21,558,579,0,0,0,23,612,594,0,0,0,25,0,0,24,600,615,0,0,0,31,0,0,30,0,0,28,0,0,29,0,0,26,0,0,17,0,0,16,567,618,0,561,585,0,654,633,0,0,0,37,645,648,0,0,0,36,630,636,0,0,0,34,639,627,0,663,666,0,657,624,0,651,642,0,669,660,0,0,0,35,0,0,267,0,0,40,0,0,268,0,0,266,0,0,32,0,0,264,0,0,265,0,0,38,0,0,269,0,0,270,0,0,33,0,0,39,0,0,7937,0,0,6913,0,0,7681,0,0,4098,0,0,7425,0,0,7169,0,0,271,0,0,274,0,0,273,0,0,272,0,0,1539,0,0,2818,0,0,3586,0,0,3330,0,0,3074,0,0,3842]),t.PICTURE_TYPE={INTRA:1,PREDICTIVE:2,B:3},t.START={SEQUENCE:179,SLICE_FIRST:1,SLICE_LAST:175,PICTURE:0,EXTENSION:181,USER_DATA:178},t}(),n.Decoder.MP2Audio=function(){var t=function t(e){n.Decoder.Base.call(this,e);var i=e.audioBufferSize||131072,s=e.streaming?n.BitBuffer.MODE.EVICT:n.BitBuffer.MODE.EXPAND;this.bits=new n.BitBuffer(i,s),this.left=new Float32Array(1152),this.right=new Float32Array(1152),this.sampleRate=44100,this.D=new Float32Array(1024),this.D.set(t.SYNTHESIS_WINDOW,0),this.D.set(t.SYNTHESIS_WINDOW,512),this.V=new Float32Array(1024),this.U=new Int32Array(32),this.VPos=0,this.allocation=[new Array(32),new Array(32)],this.scaleFactorInfo=[new Uint8Array(32),new Uint8Array(32)],this.scaleFactor=[new Array(32),new Array(32)],this.sample=[new Array(32),new Array(32)];for(var r=0;r<2;r++)for(var o=0;o<32;o++)this.scaleFactor[r][o]=[0,0,0],this.sample[r][o]=[0,0,0]};return t.prototype=Object.create(n.Decoder.Base.prototype),t.prototype.constructor=t,t.prototype.decode=function(){var t=this.bits.index>>3;if(t>=this.bits.byteLength)return!1;var e=this.decodeFrame(this.left,this.right);return this.bits.index=t+e<<3,!!e&&(this.destination&&this.destination.play(this.sampleRate,this.left,this.right),this.advanceDecodedTime(this.left.length/this.sampleRate),!0)},t.prototype.getCurrentTime=function(){var t=this.destination?this.destination.enqueuedTime:0;return this.decodedTime-t},t.prototype.decodeFrame=function(e,i){var s=this.bits.read(11),r=this.bits.read(2),o=this.bits.read(2),a=!this.bits.read(1);if(s!==t.FRAME_SYNC||r!==t.VERSION.MPEG_1||o!==t.LAYER.II)return 0;var d=this.bits.read(4)-1;if(d>13)return 0;var l=this.bits.read(2),u=t.SAMPLE_RATE[l];if(3===l)return 0;r===t.VERSION.MPEG_2&&(l+=4,d+=14);var h=this.bits.read(1),c=(this.bits.read(1),this.bits.read(2)),p=0;c===t.MODE.JOINT_STEREO?p=this.bits.read(2)+1<<2:(this.bits.skip(2),p=c===t.MODE.MONO?0:32),this.bits.skip(4),a&&this.bits.skip(16);var v=t.BIT_RATE[d],u=t.SAMPLE_RATE[l],f=144e3*v/u+h|0,m=0,g=0;if(r===t.VERSION.MPEG_2)m=2,g=30;else{var y=c===t.MODE.MONO?0:1,_=t.QUANT_LUT_STEP_1[y][d];m=t.QUANT_LUT_STEP_2[_][l],g=63&m,m>>=6}p>g&&(p=g);for(var b=0;b<p;b++)this.allocation[0][b]=this.readAllocation(b,m),this.allocation[1][b]=this.readAllocation(b,m);for(var b=p;b<g;b++)this.allocation[0][b]=this.allocation[1][b]=this.readAllocation(b,m);for(var w=c===t.MODE.MONO?1:2,b=0;b<g;b++){for(A=0;A<w;A++)this.allocation[A][b]&&(this.scaleFactorInfo[A][b]=this.bits.read(2));c===t.MODE.MONO&&(this.scaleFactorInfo[1][b]=this.scaleFactorInfo[0][b])}for(var b=0;b<g;b++){for(var A=0;A<w;A++)if(this.allocation[A][b]){var k=this.scaleFactor[A][b];switch(this.scaleFactorInfo[A][b]){case 0:k[0]=this.bits.read(6),k[1]=this.bits.read(6),k[2]=this.bits.read(6);break;case 1:k[0]=k[1]=this.bits.read(6),k[2]=this.bits.read(6);break;case 2:k[0]=k[1]=k[2]=this.bits.read(6);break;case 3:k[0]=this.bits.read(6),k[1]=k[2]=this.bits.read(6)}}c===t.MODE.MONO&&(this.scaleFactor[1][b][0]=this.scaleFactor[0][b][0],this.scaleFactor[1][b][1]=this.scaleFactor[0][b][1],this.scaleFactor[1][b][2]=this.scaleFactor[0][b][2])}for(var T=0,C=0;C<3;C++)for(var E=0;E<4;E++){for(var b=0;b<p;b++)this.readSamples(0,b,C),this.readSamples(1,b,C);for(var b=p;b<g;b++)this.readSamples(0,b,C),this.sample[1][b][0]=this.sample[0][b][0],this.sample[1][b][1]=this.sample[0][b][1],this.sample[1][b][2]=this.sample[0][b][2];for(var b=g;b<32;b++)this.sample[0][b][0]=0,this.sample[0][b][1]=0,this.sample[0][b][2]=0,this.sample[1][b][0]=0,this.sample[1][b][1]=0,this.sample[1][b][2]=0;for(var I=0;I<3;I++){this.VPos=this.VPos-64&1023;for(var A=0;A<2;A++){t.MatrixTransform(this.sample[A],I,this.V,this.VPos),n.Fill(this.U,0);for(var V=512-(this.VPos>>1),x=this.VPos%128>>1;x<1024;){for(var S=0;S<32;++S)this.U[S]+=this.D[V++]*this.V[x++];x+=96,V+=32}for(x=1120-x,V-=480;x<1024;){for(var S=0;S<32;++S)this.U[S]+=this.D[V++]*this.V[x++];x+=96,V+=32}for(var P=0===A?e:i,L=0;L<32;L++)P[T+L]=this.U[L]/2147418112}T+=32}}return this.sampleRate=u,f},t.prototype.readAllocation=function(e,i){var s=t.QUANT_LUT_STEP_3[i][e],n=t.QUANT_LUT_STEP4[15&s][this.bits.read(s>>4)];return n?t.QUANT_TAB[n-1]:0},t.prototype.readSamples=function(e,i,s){var n=this.allocation[e][i],r=this.scaleFactor[e][i][s],o=this.sample[e][i],a=0;if(!n)return void(o[0]=o[1]=o[2]=0);if(63===r)r=0;else{var d=r/3|0;r=t.SCALEFACTOR_BASE[r%3]+(1<<d>>1)>>d}var l=n.levels;n.group?(a=this.bits.read(n.bits),o[0]=a%l,a=a/l|0,o[1]=a%l,o[2]=a/l|0):(o[0]=this.bits.read(n.bits),o[1]=this.bits.read(n.bits),o[2]=this.bits.read(n.bits));var u=65536/(l+1)|0;l=(l+1>>1)-1,a=(l-o[0])*u,o[0]=a*(r>>12)+(a*(4095&r)+2048>>12)>>12,a=(l-o[1])*u,o[1]=a*(r>>12)+(a*(4095&r)+2048>>12)>>12,a=(l-o[2])*u,o[2]=a*(r>>12)+(a*(4095&r)+2048>>12)>>12},t.MatrixTransform=function(t,e,i,s){var n,r,o,a,d,l,u,h,c,p,v,f,m,g,y,_,b,w,A,k,T,C,E,I,V,x,S,P,L,F,B,D,O;n=t[0][e]+t[31][e],r=.500602998235*(t[0][e]-t[31][e]),o=t[1][e]+t[30][e],a=.505470959898*(t[1][e]-t[30][e]),d=t[2][e]+t[29][e],l=.515447309923*(t[2][e]-t[29][e]),u=t[3][e]+t[28][e],h=.53104259109*(t[3][e]-t[28][e]),c=t[4][e]+t[27][e],p=.553103896034*(t[4][e]-t[27][e]),v=t[5][e]+t[26][e],f=.582934968206*(t[5][e]-t[26][e]),m=t[6][e]+t[25][e],g=.622504123036*(t[6][e]-t[25][e]),y=t[7][e]+t[24][e],_=.674808341455*(t[7][e]-t[24][e]),b=t[8][e]+t[23][e],w=.744536271002*(t[8][e]-t[23][e]),A=t[9][e]+t[22][e],k=.839349645416*(t[9][e]-t[22][e]),T=t[10][e]+t[21][e],C=.972568237862*(t[10][e]-t[21][e]),E=t[11][e]+t[20][e],I=1.16943993343*(t[11][e]-t[20][e]),V=t[12][e]+t[19][e],x=1.48416461631*(t[12][e]-t[19][e]),S=t[13][e]+t[18][e],P=2.05778100995*(t[13][e]-t[18][e]),L=t[14][e]+t[17][e],F=3.40760841847*(t[14][e]-t[17][e]),B=t[15][e]+t[16][e],D=10.1900081235*(t[15][e]-t[16][e]),O=n+B,B=.502419286188*(n-B),n=o+L,L=.52249861494*(o-L),o=d+S,S=.566944034816*(d-S),d=u+V,V=.64682178336*(u-V),u=c+E,E=.788154623451*(c-E),c=v+T,T=1.06067768599*(v-T),v=m+A,A=1.72244709824*(m-A),m=y+b,b=5.10114861869*(y-b),y=O+m,m=.509795579104*(O-m),O=n+v,n=.601344886935*(n-v),v=o+c,c=.899976223136*(o-c),o=d+u,u=2.56291544774*(d-u),d=y+o,y=.541196100146*(y-o),o=O+v,v=1.30656296488*(O-v),O=d+o,d=.707106781187*(d-o),o=y+v,y=.707106781187*(y-v),o+=y,v=m+u,m=.541196100146*(m-u),u=n+c,c=1.30656296488*(n-c),n=v+u,u=.707106781187*(v-u),v=m+c,m=.707106781187*(m-c),v+=m,n+=v,v+=u,u+=m,c=B+b,B=.509795579104*(B-b),b=L+A,L=.601344886935*(L-A),A=S+T,T=.899976223136*(S-T),S=V+E,E=2.56291544774*(V-E),V=c+S,c=.541196100146*(c-S),S=b+A,A=1.30656296488*(b-A),b=V+S,S=.707106781187*(V-S),V=c+A,A=.707106781187*(c-A),V+=A,c=B+E,B=.541196100146*(B-E),E=L+T,T=1.30656296488*(L-T),L=c+E,E=.707106781187*(c-E),c=B+T,B=.707106781187*(B-T),c+=B,L+=c,c+=E,E+=B,b+=L,L+=V,V+=c,c+=S,S+=E,E+=A,A+=B,T=r+D,r=.502419286188*(r-D),D=a+F,a=.52249861494*(a-F),F=l+P,P=.566944034816*(l-P),l=h+x,h=.64682178336*(h-x),x=p+I,p=.788154623451*(p-I),I=f+C,C=1.06067768599*(f-C),f=g+k,k=1.72244709824*(g-k),g=_+w,_=5.10114861869*(_-w),w=T+g,g=.509795579104*(T-g),T=D+f,D=.601344886935*(D-f),f=F+I,I=.899976223136*(F-I),F=l+x,x=2.56291544774*(l-x),l=w+F,w=.541196100146*(w-F),F=T+f,f=1.30656296488*(T-f),T=l+F,F=.707106781187*(l-F),l=w+f,f=.707106781187*(w-f),l+=f,w=g+x,x=.541196100146*(g-x),g=D+I,I=1.30656296488*(D-I),D=w+g,g=.707106781187*(w-g),w=x+I,I=.707106781187*(x-I),w+=I,D+=w,w+=g,x=g+I,g=r+_,r=.509795579104*(r-_),_=a+k,a=.601344886935*(a-k),k=P+C,C=.899976223136*(P-C),P=h+p,p=2.56291544774*(h-p),h=g+P,g=.541196100146*(g-P),P=_+k,k=1.30656296488*(_-k),_=h+P,P=.707106781187*(h-P),h=g+k,k=.707106781187*(g-k),h+=k,g=r+p,r=.541196100146*(r-p),p=a+C,C=1.30656296488*(a-C),a=g+p,p=.707106781187*(g-p),g=r+C,r=.707106781187*(r-C),g+=r,a+=g,g+=p,p+=r,_+=a,a+=h,h+=g,g+=P,P+=p,p+=k,k+=r,T+=_,_+=D,D+=a,a+=l,l+=h,h+=w;w+=g;g+=F,F+=P,P+=x,x+=p,p+=f,f+=k,k+=I,I+=r,i[s+48]=-O,i[s+49]=i[s+47]=-T,i[s+50]=i[s+46]=-b,i[s+51]=i[s+45]=-_,i[s+52]=i[s+44]=-n,i[s+53]=i[s+43]=-D,i[s+54]=i[s+42]=-L,i[s+55]=i[s+41]=-a,i[s+56]=i[s+40]=-o,i[s+57]=i[s+39]=-l,i[s+58]=i[s+38]=-V,i[s+59]=i[s+37]=-h,i[s+60]=i[s+36]=-v,i[s+61]=i[s+35]=-w,i[s+62]=i[s+34]=-c,i[s+63]=i[s+33]=-g,i[s+32]=-d,i[s+0]=d,i[s+31]=-F,i[s+1]=F,i[s+30]=-S,i[s+2]=S,i[s+29]=-P,i[s+3]=P,i[s+28]=-u,i[s+4]=u,i[s+27]=-x,i[s+5]=x,i[s+26]=-E,i[s+6]=E,i[s+25]=-p,i[s+7]=p,i[s+24]=-y,i[s+8]=y,i[s+23]=-f,i[s+9]=f,i[s+22]=-A,i[s+10]=A,i[s+21]=-k,i[s+11]=k,i[s+20]=-m,i[s+12]=m,i[s+19]=-I,i[s+13]=I,i[s+18]=-B,i[s+14]=B,i[s+17]=-r,i[s+15]=r,i[s+16]=0},t.FRAME_SYNC=2047,t.VERSION={MPEG_2_5:0,MPEG_2:2,MPEG_1:3},t.LAYER={III:1,II:2,I:3},t.MODE={STEREO:0,JOINT_STEREO:1,DUAL_CHANNEL:2,MONO:3},t.SAMPLE_RATE=new Uint16Array([44100,48e3,32e3,0,22050,24e3,16e3,0]),t.BIT_RATE=new Uint16Array([32,48,56,64,80,96,112,128,160,192,224,256,320,384,8,16,24,32,40,48,56,64,80,96,112,128,144,160]),t.SCALEFACTOR_BASE=new Uint32Array([33554432,26632170,21137968]),t.SYNTHESIS_WINDOW=new Float32Array([0,-.5,-.5,-.5,-.5,-.5,-.5,-1,-1,-1,-1,-1.5,-1.5,-2,-2,-2.5,-2.5,-3,-3.5,-3.5,-4,-4.5,-5,-5.5,-6.5,-7,-8,-8.5,-9.5,-10.5,-12,-13,-14.5,-15.5,-17.5,-19,-20.5,-22.5,-24.5,-26.5,-29,-31.5,-34,-36.5,-39.5,-42.5,-45.5,-48.5,-52,-55.5,-58.5,-62.5,-66,-69.5,-73.5,-77,-80.5,-84.5,-88,-91.5,-95,-98,-101,-104,106.5,109,111,112.5,113.5,114,114,113.5,112,110.5,107.5,104,100,94.5,88.5,81.5,73,63.5,53,41.5,28.5,14.5,-1,-18,-36,-55.5,-76.5,-98.5,-122,-147,-173.5,-200.5,-229.5,-259.5,-290.5,-322.5,-355.5,-389.5,-424,-459.5,-495.5,-532,-568.5,-605,-641.5,-678,-714,-749,-783.5,-817,-849,-879.5,-908.5,-935,-959.5,-981,-1000.5,-1016,-1028.5,-1037.5,-1042.5,-1043.5,-1040,-1031.5,1018.5,1e3,976,946.5,911,869.5,822,767.5,707,640,565.5,485,397,302.5,201,92.5,-22.5,-144,-272.5,-407,-547.5,-694,-846,-1003,-1165,-1331.5,-1502,-1675.5,-1852.5,-2031.5,-2212.5,-2394,-2576.5,-2758.5,-2939.5,-3118.5,-3294.5,-3467.5,-3635.5,-3798.5,-3955,-4104.5,-4245.5,-4377.5,-4499,-4609.5,-4708,-4792.5,-4863.5,-4919,-4958,-4979.5,-4983,-4967.5,-4931.5,-4875,-4796,-4694.5,-4569.5,-4420,-4246,-4046,-3820,-3567,3287,2979.5,2644,2280.5,1888,1467.5,1018.5,541,35,-499,-1061,-1650,-2266.5,-2909,-3577,-4270,-4987.5,-5727.5,-6490,-7274,-8077.5,-8899.5,-9739,-10594.5,-11464.5,-12347,-13241,-14144.5,-15056,-15973.5,-16895.5,-17820,-18744.5,-19668,-20588,-21503,-22410.5,-23308.5,-24195,-25068.5,-25926.5,-26767,-27589,-28389,-29166.5,-29919,-30644.5,-31342,-32009.5,-32645,-33247,-33814.5,-34346,-34839.5,-35295,-35710,-36084.5,-36417.5,-36707.5,-36954,-37156.5,-37315,-37428,-37496,37519,37496,37428,37315,37156.5,36954,36707.5,36417.5,36084.5,35710,35295,34839.5,34346,33814.5,33247,32645,32009.5,31342,30644.5,29919,29166.5,28389,27589,26767,25926.5,25068.5,24195,23308.5,22410.5,21503,20588,19668,18744.5,17820,16895.5,15973.5,15056,14144.5,13241,12347,11464.5,10594.5,9739,8899.5,8077.5,7274,6490,5727.5,4987.5,4270,3577,2909,2266.5,1650,1061,499,-35,-541,-1018.5,-1467.5,-1888,-2280.5,-2644,-2979.5,3287,3567,3820,4046,4246,4420,4569.5,4694.5,4796,4875,4931.5,4967.5,4983,4979.5,4958,4919,4863.5,4792.5,4708,4609.5,4499,4377.5,4245.5,4104.5,3955,3798.5,3635.5,3467.5,3294.5,3118.5,2939.5,2758.5,2576.5,2394,2212.5,2031.5,1852.5,1675.5,1502,1331.5,1165,1003,846,694,547.5,407,272.5,144,22.5,-92.5,-201,-302.5,-397,-485,-565.5,-640,-707,-767.5,-822,-869.5,-911,-946.5,-976,-1e3,1018.5,1031.5,1040,1043.5,1042.5,1037.5,1028.5,1016,1000.5,981,959.5,935,908.5,879.5,849,817,783.5,749,714,678,641.5,605,568.5,532,495.5,459.5,424,389.5,355.5,322.5,290.5,259.5,229.5,200.5,173.5,147,122,98.5,76.5,55.5,36,18,1,-14.5,-28.5,-41.5,-53,-63.5,-73,-81.5,-88.5,-94.5,-100,-104,-107.5,-110.5,-112,-113.5,-114,-114,-113.5,-112.5,-111,-109,106.5,104,101,98,95,91.5,88,84.5,80.5,77,73.5,69.5,66,62.5,58.5,55.5,52,48.5,45.5,42.5,39.5,36.5,34,31.5,29,26.5,24.5,22.5,20.5,19,17.5,15.5,14.5,13,12,10.5,9.5,8.5,8,7,6.5,5.5,5,4.5,4,3.5,3.5,3,2.5,2.5,2,2,1.5,1.5,1,1,1,1,.5,.5,.5,.5,.5,.5]),
t.QUANT_LUT_STEP_1=[[0,0,1,1,1,2,2,2,2,2,2,2,2,2],[0,0,0,0,0,0,1,1,1,2,2,2,2,2]],t.QUANT_TAB={A:91,B:94,C:8,D:12},t.QUANT_LUT_STEP_2=[[t.QUANT_TAB.C,t.QUANT_TAB.C,t.QUANT_TAB.D],[t.QUANT_TAB.A,t.QUANT_TAB.A,t.QUANT_TAB.A],[t.QUANT_TAB.B,t.QUANT_TAB.A,t.QUANT_TAB.B]],t.QUANT_LUT_STEP_3=[[68,68,52,52,52,52,52,52,52,52,52,52],[67,67,67,66,66,66,66,66,66,66,66,49,49,49,49,49,49,49,49,49,49,49,49,32,32,32,32,32,32,32],[69,69,69,69,52,52,52,52,52,52,52,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36]],t.QUANT_LUT_STEP4=[[0,1,2,17],[0,1,2,3,4,5,6,17],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,17],[0,1,3,5,6,7,8,9,10,11,12,13,14,15,16,17],[0,1,2,4,5,6,7,8,9,10,11,12,13,14,15,17],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]],t.QUANT_TAB=[{levels:3,group:1,bits:5},{levels:5,group:1,bits:7},{levels:7,group:0,bits:3},{levels:9,group:1,bits:10},{levels:15,group:0,bits:4},{levels:31,group:0,bits:5},{levels:63,group:0,bits:6},{levels:127,group:0,bits:7},{levels:255,group:0,bits:8},{levels:511,group:0,bits:9},{levels:1023,group:0,bits:10},{levels:2047,group:0,bits:11},{levels:4095,group:0,bits:12},{levels:8191,group:0,bits:13},{levels:16383,group:0,bits:14},{levels:32767,group:0,bits:15},{levels:65535,group:0,bits:16}],t}(),n.Renderer.WebGL=function(){var t=function t(e){this.canvas=e.canvas||document.createElement("canvas"),this.width=this.canvas.width,this.height=this.canvas.height,this.enabled=!0;var i={preserveDrawingBuffer:!!e.preserveDrawingBuffer,alpha:!1,depth:!1,stencil:!1,antialias:!1};if(this.gl=this.canvas.getContext("webgl",i)||this.canvas.getContext("experimental-webgl",i),!this.gl)throw new Error("Failed to get WebGL Context");var s=this.gl,n=null,r=s.createBuffer(),o=new Float32Array([0,0,0,1,1,0,1,1]);s.bindBuffer(s.ARRAY_BUFFER,r),s.bufferData(s.ARRAY_BUFFER,o,s.STATIC_DRAW),this.program=this.createProgram(t.SHADER.VERTEX_IDENTITY,t.SHADER.FRAGMENT_YCRCB_TO_RGBA),n=s.getAttribLocation(this.program,"vertex"),s.enableVertexAttribArray(n),s.vertexAttribPointer(n,2,s.FLOAT,!1,0,0),this.textureY=this.createTexture(0,"textureY"),this.textureCb=this.createTexture(1,"textureCb"),this.textureCr=this.createTexture(2,"textureCr"),this.loadingProgram=this.createProgram(t.SHADER.VERTEX_IDENTITY,t.SHADER.FRAGMENT_LOADING),n=s.getAttribLocation(this.loadingProgram,"vertex"),s.enableVertexAttribArray(n),s.vertexAttribPointer(n,2,s.FLOAT,!1,0,0),this.shouldCreateUnclampedViews=!this.allowsClampedTextureData()};return t.prototype.resize=function(t,e){this.width=0|t,this.height=0|e,this.canvas.width=this.width,this.canvas.height=this.height,this.gl.useProgram(this.program),this.gl.viewport(0,0,this.width,this.height)},t.prototype.createTexture=function(t,e){var i=this.gl,s=i.createTexture();return i.bindTexture(i.TEXTURE_2D,s),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.uniform1i(i.getUniformLocation(this.program,e),t),s},t.prototype.createProgram=function(t,e){var i=this.gl,s=i.createProgram();return i.attachShader(s,this.compileShader(i.VERTEX_SHADER,t)),i.attachShader(s,this.compileShader(i.FRAGMENT_SHADER,e)),i.linkProgram(s),i.useProgram(s),s},t.prototype.compileShader=function(t,e){var i=this.gl,s=i.createShader(t);if(i.shaderSource(s,e),i.compileShader(s),!i.getShaderParameter(s,i.COMPILE_STATUS))throw new Error(i.getShaderInfoLog(s));return s},t.prototype.allowsClampedTextureData=function(){var t=this.gl,e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.LUMINANCE,1,1,0,t.LUMINANCE,t.UNSIGNED_BYTE,new Uint8ClampedArray([0])),0===t.getError()},t.prototype.renderProgress=function(t){var e=this.gl,i=e.getUniformLocation(this.loadingProgram,"progress");e.uniform1f(i,t),e.drawArrays(e.TRIANGLE_STRIP,0,4)},t.prototype.render=function(t,e,i){if(this.enabled){var s=this.gl,n=this.width+15>>4<<4,r=this.height,o=n>>1,a=r>>1;this.shouldCreateUnclampedViews&&(t=new Uint8Array(t.buffer),e=new Uint8Array(e.buffer),i=new Uint8Array(i.buffer)),this.updateTexture(s.TEXTURE0,this.textureY,n,r,t),this.updateTexture(s.TEXTURE1,this.textureCb,o,a,e),this.updateTexture(s.TEXTURE2,this.textureCr,o,a,i),s.drawArrays(s.TRIANGLE_STRIP,0,4)}},t.prototype.updateTexture=function(t,e,i,s,n){var r=this.gl;r.activeTexture(t),r.bindTexture(r.TEXTURE_2D,e),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,i,s,0,r.LUMINANCE,r.UNSIGNED_BYTE,n)},t.IsSupported=function(){try{if(!window.WebGLRenderingContext)return!1;var t=document.createElement("canvas");return!(!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(t){return!1}},t.SHADER={FRAGMENT_YCRCB_TO_RGBA:["precision mediump float;","uniform sampler2D textureY;","uniform sampler2D textureCb;","uniform sampler2D textureCr;","varying vec2 texCoord;","mat4 rec601 = mat4(","1.16438,  0.00000,  1.59603, -0.87079,","1.16438, -0.39176, -0.81297,  0.52959,","1.16438,  2.01723,  0.00000, -1.08139,","0, 0, 0, 1",");","void main() {","float y = texture2D(textureY, texCoord).r;","float cb = texture2D(textureCb, texCoord).r;","float cr = texture2D(textureCr, texCoord).r;","gl_FragColor = vec4(y, cr, cb, 1.0) * rec601;","}"].join("\n"),FRAGMENT_LOADING:["precision mediump float;","uniform float progress;","varying vec2 texCoord;","void main() {","float c = ceil(progress-(1.0-texCoord.y));","gl_FragColor = vec4(c,c,c,1);","}"].join("\n"),VERTEX_IDENTITY:["attribute vec2 vertex;","varying vec2 texCoord;","void main() {","texCoord = vertex;","gl_Position = vec4((vertex * 2.0 - 1.0) * vec2(1, -1), 0.0, 1.0);","}"].join("\n")},t}(),n.Renderer.Canvas2D=function(){var t=function(t){this.canvas=t.canvas||document.createElement("canvas"),this.width=this.canvas.width,this.height=this.canvas.height,this.enabled=!0,this.context=this.canvas.getContext("2d")};return t.prototype.resize=function(t,e){this.width=0|t,this.height=0|e,this.canvas.width=this.width,this.canvas.height=this.height,this.imageData=this.context.getImageData(0,0,this.width,this.height),n.Fill(this.imageData.data,255)},t.prototype.renderProgress=function(t){var e=this.canvas.width,i=this.canvas.height,s=this.context;s.fillStyle="#222",s.fillRect(0,0,e,i),s.fillStyle="#fff",s.fillRect(0,i-i*t,e,i*t)},t.prototype.render=function(t,e,i){this.YCbCrToRGBA(t,e,i,this.imageData.data),this.context.putImageData(this.imageData,0,0)},t.prototype.YCbCrToRGBA=function(t,e,i,s){if(this.enabled)for(var n,r,o,a,d,l=this.width+15>>4<<4,u=l>>1,h=0,c=l,p=l+(l-this.width),v=0,f=u-(this.width>>1),m=0,g=4*this.width,y=4*this.width,_=this.width>>1,b=this.height>>1,w=0;w<b;w++){for(var A=0;A<_;A++){n=e[v],r=i[v],v++,o=n+(103*n>>8)-179,a=(88*r>>8)-44+(183*n>>8)-91,d=r+(198*r>>8)-227;var k=t[h++],T=t[h++];s[m]=k+o,s[m+1]=k-a,s[m+2]=k+d,s[m+4]=T+o,s[m+5]=T-a,s[m+6]=T+d,m+=8;var C=t[c++],E=t[c++];s[g]=C+o,s[g+1]=C-a,s[g+2]=C+d,s[g+4]=E+o,s[g+5]=E-a,s[g+6]=E+d,g+=8}h+=p,c+=p,m+=y,g+=y,v+=f}},t}(),n.AudioOutput.WebAudio=function(){var t=function t(e){this.context=t.CachedContext=t.CachedContext||new(window.AudioContext||window.webkitAudioContext),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.destination=this.gain,this.startTime=0,this.buffer=null,this.wallclockStartTime=0,this.volume=1,this.enabled=!0,this.unlocked=!t.NeedsUnlocking(),Object.defineProperty(this,"enqueuedTime",{get:this.getEnqueuedTime})};return t.prototype.play=function(t,e,i){if(this.enabled){if(!this.unlocked){var s=n.Now();return this.wallclockStartTime<s&&(this.wallclockStartTime=s),void(this.wallclockStartTime+=e.length/t)}this.gain.gain.value=this.volume;var r=this.context.createBuffer(2,e.length,t);r.getChannelData(0).set(e),r.getChannelData(1).set(i);var o=this.context.createBufferSource();o.buffer=r,o.connect(this.destination);var a=this.context.currentTime,d=r.duration;this.startTime<a&&(this.startTime=a,this.wallclockStartTime=n.Now()),o.start(this.startTime),this.startTime+=d,this.wallclockStartTime+=d}},t.prototype.stop=function(){this.gain.gain.value=0},t.prototype.getEnqueuedTime=function(){return Math.max(this.wallclockStartTime-n.Now(),0)},t.prototype.resetEnqueuedTime=function(){this.startTime=this.context.currentTime,this.wallclockStartTime=n.Now()},t.prototype.unlock=function(t){if(this.unlocked)return void(t&&t());this.unlockCallback=t;var e=this.context.createBuffer(1,1,22050),i=this.context.createBufferSource();i.buffer=e,i.connect(this.destination),i.start(0),setTimeout(this.checkIfUnlocked.bind(this,i,0),0)},t.prototype.checkIfUnlocked=function(t,e){t.playbackState===t.PLAYING_STATE||t.playbackState===t.FINISHED_STATE?(this.unlocked=!0,this.unlockCallback&&(this.unlockCallback(),this.unlockCallback=null)):e<10&&setTimeout(this.checkIfUnlocked.bind(this,t,e+1),100)},t.NeedsUnlocking=function(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)},t.IsSupported=function(){return window.AudioContext||window.webkitAudioContext},t.CachedContext=null,t}(),t.exports=i},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var s=e.get("dsm")||{},n=s.bl||[],r=i.concat(n),o=!1;return r.map(function(e){e.indexOf(t)!==-1&&(o=!0)}),o};var i=[".rtbauction.com","video.leadzu.com"]},function(t,e){"use strict";function i(t,e){function i(t,i){var n=s(t,e),r=s(i,e);return n>r?1:-1}var n=t.sort(i);return n}function s(t,e){var i=0,s=r(t.wfIndex),o=r(t.waterfallTagId),a=r(t.cpmFloor),d=r(t.fillrate),l=e.getByAdvId("scoreBoost",t.advId)||0,u=n(t.type)||1,h={wg:s,wi:o,fr:d,cf:a,mt:u,advb:l};t.scoreSummary=h;var i=1,c=e.get("qsrtscr");if(c&&"function"==typeof c)try{i=c(h,t,e)}catch(t){i=999999}return t.score=i,i}function n(t){return"flash"===t?1:"javascript"===t?2:"spotxAdOs"===t?4:3}function r(t){return t=t||0,parseInt(t)}t.exports={sort:i}},function(t,e){"use strict";t.exports=function(t){function e(t){var e=new i(t),s=e.promise();return e.setHowMany(1),e.setUnwrap(),e.init(),s}var i=t._SomePromiseArray;t.any=function(t){return e(t)},t.prototype.any=function(){return e(this)}}},function(t,e,i){(function(e){"use strict";function s(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new h(16),this._normalQueue=new h(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=u}function n(t,e,i){this._lateQueue.push(t,e,i),this._queueTick()}function r(t,e,i){this._normalQueue.push(t,e,i),this._queueTick()}function o(t){this._normalQueue._pushOne(t),this._queueTick()}function a(t){for(;t.length()>0;)d(t)}function d(t){var e=t.shift();if("function"!=typeof e)e._settlePromises();else{var i=t.shift(),s=t.shift();e.call(i,s)}}var l;try{throw new Error}catch(t){l=t}var u=i(95),h=i(92),c=i(2);s.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},s.prototype.hasCustomScheduler=function(){return this._customScheduler},s.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},s.prototype.disableTrampolineIfNecessary=function(){c.hasDevTools&&(this._trampolineEnabled=!1)},s.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},s.prototype.fatalError=function(t,i){i?(e.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),e.exit(2)):this.throwLater(t)},s.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch(t){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},c.hasDevTools?(s.prototype.invokeLater=function(t,e,i){this._trampolineEnabled?n.call(this,t,e,i):this._schedule(function(){setTimeout(function(){t.call(e,i)},100)})},s.prototype.invoke=function(t,e,i){this._trampolineEnabled?r.call(this,t,e,i):this._schedule(function(){t.call(e,i)})},s.prototype.settlePromises=function(t){this._trampolineEnabled?o.call(this,t):this._schedule(function(){t._settlePromises()})}):(s.prototype.invokeLater=n,s.prototype.invoke=r,s.prototype.settlePromises=o),s.prototype._drainQueues=function(){a(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,a(this._lateQueue)},s.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},s.prototype._reset=function(){this._isTickUsed=!1},t.exports=s,t.exports.firstLineError=l}).call(e,i(10))},function(t,e){"use strict";t.exports=function(t,e,i,s){var n=!1,r=function(t,e){this._reject(e)},o=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(r,r,null,this,t)},a=function(t,e){0===(50397184&this._bitField)&&this._resolveCallback(e.target)},d=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(r){n||(n=!0,t.prototype._propagateFrom=s.propagateFromFunction(),t.prototype._boundValue=s.boundValueFunction());var l=i(r),u=new t(e);u._propagateFrom(this,1);var h=this._target();if(u._setBoundTo(l),l instanceof t){var c={promiseRejectionQueued:!1,promise:u,target:h,bindingPromise:l};h._then(e,o,void 0,u,c),l._then(a,d,void 0,u,c),u._setOnCancel(l)}else u._resolveCallback(h);return u},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=this._bitField&-2097153},t.prototype._isBound=function(){return 2097152===(2097152&this._bitField)},t.bind=function(e,i){return t.resolve(i).bind(e)}}},function(t,e,i){"use strict";var s=Object.create;if(s){var n=s(null),r=s(null);n[" size"]=r[" size"]=0}t.exports=function(t){function e(e,i){var s;if(null!=e&&(s=e[i]),"function"!=typeof s){var n="Object "+u.classString(e)+" has no method '"+u.toString(i)+"'";throw new t.TypeError(n)}return s}function s(t){var i=this.pop(),s=e(t,i);return s.apply(t,this)}function o(t){return t[this]}function a(t){var e=+this;return e<0&&(e=Math.max(0,e+t.length)),t[e]}var d,l,u=i(2),h=u.canEvaluate,c=u.isIdentifier,p=function(t){return new Function("ensureMethod","                                    \n\t        return function(obj) {                                               \n\t            'use strict'                                                     \n\t            var len = this.length;                                           \n\t            ensureMethod(obj, 'methodName');                                 \n\t            switch(len) {                                                    \n\t                case 1: return obj.methodName(this[0]);                      \n\t                case 2: return obj.methodName(this[0], this[1]);             \n\t                case 3: return obj.methodName(this[0], this[1], this[2]);    \n\t                case 0: return obj.methodName();                             \n\t                default:                                                     \n\t                    return obj.methodName.apply(obj, this);                  \n\t            }                                                                \n\t        };                                                                   \n\t        ".replace(/methodName/g,t))(e)},v=function(t){return new Function("obj","                                             \n\t        'use strict';                                                        \n\t        return obj.propertyName;                                             \n\t        ".replace("propertyName",t))},f=function(t,e,i){var s=i[t];if("function"!=typeof s){if(!c(t))return null;if(s=e(t),i[t]=s,i[" size"]++,i[" size"]>512){for(var n=Object.keys(i),r=0;r<256;++r)delete i[n[r]];i[" size"]=n.length-256}}return s};d=function(t){return f(t,p,n)},l=function(t){return f(t,v,r)},t.prototype.call=function(t){for(var e=arguments.length,i=new Array(Math.max(e-1,0)),n=1;n<e;++n)i[n-1]=arguments[n];if(h){var r=d(t);if(null!==r)return this._then(r,void 0,void 0,i,void 0)}return i.push(t),this._then(s,void 0,void 0,i,void 0)},t.prototype.get=function(t){var e,i="number"==typeof t;if(i)e=a;else if(h){var s=l(t);e=null!==s?s:o}else e=o;return this._then(e,void 0,void 0,t,void 0)}}},function(t,e,i){"use strict";t.exports=function(t,e,s,n){var r=i(2),o=r.tryCatch,a=r.errorObj,d=t._async;t.prototype.break=t.prototype.cancel=function(){if(!n.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var i=t._cancellationParent;if(null==i||!i._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=i}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},t.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),d.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(t,e){if(r.isArray(t))for(var i=0;i<t.length;++i)this._doInvokeOnCancel(t[i],e);else if(void 0!==t)if("function"==typeof t){if(!e){var s=o(t).call(this._boundValue());s===a&&(this._attachExtraTrace(s.e),d.throwLater(s.e))}}else t._resultCancelled(this)},t.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),d.invoke(this._doInvokeOnCancel,this,t)},t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}},function(t,e){"use strict";t.exports=function(t){function e(){this._trace=new e.CapturedTrace(s())}function i(){if(n)return new e}function s(){var t=r.length-1;if(t>=0)return r[t]}var n=!1,r=[];return t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){},e.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,r.push(this._trace))},e.prototype._popContext=function(){if(void 0!==this._trace){var t=r.pop(),e=t._promiseCreated;return t._promiseCreated=null,e}return null},e.CapturedTrace=null,e.create=i,e.deactivateLongStackTraces=function(){},e.activateLongStackTraces=function(){var i=t.prototype._pushContext,r=t.prototype._popContext,o=t._peekContext,a=t.prototype._peekContext,d=t.prototype._promiseCreated;e.deactivateLongStackTraces=function(){t.prototype._pushContext=i,t.prototype._popContext=r,t._peekContext=o,t.prototype._peekContext=a,t.prototype._promiseCreated=d,n=!1},n=!0,t.prototype._pushContext=e.prototype._pushContext,t.prototype._popContext=e.prototype._popContext,t._peekContext=t.prototype._peekContext=s,t.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},e}},function(t,e,i){(function(e){"use strict";t.exports=function(t,s){function n(t,e){return{promise:e}}function r(){return!1}function o(t,e,i){var s=this;try{t(e,i,function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+j.toString(t));s._attachCancellationCallback(t)})}catch(t){return t}}function a(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?j.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function d(){return this._onCancelField}function l(t){this._onCancelField=t}function u(){this._cancellationParent=void 0,this._onCancelField=void 0}function h(t,e){if(0!==(1&e)){this._cancellationParent=t;var i=t._branchesRemainingToCancel;void 0===i&&(i=0),t._branchesRemainingToCancel=i+1}0!==(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function c(t,e){0!==(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function p(){var e=this._boundTo;return void 0!==e&&e instanceof t?e.isFulfilled()?e.value():void 0:e}function v(){this._trace=new F(this._peekContext())}function f(t,e){if(N(t)){var i=this._trace;if(void 0!==i&&e&&(i=i._parent),void 0!==i)i.attachExtraTrace(t);else if(!t.__stackCleaned__){var s=C(t);j.notEnumerableProp(t,"stack",s.message+"\n"+s.stack.join("\n")),j.notEnumerableProp(t,"__stackCleaned__",!0)}}}function m(){this._trace=void 0}function g(t,e,i,s,n){if(void 0===t&&null!==e&&K){if(void 0!==n&&n._returnedNonUndefined())return;if(0===(65535&s._bitField))return;i&&(i+=" ");var r="",o="";if(e._trace){for(var a=e._trace.stack.split("\n"),d=k(a),l=d.length-1;l>=0;--l){var u=d[l];if(!Q.test(u)){var h=u.match(z);h&&(r="at "+h[1]+":"+h[2]+":"+h[3]+" ");break}}if(d.length>0)for(var c=d[0],l=0;l<a.length;++l)if(a[l]===c){l>0&&(o="\n"+a[l-1]);break}}var p="a promise was created in a "+i+"handler "+r+"but was not returned from it, see http://goo.gl/rRqMUw"+o;s._warn(p,!0,e)}}function y(t,e){var i=t+" is deprecated and will be removed in a future version.";return e&&(i+=" Use "+e+" instead."),_(i)}function _(e,i,s){if(dt.warnings){var n,r=new U(e);if(i)s._attachExtraTrace(r);else if(dt.longStackTraces&&(n=t._peekContext()))n.attachExtraTrace(r);else{var o=C(r);r.stack=o.message+"\n"+o.stack.join("\n")}st("warning",r)||E(r,"",!0)}}function b(t,e){for(var i=0;i<e.length-1;++i)e[i].push("From previous event:"),e[i]=e[i].join("\n");return i<e.length&&(e[i]=e[i].join("\n")),t+"\n"+e.join("\n")}function w(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}function A(t){for(var e=t[0],i=1;i<t.length;++i){for(var s=t[i],n=e.length-1,r=e[n],o=-1,a=s.length-1;a>=0;--a)if(s[a]===r){o=a;break}for(var a=o;a>=0;--a){var d=s[a];if(e[n]!==d)break;e.pop(),n--}e=s}}function k(t){for(var e=[],i=0;i<t.length;++i){var s=t[i],n="    (No stack trace)"===s||q.test(s),r=n&&rt(s);n&&!r&&(G&&" "!==s.charAt(0)&&(s="    "+s),e.push(s))}return e}function T(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),i=0;i<e.length;++i){var s=e[i];if("    (No stack trace)"===s||q.test(s))break}return i>0&&"SyntaxError"!=t.name&&(e=e.slice(i)),e}function C(t){var e=t.stack,i=t.toString();return e="string"==typeof e&&e.length>0?T(t):["    (No stack trace)"],{message:i,stack:"SyntaxError"==t.name?e:k(e)}}function E(t,e,i){if("undefined"!=typeof console){var s;if(j.isObject(t)){var n=t.stack;s=e+X(n,t)}else s=e+String(t);"function"==typeof O?O(s,i):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(s)}}function I(t,e,i,s){var n=!1;try{"function"==typeof e&&(n=!0,"rejectionHandled"===t?e(s):e(i,s))}catch(t){R.throwLater(t)}"unhandledRejection"===t?st(t,i,s)||n||E(i,"Unhandled rejection "):st(t,s)}function V(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t&&"function"==typeof t.toString?t.toString():j.toString(t);var i=/\[object [a-zA-Z0-9$_]+\]/;if(i.test(e))try{var s=JSON.stringify(t);e=s}catch(t){}0===e.length&&(e="(empty array)")}return"(<"+x(e)+">, no stack trace)"}function x(t){var e=41;return t.length<e?t:t.substr(0,e-3)+"..."}function S(){return"function"==typeof at}function P(t){var e=t.match(ot);if(e)return{fileName:e[1],line:parseInt(e[2],10)}}function L(t,e){if(S()){for(var i,s,n=t.stack.split("\n"),r=e.stack.split("\n"),o=-1,a=-1,d=0;d<n.length;++d){var l=P(n[d]);if(l){i=l.fileName,o=l.line;break}}for(var d=0;d<r.length;++d){var l=P(r[d]);if(l){s=l.fileName,a=l.line;break}}o<0||a<0||!i||!s||i!==s||o>=a||(rt=function(t){if(H.test(t))return!0;var e=P(t);return!!(e&&e.fileName===i&&o<=e.line&&e.line<=a)})}}function F(t){this._parent=t,this._promisesCreated=0;var e=this._length=1+(void 0===t?0:t._length);at(this,F),e>32&&this.uncycle()}var B,D,O,M=t._getDomain,R=t._async,U=i(5).Warning,j=i(2),W=i(7),N=j.canAttachTrace,H=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,Q=/\((?:timers\.js):\d+:\d+\)/,z=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,q=null,X=null,G=!1,Y=!(0==j.env("BLUEBIRD_DEBUG")||!j.env("BLUEBIRD_DEBUG")&&"development"!==j.env("NODE_ENV")),Z=!(0==j.env("BLUEBIRD_WARNINGS")||!Y&&!j.env("BLUEBIRD_WARNINGS")),J=!(0==j.env("BLUEBIRD_LONG_STACK_TRACES")||!Y&&!j.env("BLUEBIRD_LONG_STACK_TRACES")),K=0!=j.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(Z||!!j.env("BLUEBIRD_W_FORGOTTEN_RETURN"));t.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=t._bitField&-1048577|524288},t.prototype._ensurePossibleRejectionHandled=function(){if(0===(524288&this._bitField)){this._setRejectionIsUnhandled();var t=this;setTimeout(function(){t._notifyUnhandledRejection()},1)}},t.prototype._notifyUnhandledRejectionIsHandled=function(){I("rejectionHandled",B,void 0,this)},t.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},t.prototype._returnedNonUndefined=function(){return 0!==(268435456&this._bitField)},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),I("unhandledRejection",D,t,this)}},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&-262145},t.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},t.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&-1048577,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},t.prototype._warn=function(t,e,i){return _(t,e,i||this)},t.onPossiblyUnhandledRejection=function(t){var e=M();D="function"==typeof t?null===e?t:j.domainBind(e,t):void 0},t.onUnhandledRejectionHandled=function(t){var e=M();B="function"==typeof t?null===e?t:j.domainBind(e,t):void 0};var $=function(){};t.longStackTraces=function(){if(R.haveItemsQueued()&&!dt.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!dt.longStackTraces&&S()){var e=t.prototype._captureStackTrace,i=t.prototype._attachExtraTrace,n=t.prototype._dereferenceTrace;dt.longStackTraces=!0,$=function(){if(R.haveItemsQueued()&&!dt.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");t.prototype._captureStackTrace=e,t.prototype._attachExtraTrace=i,t.prototype._dereferenceTrace=n,s.deactivateLongStackTraces(),R.enableTrampoline(),dt.longStackTraces=!1},t.prototype._captureStackTrace=v,t.prototype._attachExtraTrace=f,t.prototype._dereferenceTrace=m,s.activateLongStackTraces(),R.disableTrampolineIfNecessary()}},t.hasLongStackTraces=function(){return dt.longStackTraces&&S()};var tt=function(){try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return j.global.dispatchEvent(t),function(t,e){var i={detail:e,cancelable:!0};W.defineProperty(i,"promise",{value:e.promise}),W.defineProperty(i,"reason",{value:e.reason});var s=new CustomEvent(t.toLowerCase(),i);return!j.global.dispatchEvent(s)}}if("function"==typeof Event){var t=new Event("CustomEvent");return j.global.dispatchEvent(t),function(t,e){var i=new Event(t.toLowerCase(),{cancelable:!0});return i.detail=e,W.defineProperty(i,"promise",{value:e.promise}),W.defineProperty(i,"reason",{value:e.reason}),!j.global.dispatchEvent(i)}}var t=document.createEvent("CustomEvent");return t.initCustomEvent("testingtheevent",!1,!0,{}),j.global.dispatchEvent(t),function(t,e){var i=document.createEvent("CustomEvent");return i.initCustomEvent(t.toLowerCase(),!1,!0,e),!j.global.dispatchEvent(i)}}catch(t){}return function(){return!1}}(),et=function(){return j.isNode?function(){return e.emit.apply(e,arguments)}:j.global?function(t){var e="on"+t.toLowerCase(),i=j.global[e];return!!i&&(i.apply(j.global,[].slice.call(arguments,1)),!0)}:function(){return!1}}(),it={promiseCreated:n,promiseFulfilled:n,promiseRejected:n,promiseResolved:n,promiseCancelled:n,promiseChained:function(t,e,i){return{promise:e,child:i}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,i){return{reason:e,promise:i}},rejectionHandled:n},st=function(t){var e=!1;try{e=et.apply(null,arguments)}catch(t){R.throwLater(t),e=!0}var i=!1;try{i=tt(t,it[t].apply(null,arguments))}catch(t){R.throwLater(t),i=!0}return i||e};t.config=function(e){if(e=Object(e),"longStackTraces"in e&&(e.longStackTraces?t.longStackTraces():!e.longStackTraces&&t.hasLongStackTraces()&&$()),"warnings"in e){var i=e.warnings;dt.warnings=!!i,K=dt.warnings,j.isObject(i)&&"wForgottenReturn"in i&&(K=!!i.wForgottenReturn)}if("cancellation"in e&&e.cancellation&&!dt.cancellation){if(R.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");t.prototype._clearCancellationData=u,t.prototype._propagateFrom=h,t.prototype._onCancel=d,t.prototype._setOnCancel=l,t.prototype._attachCancellationCallback=a,t.prototype._execute=o,nt=h,dt.cancellation=!0}return"monitoring"in e&&(e.monitoring&&!dt.monitoring?(dt.monitoring=!0,t.prototype._fireEvent=st):!e.monitoring&&dt.monitoring&&(dt.monitoring=!1,t.prototype._fireEvent=r)),t},t.prototype._fireEvent=r,t.prototype._execute=function(t,e,i){try{t(e,i)}catch(t){return t}},t.prototype._onCancel=function(){},t.prototype._setOnCancel=function(t){},t.prototype._attachCancellationCallback=function(t){},t.prototype._captureStackTrace=function(){},t.prototype._attachExtraTrace=function(){},t.prototype._dereferenceTrace=function(){},t.prototype._clearCancellationData=function(){},t.prototype._propagateFrom=function(t,e){};var nt=c,rt=function(){return!1},ot=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;j.inherits(F,Error),s.CapturedTrace=F,F.prototype.uncycle=function(){var t=this._length;if(!(t<2)){for(var e=[],i={},s=0,n=this;void 0!==n;++s)e.push(n),n=n._parent;t=this._length=s;for(var s=t-1;s>=0;--s){var r=e[s].stack;void 0===i[r]&&(i[r]=s)}for(var s=0;s<t;++s){var o=e[s].stack,a=i[o];if(void 0!==a&&a!==s){a>0&&(e[a-1]._parent=void 0,e[a-1]._length=1),e[s]._parent=void 0,e[s]._length=1;var d=s>0?e[s-1]:this;a<t-1?(d._parent=e[a+1],d._parent.uncycle(),d._length=d._parent._length+1):(d._parent=void 0,d._length=1);for(var l=d._length+1,u=s-2;u>=0;--u)e[u]._length=l,l++;return}}}},F.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=C(t),i=e.message,s=[e.stack],n=this;void 0!==n;)s.push(k(n.stack.split("\n"))),n=n._parent;A(s),w(s),j.notEnumerableProp(t,"stack",b(i,s)),j.notEnumerableProp(t,"__stackCleaned__",!0)}};var at=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():V(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,q=t,X=e;var i=Error.captureStackTrace;return rt=function(t){return H.test(t)},function(t,e){Error.stackTraceLimit+=6,i(t,e),Error.stackTraceLimit-=6}}var s=new Error;if("string"==typeof s.stack&&s.stack.split("\n")[0].indexOf("stackDetection@")>=0)return q=/@/,X=e,G=!0,function(t){t.stack=(new Error).stack};var n;try{throw new Error}catch(t){n="stack"in t}return"stack"in s||!n||"number"!=typeof Error.stackTraceLimit?(X=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?V(e):e.toString();
},null):(q=t,X=e,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit-=6})}([]);"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(O=function(t){console.warn(t)},j.isNode&&e.stderr.isTTY?O=function(t,e){var i=e?"[33m":"[31m";console.warn(i+t+"[0m\n")}:j.isNode||"string"!=typeof(new Error).stack||(O=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var dt={warnings:Z,longStackTraces:!1,cancellation:!1,monitoring:!1};return J&&t.longStackTraces(),{longStackTraces:function(){return dt.longStackTraces},warnings:function(){return dt.warnings},cancellation:function(){return dt.cancellation},monitoring:function(){return dt.monitoring},propagateFromFunction:function(){return nt},boundValueFunction:function(){return p},checkForgottenReturns:g,setBounds:L,warn:_,deprecated:y,CapturedTrace:F,fireDomEvent:tt,fireGlobalEvent:et}}}).call(e,i(10))},function(t,e){"use strict";t.exports=function(t){function e(){return this.value}function i(){throw this.reason}t.prototype.return=t.prototype.thenReturn=function(i){return i instanceof t&&i.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:i},void 0)},t.prototype.throw=t.prototype.thenThrow=function(t){return this._then(i,void 0,void 0,{reason:t},void 0)},t.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,i,void 0,{reason:t},void 0);var e=arguments[1],s=function(){throw e};return this.caught(t,s)},t.prototype.catchReturn=function(i){if(arguments.length<=1)return i instanceof t&&i.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:i},void 0);var s=arguments[1];s instanceof t&&s.suppressUnhandledRejections();var n=function(){return s};return this.caught(i,n)}}},function(t,e){"use strict";t.exports=function(t,e){function i(){return r(this)}function s(t,i){return n(t,i,e,e)}var n=t.reduce,r=t.all;t.prototype.each=function(t){return n(this,t,e,0)._then(i,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return n(this,t,e,e)},t.each=function(t,s){return n(t,s,e,0)._then(i,void 0,void 0,t,void 0)},t.mapSeries=s}},function(t,e){"use strict";t.exports=function(t,e){var i=t.map;t.prototype.filter=function(t,s){return i(this,t,s,e)},t.filter=function(t,s,n){return i(t,s,n,e)}}},function(t,e,i){"use strict";t.exports=function(t,e,s){function n(t,e,i){this.promise=t,this.type=e,this.handler=i,this.called=!1,this.cancelPromise=null}function r(t){this.finallyHandler=t}function o(t,e){return null!=t.cancelPromise&&(arguments.length>1?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,!0)}function a(){return l.call(this,this.promise._target()._settledValue())}function d(t){if(!o(this,t))return c.e=t,c}function l(i){var n=this.promise,l=this.handler;if(!this.called){this.called=!0;var u=this.isFinallyHandler()?l.call(n._boundValue()):l.call(n._boundValue(),i);if(u===s)return u;if(void 0!==u){n._setReturnedNonUndefined();var p=e(u,n);if(p instanceof t){if(null!=this.cancelPromise){if(p._isCancelled()){var v=new h("late cancellation observer");return n._attachExtraTrace(v),c.e=v,c}p.isPending()&&p._attachCancellationCallback(new r(this))}return p._then(a,d,void 0,this,void 0)}}}return n.isRejected()?(o(this),c.e=i,c):(o(this),i)}var u=i(2),h=t.CancellationError,c=u.errorObj,p=i(22)(s);return n.prototype.isFinallyHandler=function(){return 0===this.type},r.prototype._resultCancelled=function(){o(this.finallyHandler)},t.prototype._passThrough=function(t,e,i,s){return"function"!=typeof t?this.then():this._then(i,s,void 0,new n(this,e,t),void 0)},t.prototype.lastly=t.prototype.finally=function(t){return this._passThrough(t,0,l,l)},t.prototype.tap=function(t){return this._passThrough(t,1,l)},t.prototype.tapCatch=function(e){var i=arguments.length;if(1===i)return this._passThrough(e,1,void 0,l);var s,n=new Array(i-1),r=0;for(s=0;s<i-1;++s){var o=arguments[s];if(!u.isObject(o))return t.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+u.classString(o)));n[r++]=o}n.length=r;var a=arguments[s];return this._passThrough(p(n,a,this),1,void 0,l)},n}},function(t,e,i){"use strict";t.exports=function(t,e,s,n,r,o){function a(e,i,s){for(var r=0;r<i.length;++r){s._pushContext();var o=p(i[r])(e);if(s._popContext(),o===c){s._pushContext();var a=t.reject(c.e);return s._popContext(),a}var d=n(o,s);if(d instanceof t)return d}return null}function d(e,i,n,r){if(o.cancellation()){var a=new t(s),d=this._finallyPromise=new t(s);this._promise=a.lastly(function(){return d}),a._captureStackTrace(),a._setOnCancel(this)}else{var l=this._promise=new t(s);l._captureStackTrace()}this._stack=r,this._generatorFunction=e,this._receiver=i,this._generator=void 0,this._yieldHandlers="function"==typeof n?[n].concat(v):v,this._yieldedPromise=null,this._cancellationPhase=!1}var l=i(5),u=l.TypeError,h=i(2),c=h.errorObj,p=h.tryCatch,v=[];h.inherits(d,r),d.prototype._isResolved=function(){return null===this._promise},d.prototype._cleanup=function(){this._promise=this._generator=null,o.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},d.prototype._promiseCancelled=function(){if(!this._isResolved()){var e,i="undefined"!=typeof this._generator.return;if(i)this._promise._pushContext(),e=p(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var s=new t.CancellationError("generator .return() sentinel");t.coroutine.returnSentinel=s,this._promise._attachExtraTrace(s),this._promise._pushContext(),e=p(this._generator.throw).call(this._generator,s),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(e)}},d.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext();var e=p(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},d.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext();var e=p(this._generator.throw).call(this._generator,t);this._promise._popContext(),this._continue(e)},d.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof t){var e=this._yieldedPromise;this._yieldedPromise=null,e.cancel()}},d.prototype.promise=function(){return this._promise},d.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},d.prototype._continue=function(e){var i=this._promise;if(e===c)return this._cleanup(),this._cancellationPhase?i.cancel():i._rejectCallback(e.e,!1);var s=e.value;if(e.done===!0)return this._cleanup(),this._cancellationPhase?i.cancel():i._resolveCallback(s);var r=n(s,this._promise);if(!(r instanceof t)&&(r=a(r,this._yieldHandlers,this._promise),null===r))return void this._promiseRejected(new u("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(s))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));r=r._target();var o=r._bitField;0===(50397184&o)?(this._yieldedPromise=r,r._proxy(this,null)):0!==(33554432&o)?t._async.invoke(this._promiseFulfilled,this,r._value()):0!==(16777216&o)?t._async.invoke(this._promiseRejected,this,r._reason()):this._promiseCancelled()},t.coroutine=function(t,e){if("function"!=typeof t)throw new u("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var i=Object(e).yieldHandler,s=d,n=(new Error).stack;return function(){var e=t.apply(this,arguments),r=new s(void 0,void 0,i,n),o=r.promise();return r._generator=e,r._promiseFulfilled(void 0),o}},t.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new u("expecting a function but got "+h.classString(t));v.push(t)},t.spawn=function(i){if(o.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof i)return e("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var s=new d(i,this),n=s.promise();return s._run(t.spawn),n}}},function(t,e,i){"use strict";t.exports=function(t,e,s,n,r,o){var a,d=i(2),l=d.canEvaluate,u=d.tryCatch,h=d.errorObj;if(l){for(var c=function(t){return new Function("value","holder","                             \n\t            'use strict';                                                    \n\t            holder.pIndex = value;                                           \n\t            holder.checkFulfillment(this);                                   \n\t            ".replace(/Index/g,t))},p=function(t){return new Function("promise","holder","                           \n\t            'use strict';                                                    \n\t            holder.pIndex = promise;                                         \n\t            ".replace(/Index/g,t))},v=function(e){for(var i=new Array(e),s=0;s<i.length;++s)i[s]="this.p"+(s+1);var n=i.join(" = ")+" = null;",o="var promise;\n"+i.map(function(t){return"                                                         \n\t                promise = "+t+";                                      \n\t                if (promise instanceof Promise) {                            \n\t                    promise.cancel();                                        \n\t                }                                                            \n\t            "}).join("\n"),a=i.join(", "),d="Holder$"+e,l="return function(tryCatch, errorObj, Promise, async) {    \n\t            'use strict';                                                    \n\t            function [TheName](fn) {                                         \n\t                [TheProperties]                                              \n\t                this.fn = fn;                                                \n\t                this.asyncNeeded = true;                                     \n\t                this.now = 0;                                                \n\t            }                                                                \n\t                                                                             \n\t            [TheName].prototype._callFunction = function(promise) {          \n\t                promise._pushContext();                                      \n\t                var ret = tryCatch(this.fn)([ThePassedArguments]);           \n\t                promise._popContext();                                       \n\t                if (ret === errorObj) {                                      \n\t                    promise._rejectCallback(ret.e, false);                   \n\t                } else {                                                     \n\t                    promise._resolveCallback(ret);                           \n\t                }                                                            \n\t            };                                                               \n\t                                                                             \n\t            [TheName].prototype.checkFulfillment = function(promise) {       \n\t                var now = ++this.now;                                        \n\t                if (now === [TheTotal]) {                                    \n\t                    if (this.asyncNeeded) {                                  \n\t                        async.invoke(this._callFunction, this, promise);     \n\t                    } else {                                                 \n\t                        this._callFunction(promise);                         \n\t                    }                                                        \n\t                                                                             \n\t                }                                                            \n\t            };                                                               \n\t                                                                             \n\t            [TheName].prototype._resultCancelled = function() {              \n\t                [CancellationCode]                                           \n\t            };                                                               \n\t                                                                             \n\t            return [TheName];                                                \n\t        }(tryCatch, errorObj, Promise, async);                               \n\t        ";return l=l.replace(/\[TheName\]/g,d).replace(/\[TheTotal\]/g,e).replace(/\[ThePassedArguments\]/g,a).replace(/\[TheProperties\]/g,n).replace(/\[CancellationCode\]/g,o),new Function("tryCatch","errorObj","Promise","async",l)(u,h,t,r)},f=[],m=[],g=[],y=0;y<8;++y)f.push(v(y+1)),m.push(c(y+1)),g.push(p(y+1));a=function(t){this._reject(t)}}t.join=function(){var i,r=arguments.length-1;if(r>0&&"function"==typeof arguments[r]&&(i=arguments[r],r<=8&&l)){var u=new t(n);u._captureStackTrace();for(var h=f[r-1],c=new h(i),p=m,v=0;v<r;++v){var y=s(arguments[v],u);if(y instanceof t){y=y._target();var _=y._bitField;0===(50397184&_)?(y._then(p[v],a,void 0,u,c),g[v](y,c),c.asyncNeeded=!1):0!==(33554432&_)?p[v].call(u,y._value(),c):0!==(16777216&_)?u._reject(y._reason()):u._cancel()}else p[v].call(u,y,c)}if(!u._isFateSealed()){if(c.asyncNeeded){var b=o();null!==b&&(c.fn=d.domainBind(b,c.fn))}u._setAsyncGuaranteed(),u._setOnCancel(c)}return u}for(var w=arguments.length,A=new Array(w),k=0;k<w;++k)A[k]=arguments[k];i&&A.pop();var u=new e(A).promise();return void 0!==i?u.spread(i):u}}},function(t,e,i){"use strict";t.exports=function(t,e,s,n,r,o){function a(t,e,i,s){this.constructor$(t),this._promise._captureStackTrace();var n=l();this._callback=null===n?e:u.domainBind(n,e),this._preservedValues=s===r?new Array(this.length()):null,this._limit=i,this._inFlight=0,this._queue=[],p.invoke(this._asyncInit,this,void 0)}function d(e,i,n,r){if("function"!=typeof i)return s("expecting a function but got "+u.classString(i));var o=0;if(void 0!==n){if("object"!=typeof n||null===n)return t.reject(new TypeError("options argument must be an object but it is "+u.classString(n)));if("number"!=typeof n.concurrency)return t.reject(new TypeError("'concurrency' must be a number but it is "+u.classString(n.concurrency)));o=n.concurrency}return o="number"==typeof o&&isFinite(o)&&o>=1?o:0,new a(e,i,o,r).promise()}var l=t._getDomain,u=i(2),h=u.tryCatch,c=u.errorObj,p=t._async;u.inherits(a,e),a.prototype._asyncInit=function(){this._init$(void 0,-2)},a.prototype._init=function(){},a.prototype._promiseFulfilled=function(e,i){var s=this._values,r=this.length(),a=this._preservedValues,d=this._limit;if(i<0){if(i=i*-1-1,s[i]=e,d>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(d>=1&&this._inFlight>=d)return s[i]=e,this._queue.push(i),!1;null!==a&&(a[i]=e);var l=this._promise,u=this._callback,p=l._boundValue();l._pushContext();var v=h(u).call(p,e,i,r),f=l._popContext();if(o.checkForgottenReturns(v,f,null!==a?"Promise.filter":"Promise.map",l),v===c)return this._reject(v.e),!0;var m=n(v,this._promise);if(m instanceof t){m=m._target();var g=m._bitField;if(0===(50397184&g))return d>=1&&this._inFlight++,s[i]=m,m._proxy(this,(i+1)*-1),!1;if(0===(33554432&g))return 0!==(16777216&g)?(this._reject(m._reason()),!0):(this._cancel(),!0);v=m._value()}s[i]=v}var y=++this._totalResolved;return y>=r&&(null!==a?this._filter(s,a):this._resolve(s),!0)},a.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,i=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var s=t.pop();this._promiseFulfilled(i[s],s)}},a.prototype._filter=function(t,e){for(var i=e.length,s=new Array(i),n=0,r=0;r<i;++r)t[r]&&(s[n++]=e[r]);s.length=n,this._resolve(s)},a.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(t,e){return d(this,t,e,null)},t.map=function(t,e,i,s){return d(t,e,i,s)}}},function(t,e,i){"use strict";t.exports=function(t,e,s,n,r){var o=i(2),a=o.tryCatch;t.method=function(i){if("function"!=typeof i)throw new t.TypeError("expecting a function but got "+o.classString(i));return function(){var s=new t(e);s._captureStackTrace(),s._pushContext();var n=a(i).apply(this,arguments),o=s._popContext();return r.checkForgottenReturns(n,o,"Promise.method",s),s._resolveFromSyncValue(n),s}},t.attempt=t.try=function(i){if("function"!=typeof i)return n("expecting a function but got "+o.classString(i));var s=new t(e);s._captureStackTrace(),s._pushContext();var d;if(arguments.length>1){r.deprecated("calling Promise.try with more than 1 argument");var l=arguments[1],u=arguments[2];d=o.isArray(l)?a(i).apply(u,l):a(i).call(u,l)}else d=a(i)();var h=s._popContext();return r.checkForgottenReturns(d,h,"Promise.try",s),s._resolveFromSyncValue(d),s},t.prototype._resolveFromSyncValue=function(t){t===o.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},function(t,e,i){"use strict";t.exports=function(t){function e(t,e){var i=this;if(!r.isArray(t))return s.call(i,t,e);var n=a(e).apply(i._boundValue(),[null].concat(t));n===d&&o.throwLater(n.e)}function s(t,e){var i=this,s=i._boundValue(),n=void 0===t?a(e).call(s,null):a(e).call(s,null,t);n===d&&o.throwLater(n.e)}function n(t,e){var i=this;if(!t){var s=new Error(t+"");s.cause=t,t=s}var n=a(e).call(i._boundValue(),t);n===d&&o.throwLater(n.e)}var r=i(2),o=t._async,a=r.tryCatch,d=r.errorObj;t.prototype.asCallback=t.prototype.nodeify=function(t,i){if("function"==typeof t){var r=s;void 0!==i&&Object(i).spread&&(r=e),this._then(r,n,void 0,this,t)}return this}}},function(t,e,i){(function(e){"use strict";t.exports=function(){function s(){}function n(t,e){if(null==t||t.constructor!==r)throw new _("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof e)throw new _("expecting a function but got "+v.classString(e))}function r(t){t!==w&&n(this,t),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(t),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function o(t){this.promise._resolveCallback(t)}function a(t){this.promise._rejectCallback(t,!1)}function d(t){var e=new r(w);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}var l,u=function(){return new _("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},h=function(){return new r.PromiseInspection(this._target())},c=function(t){return r.reject(new _(t))},p={},v=i(2);l=v.isNode?function(){var t=e.domain;return void 0===t&&(t=null),t}:function(){return null},v.notEnumerableProp(r,"_getDomain",l);var f=i(7),m=i(73),g=new m;f.defineProperty(r,"_async",{value:g});var y=i(5),_=r.TypeError=y.TypeError;r.RangeError=y.RangeError;var b=r.CancellationError=y.CancellationError;r.TimeoutError=y.TimeoutError,r.OperationalError=y.OperationalError,r.RejectionError=y.OperationalError,r.AggregateError=y.AggregateError;var w=function(){},A={},k={},T=i(99)(r,w),C=i(89)(r,w,T,c,s),E=i(77)(r),I=E.create,V=i(78)(r,E),x=(V.CapturedTrace,i(82)(r,T,k)),S=i(22)(k),P=i(23),L=v.errorObj,F=v.tryCatch;return r.prototype.toString=function(){return"[object Promise]"},r.prototype.caught=r.prototype.catch=function(t){var e=arguments.length;if(e>1){var i,s=new Array(e-1),n=0;for(i=0;i<e-1;++i){var r=arguments[i];if(!v.isObject(r))return c("Catch statement predicate: expecting an object but got "+v.classString(r));s[n++]=r}return s.length=n,t=arguments[i],this.then(void 0,S(s,t,this))}return this.then(void 0,t)},r.prototype.reflect=function(){return this._then(h,h,void 0,this,void 0)},r.prototype.then=function(t,e){if(V.warnings()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var i=".then() only accepts functions but was passed: "+v.classString(t);arguments.length>1&&(i+=", "+v.classString(e)),this._warn(i)}return this._then(t,e,void 0,void 0,void 0)},r.prototype.done=function(t,e){var i=this._then(t,e,void 0,void 0,void 0);i._setIsFinal()},r.prototype.spread=function(t){return"function"!=typeof t?c("expecting a function but got "+v.classString(t)):this.all()._then(t,void 0,void 0,A,void 0)},r.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},r.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new C(this).promise()},r.prototype.error=function(t){return this.caught(v.originatesFromRejection,t)},r.getNewLibraryCopy=t.exports,r.is=function(t){return t instanceof r},r.fromNode=r.fromCallback=function(t){var e=new r(w);e._captureStackTrace();var i=arguments.length>1&&!!Object(arguments[1]).multiArgs,s=F(t)(P(e,i));return s===L&&e._rejectCallback(s.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},r.all=function(t){return new C(t).promise()},r.cast=function(t){var e=T(t);return e instanceof r||(e=new r(w),e._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},r.resolve=r.fulfilled=r.cast,r.reject=r.rejected=function(t){var e=new r(w);return e._captureStackTrace(),e._rejectCallback(t,!0),e},r.setScheduler=function(t){if("function"!=typeof t)throw new _("expecting a function but got "+v.classString(t));return g.setScheduler(t)},r.prototype._then=function(t,e,i,s,n){var o=void 0!==n,a=o?n:new r(w),d=this._target(),u=d._bitField;o||(a._propagateFrom(this,3),a._captureStackTrace(),void 0===s&&0!==(2097152&this._bitField)&&(s=0!==(50397184&u)?this._boundValue():d===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,a));var h=l();if(0!==(50397184&u)){var c,p,f=d._settlePromiseCtx;0!==(33554432&u)?(p=d._rejectionHandler0,c=t):0!==(16777216&u)?(p=d._fulfillmentHandler0,c=e,d._unsetRejectionIsUnhandled()):(f=d._settlePromiseLateCancellationObserver,p=new b("late cancellation observer"),d._attachExtraTrace(p),c=e),g.invoke(f,d,{handler:null===h?c:"function"==typeof c&&v.domainBind(h,c),promise:a,receiver:s,value:p})}else d._addCallbacks(t,e,a,s,h);return a},r.prototype._length=function(){return 65535&this._bitField},r.prototype._isFateSealed=function(){return 0!==(117506048&this._bitField)},r.prototype._isFollowing=function(){return 67108864===(67108864&this._bitField)},r.prototype._setLength=function(t){this._bitField=this._bitField&-65536|65535&t},r.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},r.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},r.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},r.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},r.prototype._isFinal=function(){return(4194304&this._bitField)>0},r.prototype._unsetCancelled=function(){this._bitField=this._bitField&-65537},r.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},r.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},r.prototype._setAsyncGuaranteed=function(){g.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},r.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[4*t-4+3];if(e!==p)return void 0===e&&this._isBound()?this._boundValue():e},r.prototype._promiseAt=function(t){return this[4*t-4+2]},r.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4+0]},r.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},r.prototype._boundValue=function(){},r.prototype._migrateCallback0=function(t){var e=(t._bitField,t._fulfillmentHandler0),i=t._rejectionHandler0,s=t._promise0,n=t._receiverAt(0);void 0===n&&(n=p),this._addCallbacks(e,i,s,n,null)},r.prototype._migrateCallbackAt=function(t,e){var i=t._fulfillmentHandlerAt(e),s=t._rejectionHandlerAt(e),n=t._promiseAt(e),r=t._receiverAt(e);void 0===r&&(r=p),this._addCallbacks(i,s,n,r,null)},r.prototype._addCallbacks=function(t,e,i,s,n){var r=this._length();if(r>=65531&&(r=0,this._setLength(0)),0===r)this._promise0=i,this._receiver0=s,"function"==typeof t&&(this._fulfillmentHandler0=null===n?t:v.domainBind(n,t)),"function"==typeof e&&(this._rejectionHandler0=null===n?e:v.domainBind(n,e));else{var o=4*r-4;this[o+2]=i,this[o+3]=s,"function"==typeof t&&(this[o+0]=null===n?t:v.domainBind(n,t)),"function"==typeof e&&(this[o+1]=null===n?e:v.domainBind(n,e))}return this._setLength(r+1),r},r.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},r.prototype._resolveCallback=function(t,e){if(0===(117506048&this._bitField)){if(t===this)return this._rejectCallback(u(),!1);var i=T(t,this);if(!(i instanceof r))return this._fulfill(t);e&&this._propagateFrom(i,2);var s=i._target();if(s===this)return void this._reject(u());var n=s._bitField;if(0===(50397184&n)){var o=this._length();o>0&&s._migrateCallback0(this);for(var a=1;a<o;++a)s._migrateCallbackAt(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(s)}else if(0!==(33554432&n))this._fulfill(s._value());else if(0!==(16777216&n))this._reject(s._reason());else{var d=new b("late cancellation observer");s._attachExtraTrace(d),this._reject(d)}}},r.prototype._rejectCallback=function(t,e,i){var s=v.ensureErrorObject(t),n=s===t;if(!n&&!i&&V.warnings()){var r="a promise was rejected with a non-error: "+v.classString(t);this._warn(r,!0)}this._attachExtraTrace(s,!!e&&n),this._reject(t)},r.prototype._resolveFromExecutor=function(t){if(t!==w){var e=this;this._captureStackTrace(),this._pushContext();var i=!0,s=this._execute(t,function(t){e._resolveCallback(t)},function(t){e._rejectCallback(t,i)});i=!1,this._popContext(),void 0!==s&&e._rejectCallback(s,!0)}},r.prototype._settlePromiseFromHandler=function(t,e,i,s){var n=s._bitField;if(0===(65536&n)){s._pushContext();var r;e===A?i&&"number"==typeof i.length?r=F(t).apply(this._boundValue(),i):(r=L,r.e=new _("cannot .spread() a non-array: "+v.classString(i))):r=F(t).call(e,i);var o=s._popContext();n=s._bitField,0===(65536&n)&&(r===k?s._reject(i):r===L?s._rejectCallback(r.e,!1):(V.checkForgottenReturns(r,o,"",s,this),s._resolveCallback(r)))}},r.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},r.prototype._followee=function(){return this._rejectionHandler0},r.prototype._setFollowee=function(t){this._rejectionHandler0=t},r.prototype._settlePromise=function(t,e,i,n){var o=t instanceof r,a=this._bitField,d=0!==(134217728&a);0!==(65536&a)?(o&&t._invokeInternalOnCancel(),i instanceof x&&i.isFinallyHandler()?(i.cancelPromise=t,F(e).call(i,n)===L&&t._reject(L.e)):e===h?t._fulfill(h.call(i)):i instanceof s?i._promiseCancelled(t):o||t instanceof C?t._cancel():i.cancel()):"function"==typeof e?o?(d&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,i,n,t)):e.call(i,n,t):i instanceof s?i._isResolved()||(0!==(33554432&a)?i._promiseFulfilled(n,t):i._promiseRejected(n,t)):o&&(d&&t._setAsyncGuaranteed(),0!==(33554432&a)?t._fulfill(n):t._reject(n))},r.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,i=t.promise,s=t.receiver,n=t.value;"function"==typeof e?i instanceof r?this._settlePromiseFromHandler(e,s,n,i):e.call(s,n,i):i instanceof r&&i._reject(n)},r.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},r.prototype._settlePromise0=function(t,e,i){var s=this._promise0,n=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(s,t,n,e)},r.prototype._clearCallbackDataAtIndex=function(t){var e=4*t-4;this[e+2]=this[e+3]=this[e+0]=this[e+1]=void 0},r.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this){var i=u();return this._attachExtraTrace(i),this._reject(i)}this._setFulfilled(),this._rejectionHandler0=t,(65535&e)>0&&(0!==(134217728&e)?this._settlePromises():g.settlePromises(this),this._dereferenceTrace())}},r.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16))return this._setRejected(),this._fulfillmentHandler0=t,this._isFinal()?g.fatalError(t,v.isNode):void((65535&e)>0?g.settlePromises(this):this._ensurePossibleRejectionHandled())},r.prototype._fulfillPromises=function(t,e){for(var i=1;i<t;i++){var s=this._fulfillmentHandlerAt(i),n=this._promiseAt(i),r=this._receiverAt(i);this._clearCallbackDataAtIndex(i),this._settlePromise(n,s,r,e)}},r.prototype._rejectPromises=function(t,e){for(var i=1;i<t;i++){var s=this._rejectionHandlerAt(i),n=this._promiseAt(i),r=this._receiverAt(i);this._clearCallbackDataAtIndex(i),this._settlePromise(n,s,r,e)}},r.prototype._settlePromises=function(){var t=this._bitField,e=65535&t;if(e>0){if(0!==(16842752&t)){var i=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,i,t),this._rejectPromises(e,i)}else{var s=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,s,t),this._fulfillPromises(e,s)}this._setLength(0)}this._clearCancellationData()},r.prototype._settledValue=function(){var t=this._bitField;return 0!==(33554432&t)?this._rejectionHandler0:0!==(16777216&t)?this._fulfillmentHandler0:void 0},r.defer=r.pending=function(){V.deprecated("Promise.defer","new Promise");var t=new r(w);return{promise:t,resolve:o,reject:a}},v.notEnumerableProp(r,"_makeSelfResolutionError",u),i(86)(r,w,T,c,V),i(74)(r,w,T,V),i(76)(r,C,c,V),i(79)(r),i(98)(r),i(84)(r,C,T,w,g,l),r.Promise=r,r.version="3.5.2",i(85)(r,C,c,T,w,V),i(75)(r),i(101)(r,c,T,I,w,V),i(100)(r,w,V),i(83)(r,c,w,T,s,V),i(87)(r),i(90)(r,w),i(91)(r,C,T,c),i(93)(r,w,T,c),i(94)(r,C,c,T,w,V),i(96)(r,C,V),i(97)(r,C,c),i(81)(r,w),i(80)(r,w),i(72)(r),v.toFastProperties(r),v.toFastProperties(r.prototype),d({a:1}),d({b:2}),d({c:3}),d(1),d(function(){}),d(void 0),d(!1),d(new r(w)),V.setBounds(m.firstLineError,v.lastLineError),r}}).call(e,i(10))},function(t,e,i){"use strict";t.exports=function(t,e,s,n,r){function o(t){switch(t){case-2:return[];case-3:return{};case-6:return new Map}}function a(i){var s=this._promise=new t(e);i instanceof t&&s._propagateFrom(i,3),s._setOnCancel(this),this._values=i,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var d=i(2);return d.isArray,d.inherits(a,r),a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function e(i,r){var a=s(this._values,this._promise);if(a instanceof t){a=a._target();var l=a._bitField;if(this._values=a,0===(50397184&l))return this._promise._setAsyncGuaranteed(),a._then(e,this._reject,void 0,this,r);if(0===(33554432&l))return 0!==(16777216&l)?this._reject(a._reason()):this._cancel();a=a._value()}if(a=d.asArray(a),null===a){var u=n("expecting an array or an iterable object but got "+d.classString(a)).reason();return void this._promise._rejectCallback(u,!1)}return 0===a.length?void(r===-5?this._resolveEmptyArray():this._resolve(o(r))):void this._iterate(a)},a.prototype._iterate=function(e){var i=this.getActualLength(e.length);this._length=i,this._values=this.shouldCopyValues()?new Array(i):this._values;for(var n=this._promise,r=!1,o=null,a=0;a<i;++a){var d=s(e[a],n);d instanceof t?(d=d._target(),o=d._bitField):o=null,r?null!==o&&d.suppressUnhandledRejections():null!==o?0===(50397184&o)?(d._proxy(this,a),this._values[a]=d):r=0!==(33554432&o)?this._promiseFulfilled(d._value(),a):0!==(16777216&o)?this._promiseRejected(d._reason(),a):this._promiseCancelled(a):r=this._promiseFulfilled(d,a)}r||n._setAsyncGuaranteed()},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},a.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},a.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},a.prototype._promiseFulfilled=function(t,e){
this._values[e]=t;var i=++this._totalResolved;return i>=this._length&&(this._resolve(this._values),!0)},a.prototype._promiseCancelled=function(){return this._cancel(),!0},a.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},a.prototype._resultCancelled=function(){if(!this._isResolved()){var e=this._values;if(this._cancel(),e instanceof t)e.cancel();else for(var i=0;i<e.length;++i)e[i]instanceof t&&e[i].cancel()}},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(t){return t},a}},function(t,e,i){"use strict";t.exports=function(t,e){function s(t){return!A.test(t)}function n(t){try{return t.__isPromisified__===!0}catch(t){return!1}}function r(t,e,i){var s=p.getDataPropertyOrDefault(t,e+i,b);return!!s&&n(s)}function o(t,e,i){for(var s=0;s<t.length;s+=2){var n=t[s];if(i.test(n))for(var r=n.replace(i,""),o=0;o<t.length;o+=2)if(t[o]===r)throw new y("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",e))}}function a(t,e,i,s){for(var a=p.inheritedDataKeys(t),d=[],l=0;l<a.length;++l){var u=a[l],h=t[u],c=s===k||k(u,h,t);"function"!=typeof h||n(h)||r(t,u,e)||!s(u,h,t,c)||d.push(u,h)}return o(d,e,i),d}function d(i,s,n,r,o,a){function d(){var n=s;s===c&&(n=this);var r=new t(e);r._captureStackTrace();var o="string"==typeof u&&this!==l?this[u]:i,d=v(r,a);try{o.apply(n,f(arguments,d))}catch(t){r._rejectCallback(m(t),!0,!0)}return r._isFateSealed()||r._setAsyncGuaranteed(),r}var l=function(){return this}(),u=i;return"string"==typeof u&&(i=r),p.notEnumerableProp(d,"__isPromisified__",!0),d}function l(t,e,i,s,n){for(var r=new RegExp(T(e)+"$"),o=a(t,e,r,i),d=0,l=o.length;d<l;d+=2){var u=o[d],h=o[d+1],v=u+e;if(s===x)t[v]=x(u,c,u,h,e,n);else{var f=s(h,function(){return x(u,c,u,h,e,n)});p.notEnumerableProp(f,"__isPromisified__",!0),t[v]=f}}return p.toFastProperties(t),t}function u(t,e,i){return x(t,e,void 0,t,null,i)}var h,c={},p=i(2),v=i(23),f=p.withAppended,m=p.maybeWrapAsError,g=p.canEvaluate,y=i(5).TypeError,_="Async",b={__isPromisified__:!0},w=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],A=new RegExp("^(?:"+w.join("|")+")$"),k=function(t){return p.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t},T=function(t){return t.replace(/([$])/,"\\$")},C=function(t){for(var e=[t],i=Math.max(0,t-1-3),s=t-1;s>=i;--s)e.push(s);for(var s=t+1;s<=3;++s)e.push(s);return e},E=function(t){return p.filledRange(t,"_arg","")},I=function(t){return p.filledRange(Math.max(t,3),"_arg","")},V=function(t){return"number"==typeof t.length?Math.max(Math.min(t.length,1024),0):0};h=function(i,s,n,r,o,a){function d(t){var e,i=E(t).join(", "),n=t>0?", ":"";return e=g?"ret = callback.call(this, {{args}}, nodeback); break;\n":void 0===s?"ret = callback({{args}}, nodeback); break;\n":"ret = callback.call(receiver, {{args}}, nodeback); break;\n",e.replace("{{args}}",i).replace(", ",n)}function l(){for(var t="",e=0;e<h.length;++e)t+="case "+h[e]+":"+d(h[e]);return t+="                                                             \n\t        default:                                                             \n\t            var args = new Array(len + 1);                                   \n\t            var i = 0;                                                       \n\t            for (var i = 0; i < len; ++i) {                                  \n\t               args[i] = arguments[i];                                       \n\t            }                                                                \n\t            args[i] = nodeback;                                              \n\t            [CodeForCall]                                                    \n\t            break;                                                           \n\t        ".replace("[CodeForCall]",g?"ret = callback.apply(this, args);\n":"ret = callback.apply(receiver, args);\n")}var u=Math.max(0,V(r)-1),h=C(u),g="string"==typeof i||s===c,y="string"==typeof i?"this != null ? this['"+i+"'] : fn":"fn",_="'use strict';                                                \n\t        var ret = function (Parameters) {                                    \n\t            'use strict';                                                    \n\t            var len = arguments.length;                                      \n\t            var promise = new Promise(INTERNAL);                             \n\t            promise._captureStackTrace();                                    \n\t            var nodeback = nodebackForPromise(promise, "+a+");   \n\t            var ret;                                                         \n\t            var callback = tryCatch([GetFunctionCode]);                      \n\t            switch(len) {                                                    \n\t                [CodeForSwitchCase]                                          \n\t            }                                                                \n\t            if (ret === errorObj) {                                          \n\t                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\n\t            }                                                                \n\t            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     \n\t            return promise;                                                  \n\t        };                                                                   \n\t        notEnumerableProp(ret, '__isPromisified__', true);                   \n\t        return ret;                                                          \n\t    ".replace("[CodeForSwitchCase]",l()).replace("[GetFunctionCode]",y);return _=_.replace("Parameters",I(u)),new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL",_)(t,r,s,f,m,v,p.tryCatch,p.errorObj,p.notEnumerableProp,e)};var x=g?h:d;t.promisify=function(t,e){if("function"!=typeof t)throw new y("expecting a function but got "+p.classString(t));if(n(t))return t;e=Object(e);var i=void 0===e.context?c:e.context,r=!!e.multiArgs,o=u(t,i,r);return p.copyDescriptors(t,o,s),o},t.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new y("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");e=Object(e);var i=!!e.multiArgs,s=e.suffix;"string"!=typeof s&&(s=_);var n=e.filter;"function"!=typeof n&&(n=k);var r=e.promisifier;if("function"!=typeof r&&(r=x),!p.isIdentifier(s))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var o=p.inheritedDataKeys(t),a=0;a<o.length;++a){var d=t[o[a]];"constructor"!==o[a]&&p.isClass(d)&&(l(d.prototype,s,n,r,i),l(d,s,n,r,i))}return l(t,s,n,r,i)}}},function(t,e,i){"use strict";t.exports=function(t,e,s,n){function r(t){var e,i=!1;if(void 0!==a&&t instanceof a)e=h(t),i=!0;else{var s=u.keys(t),n=s.length;e=new Array(2*n);for(var r=0;r<n;++r){var o=s[r];e[r]=t[o],e[r+n]=o}}this.constructor$(e),this._isMap=i,this._init$(void 0,i?-6:-3)}function o(e){var i,o=s(e);return l(o)?(i=o instanceof t?o._then(t.props,void 0,void 0,void 0,void 0):new r(o).promise(),o instanceof t&&i._propagateFrom(o,2),i):n("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var a,d=i(2),l=d.isObject,u=i(7);"function"==typeof Map&&(a=Map);var h=function(){function t(t,s){this[e]=t,this[e+i]=s,e++}var e=0,i=0;return function(s){i=s.size,e=0;var n=new Array(2*s.size);return s.forEach(t,n),n}}(),c=function(t){for(var e=new a,i=t.length/2|0,s=0;s<i;++s){var n=t[i+s],r=t[s];e.set(n,r)}return e};d.inherits(r,e),r.prototype._init=function(){},r.prototype._promiseFulfilled=function(t,e){this._values[e]=t;var i=++this._totalResolved;if(i>=this._length){var s;if(this._isMap)s=c(this._values);else{s={};for(var n=this.length(),r=0,o=this.length();r<o;++r)s[this._values[r+n]]=this._values[r]}return this._resolve(s),!0}return!1},r.prototype.shouldCopyValues=function(){return!1},r.prototype.getActualLength=function(t){return t>>1},t.prototype.props=function(){return o(this)},t.props=function(t){return o(t)}}},function(t,e){"use strict";function i(t,e,i,s,n){for(var r=0;r<n;++r)i[r+s]=t[r+e],t[r+e]=void 0}function s(t){this._capacity=t,this._length=0,this._front=0}s.prototype._willBeOverCapacity=function(t){return this._capacity<t},s.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1);var i=this._front+e&this._capacity-1;this[i]=t,this._length=e+1},s.prototype.push=function(t,e,i){var s=this.length()+3;if(this._willBeOverCapacity(s))return this._pushOne(t),this._pushOne(e),void this._pushOne(i);var n=this._front+s-3;this._checkCapacity(s);var r=this._capacity-1;this[n+0&r]=t,this[n+1&r]=e,this[n+2&r]=i,this._length=s},s.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},s.prototype.length=function(){return this._length},s.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},s.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t;var s=this._front,n=this._length,r=s+n&e-1;i(this,0,this,e,r)},t.exports=s},function(t,e,i){"use strict";t.exports=function(t,e,s,n){function r(i,r){var d=s(i);if(d instanceof t)return a(d);if(i=o.asArray(i),null===i)return n("expecting an array or an iterable object but got "+o.classString(i));var l=new t(e);void 0!==r&&l._propagateFrom(r,3);for(var u=l._fulfill,h=l._reject,c=0,p=i.length;c<p;++c){var v=i[c];(void 0!==v||c in i)&&t.cast(v)._then(u,h,void 0,l,null)}return l}var o=i(2),a=function(t){return t.then(function(e){return r(e,t)})};t.race=function(t){return r(t,void 0)},t.prototype.race=function(){return r(this,void 0)}}},function(t,e,i){"use strict";t.exports=function(t,e,s,n,r,o){function a(e,i,s,n){this.constructor$(e);var o=c();this._fn=null===o?i:p.domainBind(o,i),void 0!==s&&(s=t.resolve(s),s._attachCancellationCallback(this)),this._initialValue=s,this._currentCancellable=null,n===r?this._eachValues=Array(this._length):0===n?this._eachValues=null:this._eachValues=void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function d(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function l(t,e,i,n){if("function"!=typeof e)return s("expecting a function but got "+p.classString(e));var r=new a(t,e,i,n);return r.promise()}function u(e){this.accum=e,this.array._gotAccum(e);var i=n(this.value,this.array._promise);return i instanceof t?(this.array._currentCancellable=i,i._then(h,void 0,void 0,this,void 0)):h.call(this,i)}function h(e){var i=this.array,s=i._promise,n=v(i._fn);s._pushContext();var r;r=void 0!==i._eachValues?n.call(s._boundValue(),e,this.index,this.length):n.call(s._boundValue(),this.accum,e,this.index,this.length),r instanceof t&&(i._currentCancellable=r);var a=s._popContext();return o.checkForgottenReturns(r,a,void 0!==i._eachValues?"Promise.each":"Promise.reduce",s),r}var c=t._getDomain,p=i(2),v=p.tryCatch;p.inherits(a,e),a.prototype._gotAccum=function(t){void 0!==this._eachValues&&null!==this._eachValues&&t!==r&&this._eachValues.push(t)},a.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},a.prototype._init=function(){},a.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},a.prototype.shouldCopyValues=function(){return!1},a.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},a.prototype._resultCancelled=function(e){return e===this._initialValue?this._cancel():void(this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof t&&this._currentCancellable.cancel(),this._initialValue instanceof t&&this._initialValue.cancel()))},a.prototype._iterate=function(e){this._values=e;var i,s,n=e.length;if(void 0!==this._initialValue?(i=this._initialValue,s=0):(i=t.resolve(e[0]),s=1),this._currentCancellable=i,!i.isRejected())for(;s<n;++s){var r={accum:null,value:e[s],index:s,length:n,array:this};i=i._then(u,void 0,void 0,r,void 0)}void 0!==this._eachValues&&(i=i._then(this._eachComplete,void 0,void 0,this,void 0)),i._then(d,d,void 0,i,this)},t.prototype.reduce=function(t,e){return l(this,t,e,null)},t.reduce=function(t,e,i,s){return l(t,e,i,s)}}},function(t,e,i){(function(e,s,n){"use strict";var r,o=i(2),a=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")},d=o.getNativePromise();if(o.isNode&&"undefined"==typeof MutationObserver){var l=e.setImmediate,u=s.nextTick;r=o.isRecentNode?function(t){l.call(e,t)}:function(t){u.call(s,t)}}else if("function"==typeof d&&"function"==typeof d.resolve){var h=d.resolve();r=function(t){h.then(t)}}else r="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?"undefined"!=typeof n?function(t){n(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:a:function(){var t=document.createElement("div"),e={attributes:!0},i=!1,s=document.createElement("div"),n=new MutationObserver(function(){t.classList.toggle("foo"),i=!1});n.observe(s,e);var r=function(){i||(i=!0,s.classList.toggle("foo"))};return function(i){var s=new MutationObserver(function(){s.disconnect(),i()});s.observe(t,e),r()}}();t.exports=r}).call(e,function(){return this}(),i(10),i(106).setImmediate)},function(t,e,i){"use strict";t.exports=function(t,e,s){function n(t){this.constructor$(t)}var r=t.PromiseInspection,o=i(2);o.inherits(n,e),n.prototype._promiseResolved=function(t,e){this._values[t]=e;var i=++this._totalResolved;return i>=this._length&&(this._resolve(this._values),!0)},n.prototype._promiseFulfilled=function(t,e){var i=new r;return i._bitField=33554432,i._settledValueField=t,this._promiseResolved(e,i)},n.prototype._promiseRejected=function(t,e){var i=new r;return i._bitField=16777216,i._settledValueField=t,this._promiseResolved(e,i)},t.settle=function(t){return s.deprecated(".settle()",".reflect()"),new n(t).promise()},t.prototype.settle=function(){return t.settle(this)}}},function(t,e,i){"use strict";t.exports=function(t,e,s){function n(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function r(t,e){if((0|e)!==e||e<0)return s("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var i=new n(t),r=i.promise();return i.setHowMany(e),i.init(),r}var o=i(2),a=i(5).RangeError,d=i(5).AggregateError,l=o.isArray,u={};o.inherits(n,e),n.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var t=l(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},n.prototype.init=function(){this._initialized=!0,this._init()},n.prototype.setUnwrap=function(){this._unwrap=!0},n.prototype.howMany=function(){return this._howMany},n.prototype.setHowMany=function(t){this._howMany=t},n.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},n.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},n.prototype._promiseCancelled=function(){return this._values instanceof t||null==this._values?this._cancel():(this._addRejected(u),this._checkOutcome())},n.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new d,e=this.length();e<this._values.length;++e)this._values[e]!==u&&t.push(this._values[e]);return t.length>0?this._reject(t):this._cancel(),!0}return!1},n.prototype._fulfilled=function(){return this._totalResolved},n.prototype._rejected=function(){return this._values.length-this.length()},n.prototype._addRejected=function(t){this._values.push(t)},n.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},n.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},n.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new a(e)},n.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(t,e){return r(t,e)},t.prototype.some=function(t){return r(this,t)},t._SomePromiseArray=n}},function(t,e){"use strict";t.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var i=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},s=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},n=e.prototype.isFulfilled=function(){return 0!==(33554432&this._bitField)},r=e.prototype.isRejected=function(){return 0!==(16777216&this._bitField)},o=e.prototype.isPending=function(){return 0===(50397184&this._bitField)},a=e.prototype.isResolved=function(){return 0!==(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!==(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536===(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!==(8454144&this._target()._bitField)},t.prototype.isPending=function(){return o.call(this._target())},t.prototype.isRejected=function(){return r.call(this._target())},t.prototype.isFulfilled=function(){return n.call(this._target())},t.prototype.isResolved=function(){return a.call(this._target())},t.prototype.value=function(){return i.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),s.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},function(t,e,i){"use strict";t.exports=function(t,e){function s(i,s){if(u(i)){if(i instanceof t)return i;var n=r(i);if(n===l){s&&s._pushContext();var d=t.reject(n.e);return s&&s._popContext(),d}if("function"==typeof n){if(o(i)){var d=new t(e);return i._then(d._fulfill,d._reject,void 0,d,null),d}return a(i,n,s)}}return i}function n(t){return t.then}function r(t){try{return n(t)}catch(t){return l.e=t,l}}function o(t){try{return h.call(t,"_promise0")}catch(t){return!1}}function a(i,s,n){function r(t){a&&(a._resolveCallback(t),a=null)}function o(t){a&&(a._rejectCallback(t,h,!0),a=null)}var a=new t(e),u=a;n&&n._pushContext(),a._captureStackTrace(),n&&n._popContext();var h=!0,c=d.tryCatch(s).call(i,r,o);return h=!1,a&&c===l&&(a._rejectCallback(c.e,!0,!0),a=null),u}var d=i(2),l=d.errorObj,u=d.isObject,h={}.hasOwnProperty;return s}},function(t,e,i){"use strict";t.exports=function(t,e,s){function n(t){this.handle=t}function r(t){return clearTimeout(this.handle),t}function o(t){throw clearTimeout(this.handle),t}var a=i(2),d=t.TimeoutError;n.prototype._resultCancelled=function(){clearTimeout(this.handle)};var l=function(t){return u(+this).thenReturn(t)},u=t.delay=function(i,r){var o,a;return void 0!==r?(o=t.resolve(r)._then(l,null,null,i,void 0),s.cancellation()&&r instanceof t&&o._setOnCancel(r)):(o=new t(e),a=setTimeout(function(){o._fulfill()},+i),s.cancellation()&&o._setOnCancel(new n(a)),o._captureStackTrace()),o._setAsyncGuaranteed(),o};t.prototype.delay=function(t){return u(t,this)};var h=function(t,e,i){var s;s="string"!=typeof e?e instanceof Error?e:new d("operation timed out"):new d(e),a.markAsOriginatingFromRejection(s),t._attachExtraTrace(s),t._reject(s),null!=i&&i.cancel()};t.prototype.timeout=function(t,e){t=+t;var i,a,d=new n(setTimeout(function(){i.isPending()&&h(i,e,a)},t));return s.cancellation()?(a=this.then(),i=a._then(r,o,void 0,d,void 0),i._setOnCancel(d)):i=this._then(r,o,void 0,d,void 0),i}}},function(t,e,i){"use strict";t.exports=function(t,e,s,n,r,o){function a(t){setTimeout(function(){throw t},0)}function d(t){var e=s(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}function l(e,i){function n(){if(o>=l)return u._fulfill();var r=d(e[o++]);if(r instanceof t&&r._isDisposable()){try{r=s(r._getDisposer().tryDispose(i),e.promise)}catch(t){return a(t)}if(r instanceof t)return r._then(n,a,null,null,null)}n()}var o=0,l=e.length,u=new t(r);return n(),u}function u(t,e,i){this._data=t,this._promise=e,this._context=i}function h(t,e,i){this.constructor$(t,e,i)}function c(t){return u.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function p(t){this.length=t,this.promise=null,this[t-1]=null}var v=i(2),f=i(5).TypeError,m=i(2).inherits,g=v.errorObj,y=v.tryCatch,_={};u.prototype.data=function(){return this._data},u.prototype.promise=function(){return this._promise},u.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():_},u.prototype.tryDispose=function(t){var e=this.resource(),i=this._context;void 0!==i&&i._pushContext();var s=e!==_?this.doDispose(e,t):null;return void 0!==i&&i._popContext(),this._promise._unsetDisposable(),this._data=null,s},u.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},m(h,u),h.prototype.doDispose=function(t,e){var i=this.data();return i.call(t,t,e)},p.prototype._resultCancelled=function(){for(var e=this.length,i=0;i<e;++i){var s=this[i];s instanceof t&&s.cancel()}},t.using=function(){var i=arguments.length;if(i<2)return e("you must pass at least 2 arguments to Promise.using");var n=arguments[i-1];if("function"!=typeof n)return e("expecting a function but got "+v.classString(n));var r,a=!0;2===i&&Array.isArray(arguments[0])?(r=arguments[0],i=r.length,a=!1):(r=arguments,i--);for(var d=new p(i),h=0;h<i;++h){var f=r[h];if(u.isDisposer(f)){var m=f;f=f.promise(),f._setDisposable(m)}else{var _=s(f);_ instanceof t&&(f=_._then(c,null,null,{resources:d,index:h},void 0))}d[h]=f}for(var b=new Array(d.length),h=0;h<b.length;++h)b[h]=t.resolve(d[h]).reflect();var w=t.all(b).then(function(t){for(var e=0;e<t.length;++e){var i=t[e];if(i.isRejected())return g.e=i.error(),g;if(!i.isFulfilled())return void w.cancel();t[e]=i.value()}A._pushContext(),n=y(n);var s=a?n.apply(void 0,t):n(t),r=A._popContext();return o.checkForgottenReturns(s,r,"Promise.using",A),s}),A=w.lastly(function(){var e=new t.PromiseInspection(w);return l(d,e)});return d.promise=A,A._setOnCancel(d),A},t.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},t.prototype._isDisposable=function(){return(131072&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=this._bitField&-131073,this._disposer=void 0},t.prototype.disposer=function(t){if("function"==typeof t)return new h(t,this,n());throw new f}}},function(t,e,i){"use strict";function s(t){var e=(/mac os x/i.test(navigator.userAgent)?"":"Ctrl")+"+C";return t.replace(/#{\s*key\s*}/g,e)}function n(t,e){var i,n,a,d,l,u,h=!1;e||(e={}),i=e.debug||!1;try{a=r(),d=document.createRange(),l=document.getSelection(),u=document.createElement("span"),u.textContent=t,u.style.all="unset",u.style.position="fixed",u.style.top=0,u.style.clip="rect(0, 0, 0, 0)",u.style.whiteSpace="pre",u.style.webkitUserSelect="text",u.style.MozUserSelect="text",u.style.msUserSelect="text",u.style.userSelect="text",document.body.appendChild(u),d.selectNode(u),l.addRange(d);var c=document.execCommand("copy");if(!c)throw new Error("copy command was unsuccessful");h=!0}catch(r){i&&console.error("unable to copy using execCommand: ",r),i&&console.warn("trying IE specific stuff");try{window.clipboardData.setData("text",t),h=!0}catch(r){i&&console.error("unable to copy using clipboardData: ",r),i&&console.error("falling back to prompt"),n=s("message"in e?e.message:o),window.prompt(n,t)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(d):l.removeAllRanges()),u&&document.body.removeChild(u),a()}return h}var r=i(107),o="Copy to clipboard: #{key}, Enter";t.exports=n},function(t,e){(function(e){function i(t,e,i){function n(e){var i=f,s=m;return f=m=void 0,T=e,y=t.apply(s,i)}function r(t){return T=t,_=setTimeout(u,e),C?n(t):y}function d(t){var i=t-k,s=t-T,n=e-i;return E?w(n,g-s):n}function l(t){var i=t-k,s=t-T;return void 0===k||i>=e||i<0||E&&s>=g}function u(){var t=A();return l(t)?h(t):void(_=setTimeout(u,d(t)))}function h(t){return _=void 0,I&&f?n(t):(f=m=void 0,y)}function c(){void 0!==_&&clearTimeout(_),T=0,f=k=m=_=void 0}function p(){return void 0===_?y:h(A())}function v(){var t=A(),i=l(t);if(f=arguments,m=this,k=t,i){if(void 0===_)return r(k);if(E)return _=setTimeout(u,e),n(k)}return void 0===_&&(_=setTimeout(u,e)),y}var f,m,g,y,_,k,T=0,C=!1,E=!1,I=!0;if("function"!=typeof t)throw new TypeError(a);return e=o(e)||0,s(i)&&(C=!!i.leading,E="maxWait"in i,g=E?b(o(i.maxWait)||0,e):g,I="trailing"in i?!!i.trailing:I),v.cancel=c,v.flush=p,v}function s(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function n(t){return!!t&&"object"==typeof t}function r(t){return"symbol"==typeof t||n(t)&&_.call(t)==l}function o(t){if("number"==typeof t)return t;if(r(t))return d;if(s(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=s(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(u,"");var i=c.test(t);return i||p.test(t)?v(t.slice(2),i?2:8):h.test(t)?d:+t}var a="Expected a function",d=NaN,l="[object Symbol]",u=/^\s+|\s+$/g,h=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,p=/^0o[0-7]+$/i,v=parseInt,f="object"==typeof e&&e&&e.Object===Object&&e,m="object"==typeof self&&self&&self.Object===Object&&self,g=f||m||Function("return this")(),y=Object.prototype,_=y.toString,b=Math.max,w=Math.min,A=function(){return g.Date.now()};t.exports=i}).call(e,function(){return this}())},function(t,e,i){!function(e,i){t.exports=i()}(this,function(){return function(t){function e(t){delete installedChunks[t]}function i(t){var e=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.charset="utf-8",i.src=p.p+"hot_updater/hot-update.js",e.appendChild(i)}function s(){return new Promise(function(t,e){if("undefined"==typeof XMLHttpRequest)return e(new Error("No browser support"));try{var i=new XMLHttpRequest,s=p.p+"hot_updater/hot-update.json";i.open("GET",s,!0),i.timeout=1e4,i.send(null)}catch(t){return e(t)}i.onreadystatechange=function(){if(4===i.readyState)if(0===i.status)e(new Error("Manifest request to "+s+" timed out."));else if(404===i.status)t();else if(200!==i.status&&304!==i.status)e(new Error("Manifest request to "+s+" failed."));else{try{var n=JSON.parse(i.responseText)}catch(t){return void e(t)}t(n)}}})}function n(t){var e=P[t];if(!e)return p;var i=function(i){return e.hot.active?(P[i]?P[i].parents.indexOf(t)<0&&P[i].parents.push(t):(A=[t],f=i),e.children.indexOf(i)<0&&e.children.push(i)):(console.warn("[HMR] unexpected require("+i+") from disposed module "+t),A=[]),p(i)};for(var s in p)Object.prototype.hasOwnProperty.call(p,s)&&"e"!==s&&Object.defineProperty(i,s,function(t){return{configurable:!0,enumerable:!0,get:function(){return p[t]},set:function(e){p[t]=e}}}(s));return i.e=function(t){function e(){I--,"prepare"===C&&(V[t]||u(t),0===I&&0===E&&h())}return"ready"===C&&o("prepare"),I++,p.e(t).then(e,function(t){throw e(),t})},i}function r(t){var e={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:f!==t,active:!0,accept:function(t,i){if(void 0===t)e._selfAccepted=!0;else if("function"==typeof t)e._selfAccepted=t;else if("object"==typeof t)for(var s=0;s<t.length;s++)e._acceptedDependencies[t[s]]=i||function(){};else e._acceptedDependencies[t]=i||function(){}},decline:function(t){if(void 0===t)e._selfDeclined=!0;else if("object"==typeof t)for(var i=0;i<t.length;i++)e._declinedDependencies[t[i]]=!0;else e._declinedDependencies[t]=!0},dispose:function(t){e._disposeHandlers.push(t)},addDisposeHandler:function(t){e._disposeHandlers.push(t)},removeDisposeHandler:function(t){var i=e._disposeHandlers.indexOf(t);i>=0&&e._disposeHandlers.splice(i,1)},check:d,apply:c,status:function(t){return t?void T.push(t):C},addStatusHandler:function(t){T.push(t)},removeStatusHandler:function(t){var e=T.indexOf(t);e>=0&&T.splice(e,1)},data:w[t]};return f=void 0,e}function o(t){C=t;for(var e=0;e<T.length;e++)T[e].call(null,t)}function a(t){return+t+""===t?+t:t}function d(t){if("idle"!==C)throw new Error("check() is only allowed in idle status");return _=t,o("check"),s().then(function(t){if(!t)return o("idle"),null;x={},V={},S=t.c,y=t.h,o("prepare");var e=new Promise(function(t,e){m={resolve:t,reject:e}});return g={},u(0),"prepare"===C&&0===I&&0===E&&h(),e})}function l(t,e){if(S[t]&&x[t]){x[t]=!1;for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(g[i]=e[i]);0==--E&&0===I&&h()}}function u(t){S[t]?(x[t]=!0,E++,i(t)):V[t]=!0}function h(){o("ready");var t=m;if(m=null,t)if(_)c(_).then(function(e){t.resolve(e)},function(e){t.reject(e)});else{var e=[];for(var i in g)Object.prototype.hasOwnProperty.call(g,i)&&e.push(a(i));t.resolve(e)}}function c(i){function s(t,e){for(var i=0;i<e.length;i++){var s=e[i];t.indexOf(s)<0&&t.push(s)}}if("ready"!==C)throw new Error("apply() is only allowed in ready status");i=i||{};var n,r,d,l,u,h={},c=[],v={},f=function(){console.warn("[HMR] unexpected require("+_.moduleId+") to disposed module")};for(var m in g)if(Object.prototype.hasOwnProperty.call(g,m)){u=a(m);var _;_=g[m]?function(t){for(var e=[t],i={},n=e.slice().map(function(t){return{chain:[t],id:t}});n.length>0;){var r=n.pop(),o=r.id,a=r.chain;if((l=P[o])&&!l.hot._selfAccepted){if(l.hot._selfDeclined)return{type:"self-declined",chain:a,moduleId:o};if(l.hot._main)return{type:"unaccepted",chain:a,moduleId:o};for(var d=0;d<l.parents.length;d++){var u=l.parents[d],h=P[u];if(h){if(h.hot._declinedDependencies[o])return{type:"declined",chain:a.concat([u]),moduleId:o,parentId:u};e.indexOf(u)>=0||(h.hot._acceptedDependencies[o]?(i[u]||(i[u]=[]),s(i[u],[o])):(delete i[u],e.push(u),n.push({chain:a.concat([u]),id:u})))}}}}return{type:"accepted",moduleId:t,outdatedModules:e,outdatedDependencies:i}}(u):{type:"disposed",moduleId:m};var k=!1,T=!1,E=!1,I="";switch(_.chain&&(I="\nUpdate propagation: "+_.chain.join(" -> ")),_.type){case"self-declined":i.onDeclined&&i.onDeclined(_),i.ignoreDeclined||(k=new Error("Aborted because of self decline: "+_.moduleId+I));break;case"declined":i.onDeclined&&i.onDeclined(_),i.ignoreDeclined||(k=new Error("Aborted because of declined dependency: "+_.moduleId+" in "+_.parentId+I));break;case"unaccepted":i.onUnaccepted&&i.onUnaccepted(_),i.ignoreUnaccepted||(k=new Error("Aborted because "+u+" is not accepted"+I));break;case"accepted":i.onAccepted&&i.onAccepted(_),T=!0;break;case"disposed":i.onDisposed&&i.onDisposed(_),E=!0;break;default:throw new Error("Unexception type "+_.type)}if(k)return o("abort"),Promise.reject(k);if(T){v[u]=g[u],s(c,_.outdatedModules);for(u in _.outdatedDependencies)Object.prototype.hasOwnProperty.call(_.outdatedDependencies,u)&&(h[u]||(h[u]=[]),s(h[u],_.outdatedDependencies[u]))}E&&(s(c,[_.moduleId]),v[u]=f)}var V=[];for(r=0;r<c.length;r++)u=c[r],P[u]&&P[u].hot._selfAccepted&&V.push({module:u,errorHandler:P[u].hot._selfAccepted});o("dispose"),Object.keys(S).forEach(function(t){!1===S[t]&&e(t)});for(var x,L=c.slice();L.length>0;)if(u=L.pop(),l=P[u]){var F={},B=l.hot._disposeHandlers;for(d=0;d<B.length;d++)(n=B[d])(F);
for(w[u]=F,l.hot.active=!1,delete P[u],d=0;d<l.children.length;d++){var D=P[l.children[d]];D&&(x=D.parents.indexOf(u))>=0&&D.parents.splice(x,1)}}var O,M;for(u in h)if(Object.prototype.hasOwnProperty.call(h,u)&&(l=P[u]))for(M=h[u],d=0;d<M.length;d++)O=M[d],(x=l.children.indexOf(O))>=0&&l.children.splice(x,1);o("apply"),b=y;for(u in v)Object.prototype.hasOwnProperty.call(v,u)&&(t[u]=v[u]);var R=null;for(u in h)if(Object.prototype.hasOwnProperty.call(h,u)){l=P[u],M=h[u];var U=[];for(r=0;r<M.length;r++)O=M[r],n=l.hot._acceptedDependencies[O],U.indexOf(n)>=0||U.push(n);for(r=0;r<U.length;r++){n=U[r];try{n(M)}catch(t){i.onErrored&&i.onErrored({type:"accept-errored",moduleId:u,dependencyId:M[r],error:t}),i.ignoreErrored||R||(R=t)}}}for(r=0;r<V.length;r++){var j=V[r];u=j.module,A=[u];try{p(u)}catch(t){if("function"==typeof j.errorHandler)try{j.errorHandler(t)}catch(e){i.onErrored&&i.onErrored({type:"self-accept-error-handler-errored",moduleId:u,error:e,orginalError:t}),i.ignoreErrored||R||(R=e),R||(R=t)}else i.onErrored&&i.onErrored({type:"self-accept-errored",moduleId:u,error:t}),i.ignoreErrored||R||(R=t)}}return R?(o("fail"),Promise.reject(R)):(o("idle"),new Promise(function(t){t(c)}))}function p(e){if(P[e])return P[e].exports;var i=P[e]={i:e,l:!1,exports:{},hot:r(e),parents:(k=A,A=[],k),children:[]};return t[e].call(i.exports,i,i.exports,n(e)),i.l=!0,i.exports}var v=this.webpackHotUpdate;this.webpackHotUpdate=function(t,e){l(t,e),v&&v(t,e)};var f,m,g,y,_=!0,b="e011a723d4d38b992e81",w={},A=[],k=[],T=[],C="idle",E=0,I=0,V={},x={},S={},P={};return p.m=t,p.c=P,p.i=function(t){return t},p.d=function(t,e,i){p.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},p.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return p.d(e,"a",e),e},p.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},p.p="",p.h=function(){return b},n(0)(p.s=0)}({"./src/index.js":function(t,e,i){"use strict";var s=i("./src/oppsula.js");try{if(window.cmTag){var n=window.cmTag.config.ms||{};n.oppsula=n.oppsula||{},n.oppsula["1.2.8"]=s,window.cmTag.set("ms",n)}window.TRC&&(window.TRC.oppsula=window.TRC.oppsula||{},window.TRC.oppsula["1.2.8"]=s)}catch(t){}t.exports={}},"./src/opportunityType.js":function(t,e,i){"use strict";t.exports={tagStarted:0,tagImpression:1,vastFecthError:2,emptyVast:3,mediaFileNotSupported:4,adError:5,filterVastByRegex:6,playerClosed:7,vastError:8,totalTimeout:9,adErrorBeforeLoad:10,networkError:11,adUnitLoadFailed:12,queueExpired:13,queueTrimmed:14,globalTimeout:15,adtoTimeout:16,adSkiped:17,adloadedTimeout:18,hijackAttempt:19,idleMode:20,firstImpression:99,videoFirstQuartile:21,videoMidpoint:22,videoThirdQuartile:23,videoComplete:24,newCompletion:25,replayAd:27,soundViolation:34,firstWfMeasurment:35,playerClosedMeasurment:36,maxNetworkCalls:39,adLoaded:41,startAd:42,videoThrottle:43}},"./src/oppsula.js":function(t,e,i){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),r=i("./src/xhr.js"),o=i("./src/store.js"),a=i("./src/utils.js"),d=i("./src/opportunityType.js"),l={},u=function(){function t(e,i){s(this,t);var n=this._getRedId(e)||this._getRedId(i)||"red_id";return l.hasOwnProperty(n)||(this.redId=n,this.store=new o(e,i),this.baseUrl=a.getOppsServletBaseUrl(this.store),this.xhr=new r(this.baseUrl,this.store.get("psthdrs")),this.opps=[],this.fireOppsInterval=null,this.stopped=!1,this.billableEvents=(this.store.get("bllblevt")||"").split(","),this._setFireOppsInterval(),this._setFireOppsBeforeUnload(),l[n]=this),l[n]}return n(t,[{key:"_getRedId",value:function(t){if(t)return t.get("redId")||t.get("red_id")}},{key:"send",value:function(t){t.tms=Math.floor((new Date).getTime()/1e3),this.stopped||(this._isBillableEvent(t.rst)?a.fireOpp(this.baseUrl+"?"+a.flattenParams(t)):this.opps.push(t))}},{key:"_setFireOppsInterval",value:function(){this.stopped||this.fireOppsInterval||(this.fireOpps=this._fireOpps.bind(this),this.fireOppsInterval=setInterval(this.fireOpps,this.store.get("timbtopps")))}},{key:"destroy",value:function(){this.stopped||(window.removeEventListener("beforeunload",this._destroy),this.fireOppsInterval=clearInterval(this.fireOppsInterval),this._fireOpps(),this.stopped=!0,this.store&&this.store.destroy(),this.opps=this.store=this.fireOpps=this.xhr=this._destroy=void 0,l[this.redId]=void 0)}},{key:"_fireOpps",value:function(){this.stopped||(this.opps.length>0&&this.xhr.send(a.stringify(this.opps)),this.opps=[])}},{key:"_setFireOppsBeforeUnload",value:function(){this._destroy=this.destroy.bind(this),window.addEventListener("beforeunload",this._destroy)}},{key:"_isBillableEvent",value:function(t){return this.billableEvents.indexOf(""+t)>-1}},{key:"OppsID",get:function(){return d}}]),t}();t.exports=u},"./src/store.js":function(t,e,i){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),r=(i("./src/utils.js"),function(){function t(e,i){s(this,t),this.unitModel=e,this.playerModel=i,this.data={psthdrs:"application/json",timbtopps:2e3}}return n(t,[{key:"get",value:function(t){return this._getFromPlayerModel(t)}},{key:"_getFromPlayerModel",value:function(t){var e=this.playerModel?this.playerModel.get(t):void 0;return void 0!==e?e:this._getFromUnitModel(t)}},{key:"_getFromUnitModel",value:function(t){var e=this.unitModel?this.unitModel.get(t):void 0;return void 0!==e?e:this._getFromData(t)}},{key:"_getFromData",value:function(t){return t=t.toString(),-1===t.indexOf(".")?this.data[t]:o.get(t,!1,this.data)}},{key:"set",value:function(t,e){t=t.toString(),o.set(t,e,this.data)}},{key:"destroy",value:function(){this.unitModel=this.playerModel=this.data=void 0}}]),t}()),o=function(){var t=function(t,e,i){for(var s,n=i||data,r=0;n&&(s=t[r]);r++)n=s in n?n[s]:e?n[s]={}:void 0;return n};return{set:function(e,i,s){var n=e.split("."),r=n.pop(),o=t(n,!0,s);return o&&r?o[r]=i:void 0},get:function(e,i,s){return t(e.split("."),i,s)},exists:function(t,e){return void 0!==this.get(t,!1,e)}}}();t.exports=r},"./src/utils.js":function(t,e,i){"use strict";var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports={getOppsServletBaseUrl:function(t){var e=t.get("ms_data.opps_base_path");return this.setUrlPrefix(e)+(/.*\/$/g.test(e)?"":"/")+"OpportunityServlet"},setUrlPrefix:function(t){return"string"!=typeof t?t:(t=t.replace(/^(http[s]?:|ftp:)/g,""),0!==t.indexOf("//")&&(t="//"+t),t)},stringify:function(t,e){try{var i=[];return JSON.stringify(t,function(t,e){if(null!=e&&"object"==(void 0===e?"undefined":s(e))){if(i.indexOf(e)>-1)return;i.push(e)}return e},e)}catch(t){return""}},fireOpp:function(t){try{(new Image).src=t}catch(t){}},flattenParams:function(t){var e=[];for(var i in t)e.push(i+"="+t[i]);return e.join("&")}}},"./src/xhr.js":function(t,e,i){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),r=(i("./src/utils.js"),function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;arguments.length>5&&void 0!==arguments[5]&&arguments[5],s(this,t),this.baseUrl=e,this.async=void 0==n||n,this.withCredentials=void 0==r||r,this.timeout=o||5e3,this.contentType=i||"application/x-www-form-urlencoded"}return n(t,[{key:"_onFail",value:function(){this.gotResponse||(this.gotResponse=!0)}},{key:"send",value:function(t){if(this.baseUrl){var e=new XMLHttpRequest;return t=t||"",e.open(t?"POST":"GET",this.baseUrl,!0),e.withCredentials=this.withCredentials,e.setRequestHeader("Content-type",this.contentType),e.async=this.async,e.timeout=this.timeout,e.gotResponse=!1,e.addEventListener("error",this._onFail),e.addEventListener("abort",this._onFail),e.addEventListener("timeout",this._onFail),e.addEventListener("readystatechange",function(t){if(4==this.readyState){if(this.gotResponse)return;this.gotResponse=!0}}),e.send(t),!0}}}]),t}());t.exports=r},0:function(t,e,i){t.exports=i("./src/index.js")}})})},function(t,e,i){(function(t,e){!function(t,i){"use strict";function s(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var s={callback:t,args:e};return f[v]=s,p(v),v++}function n(t){delete f[t]}function r(t){var e=t.callback,s=t.args;switch(s.length){case 0:e();break;case 1:e(s[0]);break;case 2:e(s[0],s[1]);break;case 3:e(s[0],s[1],s[2]);break;default:e.apply(i,s)}}function o(t){if(m)setTimeout(o,0,t);else{var e=f[t];if(e){m=!0;try{r(e)}finally{n(t),m=!1}}}}function a(){p=function(t){e.nextTick(function(){o(t)})}}function d(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}function l(){var e="setImmediate$"+Math.random()+"$",i=function(i){i.source===t&&"string"==typeof i.data&&0===i.data.indexOf(e)&&o(+i.data.slice(e.length))};t.addEventListener?t.addEventListener("message",i,!1):t.attachEvent("onmessage",i),p=function(i){t.postMessage(e+i,"*")}}function u(){var t=new MessageChannel;t.port1.onmessage=function(t){var e=t.data;o(e)},p=function(e){t.port2.postMessage(e)}}function h(){var t=g.documentElement;p=function(e){var i=g.createElement("script");i.onreadystatechange=function(){o(e),i.onreadystatechange=null,t.removeChild(i),i=null},t.appendChild(i)}}function c(){p=function(t){setTimeout(o,0,t)}}if(!t.setImmediate){var p,v=1,f={},m=!1,g=t.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(t);y=y&&y.setTimeout?y:t,"[object process]"==={}.toString.call(t.process)?a():d()?l():t.MessageChannel?u():g&&"onreadystatechange"in g.createElement("script")?h():c(),y.setImmediate=s,y.clearImmediate=n}}("undefined"==typeof self?"undefined"==typeof t?this:t:self)}).call(e,function(){return this}(),i(10))},function(t,e,i){(function(t){function s(t,e){this._id=t,this._clearFn=e}var n="undefined"!=typeof t&&t||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;e.setTimeout=function(){return new s(r.call(setTimeout,n,arguments),clearTimeout)},e.setInterval=function(){return new s(r.call(setInterval,n,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(n,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},i(105),e.setImmediate="undefined"!=typeof self&&self.setImmediate||"undefined"!=typeof t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||"undefined"!=typeof t&&t.clearImmediate||this&&this.clearImmediate}).call(e,function(){return this}())},function(t,e){t.exports=function(){var t=document.getSelection();if(!t.rangeCount)return function(){};for(var e=document.activeElement,i=[],s=0;s<t.rangeCount;s++)i.push(t.getRangeAt(s));switch(e.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":e.blur();break;default:e=null}return t.removeAllRanges(),function(){"Caret"===t.type&&t.removeAllRanges(),t.rangeCount||i.forEach(function(e){t.addRange(e)}),e&&e.focus()}}},function(t,e,i){var s;!function(n,r){"use strict";var o="0.7.12",a="",d="?",l="function",u="undefined",h="object",c="string",p="major",v="model",f="name",m="type",g="vendor",y="version",_="architecture",b="console",w="mobile",A="tablet",k="smarttv",T="wearable",C="embedded",E={extend:function(t,e){var i={};for(var s in t)e[s]&&e[s].length%2===0?i[s]=e[s].concat(t[s]):i[s]=t[s];return i},has:function(t,e){return"string"==typeof t&&e.toLowerCase().indexOf(t.toLowerCase())!==-1},lowerize:function(t){return t.toLowerCase()},major:function(t){return typeof t===c?t.replace(/[^\d\.]/g,"").split(".")[0]:r},trim:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},I={rgx:function(){for(var t,e,i,s,n,o,a,d=0,c=arguments;d<c.length&&!o;){var p=c[d],v=c[d+1];if(typeof t===u){t={};for(s in v)v.hasOwnProperty(s)&&(n=v[s],typeof n===h?t[n[0]]=r:t[n]=r)}for(e=i=0;e<p.length&&!o;)if(o=p[e++].exec(this.getUA()))for(s=0;s<v.length;s++)a=o[++i],n=v[s],typeof n===h&&n.length>0?2==n.length?typeof n[1]==l?t[n[0]]=n[1].call(this,a):t[n[0]]=n[1]:3==n.length?typeof n[1]!==l||n[1].exec&&n[1].test?t[n[0]]=a?a.replace(n[1],n[2]):r:t[n[0]]=a?n[1].call(this,a,n[2]):r:4==n.length&&(t[n[0]]=a?n[3].call(this,a.replace(n[1],n[2])):r):t[n]=a?a:r;d+=2}return t},str:function(t,e){for(var i in e)if(typeof e[i]===h&&e[i].length>0){for(var s=0;s<e[i].length;s++)if(E.has(e[i][s],t))return i===d?r:i}else if(E.has(e[i],t))return i===d?r:i;return t}},V={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},x={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[f,y],[/(opios)[\/\s]+([\w\.]+)/i],[[f,"Opera Mini"],y],[/\s(opr)\/([\w\.]+)/i],[[f,"Opera"],y],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs)\/([\w\.-]+)/i],[f,y],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[f,"IE"],y],[/(edge)\/((\d+)?[\w\.]+)/i],[f,y],[/(yabrowser)\/([\w\.]+)/i],[[f,"Yandex"],y],[/(comodo_dragon)\/([\w\.]+)/i],[[f,/_/g," "],y],[/(micromessenger)\/([\w\.]+)/i],[[f,"WeChat"],y],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[y,[f,"MIUI Browser"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[f,/(.+)/,"$1 WebView"],y],[/android.+samsungbrowser\/([\w\.]+)/i,/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[y,[f,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(qqbrowser)[\/\s]?([\w\.]+)/i],[f,y],[/(uc\s?browser)[\/\s]?([\w\.]+)/i,/ucweb.+(ucbrowser)[\/\s]?([\w\.]+)/i,/juc.+(ucweb)[\/\s]?([\w\.]+)/i],[[f,"UCBrowser"],y],[/(dolfin)\/([\w\.]+)/i],[[f,"Dolphin"],y],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[f,"Chrome"],y],[/;fbav\/([\w\.]+);/i],[y,[f,"Facebook"]],[/fxios\/([\w\.-]+)/i],[y,[f,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[y,[f,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[y,f],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[f,[y,I.str,V.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[f,y],[/(navigator|netscape)\/([\w\.-]+)/i],[[f,"Netscape"],y],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[f,y]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[_,"amd64"]],[/(ia32(?=;))/i],[[_,E.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[_,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[_,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[_,/ower/,"",E.lowerize]],[/(sun4\w)[;\)]/i],[[_,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[_,E.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[v,g,[m,A]],[/applecoremedia\/[\w\.]+ \((ipad)/],[v,[g,"Apple"],[m,A]],[/(apple\s{0,1}tv)/i],[[v,"Apple TV"],[g,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[g,v,[m,A]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[v,[g,"Amazon"],[m,A]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[v,I.str,V.device.amazon.model],[g,"Amazon"],[m,w]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[v,g,[m,w]],[/\((ip[honed|\s\w*]+);/i],[v,[g,"Apple"],[m,w]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[g,v,[m,w]],[/\(bb10;\s(\w+)/i],[v,[g,"BlackBerry"],[m,w]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[v,[g,"Asus"],[m,A]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[g,"Sony"],[v,"Xperia Tablet"],[m,A]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[g,"Sony"],[v,"Xperia Phone"],[m,w]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[g,v,[m,b]],[/android.+;\s(shield)\sbuild/i],[v,[g,"Nvidia"],[m,b]],[/(playstation\s[34portablevi]+)/i],[v,[g,"Sony"],[m,b]],[/(sprint\s(\w+))/i],[[g,I.str,V.device.sprint.vendor],[v,I.str,V.device.sprint.model],[m,w]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[g,v,[m,A]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[g,[v,/_/g," "],[m,w]],[/(nexus\s9)/i],[v,[g,"HTC"],[m,A]],[/(nexus\s6p)/i],[v,[g,"Huawei"],[m,w]],[/(microsoft);\s(lumia[\s\w]+)/i],[g,v,[m,w]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[v,[g,"Microsoft"],[m,b]],[/(kin\.[onetw]{3})/i],[[v,/\./g," "],[g,"Microsoft"],[m,w]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[v,[g,"Motorola"],[m,w]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[v,[g,"Motorola"],[m,A]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[g,E.trim],[v,E.trim],[m,k]],[/hbbtv.+maple;(\d+)/i],[[v,/^/,"SmartTV"],[g,"Samsung"],[m,k]],[/\(dtv[\);].+(aquos)/i],[v,[g,"Sharp"],[m,k]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[g,"Samsung"],v,[m,A]],[/smart-tv.+(samsung)/i],[g,[m,k],v],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[g,"Samsung"],v,[m,w]],[/sie-(\w+)*/i],[v,[g,"Siemens"],[m,w]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[g,"Nokia"],v,[m,w]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[v,[g,"Acer"],[m,A]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[g,"LG"],v,[m,A]],[/(lg) netcast\.tv/i],[g,v,[m,k]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[v,[g,"LG"],[m,w]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[v,[g,"Lenovo"],[m,A]],[/linux;.+((jolla));/i],[g,v,[m,w]],[/((pebble))app\/[\d\.]+\s/i],[g,v,[m,T]],[/android.+;\s(glass)\s\d/i],[v,[g,"Google"],[m,T]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i],[[v,/_/g," "],[g,"Xiaomi"],[m,w]],[/android.+a000(1)\s+build/i],[v,[g,"OnePlus"],[m,w]],[/\s(tablet)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[m,E.lowerize],g,v]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[y,[f,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[f,y],[/rv\:([\w\.]+).*(gecko)/i],[y,f]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[f,y],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[f,[y,I.str,V.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[f,"Windows"],[y,I.str,V.os.windows.version]],[/\((bb)(10);/i],[[f,"BlackBerry"],y],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[f,y],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[f,"Symbian"],y],[/\((series40);/i],[f],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[f,"Firefox OS"],y],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[f,y],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[f,"Chromium OS"],y],[/(sunos)\s?([\w\.]+\d)*/i],[[f,"Solaris"],y],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[f,y],[/(haiku)\s(\w+)/i],[f,y],[/(ip[honead]+)(?:.*os\s([\w]+)*\slike\smac|;\sopera)/i],[[f,"iOS"],[y,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[f,"Mac OS"],[y,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[f,y]]},S=function(t,e){if(!(this instanceof S))return new S(t,e).getResult();var i=t||(n&&n.navigator&&n.navigator.userAgent?n.navigator.userAgent:a),s=e?E.extend(x,e):x;return this.getBrowser=function(){var t=I.rgx.apply(this,s.browser);return t.major=E.major(t.version),t},this.getCPU=function(){return I.rgx.apply(this,s.cpu)},this.getDevice=function(){return I.rgx.apply(this,s.device)},this.getEngine=function(){return I.rgx.apply(this,s.engine)},this.getOS=function(){return I.rgx.apply(this,s.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(t){return i=t,this},this};S.VERSION=o,S.BROWSER={NAME:f,MAJOR:p,VERSION:y},S.CPU={ARCHITECTURE:_},S.DEVICE={MODEL:v,VENDOR:g,TYPE:m,CONSOLE:b,MOBILE:w,SMARTTV:k,TABLET:A,WEARABLE:T,EMBEDDED:C},S.ENGINE={NAME:f,VERSION:y},S.OS={NAME:f,VERSION:y},typeof e!==u?(typeof t!==u&&t.exports&&(e=t.exports=S),e.UAParser=S):"function"===l&&i(109)?(s=function(){return S}.call(e,i,e,t),!(s!==r&&(t.exports=s))):n.UAParser=S;var P=n.jQuery||n.Zepto;if(typeof P!==u){var L=new S;P.ua=L.getResult(),P.ua.get=function(){return L.getUA()},P.ua.set=function(t){L.setUA(t);var e=L.getResult();for(var i in e)P.ua[i]=e[i]}}}("object"==typeof window?window:this)},function(t,e){(function(e){t.exports=e}).call(e,{})}]);